"use strict";var lC=Object.defineProperty,cC=Object.defineProperties,dC=Object.getOwnPropertyDescriptors,$E=Object.getOwnPropertySymbols,hC=Object.prototype.hasOwnProperty,fC=Object.prototype.propertyIsEnumerable,HE=(Ft,We,$)=>We in Ft?lC(Ft,We,{enumerable:!0,configurable:!0,writable:!0,value:$}):Ft[We]=$,GE=(Ft,We)=>{for(var $ in We||(We={}))hC.call(We,$)&&HE(Ft,$,We[$]);if($E)for(var $ of $E(We))fC.call(We,$)&&HE(Ft,$,We[$]);return Ft},WE=(Ft,We)=>cC(Ft,dC(We));(self.webpackChunkfirebaseapp=self.webpackChunkfirebaseapp||[]).push([[179],{440:(Ft,We,$)=>{$.d(We,{nm:()=>gr});var _=$(5813);$(5e3),$(5867);var ht=$(5861),xe=$(9681),Ge=$(4859),wt=$(2090),It=$(1877);const V=new Map,ut={activated:!1,tokenObservers:[]},ge={initialized:!1,enabled:!1};function Oe(Fe){return V.get(Fe)||ut}function Ue(Fe,Pe){V.set(Fe,Pe)}function Je(){return ge}class en{constructor(Pe,He,tt,pt,_t){if(this.operation=Pe,this.retryPolicy=He,this.getWaitDuration=tt,this.lowerBound=pt,this.upperBound=_t,this.pending=null,this.nextErrorWaitInterval=pt,pt>_t)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(Pe){var He=this;return(0,ht.Z)(function*(){He.stop();try{He.pending=new wt.BH,yield function on(Fe){return new Promise(Pe=>{setTimeout(Pe,Fe)})}(He.getNextRun(Pe)),He.pending.resolve(),yield He.pending.promise,He.pending=new wt.BH,yield He.operation(),He.pending.resolve(),yield He.pending.promise,He.process(!0).catch(()=>{})}catch(tt){He.retryPolicy(tt)?He.process(!1).catch(()=>{}):He.stop()}})()}getNextRun(Pe){if(Pe)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const He=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),He}}}const Kt=new wt.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function zt(Fe){if(!Oe(Fe).activated)throw Kt.create("use-before-activation",{appName:Fe.name})}function fr(Fe,Pe){return sr.apply(this,arguments)}function sr(){return(sr=(0,ht.Z)(function*({url:Fe,body:Pe},He){var tt,pt;const _t={"Content-Type":"application/json"},Un=He.getImmediate({optional:!0});if(Un){const vn=yield Un.getHeartbeatsHeader();vn&&(_t["X-Firebase-Client"]=vn)}const Mn={method:"POST",body:JSON.stringify(Pe),headers:_t};let tr,rs;try{tr=yield fetch(Fe,Mn)}catch(vn){throw Kt.create("fetch-network-error",{originalErrorMessage:null===(tt=vn)||void 0===tt?void 0:tt.message})}if(200!==tr.status)throw Kt.create("fetch-status-error",{httpStatus:tr.status});try{rs=yield tr.json()}catch(vn){throw Kt.create("fetch-parse-error",{originalErrorMessage:null===(pt=vn)||void 0===pt?void 0:pt.message})}const Bi=rs.ttl.match(/^([\d.]+)(s)$/);if(!Bi||!Bi[2]||isNaN(Number(Bi[1])))throw Kt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${rs.ttl}`});const ao=1e3*Number(Bi[1]),nr=Date.now();return{token:rs.token,expireTimeMillis:nr+ao,issuedAtTimeMillis:nr}})).apply(this,arguments)}function Gn(Fe,Pe){const{projectId:He,appId:tt,apiKey:pt}=Fe.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${He}/apps/${tt}:exchangeDebugToken?key=${pt}`,body:{debug_token:Pe}}}const Bt="firebase-app-check-store";let Sn=null;function ln(){return Sn||(Sn=new Promise((Fe,Pe)=>{var He;try{const tt=indexedDB.open("firebase-app-check-database",1);tt.onsuccess=pt=>{Fe(pt.target.result)},tt.onerror=pt=>{var _t;Pe(Kt.create("storage-open",{originalErrorMessage:null===(_t=pt.target.error)||void 0===_t?void 0:_t.message}))},tt.onupgradeneeded=pt=>{0===pt.oldVersion&&pt.target.result.createObjectStore(Bt,{keyPath:"compositeKey"})}}catch(tt){Pe(Kt.create("storage-open",{originalErrorMessage:null===(He=tt)||void 0===He?void 0:He.message}))}}),Sn)}function xr(){return(xr=(0,ht.Z)(function*(Fe,Pe){const tt=(yield ln()).transaction(Bt,"readwrite"),_t=tt.objectStore(Bt).put({compositeKey:Fe,value:Pe});return new Promise((Un,Mn)=>{_t.onsuccess=tr=>{Un()},tt.onerror=tr=>{var rs;Mn(Kt.create("storage-set",{originalErrorMessage:null===(rs=tr.target.error)||void 0===rs?void 0:rs.message}))}})})).apply(this,arguments)}const Pr=new It.Yd("@firebase/app-check");function Li(Fe,Pe){return(0,wt.hl)()?function ei(Fe,Pe){return function ci(Fe,Pe){return xr.apply(this,arguments)}(function nn(Fe){return`${Fe.options.appId}-${Fe.name}`}(Fe),Pe)}(Fe,Pe).catch(He=>{Pr.warn(`Failed to write token to IndexedDB. Error: ${He}`)}):Promise.resolve()}function dn(){return Je().enabled}function Ne(){return ye.apply(this,arguments)}function ye(){return(ye=(0,ht.Z)(function*(){const Fe=Je();if(Fe.enabled&&Fe.token)return Fe.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const ke={error:"UNKNOWN_ERROR"};function fe(Fe){return wt.US.encodeString(JSON.stringify(Fe),!1)}function qe(Fe){return At.apply(this,arguments)}function At(){return(At=(0,ht.Z)(function*(Fe,Pe=!1){const He=Fe.app;zt(He);const tt=Oe(He);let _t,pt=tt.token;if(!pt){const tr=yield tt.cachedTokenPromise;tr&&ur(tr)&&(pt=tr)}if(!Pe&&pt&&ur(pt))return{token:pt.token};let Mn,Un=!1;if(dn()){tt.exchangeTokenPromise||(tt.exchangeTokenPromise=fr(Gn(He,yield Ne()),Fe.heartbeatServiceProvider).then(rs=>(tt.exchangeTokenPromise=void 0,rs)),Un=!0);const tr=yield tt.exchangeTokenPromise;return yield Li(He,tr),Ue(He,Object.assign(Object.assign({},tt),{token:tr})),{token:tr.token}}try{tt.exchangeTokenPromise||(tt.exchangeTokenPromise=tt.provider.getToken().then(tr=>(tt.exchangeTokenPromise=void 0,tr)),Un=!0),pt=yield tt.exchangeTokenPromise}catch(tr){"appCheck/throttled"===tr.code?Pr.warn(tr.message):Pr.error(tr),_t=tr}return pt?(Mn={token:pt.token},Ue(He,Object.assign(Object.assign({},tt),{token:pt})),yield Li(He,pt)):Mn=ts(_t),Un&&an(He,Mn),Mn})).apply(this,arguments)}function hn(Fe,Pe){const He=Oe(Fe),tt=He.tokenObservers.filter(pt=>pt.next!==Pe);0===tt.length&&He.tokenRefresher&&He.tokenRefresher.isRunning()&&He.tokenRefresher.stop(),Ue(Fe,Object.assign(Object.assign({},He),{tokenObservers:tt}))}function or(Fe){const{app:Pe}=Fe,He=Oe(Pe);let tt=He.tokenRefresher;tt||(tt=function lr(Fe){const{app:Pe}=Fe;return new en((0,ht.Z)(function*(){let tt;if(tt=Oe(Pe).token?yield qe(Fe,!0):yield qe(Fe),tt.error)throw tt.error}),()=>!0,()=>{const He=Oe(Pe);if(He.token){let tt=He.token.issuedAtTimeMillis+.5*(He.token.expireTimeMillis-He.token.issuedAtTimeMillis)+3e5;return tt=Math.min(tt,He.token.expireTimeMillis-3e5),Math.max(0,tt-Date.now())}return 0},3e4,96e4)}(Fe),Ue(Pe,Object.assign(Object.assign({},He),{tokenRefresher:tt}))),!tt.isRunning()&&He.isTokenAutoRefreshEnabled&&tt.start()}function an(Fe,Pe){const He=Oe(Fe).tokenObservers;for(const tt of He)try{"EXTERNAL"===tt.type&&null!=Pe.error?tt.error(Pe.error):tt.next(Pe)}catch(pt){}}function ur(Fe){return Fe.expireTimeMillis-Date.now()>0}function ts(Fe){return{token:fe(ke),error:Fe}}class Gr{constructor(Pe,He){this.app=Pe,this.heartbeatServiceProvider=He}_delete(){const{tokenObservers:Pe}=Oe(this.app);for(const He of Pe)hn(this.app,He.next);return Promise.resolve()}}const gt="app-check-internal";!function Qt(){(0,xe._registerComponent)(new Ge.wA("app-check",Fe=>function _i(Fe,Pe){return new Gr(Fe,Pe)}(Fe.getProvider("app").getImmediate(),Fe.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((Fe,Pe,He)=>{Fe.getProvider(gt).initialize()})),(0,xe._registerComponent)(new Ge.wA(gt,Fe=>function yn(Fe){return{getToken:Pe=>qe(Fe,Pe),addTokenListener:Pe=>function $t(Fe,Pe,He,tt){const{app:pt}=Fe,_t=Oe(pt),Un={next:He,error:tt,type:Pe};if(Ue(pt,Object.assign(Object.assign({},_t),{tokenObservers:[..._t.tokenObservers,Un]})),_t.token&&ur(_t.token)){const Mn=_t.token;Promise.resolve().then(()=>{He({token:Mn.token}),or(Fe)}).catch(()=>{})}_t.cachedTokenPromise.then(()=>or(Fe))}(Fe,"INTERNAL",Pe),removeTokenListener:Pe=>hn(Fe.app,Pe)}}(Fe.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,xe.registerVersion)("@firebase/app-check","0.5.10")}();class gr{constructor(){return(0,_.vb)("app-check")}}"undefined"!=typeof window&&window},1205:(Ft,We,$)=>{$.d(We,{zQ:()=>Ye,ww:()=>St,rT:()=>ge,f7:()=>Ue,L6:()=>V,_Q:()=>ut,lh:()=>Oe,Qv:()=>It,nw:()=>Je});var _=$(5e3),ne=$(7579),ie=$(9646),be=$(8306),Ce=$(8996),Se=$(6451),Ve=$(6063);class Me extends ne.x{constructor(Wt=1/0,qt=1/0,it=Ve.l){super(),this._bufferSize=Wt,this._windowTime=qt,this._timestampProvider=it,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=qt===1/0,this._bufferSize=Math.max(1,Wt),this._windowTime=Math.max(1,qt)}next(Wt){const{isStopped:qt,_buffer:it,_infiniteTimeWindow:en,_timestampProvider:on,_windowTime:tn}=this;qt||(it.push(Wt),!en&&it.push(on.now()+tn)),this._trimBuffer(),super.next(Wt)}_subscribe(Wt){this._throwIfClosed(),this._trimBuffer();const qt=this._innerSubscribe(Wt),{_infiniteTimeWindow:it,_buffer:en}=this,on=en.slice();for(let tn=0;tn<on.length&&!Wt.closed;tn+=it?1:2)Wt.next(on[tn]);return this._checkFinalizedStatuses(Wt),qt}_trimBuffer(){const{_bufferSize:Wt,_timestampProvider:qt,_buffer:it,_infiniteTimeWindow:en}=this,on=(en?1:2)*Wt;if(Wt<1/0&&on<it.length&&it.splice(0,it.length-on),!en){const tn=qt.now();let Kt=0;for(let Tn=1;Tn<it.length&&it[Tn]<=tn;Tn+=2)Kt=Tn;Kt&&it.splice(0,Kt+1)}}}var Be=$(3099);function ce(Pt,Wt,qt){let it,en=!1;return Pt&&"object"==typeof Pt?({bufferSize:it=1/0,windowTime:Wt=1/0,refCount:en=!1,scheduler:qt}=Pt):it=null!=Pt?Pt:1/0,(0,Be.B)({connector:()=>new Me(it,Wt,qt),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:en})}var ae=$(3900),Re=$(576);function Rt(Pt,Wt){return(0,Re.m)(Wt)?(0,ae.w)(()=>Pt,Wt):(0,ae.w)(()=>Pt)}var ot=$(5363),at=$(4004),Dt=$(590),nt=$(9468),ft=$(9300),De=$(5813),kt=$(2011),ht=$(9808),xe=$(440),Ge=$(127);const It=new _.OlP("angularfire2.auth.use-emulator"),V=new _.OlP("angularfire2.auth.settings"),ut=new _.OlP("angularfire2.auth.tenant-id"),ge=new _.OlP("angularfire2.auth.langugage-code"),Oe=new _.OlP("angularfire2.auth.use-device-language"),Ue=new _.OlP("angularfire.auth.persistence"),Je=(Pt,Wt,qt,it,en,on,tn,Kt)=>(0,kt.cc)(`${Pt.name}.auth`,"AngularFireAuth",Pt.name,()=>{const Tn=Wt.runOutsideAngular(()=>Pt.auth());if(qt&&Tn.useEmulator(...qt),it&&(Tn.tenantId=it),Tn.languageCode=en,on&&Tn.useDeviceLanguage(),tn)for(const[zt,Yt]of Object.entries(tn))Tn.settings[zt]=Yt;return Kt&&Tn.setPersistence(Kt),Tn},[qt,it,en,on,tn,Kt]);let Ye=(()=>{class Pt{constructor(qt,it,en,on,tn,Kt,Tn,zt,Yt,hr,fr,sr){const Pn=new ne.x,Hr=(0,ie.of)(void 0).pipe((0,ot.Q)(tn.outsideAngular),(0,ae.w)(()=>on.runOutsideAngular(()=>Promise.resolve().then($.bind($,3677)))),(0,at.U)(()=>(0,kt.on)(qt,on,it)),(0,at.U)(Gn=>Je(Gn,on,Kt,zt,Yt,hr,Tn,fr)),ce({bufferSize:1,refCount:!1}));if((0,ht.PM)(en))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,ie.of)(null);else{Hr.pipe((0,Dt.P)()).subscribe();const Ar=Hr.pipe((0,ae.w)(En=>En.getRedirectResult().then(Sn=>Sn,()=>null)),De.iC,ce({bufferSize:1,refCount:!1})),Vn=Hr.pipe((0,ae.w)(En=>new be.y(Sn=>({unsubscribe:on.runOutsideAngular(()=>En.onAuthStateChanged(ln=>Sn.next(ln),ln=>Sn.error(ln),()=>Sn.complete()))})))),Bt=Hr.pipe((0,ae.w)(En=>new be.y(Sn=>({unsubscribe:on.runOutsideAngular(()=>En.onIdTokenChanged(ln=>Sn.next(ln),ln=>Sn.error(ln),()=>Sn.complete()))}))));this.authState=Ar.pipe(Rt(Vn),(0,nt.R)(tn.outsideAngular),(0,ot.Q)(tn.insideAngular)),this.user=Ar.pipe(Rt(Bt),(0,nt.R)(tn.outsideAngular),(0,ot.Q)(tn.insideAngular)),this.idToken=this.user.pipe((0,ae.w)(En=>En?(0,Ce.D)(En.getIdToken()):(0,ie.of)(null))),this.idTokenResult=this.user.pipe((0,ae.w)(En=>En?(0,Ce.D)(En.getIdTokenResult()):(0,ie.of)(null))),this.credential=(0,Se.T)(Ar,Pn,this.authState.pipe((0,ft.h)(En=>!En))).pipe((0,at.U)(En=>(null==En?void 0:En.user)?En:null),(0,nt.R)(tn.outsideAngular),(0,ot.Q)(tn.insideAngular))}return(0,kt.pX)(this,Hr,on,{spy:{apply:(Gn,Ar,Vn)=>{(Gn.startsWith("signIn")||Gn.startsWith("createUser"))&&Vn.then(Bt=>Pn.next(Bt))}}})}}return Pt.\u0275fac=function(qt){return new(qt||Pt)(_.LFG(kt.Dh),_.LFG(kt.xv,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(De.HU),_.LFG(It,8),_.LFG(V,8),_.LFG(ut,8),_.LFG(ge,8),_.LFG(Oe,8),_.LFG(Ue,8),_.LFG(xe.nm,8))},Pt.\u0275prov=_.Yz7({token:Pt,factory:Pt.\u0275fac,providedIn:"any"}),Pt})(),St=(()=>{class Pt{constructor(){Ge.Z.registerVersion("angularfire",De.q4.full,"auth-compat")}}return Pt.\u0275fac=function(qt){return new(qt||Pt)},Pt.\u0275mod=_.oAB({type:Pt}),Pt.\u0275inj=_.cJS({providers:[Ye]}),Pt})()},7471:(Ft,We,$)=>{$.d(We,{KQ:()=>Ef,JS:()=>Tc});var _=$(5e3),ne=$(4986),ie=$(8306),be=$(9646),Ce=$(6451),Se=$(4482),Ve=$(5403),Me=$(8421),Be=$(4671),ce=$(5032),ae=$(7669),ot=$(4004),at=$(3099),Dt=$(3900),nt=$(5026),ft=$(1884),De=$(5813),kt=$(2011),xe=($(3677),$(3942)),Ge=$(4859),wt=$(5861),It=$(9681),V=$(2090),ut=$(1877);const ge="@firebase/database";let Ue="";function Je(d){Ue=d}class Ye{constructor(u){this.domStorage_=u,this.prefix_="firebase:"}set(u,l){null==l?this.domStorage_.removeItem(this.prefixedName_(u)):this.domStorage_.setItem(this.prefixedName_(u),(0,V.Pz)(l))}get(u){const l=this.domStorage_.getItem(this.prefixedName_(u));return null==l?null:(0,V.cI)(l)}remove(u){this.domStorage_.removeItem(this.prefixedName_(u))}prefixedName_(u){return this.prefix_+u}toString(){return this.domStorage_.toString()}}class St{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(u,l){null==l?delete this.cache_[u]:this.cache_[u]=l}get(u){return(0,V.r3)(this.cache_,u)?this.cache_[u]:null}remove(u){delete this.cache_[u]}}const Pt=function(d){try{if("undefined"!=typeof window&&void 0!==window[d]){const u=window[d];return u.setItem("firebase:sentinel","cache"),u.removeItem("firebase:sentinel"),new Ye(u)}}catch(u){}return new St},Wt=Pt("localStorage"),qt=Pt("sessionStorage"),it=new ut.Yd("@firebase/database"),en=function(){let d=1;return function(){return d++}}(),on=function(d){const u=(0,V.dS)(d),l=new V.gQ;l.update(u);const g=l.digest();return V.US.encodeByteArray(g)},tn=function(...d){let u="";for(let l=0;l<d.length;l++){const g=d[l];Array.isArray(g)||g&&"object"==typeof g&&"number"==typeof g.length?u+=tn.apply(null,g):u+="object"==typeof g?(0,V.Pz)(g):g,u+=" "}return u};let Kt=null,Tn=!0;const zt=function(d,u){(0,V.hu)(!u||!0===d||!1===d,"Can't turn on custom loggers persistently."),!0===d?(it.logLevel=ut.in.VERBOSE,Kt=it.log.bind(it),u&&qt.set("logging_enabled",!0)):"function"==typeof d?Kt=d:(Kt=null,qt.remove("logging_enabled"))},Yt=function(...d){if(!0===Tn&&(Tn=!1,null===Kt&&!0===qt.get("logging_enabled")&&zt(!0)),Kt){const u=tn.apply(null,d);Kt(u)}},hr=function(d){return function(...u){Yt(d,...u)}},fr=function(...d){const u="FIREBASE INTERNAL ERROR: "+tn(...d);it.error(u)},sr=function(...d){const u=`FIREBASE FATAL ERROR: ${tn(...d)}`;throw it.error(u),new Error(u)},Pn=function(...d){const u="FIREBASE WARNING: "+tn(...d);it.warn(u)},Gn=function(d){return"number"==typeof d&&(d!=d||d===Number.POSITIVE_INFINITY||d===Number.NEGATIVE_INFINITY)},Vn="[MIN_NAME]",Bt="[MAX_NAME]",En=function(d,u){if(d===u)return 0;if(d===Vn||u===Bt)return-1;if(u===Vn||d===Bt)return 1;{const l=ri(d),g=ri(u);return null!==l?null!==g?l-g==0?d.length-u.length:l-g:-1:null!==g?1:d<u?-1:1}},Sn=function(d,u){return d===u?0:d<u?-1:1},ln=function(d,u){if(u&&d in u)return u[d];throw new Error("Missing required key ("+d+") in object: "+(0,V.Pz)(u))},Ci=function(d){if("object"!=typeof d||null===d)return(0,V.Pz)(d);const u=[];for(const g in d)u.push(g);u.sort();let l="{";for(let g=0;g<u.length;g++)0!==g&&(l+=","),l+=(0,V.Pz)(u[g]),l+=":",l+=Ci(d[u[g]]);return l+="}",l},ei=function(d,u){const l=d.length;if(l<=u)return[d];const g=[];for(let I=0;I<l;I+=u)g.push(d.substring(I,I+u>l?l:I+u));return g};function Zn(d,u){for(const l in d)d.hasOwnProperty(l)&&u(l,d[l])}const Fr=function(d){(0,V.hu)(!Gn(d),"Invalid JSON number");const g=1023;let I,M,H,ee,ue;0===d?(M=0,H=0,I=1/d==-1/0?1:0):(I=d<0,(d=Math.abs(d))>=Math.pow(2,1-g)?(ee=Math.min(Math.floor(Math.log(d)/Math.LN2),g),M=ee+g,H=Math.round(d*Math.pow(2,52-ee)-Math.pow(2,52))):(M=0,H=Math.round(d/Math.pow(2,-1074))));const ve=[];for(ue=52;ue;ue-=1)ve.push(H%2?1:0),H=Math.floor(H/2);for(ue=11;ue;ue-=1)ve.push(M%2?1:0),M=Math.floor(M/2);ve.push(I?1:0),ve.reverse();const et=ve.join("");let lt="";for(ue=0;ue<64;ue+=8){let bt=parseInt(et.substr(ue,8),2).toString(16);1===bt.length&&(bt="0"+bt),lt+=bt}return lt.toLowerCase()},Xt=new RegExp("^-?(0*)\\d{1,10}$"),nn=-2147483648,Pr=2147483647,ri=function(d){if(Xt.test(d)){const u=Number(d);if(u>=nn&&u<=Pr)return u}return null},cn=function(d){try{d()}catch(u){setTimeout(()=>{throw Pn("Exception was thrown by user callback.",u.stack||""),u},Math.floor(0))}},Lr=function(d,u){const l=setTimeout(d,u);return"object"==typeof l&&l.unref&&l.unref(),l};class vr{constructor(u,l){this.appName_=u,this.appCheckProvider=l,this.appCheck=null==l?void 0:l.getImmediate({optional:!0}),this.appCheck||null==l||l.get().then(g=>this.appCheck=g)}getToken(u){return this.appCheck?this.appCheck.getToken(u):new Promise((l,g)=>{setTimeout(()=>{this.appCheck?this.getToken(u).then(l,g):l(null)},0)})}addTokenChangeListener(u){var l;null===(l=this.appCheckProvider)||void 0===l||l.get().then(g=>g.addTokenListener(u))}notifyForInvalidToken(){Pn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class dn{constructor(u,l,g){this.appName_=u,this.firebaseOptions_=l,this.authProvider_=g,this.auth_=null,this.auth_=g.getImmediate({optional:!0}),this.auth_||g.onInit(I=>this.auth_=I)}getToken(u){return this.auth_?this.auth_.getToken(u).catch(l=>l&&"auth/token-not-initialized"===l.code?(Yt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(l)):new Promise((l,g)=>{setTimeout(()=>{this.auth_?this.getToken(u).then(l,g):l(null)},0)})}addTokenChangeListener(u){this.auth_?this.auth_.addAuthTokenListener(u):this.authProvider_.get().then(l=>l.addAuthTokenListener(u))}removeTokenChangeListener(u){this.authProvider_.get().then(l=>l.removeAuthTokenListener(u))}notifyForInvalidToken(){let u='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';u+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Pn(u)}}let Ne=(()=>{class d{constructor(l){this.accessToken=l}getToken(l){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(l){l(this.accessToken)}removeTokenChangeListener(l){}notifyForInvalidToken(){}}return d.OWNER="owner",d})();const At=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,lr="websocket",an="long_polling";class ur{constructor(u,l,g,I,M=!1,H="",ee=!1){this.secure=l,this.namespace=g,this.webSocketOnly=I,this.nodeAdmin=M,this.persistenceKey=H,this.includeNamespaceInQueryParams=ee,this._host=u.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Wt.get("host:"+u)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(u){u!==this.internalHost&&(this.internalHost=u,this.isCacheableHost()&&Wt.set("host:"+this._host,this.internalHost))}toString(){let u=this.toURLString();return this.persistenceKey&&(u+="<"+this.persistenceKey+">"),u}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Gr(d,u,l){let g;if((0,V.hu)("string"==typeof u,"typeof type must == string"),(0,V.hu)("object"==typeof l,"typeof params must == object"),u===lr)g=(d.secure?"wss://":"ws://")+d.internalHost+"/.ws?";else{if(u!==an)throw new Error("Unknown connection type: "+u);g=(d.secure?"https://":"http://")+d.internalHost+"/.lp?"}(function ts(d){return d.host!==d.internalHost||d.isCustomHost()||d.includeNamespaceInQueryParams})(d)&&(l.ns=d.namespace);const I=[];return Zn(l,(M,H)=>{I.push(M+"="+H)}),g+I.join("&")}class _i{constructor(){this.counters_={}}incrementCounter(u,l=1){(0,V.r3)(this.counters_,u)||(this.counters_[u]=0),this.counters_[u]+=l}get(){return(0,V.p$)(this.counters_)}}const yn={},br={};function ii(d){const u=d.toString();return yn[u]||(yn[u]=new _i),yn[u]}class Vr{constructor(u){this.onMessage_=u,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(u,l){this.closeAfterResponse=u,this.onClose=l,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(u,l){for(this.pendingResponses[u]=l;this.pendingResponses[this.currentResponseNum];){const g=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let I=0;I<g.length;++I)g[I]&&cn(()=>{this.onMessage_(g[I])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Ee{constructor(u,l,g,I,M,H,ee){this.connId=u,this.repoInfo=l,this.applicationId=g,this.appCheckToken=I,this.authToken=M,this.transportSessionId=H,this.lastSessionId=ee,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=hr(u),this.stats_=ii(l),this.urlFn=ue=>(this.appCheckToken&&(ue.ac=this.appCheckToken),Gr(l,an,ue))}open(u,l){this.curSegmentNum=0,this.onDisconnect_=l,this.myPacketOrderer=new Vr(u),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(d){if((0,V.Yr)()||"complete"===document.readyState)d();else{let u=!1;const l=function(){document.body?u||(u=!0,d()):setTimeout(l,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",l,!1),window.addEventListener("load",l,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&l()}),window.attachEvent("onload",l))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new pe((...M)=>{const[H,ee,ue,ve,et]=M;if(this.incrementIncomingBytes_(M),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===H)this.id=ee,this.password=ue;else{if("close"!==H)throw new Error("Unrecognized command received: "+H);ee?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(ee,()=>{this.onClosed_()})):this.onClosed_()}},(...M)=>{const[H,ee]=M;this.incrementIncomingBytes_(M),this.myPacketOrderer.handleResponse(H,ee)},()=>{this.onClosed_()},this.urlFn);const g={start:"t"};g.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(g.cb=this.scriptTagHolder.uniqueCallbackIdentifier),g.v="5",this.transportSessionId&&(g.s=this.transportSessionId),this.lastSessionId&&(g.ls=this.lastSessionId),this.applicationId&&(g.p=this.applicationId),this.appCheckToken&&(g.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&At.test(location.hostname)&&(g.r="f");const I=this.urlFn(g);this.log_("Connecting via long-poll to "+I),this.scriptTagHolder.addTag(I,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ee.forceAllow_=!0}static forceDisallow(){Ee.forceDisallow_=!0}static isAvailable(){return!((0,V.Yr)()||!Ee.forceAllow_&&(Ee.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(u){const l=(0,V.Pz)(u);this.bytesSent+=l.length,this.stats_.incrementCounter("bytes_sent",l.length);const g=(0,V.h$)(l),I=ei(g,1840);for(let M=0;M<I.length;M++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,I.length,I[M]),this.curSegmentNum++}addDisconnectPingFrame(u,l){if((0,V.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const g={dframe:"t"};g.id=u,g.pw=l,this.myDisconnFrame.src=this.urlFn(g),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(u){const l=(0,V.Pz)(u).length;this.bytesReceived+=l,this.stats_.incrementCounter("bytes_received",l)}}class pe{constructor(u,l,g,I){if(this.onDisconnect=g,this.urlFn=I,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,V.Yr)())this.commandCB=u,this.onMessageCB=l;else{this.uniqueCallbackIdentifier=en(),window["pLPCommand"+this.uniqueCallbackIdentifier]=u,window["pRTLPCB"+this.uniqueCallbackIdentifier]=l,this.myIFrame=pe.createIFrame_();let M="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(M='<script>document.domain="'+document.domain+'";<\/script>');const H="<html><body>"+M+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(H),this.myIFrame.doc.close()}catch(ee){Yt("frame writing exception"),ee.stack&&Yt(ee.stack),Yt(ee)}}}static createIFrame_(){const u=document.createElement("iframe");if(u.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(u);try{u.contentWindow.document||Yt("No IE domain setting required")}catch(l){const g=document.domain;u.src="javascript:void((function(){document.open();document.domain='"+g+"';document.close();})())"}return u.contentDocument?u.doc=u.contentDocument:u.contentWindow?u.doc=u.contentWindow.document:u.document&&(u.doc=u.document),u}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const u=this.onDisconnect;u&&(this.onDisconnect=null,u())}startLongPoll(u,l){for(this.myID=u,this.myPW=l,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const u={};u.id=this.myID,u.pw=this.myPW,u.ser=this.currentSerial;let l=this.urlFn(u),g="",I=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+g.length<=1870;){const H=this.pendingSegs.shift();g=g+"&seg"+I+"="+H.seg+"&ts"+I+"="+H.ts+"&d"+I+"="+H.d,I++}return l+=g,this.addLongPollTag_(l,this.currentSerial),!0}return!1}enqueueSegment(u,l,g){this.pendingSegs.push({seg:u,ts:l,d:g}),this.alive&&this.newRequest_()}addLongPollTag_(u,l){this.outstandingRequests.add(l);const g=()=>{this.outstandingRequests.delete(l),this.newRequest_()},I=setTimeout(g,Math.floor(25e3));this.addTag(u,()=>{clearTimeout(I),g()})}addTag(u,l){(0,V.Yr)()?this.doNodeLongPoll(u,l):setTimeout(()=>{try{if(!this.sendNewPolls)return;const g=this.myIFrame.doc.createElement("script");g.type="text/javascript",g.async=!0,g.src=u,g.onload=g.onreadystatechange=function(){const I=g.readyState;(!I||"loaded"===I||"complete"===I)&&(g.onload=g.onreadystatechange=null,g.parentNode&&g.parentNode.removeChild(g),l())},g.onerror=()=>{Yt("Long-poll script failed to load: "+u),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(g)}catch(g){}},Math.floor(1))}}let gt=null;"undefined"!=typeof MozWebSocket?gt=MozWebSocket:"undefined"!=typeof WebSocket&&(gt=WebSocket);let Qt=(()=>{class d{constructor(l,g,I,M,H,ee,ue){this.connId=l,this.applicationId=I,this.appCheckToken=M,this.authToken=H,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=hr(this.connId),this.stats_=ii(g),this.connURL=d.connectionURL_(g,ee,ue,M,I),this.nodeAdmin=g.nodeAdmin}static connectionURL_(l,g,I,M,H){const ee={v:"5"};return!(0,V.Yr)()&&"undefined"!=typeof location&&location.hostname&&At.test(location.hostname)&&(ee.r="f"),g&&(ee.s=g),I&&(ee.ls=I),M&&(ee.ac=M),H&&(ee.p=H),Gr(l,lr,ee)}open(l,g){this.onDisconnect=g,this.onMessage=l,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Wt.set("previous_websocket_failure",!0);try{let I;if((0,V.Yr)()){const H={headers:{"User-Agent":`Firebase/5/${Ue}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(H.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(H.headers["X-Firebase-AppCheck"]=this.appCheckToken);const ee=process.env,ue=0===this.connURL.indexOf("wss://")?ee.HTTPS_PROXY||ee.https_proxy:ee.HTTP_PROXY||ee.http_proxy;ue&&(H.proxy={origin:ue})}this.mySock=new gt(this.connURL,[],I)}catch(I){this.log_("Error instantiating WebSocket.");const M=I.message||I.data;return M&&this.log_(M),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=I=>{this.handleIncomingFrame(I)},this.mySock.onerror=I=>{this.log_("WebSocket error.  Closing connection.");const M=I.message||I.data;M&&this.log_(M),this.onClosed_()}}start(){}static forceDisallow(){d.forceDisallow_=!0}static isAvailable(){let l=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const I=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);I&&I.length>1&&parseFloat(I[1])<4.4&&(l=!0)}return!l&&null!==gt&&!d.forceDisallow_}static previouslyFailed(){return Wt.isInMemoryStorage||!0===Wt.get("previous_websocket_failure")}markConnectionHealthy(){Wt.remove("previous_websocket_failure")}appendFrame_(l){if(this.frames.push(l),this.frames.length===this.totalFrames){const g=this.frames.join("");this.frames=null;const I=(0,V.cI)(g);this.onMessage(I)}}handleNewFrameCount_(l){this.totalFrames=l,this.frames=[]}extractFrameCount_(l){if((0,V.hu)(null===this.frames,"We already have a frame buffer"),l.length<=6){const g=Number(l);if(!isNaN(g))return this.handleNewFrameCount_(g),null}return this.handleNewFrameCount_(1),l}handleIncomingFrame(l){if(null===this.mySock)return;const g=l.data;if(this.bytesReceived+=g.length,this.stats_.incrementCounter("bytes_received",g.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(g);else{const I=this.extractFrameCount_(g);null!==I&&this.appendFrame_(I)}}send(l){this.resetKeepAlive();const g=(0,V.Pz)(l);this.bytesSent+=g.length,this.stats_.incrementCounter("bytes_sent",g.length);const I=ei(g,16384);I.length>1&&this.sendString_(String(I.length));for(let M=0;M<I.length;M++)this.sendString_(I[M])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(l){try{this.mySock.send(l)}catch(g){this.log_("Exception thrown from WebSocket.send():",g.message||g.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return d.responsesRequiredToBeHealthy=2,d.healthyTimeout=3e4,d})(),gn=(()=>{class d{constructor(l){this.initTransports_(l)}static get ALL_TRANSPORTS(){return[Ee,Qt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(l){const g=Qt&&Qt.isAvailable();let I=g&&!Qt.previouslyFailed();if(l.webSocketOnly&&(g||Pn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),I=!0),I)this.transports_=[Qt];else{const M=this.transports_=[];for(const H of d.ALL_TRANSPORTS)H&&H.isAvailable()&&M.push(H);d.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return d.globalTransportInitialized_=!1,d})();class yo{constructor(u,l,g,I,M,H,ee,ue,ve,et){this.id=u,this.repoInfo_=l,this.applicationId_=g,this.appCheckToken_=I,this.authToken_=M,this.onMessage_=H,this.onReady_=ee,this.onDisconnect_=ue,this.onKill_=ve,this.lastSessionId=et,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=hr("c:"+this.id+":"),this.transportManager_=new gn(l),this.log_("Connection created"),this.start_()}start_(){const u=this.transportManager_.initialTransport();this.conn_=new u(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=u.responsesRequiredToBeHealthy||0;const l=this.connReceiver_(this.conn_),g=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(l,g)},Math.floor(0));const I=u.healthyTimeout||0;I>0&&(this.healthyTimeout_=Lr(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(I)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(u){return l=>{u===this.conn_?this.onConnectionLost_(l):u===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(u){return l=>{2!==this.state_&&(u===this.rx_?this.onPrimaryMessageReceived_(l):u===this.secondaryConn_?this.onSecondaryMessageReceived_(l):this.log_("message on old connection"))}}sendRequest(u){this.sendData_({t:"d",d:u})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(u){if("t"in u){const l=u.t;"a"===l?this.upgradeIfSecondaryHealthy_():"r"===l?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===l&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(u){const l=ln("t",u),g=ln("d",u);if("c"===l)this.onSecondaryControl_(g);else{if("d"!==l)throw new Error("Unknown protocol layer: "+l);this.pendingDataMessages.push(g)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(u){const l=ln("t",u),g=ln("d",u);"c"===l?this.onControl_(g):"d"===l&&this.onDataMessage_(g)}onDataMessage_(u){this.onPrimaryResponse_(),this.onMessage_(u)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(u){const l=ln("t",u);if("d"in u){const g=u.d;if("h"===l)this.onHandshake_(g);else if("n"===l){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let I=0;I<this.pendingDataMessages.length;++I)this.onDataMessage_(this.pendingDataMessages[I]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===l?this.onConnectionShutdown_(g):"r"===l?this.onReset_(g):"e"===l?fr("Server Error: "+g):"o"===l?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):fr("Unknown control packet command: "+l)}}onHandshake_(u){const l=u.ts,g=u.v,I=u.h;this.sessionId=u.s,this.repoInfo_.host=I,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,l),"5"!==g&&Pn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const u=this.transportManager_.upgradeTransport();u&&this.startUpgrade_(u)}startUpgrade_(u){this.secondaryConn_=new u(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=u.responsesRequiredToBeHealthy||0;const l=this.connReceiver_(this.secondaryConn_),g=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(l,g),Lr(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(u){this.log_("Reset packet received.  New host: "+u),this.repoInfo_.host=u,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(u,l){this.log_("Realtime connection established."),this.conn_=u,this.state_=1,this.onReady_&&(this.onReady_(l,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Lr(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const u=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===u||this.rx_===u)&&this.close()}onConnectionLost_(u){this.conn_=null,u||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Wt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(u){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(u),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(u){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(u)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Ir{put(u,l,g,I){}merge(u,l,g,I){}refreshAuthToken(u){}refreshAppCheckToken(u){}onDisconnectPut(u,l,g){}onDisconnectMerge(u,l,g){}onDisconnectCancel(u,l){}reportStats(u){}}class us{constructor(u){this.allowedEvents_=u,this.listeners_={},(0,V.hu)(Array.isArray(u)&&u.length>0,"Requires a non-empty array")}trigger(u,...l){if(Array.isArray(this.listeners_[u])){const g=[...this.listeners_[u]];for(let I=0;I<g.length;I++)g[I].callback.apply(g[I].context,l)}}on(u,l,g){this.validateEventType_(u),this.listeners_[u]=this.listeners_[u]||[],this.listeners_[u].push({callback:l,context:g});const I=this.getInitialEvent(u);I&&l.apply(g,I)}off(u,l,g){this.validateEventType_(u);const I=this.listeners_[u]||[];for(let M=0;M<I.length;M++)if(I[M].callback===l&&(!g||g===I[M].context))return void I.splice(M,1)}validateEventType_(u){(0,V.hu)(this.allowedEvents_.find(l=>l===u),"Unknown event: "+u)}}class Fe extends us{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,V.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Fe}getInitialEvent(u){return(0,V.hu)("online"===u,"Unknown event type: "+u),[this.online_]}currentlyOnline(){return this.online_}}class tt{constructor(u,l){if(void 0===l){this.pieces_=u.split("/");let g=0;for(let I=0;I<this.pieces_.length;I++)this.pieces_[I].length>0&&(this.pieces_[g]=this.pieces_[I],g++);this.pieces_.length=g,this.pieceNum_=0}else this.pieces_=u,this.pieceNum_=l}toString(){let u="";for(let l=this.pieceNum_;l<this.pieces_.length;l++)""!==this.pieces_[l]&&(u+="/"+this.pieces_[l]);return u||"/"}}function pt(){return new tt("")}function _t(d){return d.pieceNum_>=d.pieces_.length?null:d.pieces_[d.pieceNum_]}function Un(d){return d.pieces_.length-d.pieceNum_}function Mn(d){let u=d.pieceNum_;return u<d.pieces_.length&&u++,new tt(d.pieces_,u)}function tr(d){return d.pieceNum_<d.pieces_.length?d.pieces_[d.pieces_.length-1]:null}function Bi(d,u=0){return d.pieces_.slice(d.pieceNum_+u)}function ao(d){if(d.pieceNum_>=d.pieces_.length)return null;const u=[];for(let l=d.pieceNum_;l<d.pieces_.length-1;l++)u.push(d.pieces_[l]);return new tt(u,0)}function nr(d,u){const l=[];for(let g=d.pieceNum_;g<d.pieces_.length;g++)l.push(d.pieces_[g]);if(u instanceof tt)for(let g=u.pieceNum_;g<u.pieces_.length;g++)l.push(u.pieces_[g]);else{const g=u.split("/");for(let I=0;I<g.length;I++)g[I].length>0&&l.push(g[I])}return new tt(l,0)}function vn(d){return d.pieceNum_>=d.pieces_.length}function Ur(d,u){const l=_t(d),g=_t(u);if(null===l)return u;if(l===g)return Ur(Mn(d),Mn(u));throw new Error("INTERNAL ERROR: innerPath ("+u+") is not within outerPath ("+d+")")}function _s(d,u){const l=Bi(d,0),g=Bi(u,0);for(let I=0;I<l.length&&I<g.length;I++){const M=En(l[I],g[I]);if(0!==M)return M}return l.length===g.length?0:l.length<g.length?-1:1}function uo(d,u){if(Un(d)!==Un(u))return!1;for(let l=d.pieceNum_,g=u.pieceNum_;l<=d.pieces_.length;l++,g++)if(d.pieces_[l]!==u.pieces_[g])return!1;return!0}function ji(d,u){let l=d.pieceNum_,g=u.pieceNum_;if(Un(d)>Un(u))return!1;for(;l<d.pieces_.length;){if(d.pieces_[l]!==u.pieces_[g])return!1;++l,++g}return!0}class ti{constructor(u,l){this.errorPrefix_=l,this.parts_=Bi(u,0),this.byteLength_=Math.max(1,this.parts_.length);for(let g=0;g<this.parts_.length;g++)this.byteLength_+=(0,V.ug)(this.parts_[g]);vs(this)}}function vs(d){if(d.byteLength_>768)throw new Error(d.errorPrefix_+"has a key path longer than 768 bytes ("+d.byteLength_+").");if(d.parts_.length>32)throw new Error(d.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+ls(d))}function ls(d){return 0===d.parts_.length?"":"in property '"+d.parts_.join(".")+"'"}class Es extends us{constructor(){let u,l;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(l="visibilitychange",u="hidden"):void 0!==document.mozHidden?(l="mozvisibilitychange",u="mozHidden"):void 0!==document.msHidden?(l="msvisibilitychange",u="msHidden"):void 0!==document.webkitHidden&&(l="webkitvisibilitychange",u="webkitHidden")),this.visible_=!0,l&&document.addEventListener(l,()=>{const g=!document[u];g!==this.visible_&&(this.visible_=g,this.trigger("visible",g))},!1)}static getInstance(){return new Es}getInitialEvent(u){return(0,V.hu)("visible"===u,"Unknown event type: "+u),[this.visible_]}}const Ao=1e3;let $i,ws=(()=>{class d extends Ir{constructor(l,g,I,M,H,ee,ue,ve){if(super(),this.repoInfo_=l,this.applicationId_=g,this.onDataUpdate_=I,this.onConnectStatus_=M,this.onServerInfoUpdate_=H,this.authTokenProvider_=ee,this.appCheckTokenProvider_=ue,this.authOverride_=ve,this.id=d.nextPersistentConnectionId_++,this.log_=hr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ao,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,ve&&!(0,V.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Es.getInstance().on("visible",this.onVisible_,this),-1===l.host.indexOf("fblocal")&&Fe.getInstance().on("online",this.onOnline_,this)}sendRequest(l,g,I){const M=++this.requestNumber_,H={r:M,a:l,b:g};this.log_((0,V.Pz)(H)),(0,V.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(H),I&&(this.requestCBHash_[M]=I)}get(l){this.initConnection_();const g=new V.BH,M={action:"g",request:{p:l._path.toString(),q:l._queryObject},onComplete:ee=>{const ue=ee.d;"ok"===ee.s?g.resolve(ue):g.reject(ue)}};this.outstandingGets_.push(M),this.outstandingGetCount_++;const H=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const ee=this.outstandingGets_[H];void 0===ee||M!==ee||(delete this.outstandingGets_[H],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+H+" timed out on connection"),g.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(H),g.promise}listen(l,g,I,M){this.initConnection_();const H=l._queryIdentifier,ee=l._path.toString();this.log_("Listen called for "+ee+" "+H),this.listens.has(ee)||this.listens.set(ee,new Map),(0,V.hu)(l._queryParams.isDefault()||!l._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,V.hu)(!this.listens.get(ee).has(H),"listen() called twice for same path/queryId.");const ue={onComplete:M,hashFn:g,query:l,tag:I};this.listens.get(ee).set(H,ue),this.connected_&&this.sendListen_(ue)}sendGet_(l){const g=this.outstandingGets_[l];this.sendRequest("g",g.request,I=>{delete this.outstandingGets_[l],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),g.onComplete&&g.onComplete(I)})}sendListen_(l){const g=l.query,I=g._path.toString(),M=g._queryIdentifier;this.log_("Listen on "+I+" for "+M);const H={p:I};l.tag&&(H.q=g._queryObject,H.t=l.tag),H.h=l.hashFn(),this.sendRequest("q",H,ue=>{const ve=ue.d,et=ue.s;d.warnOnListenWarnings_(ve,g),(this.listens.get(I)&&this.listens.get(I).get(M))===l&&(this.log_("listen response",ue),"ok"!==et&&this.removeListen_(I,M),l.onComplete&&l.onComplete(et,ve))})}static warnOnListenWarnings_(l,g){if(l&&"object"==typeof l&&(0,V.r3)(l,"w")){const I=(0,V.DV)(l,"w");if(Array.isArray(I)&&~I.indexOf("no_index")){const M='".indexOn": "'+g._queryParams.getIndex().toString()+'"',H=g._path.toString();Pn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${M} at ${H} to your security rules for better performance.`)}}}refreshAuthToken(l){this.authToken_=l,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(l)}reduceReconnectDelayIfAdminCredential_(l){(l&&40===l.length||(0,V.GJ)(l))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(l){this.appCheckToken_=l,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const l=this.authToken_,g=(0,V.w9)(l)?"auth":"gauth",I={cred:l};null===this.authOverride_?I.noauth=!0:"object"==typeof this.authOverride_&&(I.authvar=this.authOverride_),this.sendRequest(g,I,M=>{const H=M.s,ee=M.d||"error";this.authToken_===l&&("ok"===H?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(H,ee))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},l=>{const g=l.s,I=l.d||"error";"ok"===g?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(g,I)})}unlisten(l,g){const I=l._path.toString(),M=l._queryIdentifier;this.log_("Unlisten called for "+I+" "+M),(0,V.hu)(l._queryParams.isDefault()||!l._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(I,M)&&this.connected_&&this.sendUnlisten_(I,M,l._queryObject,g)}sendUnlisten_(l,g,I,M){this.log_("Unlisten on "+l+" for "+g);const H={p:l};M&&(H.q=I,H.t=M),this.sendRequest("n",H)}onDisconnectPut(l,g,I){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",l,g,I):this.onDisconnectRequestQueue_.push({pathString:l,action:"o",data:g,onComplete:I})}onDisconnectMerge(l,g,I){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",l,g,I):this.onDisconnectRequestQueue_.push({pathString:l,action:"om",data:g,onComplete:I})}onDisconnectCancel(l,g){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",l,null,g):this.onDisconnectRequestQueue_.push({pathString:l,action:"oc",data:null,onComplete:g})}sendOnDisconnect_(l,g,I,M){const H={p:g,d:I};this.log_("onDisconnect "+l,H),this.sendRequest(l,H,ee=>{M&&setTimeout(()=>{M(ee.s,ee.d)},Math.floor(0))})}put(l,g,I,M){this.putInternal("p",l,g,I,M)}merge(l,g,I,M){this.putInternal("m",l,g,I,M)}putInternal(l,g,I,M,H){this.initConnection_();const ee={p:g,d:I};void 0!==H&&(ee.h=H),this.outstandingPuts_.push({action:l,request:ee,onComplete:M}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+g)}sendPut_(l){const g=this.outstandingPuts_[l].action,I=this.outstandingPuts_[l].request,M=this.outstandingPuts_[l].onComplete;this.outstandingPuts_[l].queued=this.connected_,this.sendRequest(g,I,H=>{this.log_(g+" response",H),delete this.outstandingPuts_[l],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),M&&M(H.s,H.d)})}reportStats(l){if(this.connected_){const g={c:l};this.log_("reportStats",g),this.sendRequest("s",g,I=>{"ok"!==I.s&&this.log_("reportStats","Error sending stats: "+I.d)})}}onDataMessage_(l){if("r"in l){this.log_("from server: "+(0,V.Pz)(l));const g=l.r,I=this.requestCBHash_[g];I&&(delete this.requestCBHash_[g],I(l.b))}else{if("error"in l)throw"A server-side error has occurred: "+l.error;"a"in l&&this.onDataPush_(l.a,l.b)}}onDataPush_(l,g){this.log_("handleServerMessage",l,g),"d"===l?this.onDataUpdate_(g.p,g.d,!1,g.t):"m"===l?this.onDataUpdate_(g.p,g.d,!0,g.t):"c"===l?this.onListenRevoked_(g.p,g.q):"ac"===l?this.onAuthRevoked_(g.s,g.d):"apc"===l?this.onAppCheckRevoked_(g.s,g.d):"sd"===l?this.onSecurityDebugPacket_(g):fr("Unrecognized action received from server: "+(0,V.Pz)(l)+"\nAre you using the latest client?")}onReady_(l,g){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(l),this.lastSessionId=g,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(l){(0,V.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(l))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(l){l&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ao,this.realtime_||this.scheduleConnect_(0)),this.visible_=l}onOnline_(l){l?(this.log_("Browser went online."),this.reconnectDelay_=Ao,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ao),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const l=(new Date).getTime()-this.lastConnectionAttemptTime_;let g=Math.max(0,this.reconnectDelay_-l);g=Math.random()*g,this.log_("Trying to reconnect in "+g+"ms"),this.scheduleConnect_(g),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var l=this;return(0,wt.Z)(function*(){if(l.shouldReconnect_()){l.log_("Making a connection attempt"),l.lastConnectionAttemptTime_=(new Date).getTime(),l.lastConnectionEstablishedTime_=null;const g=l.onDataMessage_.bind(l),I=l.onReady_.bind(l),M=l.onRealtimeDisconnect_.bind(l),H=l.id+":"+d.nextConnectionId_++,ee=l.lastSessionId;let ue=!1,ve=null;const et=function(){ve?ve.close():(ue=!0,M())};l.realtime_={close:et,sendRequest:function(In){(0,V.hu)(ve,"sendRequest call when we're not connected not allowed."),ve.sendRequest(In)}};const bt=l.forceTokenRefresh_;l.forceTokenRefresh_=!1;try{const[In,Fn]=yield Promise.all([l.authTokenProvider_.getToken(bt),l.appCheckTokenProvider_.getToken(bt)]);ue?Yt("getToken() completed but was canceled"):(Yt("getToken() completed. Creating connection."),l.authToken_=In&&In.accessToken,l.appCheckToken_=Fn&&Fn.token,ve=new yo(H,l.repoInfo_,l.applicationId_,l.appCheckToken_,l.authToken_,g,I,M,li=>{Pn(li+" ("+l.repoInfo_.toString()+")"),l.interrupt("server_kill")},ee))}catch(In){l.log_("Failed to get token: "+In),ue||(l.repoInfo_.nodeAdmin&&Pn(In),et())}}})()}interrupt(l){Yt("Interrupting connection for reason: "+l),this.interruptReasons_[l]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(l){Yt("Resuming connection for reason: "+l),delete this.interruptReasons_[l],(0,V.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Ao,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(l){const g=l-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:g})}cancelSentTransactions_(){for(let l=0;l<this.outstandingPuts_.length;l++){const g=this.outstandingPuts_[l];g&&"h"in g.request&&g.queued&&(g.onComplete&&g.onComplete("disconnect"),delete this.outstandingPuts_[l],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(l,g){let I;I=g?g.map(H=>Ci(H)).join("$"):"default";const M=this.removeListen_(l,I);M&&M.onComplete&&M.onComplete("permission_denied")}removeListen_(l,g){const I=new tt(l).toString();let M;if(this.listens.has(I)){const H=this.listens.get(I);M=H.get(g),H.delete(g),0===H.size&&this.listens.delete(I)}else M=void 0;return M}onAuthRevoked_(l,g){Yt("Auth token revoked: "+l+"/"+g),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===l||"permission_denied"===l)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(l,g){Yt("App check token revoked: "+l+"/"+g),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===l||"permission_denied"===l)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(l){this.securityDebugCallback_?this.securityDebugCallback_(l):"msg"in l&&console.log("FIREBASE: "+l.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const l of this.listens.values())for(const g of l.values())this.sendListen_(g);for(let l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){const l=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(l.action,l.pathString,l.data,l.onComplete)}for(let l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)}sendConnectStats_(){const l={};let g="js";(0,V.Yr)()&&(g=this.repoInfo_.nodeAdmin?"admin_node":"node"),l["sdk."+g+"."+Ue.replace(/\./g,"-")]=1,(0,V.uI)()?l["framework.cordova"]=1:(0,V.b$)()&&(l["framework.reactnative"]=1),this.reportStats(l)}shouldReconnect_(){const l=Fe.getInstance().currentlyOnline();return(0,V.xb)(this.interruptReasons_)&&l}}return d.nextPersistentConnectionId_=0,d.nextConnectionId_=0,d})();class Cn{constructor(u,l){this.name=u,this.node=l}static Wrap(u,l){return new Cn(u,l)}}class xs{getCompare(){return this.compare.bind(this)}indexedValueChanged(u,l){const g=new Cn(Vn,u),I=new Cn(Vn,l);return 0!==this.compare(g,I)}minPost(){return Cn.MIN}}class cs extends xs{static get __EMPTY_NODE(){return $i}static set __EMPTY_NODE(u){$i=u}compare(u,l){return En(u.name,l.name)}isDefinedOn(u){throw(0,V.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(u,l){return!1}minPost(){return Cn.MIN}maxPost(){return new Cn(Bt,$i)}makePost(u,l){return(0,V.hu)("string"==typeof u,"KeyIndex indexValue must always be a string."),new Cn(u,$i)}toString(){return".key"}}const fi=new cs;class Rs{constructor(u,l,g,I,M=null){this.isReverse_=I,this.resultGenerator_=M,this.nodeStack_=[];let H=1;for(;!u.isEmpty();)if(u=u,H=l?g(u.key,l):1,I&&(H*=-1),H<0)u=this.isReverse_?u.left:u.right;else{if(0===H){this.nodeStack_.push(u);break}this.nodeStack_.push(u),u=this.isReverse_?u.right:u.left}}getNext(){if(0===this.nodeStack_.length)return null;let l,u=this.nodeStack_.pop();if(l=this.resultGenerator_?this.resultGenerator_(u.key,u.value):{key:u.key,value:u.value},this.isReverse_)for(u=u.left;!u.isEmpty();)this.nodeStack_.push(u),u=u.right;else for(u=u.right;!u.isEmpty();)this.nodeStack_.push(u),u=u.left;return l}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const u=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(u.key,u.value):{key:u.key,value:u.value}}}let _e,On=(()=>{class d{constructor(l,g,I,M,H){this.key=l,this.value=g,this.color=null!=I?I:d.RED,this.left=null!=M?M:Q.EMPTY_NODE,this.right=null!=H?H:Q.EMPTY_NODE}copy(l,g,I,M,H){return new d(null!=l?l:this.key,null!=g?g:this.value,null!=I?I:this.color,null!=M?M:this.left,null!=H?H:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(l){return this.left.inorderTraversal(l)||!!l(this.key,this.value)||this.right.inorderTraversal(l)}reverseTraversal(l){return this.right.reverseTraversal(l)||l(this.key,this.value)||this.left.reverseTraversal(l)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(l,g,I){let M=this;const H=I(l,M.key);return M=H<0?M.copy(null,null,null,M.left.insert(l,g,I),null):0===H?M.copy(null,g,null,null,null):M.copy(null,null,null,null,M.right.insert(l,g,I)),M.fixUp_()}removeMin_(){if(this.left.isEmpty())return Q.EMPTY_NODE;let l=this;return!l.left.isRed_()&&!l.left.left.isRed_()&&(l=l.moveRedLeft_()),l=l.copy(null,null,null,l.left.removeMin_(),null),l.fixUp_()}remove(l,g){let I,M;if(I=this,g(l,I.key)<0)!I.left.isEmpty()&&!I.left.isRed_()&&!I.left.left.isRed_()&&(I=I.moveRedLeft_()),I=I.copy(null,null,null,I.left.remove(l,g),null);else{if(I.left.isRed_()&&(I=I.rotateRight_()),!I.right.isEmpty()&&!I.right.isRed_()&&!I.right.left.isRed_()&&(I=I.moveRedRight_()),0===g(l,I.key)){if(I.right.isEmpty())return Q.EMPTY_NODE;M=I.right.min_(),I=I.copy(M.key,M.value,null,null,I.right.removeMin_())}I=I.copy(null,null,null,null,I.right.remove(l,g))}return I.fixUp_()}isRed_(){return this.color}fixUp_(){let l=this;return l.right.isRed_()&&!l.left.isRed_()&&(l=l.rotateLeft_()),l.left.isRed_()&&l.left.left.isRed_()&&(l=l.rotateRight_()),l.left.isRed_()&&l.right.isRed_()&&(l=l.colorFlip_()),l}moveRedLeft_(){let l=this.colorFlip_();return l.right.left.isRed_()&&(l=l.copy(null,null,null,null,l.right.rotateRight_()),l=l.rotateLeft_(),l=l.colorFlip_()),l}moveRedRight_(){let l=this.colorFlip_();return l.left.left.isRed_()&&(l=l.rotateRight_(),l=l.colorFlip_()),l}rotateLeft_(){const l=this.copy(null,null,d.RED,null,this.right.left);return this.right.copy(null,null,this.color,l,null)}rotateRight_(){const l=this.copy(null,null,d.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,l)}colorFlip_(){const l=this.left.copy(null,null,!this.left.color,null,null),g=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,l,g)}checkMaxDepth_(){const l=this.check_();return Math.pow(2,l)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const l=this.left.check_();if(l!==this.right.check_())throw new Error("Black depths differ");return l+(this.isRed_()?0:1)}}return d.RED=!0,d.BLACK=!1,d})();class Q{constructor(u,l=Q.EMPTY_NODE){this.comparator_=u,this.root_=l}insert(u,l){return new Q(this.comparator_,this.root_.insert(u,l,this.comparator_).copy(null,null,On.BLACK,null,null))}remove(u){return new Q(this.comparator_,this.root_.remove(u,this.comparator_).copy(null,null,On.BLACK,null,null))}get(u){let l,g=this.root_;for(;!g.isEmpty();){if(l=this.comparator_(u,g.key),0===l)return g.value;l<0?g=g.left:l>0&&(g=g.right)}return null}getPredecessorKey(u){let l,g=this.root_,I=null;for(;!g.isEmpty();){if(l=this.comparator_(u,g.key),0===l){if(g.left.isEmpty())return I?I.key:null;for(g=g.left;!g.right.isEmpty();)g=g.right;return g.key}l<0?g=g.left:l>0&&(I=g,g=g.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(u){return this.root_.inorderTraversal(u)}reverseTraversal(u){return this.root_.reverseTraversal(u)}getIterator(u){return new Rs(this.root_,null,this.comparator_,!1,u)}getIteratorFrom(u,l){return new Rs(this.root_,u,this.comparator_,!1,l)}getReverseIteratorFrom(u,l){return new Rs(this.root_,u,this.comparator_,!0,l)}getReverseIterator(u){return new Rs(this.root_,null,this.comparator_,!0,u)}}function U(d,u){return En(d.name,u.name)}function te(d,u){return En(d,u)}Q.EMPTY_NODE=new class B{copy(u,l,g,I,M){return this}insert(u,l,g){return new On(u,l,null)}remove(u,l){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(u){return!1}reverseTraversal(u){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const yt=function(d){return"number"==typeof d?"number:"+Fr(d):"string:"+d},un=function(d){if(d.isLeafNode()){const u=d.val();(0,V.hu)("string"==typeof u||"number"==typeof u||"object"==typeof u&&(0,V.r3)(u,".sv"),"Priority must be a string or number.")}else(0,V.hu)(d===_e||d.isEmpty(),"priority of unexpected type.");(0,V.hu)(d===_e||d.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let wn,kn,Jn,Wn=(()=>{class d{constructor(l,g=d.__childrenNodeConstructor.EMPTY_NODE){this.value_=l,this.priorityNode_=g,this.lazyHash_=null,(0,V.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),un(this.priorityNode_)}static set __childrenNodeConstructor(l){wn=l}static get __childrenNodeConstructor(){return wn}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(l){return new d(this.value_,l)}getImmediateChild(l){return".priority"===l?this.priorityNode_:d.__childrenNodeConstructor.EMPTY_NODE}getChild(l){return vn(l)?this:".priority"===_t(l)?this.priorityNode_:d.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(l,g){return null}updateImmediateChild(l,g){return".priority"===l?this.updatePriority(g):g.isEmpty()&&".priority"!==l?this:d.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(l,g).updatePriority(this.priorityNode_)}updateChild(l,g){const I=_t(l);return null===I?g:g.isEmpty()&&".priority"!==I?this:((0,V.hu)(".priority"!==I||1===Un(l),".priority must be the last token in a path"),this.updateImmediateChild(I,d.__childrenNodeConstructor.EMPTY_NODE.updateChild(Mn(l),g)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(l,g){return!1}val(l){return l&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let l="";this.priorityNode_.isEmpty()||(l+="priority:"+yt(this.priorityNode_.val())+":");const g=typeof this.value_;l+=g+":",l+="number"===g?Fr(this.value_):this.value_,this.lazyHash_=on(l)}return this.lazyHash_}getValue(){return this.value_}compareTo(l){return l===d.__childrenNodeConstructor.EMPTY_NODE?1:l instanceof d.__childrenNodeConstructor?-1:((0,V.hu)(l.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(l))}compareToLeafNode_(l){const g=typeof l.value_,I=typeof this.value_,M=d.VALUE_TYPE_ORDER.indexOf(g),H=d.VALUE_TYPE_ORDER.indexOf(I);return(0,V.hu)(M>=0,"Unknown leaf type: "+g),(0,V.hu)(H>=0,"Unknown leaf type: "+I),M===H?"object"===I?0:this.value_<l.value_?-1:this.value_===l.value_?0:1:H-M}withIndex(){return this}isIndexed(){return!0}equals(l){if(l===this)return!0;if(l.isLeafNode()){const g=l;return this.value_===g.value_&&this.priorityNode_.equals(g.priorityNode_)}return!1}}return d.VALUE_TYPE_ORDER=["object","boolean","number","string"],d})();const zn=new class $r extends xs{compare(u,l){const g=u.node.getPriority(),I=l.node.getPriority(),M=g.compareTo(I);return 0===M?En(u.name,l.name):M}isDefinedOn(u){return!u.getPriority().isEmpty()}indexedValueChanged(u,l){return!u.getPriority().equals(l.getPriority())}minPost(){return Cn.MIN}maxPost(){return new Cn(Bt,new Wn("[PRIORITY-POST]",Jn))}makePost(u,l){const g=kn(u);return new Cn(l,new Wn("[PRIORITY-POST]",g))}toString(){return".priority"}},pi=Math.log(2);class fn{constructor(u){this.count=parseInt(Math.log(u+1)/pi,10),this.current_=this.count-1;const I=(M=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=u+1&I}nextBitIsOne(){const u=!(this.bits_&1<<this.current_);return this.current_--,u}}const Zi=function(d,u,l,g){d.sort(u);const I=function(ue,ve){const et=ve-ue;let lt,bt;if(0===et)return null;if(1===et)return lt=d[ue],bt=l?l(lt):lt,new On(bt,lt.node,On.BLACK,null,null);{const In=parseInt(et/2,10)+ue,Fn=I(ue,In),li=I(In+1,ve);return lt=d[In],bt=l?l(lt):lt,new On(bt,lt.node,On.BLACK,Fn,li)}},ee=function(ue){let ve=null,et=null,lt=d.length;const bt=function(Fn,li){const Xi=lt-Fn,bl=lt;lt-=Fn;const fu=I(Xi+1,bl),ud=d[Xi],nm=l?l(ud):ud;In(new On(nm,ud.node,li,null,fu))},In=function(Fn){ve?(ve.left=Fn,ve=Fn):(et=Fn,ve=Fn)};for(let Fn=0;Fn<ue.count;++Fn){const li=ue.nextBitIsOne(),Xi=Math.pow(2,ue.count-(Fn+1));li?bt(Xi,On.BLACK):(bt(Xi,On.BLACK),bt(Xi,On.RED))}return et}(new fn(d.length));return new Q(g||u,ee)};let ho;const ds={};class Ni{constructor(u,l){this.indexes_=u,this.indexSet_=l}static get Default(){return(0,V.hu)(ds&&zn,"ChildrenNode.ts has not been loaded"),ho=ho||new Ni({".priority":ds},{".priority":zn}),ho}get(u){const l=(0,V.DV)(this.indexes_,u);if(!l)throw new Error("No index defined for "+u);return l instanceof Q?l:null}hasIndex(u){return(0,V.r3)(this.indexSet_,u.toString())}addIndex(u,l){(0,V.hu)(u!==fi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const g=[];let I=!1;const M=l.getIterator(Cn.Wrap);let ee,H=M.getNext();for(;H;)I=I||u.isDefinedOn(H.node),g.push(H),H=M.getNext();ee=I?Zi(g,u.getCompare()):ds;const ue=u.toString(),ve=Object.assign({},this.indexSet_);ve[ue]=u;const et=Object.assign({},this.indexes_);return et[ue]=ee,new Ni(et,ve)}addToIndexes(u,l){const g=(0,V.UI)(this.indexes_,(I,M)=>{const H=(0,V.DV)(this.indexSet_,M);if((0,V.hu)(H,"Missing index implementation for "+M),I===ds){if(H.isDefinedOn(u.node)){const ee=[],ue=l.getIterator(Cn.Wrap);let ve=ue.getNext();for(;ve;)ve.name!==u.name&&ee.push(ve),ve=ue.getNext();return ee.push(u),Zi(ee,H.getCompare())}return ds}{const ee=l.get(u.name);let ue=I;return ee&&(ue=ue.remove(new Cn(u.name,ee))),ue.insert(u,u.node)}});return new Ni(g,this.indexSet_)}removeFromIndexes(u,l){const g=(0,V.UI)(this.indexes_,I=>{if(I===ds)return I;{const M=l.get(u.name);return M?I.remove(new Cn(u.name,M)):I}});return new Ni(g,this.indexSet_)}}let G,k=(()=>{class d{constructor(l,g,I){this.children_=l,this.priorityNode_=g,this.indexMap_=I,this.lazyHash_=null,this.priorityNode_&&un(this.priorityNode_),this.children_.isEmpty()&&(0,V.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return G||(G=new d(new Q(te),null,Ni.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||G}updatePriority(l){return this.children_.isEmpty()?this:new d(this.children_,l,this.indexMap_)}getImmediateChild(l){if(".priority"===l)return this.getPriority();{const g=this.children_.get(l);return null===g?G:g}}getChild(l){const g=_t(l);return null===g?this:this.getImmediateChild(g).getChild(Mn(l))}hasChild(l){return null!==this.children_.get(l)}updateImmediateChild(l,g){if((0,V.hu)(g,"We should always be passing snapshot nodes"),".priority"===l)return this.updatePriority(g);{const I=new Cn(l,g);let M,H;g.isEmpty()?(M=this.children_.remove(l),H=this.indexMap_.removeFromIndexes(I,this.children_)):(M=this.children_.insert(l,g),H=this.indexMap_.addToIndexes(I,this.children_));const ee=M.isEmpty()?G:this.priorityNode_;return new d(M,ee,H)}}updateChild(l,g){const I=_t(l);if(null===I)return g;{(0,V.hu)(".priority"!==_t(l)||1===Un(l),".priority must be the last token in a path");const M=this.getImmediateChild(I).updateChild(Mn(l),g);return this.updateImmediateChild(I,M)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(l){if(this.isEmpty())return null;const g={};let I=0,M=0,H=!0;if(this.forEachChild(zn,(ee,ue)=>{g[ee]=ue.val(l),I++,H&&d.INTEGER_REGEXP_.test(ee)?M=Math.max(M,Number(ee)):H=!1}),!l&&H&&M<2*I){const ee=[];for(const ue in g)ee[ue]=g[ue];return ee}return l&&!this.getPriority().isEmpty()&&(g[".priority"]=this.getPriority().val()),g}hash(){if(null===this.lazyHash_){let l="";this.getPriority().isEmpty()||(l+="priority:"+yt(this.getPriority().val())+":"),this.forEachChild(zn,(g,I)=>{const M=I.hash();""!==M&&(l+=":"+g+":"+M)}),this.lazyHash_=""===l?"":on(l)}return this.lazyHash_}getPredecessorChildName(l,g,I){const M=this.resolveIndex_(I);if(M){const H=M.getPredecessorKey(new Cn(l,g));return H?H.name:null}return this.children_.getPredecessorKey(l)}getFirstChildName(l){const g=this.resolveIndex_(l);if(g){const I=g.minKey();return I&&I.name}return this.children_.minKey()}getFirstChild(l){const g=this.getFirstChildName(l);return g?new Cn(g,this.children_.get(g)):null}getLastChildName(l){const g=this.resolveIndex_(l);if(g){const I=g.maxKey();return I&&I.name}return this.children_.maxKey()}getLastChild(l){const g=this.getLastChildName(l);return g?new Cn(g,this.children_.get(g)):null}forEachChild(l,g){const I=this.resolveIndex_(l);return I?I.inorderTraversal(M=>g(M.name,M.node)):this.children_.inorderTraversal(g)}getIterator(l){return this.getIteratorFrom(l.minPost(),l)}getIteratorFrom(l,g){const I=this.resolveIndex_(g);if(I)return I.getIteratorFrom(l,M=>M);{const M=this.children_.getIteratorFrom(l.name,Cn.Wrap);let H=M.peek();for(;null!=H&&g.compare(H,l)<0;)M.getNext(),H=M.peek();return M}}getReverseIterator(l){return this.getReverseIteratorFrom(l.maxPost(),l)}getReverseIteratorFrom(l,g){const I=this.resolveIndex_(g);if(I)return I.getReverseIteratorFrom(l,M=>M);{const M=this.children_.getReverseIteratorFrom(l.name,Cn.Wrap);let H=M.peek();for(;null!=H&&g.compare(H,l)>0;)M.getNext(),H=M.peek();return M}}compareTo(l){return this.isEmpty()?l.isEmpty()?0:-1:l.isLeafNode()||l.isEmpty()?1:l===E?-1:0}withIndex(l){if(l===fi||this.indexMap_.hasIndex(l))return this;{const g=this.indexMap_.addIndex(l,this.children_);return new d(this.children_,this.priorityNode_,g)}}isIndexed(l){return l===fi||this.indexMap_.hasIndex(l)}equals(l){if(l===this)return!0;if(l.isLeafNode())return!1;{const g=l;if(this.getPriority().equals(g.getPriority())){if(this.children_.count()===g.children_.count()){const I=this.getIterator(zn),M=g.getIterator(zn);let H=I.getNext(),ee=M.getNext();for(;H&&ee;){if(H.name!==ee.name||!H.node.equals(ee.node))return!1;H=I.getNext(),ee=M.getNext()}return null===H&&null===ee}return!1}return!1}}resolveIndex_(l){return l===fi?null:this.indexMap_.get(l.toString())}}return d.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,d})();const E=new class F extends k{constructor(){super(new Q(te),k.EMPTY_NODE,Ni.Default)}compareTo(u){return u===this?0:1}equals(u){return u===this}getPriority(){return this}getImmediateChild(u){return k.EMPTY_NODE}isEmpty(){return!1}};function Y(d,u=null){if(null===d)return k.EMPTY_NODE;if("object"==typeof d&&".priority"in d&&(u=d[".priority"]),(0,V.hu)(null===u||"string"==typeof u||"number"==typeof u||"object"==typeof u&&".sv"in u,"Invalid priority type found: "+typeof u),"object"==typeof d&&".value"in d&&null!==d[".value"]&&(d=d[".value"]),"object"!=typeof d||".sv"in d)return new Wn(d,Y(u));if(d instanceof Array){let l=k.EMPTY_NODE;return Zn(d,(g,I)=>{if((0,V.r3)(d,g)&&"."!==g.substring(0,1)){const M=Y(I);(M.isLeafNode()||!M.isEmpty())&&(l=l.updateImmediateChild(g,M))}}),l.updatePriority(Y(u))}{const l=[];let g=!1;if(Zn(d,(H,ee)=>{if("."!==H.substring(0,1)){const ue=Y(ee);ue.isEmpty()||(g=g||!ue.getPriority().isEmpty(),l.push(new Cn(H,ue)))}}),0===l.length)return k.EMPTY_NODE;const M=Zi(l,U,H=>H.name,te);if(g){const H=Zi(l,zn.getCompare());return new k(M,Y(u),new Ni({".priority":H},{".priority":zn}))}return new k(M,Y(u),Ni.Default)}}Object.defineProperties(Cn,{MIN:{value:new Cn(Vn,k.EMPTY_NODE)},MAX:{value:new Cn(Bt,E)}}),cs.__EMPTY_NODE=k.EMPTY_NODE,Wn.__childrenNodeConstructor=k,function rt(d){_e=d}(E),function Mr(d){Jn=d}(E),function qr(d){kn=d}(Y);class oe extends xs{constructor(u){super(),this.indexPath_=u,(0,V.hu)(!vn(u)&&".priority"!==_t(u),"Can't create PathIndex with empty path or .priority key")}extractChild(u){return u.getChild(this.indexPath_)}isDefinedOn(u){return!u.getChild(this.indexPath_).isEmpty()}compare(u,l){const g=this.extractChild(u.node),I=this.extractChild(l.node),M=g.compareTo(I);return 0===M?En(u.name,l.name):M}makePost(u,l){const g=Y(u),I=k.EMPTY_NODE.updateChild(this.indexPath_,g);return new Cn(l,I)}maxPost(){const u=k.EMPTY_NODE.updateChild(this.indexPath_,E);return new Cn(Bt,u)}toString(){return Bi(this.indexPath_,0).join("/")}}const Ke=new class Te extends xs{compare(u,l){const g=u.node.compareTo(l.node);return 0===g?En(u.name,l.name):g}isDefinedOn(u){return!0}indexedValueChanged(u,l){return!u.equals(l)}minPost(){return Cn.MIN}maxPost(){return Cn.MAX}makePost(u,l){const g=Y(u);return new Cn(l,g)}toString(){return".value"}},mt="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",cr=function(){let d=0;const u=[];return function(l){const g=l===d;let I;d=l;const M=new Array(8);for(I=7;I>=0;I--)M[I]=mt.charAt(l%64),l=Math.floor(l/64);(0,V.hu)(0===l,"Cannot push at time == 0");let H=M.join("");if(g){for(I=11;I>=0&&63===u[I];I--)u[I]=0;u[I]++}else for(I=0;I<12;I++)u[I]=Math.floor(64*Math.random());for(I=0;I<12;I++)H+=mt.charAt(u[I]);return(0,V.hu)(20===H.length,"nextPushId: Length should be 20."),H}}(),Br=function(d){if(d===""+Pr)return"-";const u=ri(d);if(null!=u)return""+(u+1);const l=new Array(d.length);for(let H=0;H<l.length;H++)l[H]=d.charAt(H);if(l.length<786)return l.push("-"),l.join("");let g=l.length-1;for(;g>=0&&"z"===l[g];)g--;if(-1===g)return Bt;const M=mt.charAt(mt.indexOf(l[g])+1);return l[g]=M,l.slice(0,g+1).join("")},Or=function(d){if(d===""+nn)return Vn;const u=ri(d);if(null!=u)return""+(u-1);const l=new Array(d.length);for(let g=0;g<l.length;g++)l[g]=d.charAt(g);return"-"===l[l.length-1]?1===l.length?""+Pr:(delete l[l.length-1],l.join("")):(l[l.length-1]=mt.charAt(mt.indexOf(l[l.length-1])-1),l.join("")+"z".repeat(786-l.length))};function rr(d){return{type:"value",snapshotNode:d}}function Dr(d,u){return{type:"child_added",snapshotNode:u,childName:d}}function Ti(d,u){return{type:"child_removed",snapshotNode:u,childName:d}}function Cr(d,u,l){return{type:"child_changed",snapshotNode:u,childName:d,oldSnap:l}}class Ms{constructor(u){this.index_=u}updateChild(u,l,g,I,M,H){(0,V.hu)(u.isIndexed(this.index_),"A node must be indexed if only a child is updated");const ee=u.getImmediateChild(l);return ee.getChild(I).equals(g.getChild(I))&&ee.isEmpty()===g.isEmpty()||(null!=H&&(g.isEmpty()?u.hasChild(l)?H.trackChildChange(Ti(l,ee)):(0,V.hu)(u.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):ee.isEmpty()?H.trackChildChange(Dr(l,g)):H.trackChildChange(Cr(l,g,ee))),u.isLeafNode()&&g.isEmpty())?u:u.updateImmediateChild(l,g).withIndex(this.index_)}updateFullNode(u,l,g){return null!=g&&(u.isLeafNode()||u.forEachChild(zn,(I,M)=>{l.hasChild(I)||g.trackChildChange(Ti(I,M))}),l.isLeafNode()||l.forEachChild(zn,(I,M)=>{if(u.hasChild(I)){const H=u.getImmediateChild(I);H.equals(M)||g.trackChildChange(Cr(I,M,H))}else g.trackChildChange(Dr(I,M))})),l.withIndex(this.index_)}updatePriority(u,l){return u.isEmpty()?k.EMPTY_NODE:u.updatePriority(l)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Xn{constructor(u){this.indexedFilter_=new Ms(u.getIndex()),this.index_=u.getIndex(),this.startPost_=Xn.getStartPost_(u),this.endPost_=Xn.getEndPost_(u)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(u){return this.index_.compare(this.getStartPost(),u)<=0&&this.index_.compare(u,this.getEndPost())<=0}updateChild(u,l,g,I,M,H){return this.matches(new Cn(l,g))||(g=k.EMPTY_NODE),this.indexedFilter_.updateChild(u,l,g,I,M,H)}updateFullNode(u,l,g){l.isLeafNode()&&(l=k.EMPTY_NODE);let I=l.withIndex(this.index_);I=I.updatePriority(k.EMPTY_NODE);const M=this;return l.forEachChild(zn,(H,ee)=>{M.matches(new Cn(H,ee))||(I=I.updateImmediateChild(H,k.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(u,I,g)}updatePriority(u,l){return u}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(u){if(u.hasStart()){const l=u.getIndexStartName();return u.getIndex().makePost(u.getIndexStartValue(),l)}return u.getIndex().minPost()}static getEndPost_(u){if(u.hasEnd()){const l=u.getIndexEndName();return u.getIndex().makePost(u.getIndexEndValue(),l)}return u.getIndex().maxPost()}}class Pi{constructor(u){this.rangedFilter_=new Xn(u),this.index_=u.getIndex(),this.limit_=u.getLimit(),this.reverse_=!u.isViewFromLeft()}updateChild(u,l,g,I,M,H){return this.rangedFilter_.matches(new Cn(l,g))||(g=k.EMPTY_NODE),u.getImmediateChild(l).equals(g)?u:u.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(u,l,g,I,M,H):this.fullLimitUpdateChild_(u,l,g,M,H)}updateFullNode(u,l,g){let I;if(l.isLeafNode()||l.isEmpty())I=k.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<l.numChildren()&&l.isIndexed(this.index_)){let M;I=k.EMPTY_NODE.withIndex(this.index_),M=this.reverse_?l.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):l.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let H=0;for(;M.hasNext()&&H<this.limit_;){const ee=M.getNext();let ue;if(ue=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),ee)<=0:this.index_.compare(ee,this.rangedFilter_.getEndPost())<=0,!ue)break;I=I.updateImmediateChild(ee.name,ee.node),H++}}else{let M,H,ee,ue;if(I=l.withIndex(this.index_),I=I.updatePriority(k.EMPTY_NODE),this.reverse_){ue=I.getReverseIterator(this.index_),M=this.rangedFilter_.getEndPost(),H=this.rangedFilter_.getStartPost();const lt=this.index_.getCompare();ee=(bt,In)=>lt(In,bt)}else ue=I.getIterator(this.index_),M=this.rangedFilter_.getStartPost(),H=this.rangedFilter_.getEndPost(),ee=this.index_.getCompare();let ve=0,et=!1;for(;ue.hasNext();){const lt=ue.getNext();!et&&ee(M,lt)<=0&&(et=!0),et&&ve<this.limit_&&ee(lt,H)<=0?ve++:I=I.updateImmediateChild(lt.name,k.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(u,I,g)}updatePriority(u,l){return u}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(u,l,g,I,M){let H;if(this.reverse_){const lt=this.index_.getCompare();H=(bt,In)=>lt(In,bt)}else H=this.index_.getCompare();const ee=u;(0,V.hu)(ee.numChildren()===this.limit_,"");const ue=new Cn(l,g),ve=this.reverse_?ee.getFirstChild(this.index_):ee.getLastChild(this.index_),et=this.rangedFilter_.matches(ue);if(ee.hasChild(l)){const lt=ee.getImmediateChild(l);let bt=I.getChildAfterChild(this.index_,ve,this.reverse_);for(;null!=bt&&(bt.name===l||ee.hasChild(bt.name));)bt=I.getChildAfterChild(this.index_,bt,this.reverse_);const In=null==bt?1:H(bt,ue);if(et&&!g.isEmpty()&&In>=0)return null!=M&&M.trackChildChange(Cr(l,g,lt)),ee.updateImmediateChild(l,g);{null!=M&&M.trackChildChange(Ti(l,lt));const li=ee.updateImmediateChild(l,k.EMPTY_NODE);return null!=bt&&this.rangedFilter_.matches(bt)?(null!=M&&M.trackChildChange(Dr(bt.name,bt.node)),li.updateImmediateChild(bt.name,bt.node)):li}}return g.isEmpty()?u:et&&H(ve,ue)>=0?(null!=M&&(M.trackChildChange(Ti(ve.name,ve.node)),M.trackChildChange(Dr(l,g))),ee.updateImmediateChild(l,g).updateImmediateChild(ve.name,k.EMPTY_NODE)):u}}class Js{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=zn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,V.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,V.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Vn}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,V.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,V.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Bt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,V.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===zn}copy(){const u=new Js;return u.limitSet_=this.limitSet_,u.limit_=this.limit_,u.startSet_=this.startSet_,u.indexStartValue_=this.indexStartValue_,u.startNameSet_=this.startNameSet_,u.indexStartName_=this.indexStartName_,u.endSet_=this.endSet_,u.indexEndValue_=this.indexEndValue_,u.endNameSet_=this.endNameSet_,u.indexEndName_=this.indexEndName_,u.index_=this.index_,u.viewFrom_=this.viewFrom_,u}}function Ro(d,u,l){const g=d.copy();return g.startSet_=!0,void 0===u&&(u=null),g.indexStartValue_=u,null!=l?(g.startNameSet_=!0,g.indexStartName_=l):(g.startNameSet_=!1,g.indexStartName_=""),g}function Ea(d,u,l){const g=d.copy();return g.endSet_=!0,void 0===u&&(u=null),g.indexEndValue_=u,void 0!==l?(g.endNameSet_=!0,g.indexEndName_=l):(g.endNameSet_=!1,g.indexEndName_=""),g}function Ko(d,u){const l=d.copy();return l.index_=u,l}function Mo(d){const u={};if(d.isDefault())return u;let l;return d.index_===zn?l="$priority":d.index_===Ke?l="$value":d.index_===fi?l="$key":((0,V.hu)(d.index_ instanceof oe,"Unrecognized index type!"),l=d.index_.toString()),u.orderBy=(0,V.Pz)(l),d.startSet_&&(u.startAt=(0,V.Pz)(d.indexStartValue_),d.startNameSet_&&(u.startAt+=","+(0,V.Pz)(d.indexStartName_))),d.endSet_&&(u.endAt=(0,V.Pz)(d.indexEndValue_),d.endNameSet_&&(u.endAt+=","+(0,V.Pz)(d.indexEndName_))),d.limitSet_&&(d.isViewFromLeft()?u.limitToFirst=d.limit_:u.limitToLast=d.limit_),u}function ca(d){const u={};if(d.startSet_&&(u.sp=d.indexStartValue_,d.startNameSet_&&(u.sn=d.indexStartName_)),d.endSet_&&(u.ep=d.indexEndValue_,d.endNameSet_&&(u.en=d.indexEndName_)),d.limitSet_){u.l=d.limit_;let l=d.viewFrom_;""===l&&(l=d.isViewFromLeft()?"l":"r"),u.vf=l}return d.index_!==zn&&(u.i=d.index_.toString()),u}class Ga extends Ir{constructor(u,l,g,I){super(),this.repoInfo_=u,this.onDataUpdate_=l,this.authTokenProvider_=g,this.appCheckTokenProvider_=I,this.log_=hr("p:rest:"),this.listens_={}}reportStats(u){throw new Error("Method not implemented.")}static getListenId_(u,l){return void 0!==l?"tag$"+l:((0,V.hu)(u._queryParams.isDefault(),"should have a tag if it's not a default query."),u._path.toString())}listen(u,l,g,I){const M=u._path.toString();this.log_("Listen called for "+M+" "+u._queryIdentifier);const H=Ga.getListenId_(u,g),ee={};this.listens_[H]=ee;const ue=Mo(u._queryParams);this.restRequest_(M+".json",ue,(ve,et)=>{let lt=et;if(404===ve&&(lt=null,ve=null),null===ve&&this.onDataUpdate_(M,lt,!1,g),(0,V.DV)(this.listens_,H)===ee){let bt;bt=ve?401===ve?"permission_denied":"rest_error:"+ve:"ok",I(bt,null)}})}unlisten(u,l){const g=Ga.getListenId_(u,l);delete this.listens_[g]}get(u){const l=Mo(u._queryParams),g=u._path.toString(),I=new V.BH;return this.restRequest_(g+".json",l,(M,H)=>{let ee=H;404===M&&(ee=null,M=null),null===M?(this.onDataUpdate_(g,ee,!1,null),I.resolve(ee)):I.reject(new Error(ee))}),I.promise}refreshAuthToken(u){}restRequest_(u,l={},g){return l.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([I,M])=>{I&&I.accessToken&&(l.auth=I.accessToken),M&&M.token&&(l.ac=M.token);const H=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+u+"?ns="+this.repoInfo_.namespace+(0,V.xO)(l);this.log_("Sending REST request for "+H);const ee=new XMLHttpRequest;ee.onreadystatechange=()=>{if(g&&4===ee.readyState){this.log_("REST Response for "+H+" received. status:",ee.status,"response:",ee.responseText);let ue=null;if(ee.status>=200&&ee.status<300){try{ue=(0,V.cI)(ee.responseText)}catch(ve){Pn("Failed to parse JSON response for "+H+": "+ee.responseText)}g(null,ue)}else 401!==ee.status&&404!==ee.status&&Pn("Got unsuccessful REST response for "+H+" Status: "+ee.status),g(ee.status);g=null}},ee.open("GET",H,!0),ee.send()})}}class Ma{constructor(){this.rootNode_=k.EMPTY_NODE}getNode(u){return this.rootNode_.getChild(u)}updateSnapshot(u,l){this.rootNode_=this.rootNode_.updateChild(u,l)}}function No(){return{value:null,children:new Map}}function Na(d,u,l){if(vn(u))d.value=l,d.children.clear();else if(null!==d.value)d.value=d.value.updateChild(u,l);else{const g=_t(u);d.children.has(g)||d.children.set(g,No()),Na(d.children.get(g),u=Mn(u),l)}}function Si(d,u){if(vn(u))return d.value=null,d.children.clear(),!0;if(null!==d.value){if(d.value.isLeafNode())return!1;{const l=d.value;return d.value=null,l.forEachChild(zn,(g,I)=>{Na(d,new tt(g),I)}),Si(d,u)}}if(d.children.size>0){const l=_t(u);return u=Mn(u),d.children.has(l)&&Si(d.children.get(l),u)&&d.children.delete(l),0===d.children.size}return!0}function fo(d,u,l){null!==d.value?l(u,d.value):function Hi(d,u){d.children.forEach((l,g)=>{u(g,l)})}(d,(g,I)=>{fo(I,new tt(u.toString()+"/"+g),l)})}class Sl{constructor(u){this.collection_=u,this.last_=null}get(){const u=this.collection_.get(),l=Object.assign({},u);return this.last_&&Zn(this.last_,(g,I)=>{l[g]=l[g]-I}),this.last_=u,l}}class Pa{constructor(u,l){this.server_=l,this.statsToReport_={},this.statsListener_=new Sl(u);const g=1e4+2e4*Math.random();Lr(this.reportStats_.bind(this),Math.floor(g))}reportStats_(){const u=this.statsListener_.get(),l={};let g=!1;Zn(u,(I,M)=>{M>0&&(0,V.r3)(this.statsToReport_,I)&&(l[I]=M,g=!0)}),g&&this.server_.reportStats(l),Lr(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var vo=(()=>{return(d=vo||(vo={}))[d.OVERWRITE=0]="OVERWRITE",d[d.MERGE=1]="MERGE",d[d.ACK_USER_WRITE=2]="ACK_USER_WRITE",d[d.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",vo;var d})();function Xs(d){return{fromUser:!1,fromServer:!0,queryId:d,tagged:!0}}class qo{constructor(u,l,g){this.path=u,this.affectedTree=l,this.revert=g,this.type=vo.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(u){if(vn(this.path)){if(null!=this.affectedTree.value)return(0,V.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const l=this.affectedTree.subtree(new tt(u));return new qo(pt(),l,this.revert)}}return(0,V.hu)(_t(this.path)===u,"operationForChild called for unrelated child."),new qo(Mn(this.path),this.affectedTree,this.revert)}}class mr{constructor(u,l){this.source=u,this.path=l,this.type=vo.LISTEN_COMPLETE}operationForChild(u){return vn(this.path)?new mr(this.source,pt()):new mr(this.source,Mn(this.path))}}class da{constructor(u,l,g){this.source=u,this.path=l,this.snap=g,this.type=vo.OVERWRITE}operationForChild(u){return vn(this.path)?new da(this.source,pt(),this.snap.getImmediateChild(u)):new da(this.source,Mn(this.path),this.snap)}}class $s{constructor(u,l,g){this.source=u,this.path=l,this.children=g,this.type=vo.MERGE}operationForChild(u){if(vn(this.path)){const l=this.children.subtree(new tt(u));return l.isEmpty()?null:l.value?new da(this.source,pt(),l.value):new $s(this.source,pt(),l)}return(0,V.hu)(_t(this.path)===u,"Can't get a merge for a child not on the path of the operation"),new $s(this.source,Mn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Gi{constructor(u,l,g){this.node_=u,this.fullyInitialized_=l,this.filtered_=g}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(u){if(vn(u))return this.isFullyInitialized()&&!this.filtered_;const l=_t(u);return this.isCompleteForChild(l)}isCompleteForChild(u){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(u)}getNode(){return this.node_}}class Oa{constructor(u){this.query_=u,this.index_=this.query_._queryParams.getIndex()}}function ko(d,u,l,g,I,M){const H=g.filter(ee=>ee.type===l);H.sort((ee,ue)=>function za(d,u,l){if(null==u.childName||null==l.childName)throw(0,V.g5)("Should only compare child_ events.");const g=new Cn(u.childName,u.snapshotNode),I=new Cn(l.childName,l.snapshotNode);return d.index_.compare(g,I)}(d,ee,ue)),H.forEach(ee=>{const ue=function ha(d,u,l){return"value"===u.type||"child_removed"===u.type||(u.prevName=l.getPredecessorChildName(u.childName,u.snapshotNode,d.index_)),u}(d,ee,M);I.forEach(ve=>{ve.respondsTo(ee.type)&&u.push(ve.createEvent(ue,d.query_))})})}function Ns(d,u){return{eventCache:d,serverCache:u}}function Ka(d,u,l,g){return Ns(new Gi(u,l,g),d.serverCache)}function $u(d,u,l,g){return Ns(d.eventCache,new Gi(u,l,g))}function mi(d){return d.eventCache.isFullyInitialized()?d.eventCache.getNode():null}function Zo(d){return d.serverCache.isFullyInitialized()?d.serverCache.getNode():null}let Yo;class Yr{constructor(u,l=(()=>(Yo||(Yo=new Q(Sn)),Yo))()){this.value=u,this.children=l}static fromObject(u){let l=new Yr(null);return Zn(u,(g,I)=>{l=l.set(new tt(g),I)}),l}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(u,l){if(null!=this.value&&l(this.value))return{path:pt(),value:this.value};if(vn(u))return null;{const g=_t(u),I=this.children.get(g);if(null!==I){const M=I.findRootMostMatchingPathAndValue(Mn(u),l);return null!=M?{path:nr(new tt(g),M.path),value:M.value}:null}return null}}findRootMostValueAndPath(u){return this.findRootMostMatchingPathAndValue(u,()=>!0)}subtree(u){if(vn(u))return this;{const l=_t(u),g=this.children.get(l);return null!==g?g.subtree(Mn(u)):new Yr(null)}}set(u,l){if(vn(u))return new Yr(l,this.children);{const g=_t(u),M=(this.children.get(g)||new Yr(null)).set(Mn(u),l),H=this.children.insert(g,M);return new Yr(this.value,H)}}remove(u){if(vn(u))return this.children.isEmpty()?new Yr(null):new Yr(null,this.children);{const l=_t(u),g=this.children.get(l);if(g){const I=g.remove(Mn(u));let M;return M=I.isEmpty()?this.children.remove(l):this.children.insert(l,I),null===this.value&&M.isEmpty()?new Yr(null):new Yr(this.value,M)}return this}}get(u){if(vn(u))return this.value;{const l=_t(u),g=this.children.get(l);return g?g.get(Mn(u)):null}}setTree(u,l){if(vn(u))return l;{const g=_t(u),M=(this.children.get(g)||new Yr(null)).setTree(Mn(u),l);let H;return H=M.isEmpty()?this.children.remove(g):this.children.insert(g,M),new Yr(this.value,H)}}fold(u){return this.fold_(pt(),u)}fold_(u,l){const g={};return this.children.inorderTraversal((I,M)=>{g[I]=M.fold_(nr(u,I),l)}),l(u,this.value,g)}findOnPath(u,l){return this.findOnPath_(u,pt(),l)}findOnPath_(u,l,g){const I=!!this.value&&g(l,this.value);if(I)return I;if(vn(u))return null;{const M=_t(u),H=this.children.get(M);return H?H.findOnPath_(Mn(u),nr(l,M),g):null}}foreachOnPath(u,l){return this.foreachOnPath_(u,pt(),l)}foreachOnPath_(u,l,g){if(vn(u))return this;{this.value&&g(l,this.value);const I=_t(u),M=this.children.get(I);return M?M.foreachOnPath_(Mn(u),nr(l,I),g):new Yr(null)}}foreach(u){this.foreach_(pt(),u)}foreach_(u,l){this.children.inorderTraversal((g,I)=>{I.foreach_(nr(u,g),l)}),this.value&&l(u,this.value)}foreachChild(u){this.children.inorderTraversal((l,g)=>{g.value&&u(l,g.value)})}}class Eo{constructor(u){this.writeTree_=u}static empty(){return new Eo(new Yr(null))}}function Hs(d,u,l){if(vn(u))return new Eo(new Yr(l));{const g=d.writeTree_.findRootMostValueAndPath(u);if(null!=g){const I=g.path;let M=g.value;const H=Ur(I,u);return M=M.updateChild(H,l),new Eo(d.writeTree_.set(I,M))}{const I=new Yr(l),M=d.writeTree_.setTree(u,I);return new Eo(M)}}}function ru(d,u,l){let g=d;return Zn(l,(I,M)=>{g=Hs(g,nr(u,I),M)}),g}function Qr(d,u){if(vn(u))return Eo.empty();{const l=d.writeTree_.setTree(u,new Yr(null));return new Eo(l)}}function ka(d,u){return null!=Gs(d,u)}function Gs(d,u){const l=d.writeTree_.findRootMostValueAndPath(u);return null!=l?d.writeTree_.get(l.path).getChild(Ur(l.path,u)):null}function Yi(d){const u=[],l=d.writeTree_.value;return null!=l?l.isLeafNode()||l.forEachChild(zn,(g,I)=>{u.push(new Cn(g,I))}):d.writeTree_.children.inorderTraversal((g,I)=>{null!=I.value&&u.push(new Cn(g,I.value))}),u}function Ps(d,u){if(vn(u))return d;{const l=Gs(d,u);return new Eo(null!=l?new Yr(l):d.writeTree_.subtree(u))}}function Fo(d){return d.writeTree_.isEmpty()}function Qo(d,u){return Hu(pt(),d.writeTree_,u)}function Hu(d,u,l){if(null!=u.value)return l.updateChild(d,u.value);{let g=null;return u.children.inorderTraversal((I,M)=>{".priority"===I?((0,V.hu)(null!==M.value,"Priority writes must always be leaf nodes"),g=M.value):l=Hu(nr(d,I),M,l)}),!l.getChild(d).isEmpty()&&null!==g&&(l=l.updateChild(nr(d,".priority"),g)),l}}function xt(d,u){return wo(u,d)}function D(d,u){if(d.snap)return ji(d.path,u);for(const l in d.children)if(d.children.hasOwnProperty(l)&&ji(nr(d.path,l),u))return!0;return!1}function N(d){return d.visible}function P(d,u,l){let g=Eo.empty();for(let I=0;I<d.length;++I){const M=d[I];if(u(M)){const H=M.path;let ee;if(M.snap)ji(l,H)?(ee=Ur(l,H),g=Hs(g,ee,M.snap)):ji(H,l)&&(ee=Ur(H,l),g=Hs(g,pt(),M.snap.getChild(ee)));else{if(!M.children)throw(0,V.g5)("WriteRecord should have .snap or .children");if(ji(l,H))ee=Ur(l,H),g=ru(g,ee,M.children);else if(ji(H,l))if(ee=Ur(H,l),vn(ee))g=ru(g,pt(),M.children);else{const ue=(0,V.DV)(M.children,_t(ee));if(ue){const ve=ue.getChild(Mn(ee));g=Hs(g,pt(),ve)}}}}}return g}function K(d,u,l,g,I){if(g||I){const M=Ps(d.visibleWrites,u);return!I&&Fo(M)?l:I||null!=l||ka(M,pt())?Qo(P(d.allWrites,function(ve){return(ve.visible||I)&&(!g||!~g.indexOf(ve.writeId))&&(ji(ve.path,u)||ji(u,ve.path))},u),l||k.EMPTY_NODE):null}{const M=Gs(d.visibleWrites,u);if(null!=M)return M;{const H=Ps(d.visibleWrites,u);return Fo(H)?l:null!=l||ka(H,pt())?Qo(H,l||k.EMPTY_NODE):null}}}function Tr(d,u,l,g){return K(d.writeTree,d.treePath,u,l,g)}function _r(d,u){return function de(d,u,l){let g=k.EMPTY_NODE;const I=Gs(d.visibleWrites,u);if(I)return I.isLeafNode()||I.forEachChild(zn,(M,H)=>{g=g.updateImmediateChild(M,H)}),g;if(l){const M=Ps(d.visibleWrites,u);return l.forEachChild(zn,(H,ee)=>{const ue=Qo(Ps(M,new tt(H)),ee);g=g.updateImmediateChild(H,ue)}),Yi(M).forEach(H=>{g=g.updateImmediateChild(H.name,H.node)}),g}return Yi(Ps(d.visibleWrites,u)).forEach(H=>{g=g.updateImmediateChild(H.name,H.node)}),g}(d.writeTree,d.treePath,u)}function to(d,u,l,g){return function Ie(d,u,l,g,I){(0,V.hu)(g||I,"Either existingEventSnap or existingServerSnap must exist");const M=nr(u,l);if(ka(d.visibleWrites,M))return null;{const H=Ps(d.visibleWrites,M);return Fo(H)?I.getChild(l):Qo(H,I.getChild(l))}}(d.writeTree,d.treePath,u,l,g)}function po(d,u){return function Jt(d,u){return Gs(d.visibleWrites,u)}(d.writeTree,nr(d.treePath,u))}function Lo(d,u,l){return function dt(d,u,l,g){const I=nr(u,l),M=Gs(d.visibleWrites,I);return null!=M?M:g.isCompleteForChild(l)?Qo(Ps(d.visibleWrites,I),g.getNode().getImmediateChild(l)):null}(d.writeTree,d.treePath,u,l)}function Dn(d,u){return wo(nr(d.treePath,u),d.writeTree)}function wo(d,u){return{treePath:d,writeTree:u}}class Gu{constructor(){this.changeMap=new Map}trackChildChange(u){const l=u.type,g=u.childName;(0,V.hu)("child_added"===l||"child_changed"===l||"child_removed"===l,"Only child changes supported for tracking"),(0,V.hu)(".priority"!==g,"Only non-priority child changes can be tracked.");const I=this.changeMap.get(g);if(I){const M=I.type;if("child_added"===l&&"child_removed"===M)this.changeMap.set(g,Cr(g,u.snapshotNode,I.snapshotNode));else if("child_removed"===l&&"child_added"===M)this.changeMap.delete(g);else if("child_removed"===l&&"child_changed"===M)this.changeMap.set(g,Ti(g,I.oldSnap));else if("child_changed"===l&&"child_added"===M)this.changeMap.set(g,Dr(g,u.snapshotNode));else{if("child_changed"!==l||"child_changed"!==M)throw(0,V.g5)("Illegal combination of changes: "+u+" occurred after "+I);this.changeMap.set(g,Cr(g,u.snapshotNode,I.oldSnap))}}else this.changeMap.set(g,u)}getChanges(){return Array.from(this.changeMap.values())}}const An=new class ui{getCompleteChild(u){return null}getChildAfterChild(u,l,g){return null}};class _u{constructor(u,l,g=null){this.writes_=u,this.viewCache_=l,this.optCompleteServerCache_=g}getCompleteChild(u){const l=this.viewCache_.eventCache;if(l.isCompleteForChild(u))return l.getNode().getImmediateChild(u);{const g=null!=this.optCompleteServerCache_?new Gi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Lo(this.writes_,u,g)}}getChildAfterChild(u,l,g){const I=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Zo(this.viewCache_),M=function Fa(d,u,l,g,I,M){return function yr(d,u,l,g,I,M,H){let ee;const ue=Ps(d.visibleWrites,u),ve=Gs(ue,pt());if(null!=ve)ee=ve;else{if(null==l)return[];ee=Qo(ue,l)}if(ee=ee.withIndex(H),ee.isEmpty()||ee.isLeafNode())return[];{const et=[],lt=H.getCompare(),bt=M?ee.getReverseIteratorFrom(g,H):ee.getIteratorFrom(g,H);let In=bt.getNext();for(;In&&et.length<I;)0!==lt(In,g)&&et.push(In),In=bt.getNext();return et}}(d.writeTree,d.treePath,u,l,g,I,M)}(this.writes_,I,l,1,g,u);return 0===M.length?null:M[0]}}function Al(d,u,l,g,I,M){const H=u.eventCache;if(null!=po(g,l))return u;{let ee,ue;if(vn(l))if((0,V.hu)(u.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),u.serverCache.isFiltered()){const ve=Zo(u),lt=_r(g,ve instanceof k?ve:k.EMPTY_NODE);ee=d.filter.updateFullNode(u.eventCache.getNode(),lt,M)}else{const ve=Tr(g,Zo(u));ee=d.filter.updateFullNode(u.eventCache.getNode(),ve,M)}else{const ve=_t(l);if(".priority"===ve){(0,V.hu)(1===Un(l),"Can't have a priority with additional path components");const et=H.getNode();ue=u.serverCache.getNode();const lt=to(g,l,et,ue);ee=null!=lt?d.filter.updatePriority(et,lt):H.getNode()}else{const et=Mn(l);let lt;if(H.isCompleteForChild(ve)){ue=u.serverCache.getNode();const bt=to(g,l,H.getNode(),ue);lt=null!=bt?H.getNode().getImmediateChild(ve).updateChild(et,bt):H.getNode().getImmediateChild(ve)}else lt=Lo(g,ve,u.serverCache);ee=null!=lt?d.filter.updateChild(H.getNode(),ve,lt,et,I,M):H.getNode()}}return Ka(u,ee,H.isFullyInitialized()||vn(l),d.filter.filtersNodes())}}function Wu(d,u,l,g,I,M,H,ee){const ue=u.serverCache;let ve;const et=H?d.filter:d.filter.getIndexedFilter();if(vn(l))ve=et.updateFullNode(ue.getNode(),g,null);else if(et.filtersNodes()&&!ue.isFiltered()){const In=ue.getNode().updateChild(l,g);ve=et.updateFullNode(ue.getNode(),In,null)}else{const In=_t(l);if(!ue.isCompleteForPath(l)&&Un(l)>1)return u;const Fn=Mn(l),Xi=ue.getNode().getImmediateChild(In).updateChild(Fn,g);ve=".priority"===In?et.updatePriority(ue.getNode(),Xi):et.updateChild(ue.getNode(),In,Xi,Fn,An,null)}const lt=$u(u,ve,ue.isFullyInitialized()||vn(l),et.filtersNodes());return Al(d,lt,l,I,new _u(I,lt,M),ee)}function La(d,u,l,g,I,M,H){const ee=u.eventCache;let ue,ve;const et=new _u(I,u,M);if(vn(l))ve=d.filter.updateFullNode(u.eventCache.getNode(),g,H),ue=Ka(u,ve,!0,d.filter.filtersNodes());else{const lt=_t(l);if(".priority"===lt)ve=d.filter.updatePriority(u.eventCache.getNode(),g),ue=Ka(u,ve,ee.isFullyInitialized(),ee.isFiltered());else{const bt=Mn(l),In=ee.getNode().getImmediateChild(lt);let Fn;if(vn(bt))Fn=g;else{const li=et.getCompleteChild(lt);Fn=null!=li?".priority"===tr(bt)&&li.getChild(ao(bt)).isEmpty()?li:li.updateChild(bt,g):k.EMPTY_NODE}ue=In.equals(Fn)?u:Ka(u,d.filter.updateChild(ee.getNode(),lt,Fn,bt,et,H),ee.isFullyInitialized(),d.filter.filtersNodes())}}return ue}function vu(d,u){return d.eventCache.isCompleteForChild(u)}function iu(d,u,l){return l.foreach((g,I)=>{u=u.updateChild(g,I)}),u}function xl(d,u,l,g,I,M,H,ee){if(u.serverCache.getNode().isEmpty()&&!u.serverCache.isFullyInitialized())return u;let ve,ue=u;ve=vn(l)?g:new Yr(null).setTree(l,g);const et=u.serverCache.getNode();return ve.children.inorderTraversal((lt,bt)=>{if(et.hasChild(lt)){const Fn=iu(0,u.serverCache.getNode().getImmediateChild(lt),bt);ue=Wu(d,ue,new tt(lt),Fn,I,M,H,ee)}}),ve.children.inorderTraversal((lt,bt)=>{const In=!u.serverCache.isCompleteForChild(lt)&&void 0===bt.value;if(!et.hasChild(lt)&&!In){const li=iu(0,u.serverCache.getNode().getImmediateChild(lt),bt);ue=Wu(d,ue,new tt(lt),li,I,M,H,ee)}}),ue}class bd{constructor(u,l){this.query_=u,this.eventRegistrations_=[];const g=this.query_._queryParams,I=new Ms(g.getIndex()),M=function _o(d){return d.loadsAllData()?new Ms(d.getIndex()):d.hasLimit()?new Pi(d):new Xn(d)}(g);this.processor_=function Nr(d){return{filter:d}}(M);const H=l.serverCache,ee=l.eventCache,ue=I.updateFullNode(k.EMPTY_NODE,H.getNode(),null),ve=M.updateFullNode(k.EMPTY_NODE,ee.getNode(),null),et=new Gi(ue,H.isFullyInitialized(),I.filtersNodes()),lt=new Gi(ve,ee.isFullyInitialized(),M.filtersNodes());this.viewCache_=Ns(lt,et),this.eventGenerator_=new Oa(this.query_)}get query(){return this.query_}}function Qe(d,u){const l=Zo(d.viewCache_);return l&&(d.query._queryParams.loadsAllData()||!vn(u)&&!l.getImmediateChild(_t(u)).isEmpty())?l.getChild(u):null}function Va(d){return 0===d.eventRegistrations_.length}function Za(d,u,l){const g=[];if(l){(0,V.hu)(null==u,"A cancel should cancel all event registrations.");const I=d.query._path;d.eventRegistrations_.forEach(M=>{const H=M.createCancelEvent(l,I);H&&g.push(H)})}if(u){let I=[];for(let M=0;M<d.eventRegistrations_.length;++M){const H=d.eventRegistrations_[M];if(H.matches(u)){if(u.hasAnyCallback()){I=I.concat(d.eventRegistrations_.slice(M+1));break}}else I.push(H)}d.eventRegistrations_=I}else d.eventRegistrations_=[];return g}function pa(d,u,l,g){u.type===vo.MERGE&&null!==u.source.queryId&&((0,V.hu)(Zo(d.viewCache_),"We should always have a full cache before handling merges"),(0,V.hu)(mi(d.viewCache_),"Missing event cache, even though we have a server cache"));const I=d.viewCache_,M=function hs(d,u,l,g,I){const M=new Gu;let H,ee;if(l.type===vo.OVERWRITE){const ve=l;ve.source.fromUser?H=La(d,u,ve.path,ve.snap,g,I,M):((0,V.hu)(ve.source.fromServer,"Unknown source."),ee=ve.source.tagged||u.serverCache.isFiltered()&&!vn(ve.path),H=Wu(d,u,ve.path,ve.snap,g,I,ee,M))}else if(l.type===vo.MERGE){const ve=l;ve.source.fromUser?H=function al(d,u,l,g,I,M,H){let ee=u;return g.foreach((ue,ve)=>{const et=nr(l,ue);vu(u,_t(et))&&(ee=La(d,ee,et,ve,I,M,H))}),g.foreach((ue,ve)=>{const et=nr(l,ue);vu(u,_t(et))||(ee=La(d,ee,et,ve,I,M,H))}),ee}(d,u,ve.path,ve.children,g,I,M):((0,V.hu)(ve.source.fromServer,"Unknown source."),ee=ve.source.tagged||u.serverCache.isFiltered(),H=xl(d,u,ve.path,ve.children,g,I,ee,M))}else if(l.type===vo.ACK_USER_WRITE){const ve=l;H=ve.revert?function qa(d,u,l,g,I,M){let H;if(null!=po(g,l))return u;{const ee=new _u(g,u,I),ue=u.eventCache.getNode();let ve;if(vn(l)||".priority"===_t(l)){let et;if(u.serverCache.isFullyInitialized())et=Tr(g,Zo(u));else{const lt=u.serverCache.getNode();(0,V.hu)(lt instanceof k,"serverChildren would be complete if leaf node"),et=_r(g,lt)}et=et,ve=d.filter.updateFullNode(ue,et,M)}else{const et=_t(l);let lt=Lo(g,et,u.serverCache);null==lt&&u.serverCache.isCompleteForChild(et)&&(lt=ue.getImmediateChild(et)),ve=null!=lt?d.filter.updateChild(ue,et,lt,Mn(l),ee,M):u.eventCache.getNode().hasChild(et)?d.filter.updateChild(ue,et,k.EMPTY_NODE,Mn(l),ee,M):ue,ve.isEmpty()&&u.serverCache.isFullyInitialized()&&(H=Tr(g,Zo(u)),H.isLeafNode()&&(ve=d.filter.updateFullNode(ve,H,M)))}return H=u.serverCache.isFullyInitialized()||null!=po(g,pt()),Ka(u,ve,H,d.filter.filtersNodes())}}(d,u,ve.path,g,I,M):function jr(d,u,l,g,I,M,H){if(null!=po(I,l))return u;const ee=u.serverCache.isFiltered(),ue=u.serverCache;if(null!=g.value){if(vn(l)&&ue.isFullyInitialized()||ue.isCompleteForPath(l))return Wu(d,u,l,ue.getNode().getChild(l),I,M,ee,H);if(vn(l)){let ve=new Yr(null);return ue.getNode().forEachChild(fi,(et,lt)=>{ve=ve.set(new tt(et),lt)}),xl(d,u,l,ve,I,M,ee,H)}return u}{let ve=new Yr(null);return g.foreach((et,lt)=>{const bt=nr(l,et);ue.isCompleteForPath(bt)&&(ve=ve.set(et,ue.getNode().getChild(bt)))}),xl(d,u,l,ve,I,M,ee,H)}}(d,u,ve.path,ve.affectedTree,g,I,M)}else{if(l.type!==vo.LISTEN_COMPLETE)throw(0,V.g5)("Unknown operation type: "+l.type);H=function zu(d,u,l,g,I){const M=u.serverCache;return Al(d,$u(u,M.getNode(),M.isFullyInitialized()||vn(l),M.isFiltered()),l,g,An,I)}(d,u,l.path,g,M)}const ue=M.getChanges();return function Zt(d,u,l){const g=u.eventCache;if(g.isFullyInitialized()){const I=g.getNode().isLeafNode()||g.getNode().isEmpty(),M=mi(d);(l.length>0||!d.eventCache.isFullyInitialized()||I&&!g.getNode().equals(M)||!g.getNode().getPriority().equals(M.getPriority()))&&l.push(rr(mi(u)))}}(u,H,ue),{viewCache:H,changes:ue}}(d.processor_,I,u,l,g);return function Qi(d,u){(0,V.hu)(u.eventCache.getNode().isIndexed(d.filter.getIndex()),"Event snap not indexed"),(0,V.hu)(u.serverCache.getNode().isIndexed(d.filter.getIndex()),"Server snap not indexed")}(d.processor_,M.viewCache),(0,V.hu)(M.viewCache.serverCache.isFullyInitialized()||!I.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),d.viewCache_=M.viewCache,Ca(d,M.changes,M.viewCache.eventCache.getNode(),null)}function Ca(d,u,l,g){return function Oo(d,u,l,g){const I=[],M=[];return u.forEach(H=>{"child_changed"===H.type&&d.index_.indexedValueChanged(H.oldSnap,H.snapshotNode)&&M.push(function gi(d,u){return{type:"child_moved",snapshotNode:u,childName:d}}(H.childName,H.snapshotNode))}),ko(d,I,"child_removed",u,g,l),ko(d,I,"child_added",u,g,l),ko(d,I,"child_moved",M,g,l),ko(d,I,"child_changed",u,g,l),ko(d,I,"value",u,g,l),I}(d.eventGenerator_,u,l,g?[g]:d.eventRegistrations_)}let Vo,Wi;class ul{constructor(){this.views=new Map}}function os(d,u,l,g){const I=u.source.queryId;if(null!==I){const M=d.views.get(I);return(0,V.hu)(null!=M,"SyncTree gave us an op for an invalid query."),pa(M,u,l,g)}{let M=[];for(const H of d.views.values())M=M.concat(pa(H,u,l,g));return M}}function Rl(d,u,l,g,I){const H=d.views.get(u._queryIdentifier);if(!H){let ee=Tr(l,I?g:null),ue=!1;ee?ue=!0:g instanceof k?(ee=_r(l,g),ue=!1):(ee=k.EMPTY_NODE,ue=!1);const ve=Ns(new Gi(ee,ue,!1),new Gi(g,I,!1));return new bd(u,ve)}return H}function Oi(d){const u=[];for(const l of d.views.values())l.query._queryParams.loadsAllData()||u.push(l);return u}function Uo(d,u){let l=null;for(const g of d.views.values())l=l||Qe(g,u);return l}function Os(d,u){return u._queryParams.loadsAllData()?Ws(d):d.views.get(u._queryIdentifier)}function Sr(d,u){return null!=Os(d,u)}function ea(d){return null!=Ws(d)}function Ws(d){for(const u of d.views.values())if(u.query._queryParams.loadsAllData())return u;return null}let Ku=1;class bo{constructor(u){this.listenProvider_=u,this.syncPointTree_=new Yr(null),this.pendingWriteTree_=function pn(){return{visibleWrites:Eo.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ai(d,u,l,g,I){return function ai(d,u,l,g,I){(0,V.hu)(g>d.lastWriteId,"Stacking an older write on top of newer ones"),void 0===I&&(I=!0),d.allWrites.push({path:u,snap:l,writeId:g,visible:I}),I&&(d.visibleWrites=Hs(d.visibleWrites,u,l)),d.lastWriteId=g}(d.pendingWriteTree_,u,l,g,I),I?ks(d,new da({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},u,l)):[]}function j(d,u,l=!1){const g=function fa(d,u){for(let l=0;l<d.allWrites.length;l++){const g=d.allWrites[l];if(g.writeId===u)return g}return null}(d.pendingWriteTree_,u);if(function S(d,u){const l=d.allWrites.findIndex(ee=>ee.writeId===u);(0,V.hu)(l>=0,"removeWrite called with nonexistent writeId.");const g=d.allWrites[l];d.allWrites.splice(l,1);let I=g.visible,M=!1,H=d.allWrites.length-1;for(;I&&H>=0;){const ee=d.allWrites[H];ee.visible&&(H>=l&&D(ee,g.path)?I=!1:ji(g.path,ee.path)&&(M=!0)),H--}return!!I&&(M?(function b(d){d.visibleWrites=P(d.allWrites,N,pt()),d.lastWriteId=d.allWrites.length>0?d.allWrites[d.allWrites.length-1].writeId:-1}(d),!0):(g.snap?d.visibleWrites=Qr(d.visibleWrites,g.path):Zn(g.children,ue=>{d.visibleWrites=Qr(d.visibleWrites,nr(g.path,ue))}),!0))}(d.pendingWriteTree_,u)){let M=new Yr(null);return null!=g.snap?M=M.set(pt(),!0):Zn(g.children,H=>{M=M.set(new tt(H),!0)}),ks(d,new qo(g.path,M,l))}return[]}function X(d,u,l){return ks(d,new da({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},u,l))}function Ct(d,u,l,g){const I=u._path,M=d.syncPointTree_.get(I);let H=[];if(M&&("default"===u._queryIdentifier||Sr(M,u))){const ee=function Ua(d,u,l,g){const I=u._queryIdentifier,M=[];let H=[];const ee=ea(d);if("default"===I)for(const[ue,ve]of d.views.entries())H=H.concat(Za(ve,l,g)),Va(ve)&&(d.views.delete(ue),ve.query._queryParams.loadsAllData()||M.push(ve.query));else{const ue=d.views.get(I);ue&&(H=H.concat(Za(ue,l,g)),Va(ue)&&(d.views.delete(I),ue.query._queryParams.loadsAllData()||M.push(ue.query)))}return ee&&!ea(d)&&M.push(new(function Xo(){return(0,V.hu)(Vo,"Reference.ts has not been loaded"),Vo}())(u._repo,u._path)),{removed:M,events:H}}(M,u,l,g);(function ll(d){return 0===d.views.size})(M)&&(d.syncPointTree_=d.syncPointTree_.remove(I));const ue=ee.removed;H=ee.events;const ve=-1!==ue.findIndex(lt=>lt._queryParams.loadsAllData()),et=d.syncPointTree_.findOnPath(I,(lt,bt)=>ea(bt));if(ve&&!et){const lt=d.syncPointTree_.subtree(I);if(!lt.isEmpty()){const bt=function Ml(d){return d.fold((u,l,g)=>{if(l&&ea(l))return[Ws(l)];{let I=[];return l&&(I=Oi(l)),Zn(g,(M,H)=>{I=I.concat(H)}),I}})}(lt);for(let In=0;In<bt.length;++In){const Fn=bt[In],li=Fn.query,Xi=wu(d,Fn);d.listenProvider_.startListening(Qa(li),Is(d,li),Xi.hashFn,Xi.onComplete)}}}!et&&ue.length>0&&!g&&(ve?d.listenProvider_.stopListening(Qa(u),null):ue.forEach(lt=>{const bt=d.queryToTagMap.get(ba(lt));d.listenProvider_.stopListening(Qa(lt),bt)})),function nc(d,u){for(let l=0;l<u.length;++l){const g=u[l];if(!g._queryParams.loadsAllData()){const I=ba(g),M=d.queryToTagMap.get(I);d.queryToTagMap.delete(I),d.tagToQueryMap.delete(M)}}}(d,ue)}return H}function Nn(d,u,l,g){const I=go(d,g);if(null!=I){const M=ta(I),H=M.path,ee=M.queryId,ue=Ur(H,u);return Ba(d,H,new da(Xs(ee),ue,l))}return[]}function ir(d,u){const l=d._path;let g=null,I=!1;u.syncPointTree_.foreachOnPath(l,(ve,et)=>{const lt=Ur(ve,l);g=g||Uo(et,lt),I=I||ea(et)});let H,M=u.syncPointTree_.get(l);M?(I=I||ea(M),g=g||Uo(M,pt())):(M=new ul,u.syncPointTree_=u.syncPointTree_.set(l,M)),null!=g?H=!0:(H=!1,g=k.EMPTY_NODE,u.syncPointTree_.subtree(l).foreachChild((et,lt)=>{const bt=Uo(lt,pt());bt&&(g=g.updateImmediateChild(et,bt))}));const ee=Sr(M,d);if(!ee&&!d._queryParams.loadsAllData()){const ve=ba(d);(0,V.hu)(!u.queryToTagMap.has(ve),"View does not exist, but we have a tag");const et=function cl(){return Ku++}();u.queryToTagMap.set(ve,et),u.tagToQueryMap.set(et,ve)}return{syncPoint:M,writesCache:xt(u.pendingWriteTree_,l),serverCache:g,serverCacheComplete:H,foundAncestorDefaultView:I,viewAlreadyExists:ee}}function _n(d,u,l){const{syncPoint:g,serverCache:I,writesCache:M,serverCacheComplete:H,viewAlreadyExists:ee,foundAncestorDefaultView:ue}=ir(u,d);let ve=function Ya(d,u,l,g,I,M){const H=Rl(d,u,g,I,M);return d.views.has(u._queryIdentifier)||d.views.set(u._queryIdentifier,H),function no(d,u){d.eventRegistrations_.push(u)}(H,l),function Co(d,u){const l=d.viewCache_.eventCache,g=[];return l.getNode().isLeafNode()||l.getNode().forEachChild(zn,(M,H)=>{g.push(Dr(M,H))}),l.isFullyInitialized()&&g.push(rr(l.getNode())),Ca(d,g,l.getNode(),u)}(H,l)}(g,u,l,M,I,H);if(!ee&&!ue){const et=Os(g,u);ve=ve.concat(function Nl(d,u,l){const g=u._path,I=Is(d,u),M=wu(d,l),H=d.listenProvider_.startListening(Qa(u),I,M.hashFn,M.onComplete),ee=d.syncPointTree_.subtree(g);if(I)(0,V.hu)(!ea(ee.value),"If we're adding a query, it shouldn't be shadowed");else{const ue=ee.fold((ve,et,lt)=>{if(!vn(ve)&&et&&ea(et))return[Ws(et).query];{let bt=[];return et&&(bt=bt.concat(Oi(et).map(In=>In.query))),Zn(lt,(In,Fn)=>{bt=bt.concat(Fn)}),bt}});for(let ve=0;ve<ue.length;++ve){const et=ue[ve];d.listenProvider_.stopListening(Qa(et),Is(d,et))}}return H}(d,u,et))}return ve}function Jr(d,u,l){const I=d.pendingWriteTree_,M=d.syncPointTree_.findOnPath(u,(H,ee)=>{const ve=Uo(ee,Ur(H,u));if(ve)return ve});return K(I,u,M,l,!0)}function ks(d,u){return Bo(u,d.syncPointTree_,null,xt(d.pendingWriteTree_,pt()))}function Bo(d,u,l,g){if(vn(d.path))return Fs(d,u,l,g);{const I=u.get(pt());null==l&&null!=I&&(l=Uo(I,pt()));let M=[];const H=_t(d.path),ee=d.operationForChild(H),ue=u.children.get(H);if(ue&&ee){const ve=l?l.getImmediateChild(H):null,et=Dn(g,H);M=M.concat(Bo(ee,ue,ve,et))}return I&&(M=M.concat(os(I,d,g,l))),M}}function Fs(d,u,l,g){const I=u.get(pt());null==l&&null!=I&&(l=Uo(I,pt()));let M=[];return u.children.inorderTraversal((H,ee)=>{const ue=l?l.getImmediateChild(H):null,ve=Dn(g,H),et=d.operationForChild(H);et&&(M=M.concat(Fs(et,ee,ue,ve)))}),I&&(M=M.concat(os(I,d,g,l))),M}function wu(d,u){const l=u.query,g=Is(d,l);return{hashFn:()=>(function Ia(d){return d.viewCache_.serverCache.getNode()}(u)||k.EMPTY_NODE).hash(),onComplete:I=>{if("ok"===I)return g?function Xe(d,u,l){const g=go(d,l);if(g){const I=ta(g),M=I.path,H=I.queryId,ee=Ur(M,u);return Ba(d,M,new mr(Xs(H),ee))}return[]}(d,l._path,g):function $e(d,u){return ks(d,new mr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},u))}(d,l._path);{const M=function Vt(d,u){let l="Unknown Error";"too_big"===d?l="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===d?l="Client doesn't have permission to access the desired data.":"unavailable"===d&&(l="The service is unavailable");const g=new Error(d+" at "+u._path.toString()+": "+l);return g.code=d.toUpperCase(),g}(I,l);return Ct(d,l,null,M)}}}}function Is(d,u){const l=ba(u);return d.queryToTagMap.get(l)}function ba(d){return d._path.toString()+"$"+d._queryIdentifier}function go(d,u){return d.tagToQueryMap.get(u)}function ta(d){const u=d.indexOf("$");return(0,V.hu)(-1!==u&&u<d.length-1,"Bad queryKey."),{queryId:d.substr(u+1),path:new tt(d.substr(0,u))}}function Ba(d,u,l){const g=d.syncPointTree_.get(u);return(0,V.hu)(g,"Missing sync point for query tag that we're tracking"),os(g,l,xt(d.pendingWriteTree_,u),null)}function Qa(d){return d._queryParams.loadsAllData()&&!d._queryParams.isDefault()?new(function ki(){return(0,V.hu)(Wi,"Reference.ts has not been loaded"),Wi}())(d._repo,d._path):d}class rc{constructor(u){this.node_=u}getImmediateChild(u){const l=this.node_.getImmediateChild(u);return new rc(l)}node(){return this.node_}}class Pl{constructor(u,l){this.syncTree_=u,this.path_=l}getImmediateChild(u){const l=nr(this.path_,u);return new Pl(this.syncTree_,l)}node(){return Jr(this.syncTree_,this.path_)}}const Hc=function(d,u,l){return d&&"object"==typeof d?((0,V.hu)(".sv"in d,"Unexpected leaf node or priority contents"),"string"==typeof d[".sv"]?Fi(d[".sv"],u,l):"object"==typeof d[".sv"]?hh(d[".sv"],u):void(0,V.hu)(!1,"Unexpected server value: "+JSON.stringify(d,null,2))):d},Fi=function(d,u,l){if("timestamp"===d)return l.timestamp;(0,V.hu)(!1,"Unexpected server value: "+d)},hh=function(d,u,l){d.hasOwnProperty("increment")||(0,V.hu)(!1,"Unexpected server value: "+JSON.stringify(d,null,2));const g=d.increment;"number"!=typeof g&&(0,V.hu)(!1,"Unexpected increment value: "+g);const I=u.node();if((0,V.hu)(null!=I,"Expected ChildrenNode.EMPTY_NODE for nulls"),!I.isLeafNode())return g;const H=I.getValue();return"number"!=typeof H?g:H+g},dl=function(d,u,l,g){return hl(u,new Pl(l,d),g)},su=function(d,u,l){return hl(d,new rc(u),l)};function hl(d,u,l){const g=d.getPriority().val(),I=Hc(g,u.getImmediateChild(".priority"),l);let M;if(d.isLeafNode()){const H=d,ee=Hc(H.getValue(),u,l);return ee!==H.getValue()||I!==H.getPriority().val()?new Wn(ee,Y(I)):d}{const H=d;return M=H,I!==H.getPriority().val()&&(M=M.updatePriority(new Wn(I))),H.forEachChild(zn,(ee,ue)=>{const ve=hl(ue,u.getImmediateChild(ee),l);ve!==ue&&(M=M.updateImmediateChild(ee,ve))}),M}}class ou{constructor(u="",l=null,g={children:{},childCount:0}){this.name=u,this.parent=l,this.node=g}}function Da(d,u){let l=u instanceof tt?u:new tt(u),g=d,I=_t(l);for(;null!==I;){const M=(0,V.DV)(g.node.children,I)||{children:{},childCount:0};g=new ou(I,g,M),l=Mn(l),I=_t(l)}return g}function Ja(d){return d.node.value}function ic(d,u){d.node.value=u,sc(d)}function Dd(d){return d.node.childCount>0}function Iu(d,u){Zn(d.node.children,(l,g)=>{u(new ou(l,d,g))})}function Gc(d,u,l,g){l&&!g&&u(d),Iu(d,I=>{Gc(I,u,!0,g)}),l&&g&&u(d)}function qu(d){return new tt(null===d.parent?d.name:qu(d.parent)+"/"+d.name)}function sc(d){null!==d.parent&&function fh(d,u,l){const g=function Ls(d){return void 0===Ja(d)&&!Dd(d)}(l),I=(0,V.r3)(d.node.children,u);g&&I?(delete d.node.children[u],d.node.childCount--,sc(d)):!g&&!I&&(d.node.children[u]=l.node,d.node.childCount++,sc(d))}(d.parent,d.name,d)}const Sd=/[\[\].#$\/\u0000-\u001F\u007F]/,ph=/[\[\].#$\u0000-\u001F\u007F]/,Xa=10485760,au=function(d){return"string"==typeof d&&0!==d.length&&!Sd.test(d)},uu=function(d){return"string"==typeof d&&0!==d.length&&!ph.test(d)},fl=function(d){return null===d||"string"==typeof d||"number"==typeof d&&!Gn(d)||d&&"object"==typeof d&&(0,V.r3)(d,".sv")},Ks=function(d,u,l,g){g&&void 0===u||Ol((0,V.gK)(d,"value"),u,l)},Ol=function(d,u,l){const g=l instanceof tt?new ti(l,d):l;if(void 0===u)throw new Error(d+"contains undefined "+ls(g));if("function"==typeof u)throw new Error(d+"contains a function "+ls(g)+" with contents = "+u.toString());if(Gn(u))throw new Error(d+"contains "+u.toString()+" "+ls(g));if("string"==typeof u&&u.length>Xa/3&&(0,V.ug)(u)>Xa)throw new Error(d+"contains a string greater than "+Xa+" utf8 bytes "+ls(g)+" ('"+u.substring(0,50)+"...')");if(u&&"object"==typeof u){let I=!1,M=!1;if(Zn(u,(H,ee)=>{if(".value"===H)I=!0;else if(".priority"!==H&&".sv"!==H&&(M=!0,!au(H)))throw new Error(d+" contains an invalid key ("+H+") "+ls(g)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function is(d,u){d.parts_.length>0&&(d.byteLength_+=1),d.parts_.push(u),d.byteLength_+=(0,V.ug)(u),vs(d)})(g,H),Ol(d,ee,g),function ss(d){const u=d.parts_.pop();d.byteLength_-=(0,V.ug)(u),d.parts_.length>0&&(d.byteLength_-=1)}(g)}),I&&M)throw new Error(d+' contains ".value" child '+ls(g)+" in addition to actual children.")}},gh=function(d,u,l,g){if(g&&void 0===u)return;const I=(0,V.gK)(d,"values");if(!u||"object"!=typeof u||Array.isArray(u))throw new Error(I+" must be an object containing the children to replace.");const M=[];Zn(u,(H,ee)=>{const ue=new tt(H);if(Ol(I,ee,nr(l,ue)),".priority"===tr(ue)&&!fl(ee))throw new Error(I+"contains an invalid value for '"+ue.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");M.push(ue)}),function(d,u){let l,g;for(l=0;l<u.length;l++){g=u[l];const M=Bi(g);for(let H=0;H<M.length;H++)if((".priority"!==M[H]||H!==M.length-1)&&!au(M[H]))throw new Error(d+"contains an invalid key ("+M[H]+") in path "+g.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}u.sort(_s);let I=null;for(l=0;l<u.length;l++){if(g=u[l],null!==I&&ji(I,g))throw new Error(d+"contains a path "+I.toString()+" that is ancestor of another path "+g.toString());I=g}}(I,M)},gl=function(d,u,l){if(!l||void 0!==u){if(Gn(u))throw new Error((0,V.gK)(d,"priority")+"is "+u.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!fl(u))throw new Error((0,V.gK)(d,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},bu=function(d,u,l,g){if(!(g&&void 0===l||au(l)))throw new Error((0,V.gK)(d,u)+'was an invalid key = "'+l+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Du=function(d,u,l,g){if(!(g&&void 0===l||uu(l)))throw new Error((0,V.gK)(d,u)+'was an invalid path = "'+l+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},as=function(d,u){if(".info"===_t(u))throw new Error(d+" failed = Can't modify data under /.info/")},Wc=function(d,u){const l=u.path.toString();if("string"!=typeof u.repoInfo.host||0===u.repoInfo.host.length||!au(u.repoInfo.namespace)&&"localhost"!==u.repoInfo.host.split(":")[0]||0!==l.length&&!function(d){return d&&(d=d.replace(/^\/*\.info(\/|$)/,"/")),uu(d)}(l))throw new Error((0,V.gK)(d,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class oc{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ac(d,u){let l=null;for(let g=0;g<u.length;g++){const I=u[g],M=I.getPath();null!==l&&!uo(M,l.path)&&(d.eventLists_.push(l),l=null),null===l&&(l={events:[],path:M}),l.events.push(I)}l&&d.eventLists_.push(l)}function ga(d,u,l){ac(d,l),Ta(d,g=>uo(g,u))}function jo(d,u,l){ac(d,l),Ta(d,g=>ji(g,u)||ji(u,g))}function Ta(d,u){d.recursionDepth_++;let l=!0;for(let g=0;g<d.eventLists_.length;g++){const I=d.eventLists_[g];I&&(u(I.path)?(Tu(d.eventLists_[g]),d.eventLists_[g]=null):l=!1)}l&&(d.eventLists_=[]),d.recursionDepth_--}function Tu(d){for(let u=0;u<d.events.length;u++){const l=d.events[u];if(null!==l){d.events[u]=null;const g=l.getEventRunner();Kt&&Yt("event: "+l.toString()),cn(g)}}}const zc="repo_interrupt";class Kc{constructor(u,l,g,I){this.repoInfo_=u,this.forceRestClient_=l,this.authTokenProvider_=g,this.appCheckProvider_=I,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new oc,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=No(),this.transactionQueueTree_=new ou,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ml(d){const l=d.infoData_.getNode(new tt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+l}function uc(d){return function(d){return(d=d||{}).timestamp=d.timestamp||(new Date).getTime(),d}({timestamp:ml(d)})}function lc(d,u,l,g,I){d.dataUpdateCount++;const M=new tt(u);l=d.interceptServerDataCallback_?d.interceptServerDataCallback_(u,l):l;let H=[];if(I)if(g){const ue=(0,V.UI)(l,ve=>Y(ve));H=function jn(d,u,l,g){const I=go(d,g);if(I){const M=ta(I),H=M.path,ee=M.queryId,ue=Ur(H,u),ve=Yr.fromObject(l);return Ba(d,H,new $s(Xs(ee),ue,ve))}return[]}(d.serverSyncTree_,M,ue,I)}else{const ue=Y(l);H=Nn(d.serverSyncTree_,M,ue,I)}else if(g){const ue=(0,V.UI)(l,ve=>Y(ve));H=function me(d,u,l){const g=Yr.fromObject(l);return ks(d,new $s({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},u,g))}(d.serverSyncTree_,M,ue)}else{const ue=Y(l);H=X(d.serverSyncTree_,M,ue)}let ee=M;H.length>0&&(ee=el(d,M)),jo(d.eventQueue_,ee,H)}function Yu(d,u){Au(d,"connected",u),!1===u&&function hc(d){Xu(d,"onDisconnectEvents");const u=uc(d),l=No();fo(d.onDisconnect_,pt(),(I,M)=>{const H=dl(I,M,d.serverSyncTree_,u);Na(l,I,H)});let g=[];fo(l,pt(),(I,M)=>{g=g.concat(X(d.serverSyncTree_,I,M));const H=Ji(d,I);el(d,H)}),d.onDisconnect_=No(),jo(d.eventQueue_,pt(),g)}(d)}function Au(d,u,l){const g=new tt("/.info/"+u),I=Y(l);d.infoData_.updateSnapshot(g,I);const M=X(d.infoSyncTree_,g,I);jo(d.eventQueue_,g,M)}function cc(d){return d.nextWriteId_++}function xu(d,u){const l=function zs(d,u){const l=u._path;let g=null;d.syncPointTree_.foreachOnPath(l,(ve,et)=>{const lt=Ur(ve,l);g=g||Uo(et,lt)});let I=d.syncPointTree_.get(l);I?g=g||Uo(I,pt()):(I=new ul,d.syncPointTree_=d.syncPointTree_.set(l,I));const M=null!=g,H=M?new Gi(g,!0,!1):null;return function Io(d){return mi(d.viewCache_)}(Rl(I,u,xt(d.pendingWriteTree_,u._path),M?H.getNode():k.EMPTY_NODE,M))}(d.serverSyncTree_,u);return null!=l?Promise.resolve(l):d.server_.get(u).then(g=>{const I=Y(g).withIndex(u._queryParams.getIndex());if(u._queryParams.loadsAllData())X(d.serverSyncTree_,u._path,I);else{const H=function Ot(d,u){const{syncPoint:l,serverCache:g,writesCache:I,serverCacheComplete:M}=ir(u,d),H=Rl(l,u,I,g,M);return l.views.has(u._queryIdentifier)||l.views.set(u._queryIdentifier,H),u._queryParams.loadsAllData()?null:Is(d,u)}(d.serverSyncTree_,u);Nn(d.serverSyncTree_,u._path,I,H)}return Ct(d.serverSyncTree_,u,null).length>0&&Xu(d,"unexpected cancel events in repoGetValue"),I},g=>(Xu(d,"get for query "+(0,V.Pz)(u)+" failed: "+g),Promise.reject(new Error(g))))}function dc(d,u,l,g,I){Xu(d,"set",{path:u.toString(),value:l,priority:g});const M=uc(d),H=Y(l,g),ee=Jr(d.serverSyncTree_,u),ue=su(H,ee,M),ve=cc(d),et=Ai(d.serverSyncTree_,u,ue,ve,!0);ac(d.eventQueue_,et),d.server_.put(u.toString(),H.val(!0),(bt,In)=>{const Fn="ok"===bt;Fn||Pn("set at "+u+" failed: "+bt);const li=j(d.serverSyncTree_,ve,!Fn);jo(d.eventQueue_,u,li),na(0,I,bt,In)});const lt=Ji(d,u);el(d,lt),jo(d.eventQueue_,lt,[])}function Ad(d,u,l){d.server_.onDisconnectCancel(u.toString(),(g,I)=>{"ok"===g&&Si(d.onDisconnect_,u),na(0,l,g,I)})}function Ju(d,u,l,g){const I=Y(l);d.server_.onDisconnectPut(u.toString(),I.val(!0),(M,H)=>{"ok"===M&&Na(d.onDisconnect_,u,I),na(0,g,M,H)})}function _l(d,u,l){let g;g=".info"===_t(u._path)?Ct(d.infoSyncTree_,u,l):Ct(d.serverSyncTree_,u,l),ga(d.eventQueue_,u._path,g)}function xi(d){d.persistentConnection_&&d.persistentConnection_.interrupt(zc)}function Xu(d,...u){let l="";d.persistentConnection_&&(l=d.persistentConnection_.id+":"),Yt(l,...u)}function na(d,u,l,g){u&&cn(()=>{if("ok"===l)u(null);else{const I=(l||"error").toUpperCase();let M=I;g&&(M+=": "+g);const H=new Error(M);H.code=I,u(H)}})}function fc(d,u,l){return Jr(d.serverSyncTree_,u,l)||k.EMPTY_NODE}function lu(d,u=d.transactionQueueTree_){if(u||io(d,u),Ja(u)){const l=tl(d,u);(0,V.hu)(l.length>0,"Sending zero length transaction queue"),l.every(I=>0===I.status)&&function cu(d,u,l){const g=l.map(ve=>ve.currentWriteId),I=fc(d,u,g);let M=I;const H=I.hash();for(let ve=0;ve<l.length;ve++){const et=l[ve];(0,V.hu)(0===et.status,"tryToSendTransactionQueue_: items in queue should all be run."),et.status=1,et.retryCount++;const lt=Ur(u,et.path);M=M.updateChild(lt,et.currentOutputSnapshotRaw)}const ee=M.val(!0),ue=u;d.server_.put(ue.toString(),ee,ve=>{Xu(d,"transaction put response",{path:ue.toString(),status:ve});let et=[];if("ok"===ve){const lt=[];for(let bt=0;bt<l.length;bt++)l[bt].status=2,et=et.concat(j(d.serverSyncTree_,l[bt].currentWriteId)),l[bt].onComplete&&lt.push(()=>l[bt].onComplete(null,!0,l[bt].currentOutputSnapshotResolved)),l[bt].unwatcher();io(d,Da(d.transactionQueueTree_,u)),lu(d,d.transactionQueueTree_),jo(d.eventQueue_,u,et);for(let bt=0;bt<lt.length;bt++)cn(lt[bt])}else{if("datastale"===ve)for(let lt=0;lt<l.length;lt++)l[lt].status=3===l[lt].status?4:0;else{Pn("transaction at "+ue.toString()+" failed: "+ve);for(let lt=0;lt<l.length;lt++)l[lt].status=4,l[lt].abortReason=ve}el(d,u)}},H)}(d,qu(u),l)}else Dd(u)&&Iu(u,l=>{lu(d,l)})}function el(d,u){const l=Rd(d,u),g=qu(l);return function vl(d,u,l){if(0===u.length)return;const g=[];let I=[];const H=u.filter(ee=>0===ee.status).map(ee=>ee.currentWriteId);for(let ee=0;ee<u.length;ee++){const ue=u[ee],ve=Ur(l,ue.path);let lt,et=!1;if((0,V.hu)(null!==ve,"rerunTransactionsUnderNode_: relativePath should not be null."),4===ue.status)et=!0,lt=ue.abortReason,I=I.concat(j(d.serverSyncTree_,ue.currentWriteId,!0));else if(0===ue.status)if(ue.retryCount>=25)et=!0,lt="maxretry",I=I.concat(j(d.serverSyncTree_,ue.currentWriteId,!0));else{const bt=fc(d,ue.path,H);ue.currentInputSnapshot=bt;const In=u[ee].update(bt.val());if(void 0!==In){Ol("transaction failed: Data returned ",In,ue.path);let Fn=Y(In);"object"==typeof In&&null!=In&&(0,V.r3)(In,".priority")||(Fn=Fn.updatePriority(bt.getPriority()));const Xi=ue.currentWriteId,bl=uc(d),fu=su(Fn,bt,bl);ue.currentOutputSnapshotRaw=Fn,ue.currentOutputSnapshotResolved=fu,ue.currentWriteId=cc(d),H.splice(H.indexOf(Xi),1),I=I.concat(Ai(d.serverSyncTree_,ue.path,fu,ue.currentWriteId,ue.applyLocally)),I=I.concat(j(d.serverSyncTree_,Xi,!0))}else et=!0,lt="nodata",I=I.concat(j(d.serverSyncTree_,ue.currentWriteId,!0))}jo(d.eventQueue_,l,I),I=[],et&&(u[ee].status=2,setTimeout(u[ee].unwatcher,Math.floor(0)),u[ee].onComplete&&g.push("nodata"===lt?()=>u[ee].onComplete(null,!1,u[ee].currentInputSnapshot):()=>u[ee].onComplete(new Error(lt),!1,null)))}io(d,d.transactionQueueTree_);for(let ee=0;ee<g.length;ee++)cn(g[ee]);lu(d,d.transactionQueueTree_)}(d,tl(d,l),g),g}function Rd(d,u){let l,g=d.transactionQueueTree_;for(l=_t(u);null!==l&&void 0===Ja(g);)g=Da(g,l),l=_t(u=Mn(u));return g}function tl(d,u){const l=[];return Ru(d,u,l),l.sort((g,I)=>g.order-I.order),l}function Ru(d,u,l){const g=Ja(u);if(g)for(let I=0;I<g.length;I++)l.push(g[I]);Iu(u,I=>{Ru(d,I,l)})}function io(d,u){const l=Ja(u);if(l){let g=0;for(let I=0;I<l.length;I++)2!==l[I].status&&(l[g]=l[I],g++);l.length=g,ic(u,l.length>0?l:void 0)}Iu(u,g=>{io(d,g)})}function Ji(d,u){const l=qu(Rd(d,u)),g=Da(d.transactionQueueTree_,u);return function Td(d,u,l){let g=l?d:d.parent;for(;null!==g;){if(u(g))return!0;g=g.parent}}(g,I=>{kr(d,I)}),kr(d,g),Gc(g,I=>{kr(d,I)}),l}function kr(d,u){const l=Ja(u);if(l){const g=[];let I=[],M=-1;for(let H=0;H<l.length;H++)3===l[H].status||(1===l[H].status?((0,V.hu)(M===H-1,"All SENT items should be at beginning of queue."),M=H,l[H].status=3,l[H].abortReason="set"):((0,V.hu)(0===l[H].status,"Unexpected transaction status in abort"),l[H].unwatcher(),I=I.concat(j(d.serverSyncTree_,l[H].currentWriteId,!0)),l[H].onComplete&&g.push(l[H].onComplete.bind(null,new Error("set"),!1,null))));-1===M?ic(u,void 0):l.length=M+1,jo(d.eventQueue_,qu(u),I);for(let H=0;H<g.length;H++)cn(g[H])}}const Do=function(d,u){const l=gc(d),g=l.namespace;return"firebase.com"===l.domain&&sr(l.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!g||"undefined"===g)&&"localhost"!==l.domain&&sr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),l.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Pn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new ur(l.host,l.secure,g,"ws"===l.scheme||"wss"===l.scheme,u,"",g!==l.subdomain),path:new tt(l.pathString)}},gc=function(d){let u="",l="",g="",I="",M="",H=!0,ee="https",ue=443;if("string"==typeof d){let ve=d.indexOf("//");ve>=0&&(ee=d.substring(0,ve-1),d=d.substring(ve+2));let et=d.indexOf("/");-1===et&&(et=d.length);let lt=d.indexOf("?");-1===lt&&(lt=d.length),u=d.substring(0,Math.min(et,lt)),et<lt&&(I=function pc(d){let u="";const l=d.split("/");for(let g=0;g<l.length;g++)if(l[g].length>0){let I=l[g];try{I=decodeURIComponent(I.replace(/\+/g," "))}catch(M){}u+="/"+I}return u}(d.substring(et,lt)));const bt=function qs(d){const u={};"?"===d.charAt(0)&&(d=d.substring(1));for(const l of d.split("&")){if(0===l.length)continue;const g=l.split("=");2===g.length?u[decodeURIComponent(g[0])]=decodeURIComponent(g[1]):Pn(`Invalid query segment '${l}' in query '${d}'`)}return u}(d.substring(Math.min(d.length,lt)));ve=u.indexOf(":"),ve>=0?(H="https"===ee||"wss"===ee,ue=parseInt(u.substring(ve+1),10)):ve=u.length;const In=u.slice(0,ve);if("localhost"===In.toLowerCase())l="localhost";else if(In.split(".").length<=2)l=In;else{const Fn=u.indexOf(".");g=u.substring(0,Fn).toLowerCase(),l=u.substring(Fn+1),M=g}"ns"in bt&&(M=bt.ns)}return{host:u,port:ue,domain:l,subdomain:g,secure:H,scheme:ee,pathString:I,namespace:M}};class $o{constructor(u,l,g,I){this.eventType=u,this.eventRegistration=l,this.snapshot=g,this.prevName=I}getPath(){const u=this.snapshot.ref;return"value"===this.eventType?u._path:u.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,V.Pz)(this.snapshot.exportVal())}}class Fl{constructor(u,l,g){this.eventRegistration=u,this.error=l,this.path=g}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class nl{constructor(u,l){this.snapshotCallback=u,this.cancelCallback=l}onValue(u,l){this.snapshotCallback.call(null,u,l)}onCancel(u){return(0,V.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,u)}get hasCancelCallback(){return!!this.cancelCallback}matches(u){return this.snapshotCallback===u.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===u.snapshotCallback.userCallback&&this.snapshotCallback.context===u.snapshotCallback.context}}class Ho{constructor(u,l){this._repo=u,this._path=l}cancel(){const u=new V.BH;return Ad(this._repo,this._path,u.wrapCallback(()=>{})),u.promise}remove(){as("OnDisconnect.remove",this._path);const u=new V.BH;return Ju(this._repo,this._path,null,u.wrapCallback(()=>{})),u.promise}set(u){as("OnDisconnect.set",this._path),Ks("OnDisconnect.set",u,this._path,!1);const l=new V.BH;return Ju(this._repo,this._path,u,l.wrapCallback(()=>{})),l.promise}setWithPriority(u,l){as("OnDisconnect.setWithPriority",this._path),Ks("OnDisconnect.setWithPriority",u,this._path,!1),gl("OnDisconnect.setWithPriority",l,!1);const g=new V.BH;return function yl(d,u,l,g,I){const M=Y(l,g);d.server_.onDisconnectPut(u.toString(),M.val(!0),(H,ee)=>{"ok"===H&&Na(d.onDisconnect_,u,M),na(0,I,H,ee)})}(this._repo,this._path,u,l,g.wrapCallback(()=>{})),g.promise}update(u){as("OnDisconnect.update",this._path),gh("OnDisconnect.update",u,this._path,!1);const l=new V.BH;return function qc(d,u,l,g){if((0,V.xb)(l))return Yt("onDisconnect().update() called with empty data.  Don't do anything."),void na(0,g,"ok",void 0);d.server_.onDisconnectMerge(u.toString(),l,(I,M)=>{"ok"===I&&Zn(l,(H,ee)=>{const ue=Y(ee);Na(d.onDisconnect_,nr(u,H),ue)}),na(0,g,I,M)})}(this._repo,this._path,u,l.wrapCallback(()=>{})),l.promise}}class Ii{constructor(u,l,g,I){this._repo=u,this._path=l,this._queryParams=g,this._orderByCalled=I}get key(){return vn(this._path)?null:tr(this._path)}get ref(){return new ra(this._repo,this._path)}get _queryIdentifier(){const u=ca(this._queryParams),l=Ci(u);return"{}"===l?"default":l}get _queryObject(){return ca(this._queryParams)}isEqual(u){if(!((u=(0,V.m9)(u))instanceof Ii))return!1;const l=this._repo===u._repo,g=uo(this._path,u._path);return l&&g&&this._queryIdentifier===u._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function rs(d){let u="";for(let l=d.pieceNum_;l<d.pieces_.length;l++)""!==d.pieces_[l]&&(u+="/"+encodeURIComponent(String(d.pieces_[l])));return u||"/"}(this._path)}}function El(d,u){if(!0===d._orderByCalled)throw new Error(u+": You can't combine multiple orderBy calls.")}function ma(d){let u=null,l=null;if(d.hasStart()&&(u=d.getIndexStartValue()),d.hasEnd()&&(l=d.getIndexEndValue()),d.getIndex()===fi){const g="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",I="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(d.hasStart()){if(d.getIndexStartName()!==Vn)throw new Error(g);if("string"!=typeof u)throw new Error(I)}if(d.hasEnd()){if(d.getIndexEndName()!==Bt)throw new Error(g);if("string"!=typeof l)throw new Error(I)}}else if(d.getIndex()===zn){if(null!=u&&!fl(u)||null!=l&&!fl(l))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,V.hu)(d.getIndex()instanceof oe||d.getIndex()===Ke,"unknown index type."),null!=u&&"object"==typeof u||null!=l&&"object"==typeof l)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function wl(d){if(d.hasStart()&&d.hasEnd()&&d.hasLimit()&&!d.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ra extends Ii{constructor(u,l){super(u,l,new Js,!1)}get parent(){const u=ao(this._path);return null===u?null:new ra(this._repo,u)}get root(){let u=this;for(;null!==u.parent;)u=u.parent;return u}}class Kn{constructor(u,l,g){this._node=u,this.ref=l,this._index=g}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(u){const l=new tt(u),g=Vs(this.ref,u);return new Kn(this._node.getChild(l),g,zn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(u){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(g,I)=>u(new Kn(I,Vs(this.ref,g),zn)))}hasChild(u){const l=new tt(u);return!this._node.getChild(l).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Yc(d,u){return(d=(0,V.m9)(d))._checkNotDeleted("ref"),void 0!==u?Vs(d._root,u):d._root}function Ll(d,u){(d=(0,V.m9)(d))._checkNotDeleted("refFromURL");const l=Do(u,d._repo.repoInfo_.nodeAdmin);Wc("refFromURL",l);const g=l.repoInfo;return!d._repo.repoInfo_.isCustomHost()&&g.host!==d._repo.repoInfo_.host&&sr("refFromURL: Host name does not match the current database: (found "+g.host+" but expected "+d._repo.repoInfo_.host+")"),Yc(d,l.path.toString())}function Vs(d,u){return null===_t((d=(0,V.m9)(d))._path)?(l=u,l&&(l=l.replace(/^\/*\.info(\/|$)/,"/")),Du("child","path",l,!1)):Du("child","path",u,!1),new ra(d._repo,nr(d._path,u));var l}function yc(d,u){d=(0,V.m9)(d),as("set",d._path),Ks("set",u,d._path,!1);const l=new V.BH;return dc(d._repo,d._path,u,null,l.wrapCallback(()=>{})),l.promise}function _c(d,u){gh("update",u,d._path,!1);const l=new V.BH;return function Qu(d,u,l,g){Xu(d,"update",{path:u.toString(),value:l});let I=!0;const M=uc(d),H={};if(Zn(l,(ee,ue)=>{I=!1,H[ee]=dl(nr(u,ee),Y(ue),d.serverSyncTree_,M)}),I)Yt("update() called with empty data.  Don't do anything."),na(0,g,"ok",void 0);else{const ee=cc(d),ue=function L(d,u,l,g){!function Jo(d,u,l,g){(0,V.hu)(g>d.lastWriteId,"Stacking an older merge on top of newer ones"),d.allWrites.push({path:u,children:l,writeId:g,visible:!0}),d.visibleWrites=ru(d.visibleWrites,u,l),d.lastWriteId=g}(d.pendingWriteTree_,u,l,g);const I=Yr.fromObject(l);return ks(d,new $s({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},u,I))}(d.serverSyncTree_,u,H,ee);ac(d.eventQueue_,ue),d.server_.merge(u.toString(),l,(ve,et)=>{const lt="ok"===ve;lt||Pn("update at "+u+" failed: "+ve);const bt=j(d.serverSyncTree_,ee,!lt),In=bt.length>0?el(d,u):u;jo(d.eventQueue_,In,bt),na(0,g,ve,et)}),Zn(l,ve=>{const et=Ji(d,nr(u,ve));el(d,et)}),jo(d.eventQueue_,u,[])}}(d._repo,d._path,u,l.wrapCallback(()=>{})),l.promise}class Bl{constructor(u){this.callbackContext=u}respondsTo(u){return"value"===u}createEvent(u,l){const g=l._queryParams.getIndex();return new $o("value",this,new Kn(u.snapshotNode,new ra(l._repo,l._path),g))}getEventRunner(u){return"cancel"===u.getEventType()?()=>this.callbackContext.onCancel(u.error):()=>this.callbackContext.onValue(u.snapshot,null)}createCancelEvent(u,l){return this.callbackContext.hasCancelCallback?new Fl(this,u,l):null}matches(u){return u instanceof Bl&&(!u.callbackContext||!this.callbackContext||u.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Sa{constructor(u,l){this.eventType=u,this.callbackContext=l}respondsTo(u){let l="children_added"===u?"child_added":u;return l="children_removed"===l?"child_removed":l,this.eventType===l}createCancelEvent(u,l){return this.callbackContext.hasCancelCallback?new Fl(this,u,l):null}createEvent(u,l){(0,V.hu)(null!=u.childName,"Child events should have a childName.");const g=Vs(new ra(l._repo,l._path),u.childName),I=l._queryParams.getIndex();return new $o(u.type,this,new Kn(u.snapshotNode,g,I),u.prevName)}getEventRunner(u){return"cancel"===u.getEventType()?()=>this.callbackContext.onCancel(u.error):()=>this.callbackContext.onValue(u.snapshot,u.prevName)}matches(u){return u instanceof Sa&&this.eventType===u.eventType&&(!this.callbackContext||!u.callbackContext||this.callbackContext.matches(u.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function du(d,u,l,g,I){let M;if("object"==typeof g&&(M=void 0,I=g),"function"==typeof g&&(M=g),I&&I.onlyOnce){const ue=l,ve=(et,lt)=>{_l(d._repo,d,ee),ue(et,lt)};ve.userCallback=l.userCallback,ve.context=l.context,l=ve}const H=new nl(l,M||void 0),ee="value"===u?new Bl(H):new Sa(u,H);return function zi(d,u,l){let g;g=".info"===_t(u._path)?_n(d.infoSyncTree_,u,l):_n(d.serverSyncTree_,u,l),ga(d.eventQueue_,u._path,g)}(d._repo,d,ee),()=>_l(d._repo,d,ee)}function Mu(d,u,l,g){return du(d,"value",u,l,g)}function Ec(d,u,l,g){return du(d,"child_added",u,l,g)}function Md(d,u,l,g){return du(d,"child_changed",u,l,g)}function Cs(d,u,l,g){return du(d,"child_moved",u,l,g)}function wc(d,u,l,g){return du(d,"child_removed",u,l,g)}function Jc(d,u,l){let g=null;const I=l?new nl(l):null;"value"===u?g=new Bl(I):u&&(g=new Sa(u,I)),_l(d._repo,d,g)}class Us{}class Bs extends Us{constructor(u,l){super(),this._value=u,this._key=l}_apply(u){Ks("endAt",this._value,u._path,!0);const l=Ea(u._queryParams,this._value,this._key);if(wl(l),ma(l),u._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ii(u._repo,u._path,l,u._orderByCalled)}}class f extends Us{constructor(u,l){super(),this._value=u,this._key=l}_apply(u){Ks("endBefore",this._value,u._path,!1);const l=function zo(d,u,l){let g,I;return d.index_===fi?("string"==typeof u&&(u=Or(u)),I=Ea(d,u,l)):(g=null==l?Vn:Or(l),I=Ea(d,u,g)),I.endBeforeSet_=!0,I}(u._queryParams,this._value,this._key);if(wl(l),ma(l),u._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ii(u._repo,u._path,l,u._orderByCalled)}}class T extends Us{constructor(u,l){super(),this._value=u,this._key=l}_apply(u){Ks("startAt",this._value,u._path,!0);const l=Ro(u._queryParams,this._value,this._key);if(wl(l),ma(l),u._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ii(u._repo,u._path,l,u._orderByCalled)}}class re extends Us{constructor(u,l){super(),this._value=u,this._key=l}_apply(u){Ks("startAfter",this._value,u._path,!1);const l=function ju(d,u,l){let g;if(d.index_===fi)"string"==typeof u&&(u=Br(u)),g=Ro(d,u,l);else{let I;I=null==l?Bt:Br(l),g=Ro(d,u,I)}return g.startAfterSet_=!0,g}(u._queryParams,this._value,this._key);if(wl(l),ma(l),u._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ii(u._repo,u._path,l,u._orderByCalled)}}class ct extends Us{constructor(u){super(),this._limit=u}_apply(u){if(u._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ii(u._repo,u._path,function la(d,u){const l=d.copy();return l.limitSet_=!0,l.limit_=u,l.viewFrom_="l",l}(u._queryParams,this._limit),u._orderByCalled)}}class rn extends Us{constructor(u){super(),this._limit=u}_apply(u){if(u._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ii(u._repo,u._path,function xo(d,u){const l=d.copy();return l.limitSet_=!0,l.limit_=u,l.viewFrom_="r",l}(u._queryParams,this._limit),u._orderByCalled)}}class xn extends Us{constructor(u){super(),this._path=u}_apply(u){El(u,"orderByChild");const l=new tt(this._path);if(vn(l))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const g=new oe(l),I=Ko(u._queryParams,g);return ma(I),new Ii(u._repo,u._path,I,!0)}}class sa extends Us{_apply(u){El(u,"orderByKey");const l=Ko(u._queryParams,fi);return ma(l),new Ii(u._repo,u._path,l,!0)}}class Nd extends Us{_apply(u){El(u,"orderByPriority");const l=Ko(u._queryParams,zn);return ma(l),new Ii(u._repo,u._path,l,!0)}}class Ic extends Us{_apply(u){El(u,"orderByValue");const l=Ko(u._queryParams,Ke);return ma(l),new Ii(u._repo,u._path,l,!0)}}class Ou extends Us{constructor(u,l){super(),this._value=u,this._key=l}_apply(u){if(Ks("equalTo",this._value,u._path,!1),u._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(u._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Bs(this._value,this._key)._apply(new T(this._value,this._key)._apply(u))}}function Aa(d,...u){let l=(0,V.m9)(d);for(const g of u)l=g._apply(l);return l}(function Eu(d){(0,V.hu)(!Vo,"__referenceConstructor has already been defined"),Vo=d})(ra),function dh(d){(0,V.hu)(!Wi,"__referenceConstructor has already been defined"),Wi=d}(ra);const $l={};function td(d,u,l,g,I){let M=g||d.options.databaseURL;void 0===M&&(d.options.projectId||sr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Yt("Using default host for project ",d.options.projectId),M=`${d.options.projectId}-default-rtdb.firebaseio.com`);let ue,ve,H=Do(M,I),ee=H.repoInfo;"undefined"!=typeof process&&process.env&&(ve=process.env.FIREBASE_DATABASE_EMULATOR_HOST),ve?(ue=!0,M=`http://${ve}?ns=${ee.namespace}`,H=Do(M,I),ee=H.repoInfo):ue=!H.repoInfo.secure;const et=I&&ue?new Ne(Ne.OWNER):new dn(d.name,d.options,u);Wc("Invalid Firebase Database URL",H),vn(H.path)||sr("Database URL must point to the root of a Firebase Database (not including a child path).");const lt=function Pd(d,u,l,g){let I=$l[u.name];I||(I={},$l[u.name]=I);let M=I[d.toURLString()];return M&&sr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),M=new Kc(d,false,l,g),I[d.toURLString()]=M,M}(ee,d,et,new vr(d.name,l));return new Od(lt,d)}class Od{constructor(u,l){this._repoInternal=u,this.app=l,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function mh(d,u,l){if(d.stats_=ii(d.repoInfo_),d.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)d.server_=new Ga(d.repoInfo_,(g,I,M,H)=>{lc(d,g,I,M,H)},d.authTokenProvider_,d.appCheckProvider_),setTimeout(()=>Yu(d,!0),0);else{if(null!=l){if("object"!=typeof l)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,V.Pz)(l)}catch(g){throw new Error("Invalid authOverride provided: "+g)}}d.persistentConnection_=new ws(d.repoInfo_,u,(g,I,M,H)=>{lc(d,g,I,M,H)},g=>{Yu(d,g)},g=>{!function Su(d,u){Zn(u,(l,g)=>{Au(d,l,g)})}(d,g)},d.authTokenProvider_,d.appCheckProvider_,l),d.server_=d.persistentConnection_}d.authTokenProvider_.addTokenChangeListener(g=>{d.server_.refreshAuthToken(g)}),d.appCheckProvider_.addTokenChangeListener(g=>{d.server_.refreshAppCheckToken(g.token)}),d.statsReporter_=function Zr(d,u){const l=d.toString();return br[l]||(br[l]=u()),br[l]}(d.repoInfo_,()=>new Pa(d.stats_,d.server_)),d.infoData_=new Ma,d.infoSyncTree_=new bo({startListening:(g,I,M,H)=>{let ee=[];const ue=d.infoData_.getNode(g._path);return ue.isEmpty()||(ee=X(d.infoSyncTree_,g._path,ue),setTimeout(()=>{H("ok")},0)),ee},stopListening:()=>{}}),Au(d,"connected",!1),d.serverSyncTree_=new bo({startListening:(g,I,M,H)=>(d.server_.listen(g,M,I,(ee,ue)=>{const ve=H(ee,ue);jo(d.eventQueue_,g._path,ve)}),[]),stopListening:(g,I)=>{d.server_.unlisten(g,I)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ra(this._repo,pt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function hu(d,u){const l=$l[u];(!l||l[d.key]!==d)&&sr(`Database ${u}(${d.repoInfo_}) has already been deleted.`),xi(d),delete l[d.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(u){null===this._rootInternal&&sr("Cannot call "+u+" on a deleted database.")}}function lf(){gn.IS_TRANSPORT_INITIALIZED&&Pn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Ep(){lf(),Ee.forceDisallow()}function cf(){lf(),Qt.forceDisallow(),Ee.forceAllow()}function Ip(d,u){zt(d,u)}const Cp={".sv":"timestamp"};class gf{constructor(u,l){this.committed=u,this.snapshot=l}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}ws.prototype.simpleListen=function(d,u){this.sendRequest("q",{p:d},u)},ws.prototype.echo=function(d,u){this.sendRequest("echo",{d},u)},function kd(d){Je(It.SDK_VERSION),(0,It._registerComponent)(new Ge.wA("database",(u,{instanceIdentifier:l})=>td(u.getProvider("app").getImmediate(),u.getProvider("auth-internal"),u.getProvider("app-check-internal"),l),"PUBLIC").setMultipleInstances(!0)),(0,It.registerVersion)(ge,"0.13.2",d),(0,It.registerVersion)(ge,"0.13.2","esm2017")}();const Vd=new ut.Yd("@firebase/database-compat"),vh=function(d){Vd.warn("FIREBASE WARNING: "+d)};class Eh{constructor(u){this._delegate=u}cancel(u){(0,V.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,V.Wj)("OnDisconnect.cancel","onComplete",u,!0);const l=this._delegate.cancel();return u&&l.then(()=>u(null),g=>u(g)),l}remove(u){(0,V.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,V.Wj)("OnDisconnect.remove","onComplete",u,!0);const l=this._delegate.remove();return u&&l.then(()=>u(null),g=>u(g)),l}set(u,l){(0,V.Dv)("OnDisconnect.set",1,2,arguments.length),(0,V.Wj)("OnDisconnect.set","onComplete",l,!0);const g=this._delegate.set(u);return l&&g.then(()=>l(null),I=>l(I)),g}setWithPriority(u,l,g){(0,V.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,V.Wj)("OnDisconnect.setWithPriority","onComplete",g,!0);const I=this._delegate.setWithPriority(u,l);return g&&I.then(()=>g(null),M=>g(M)),I}update(u,l){if((0,V.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(u)){const I={};for(let M=0;M<u.length;++M)I[""+M]=u[M];u=I,vh("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,V.Wj)("OnDisconnect.update","onComplete",l,!0);const g=this._delegate.update(u);return l&&g.then(()=>l(null),I=>l(I)),g}}class Ud{constructor(u,l){this.committed=u,this.snapshot=l}toJSON(){return(0,V.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class ku{constructor(u,l){this._database=u,this._delegate=l}val(){return(0,V.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,V.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,V.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,V.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(u){return(0,V.Dv)("DataSnapshot.child",0,1,arguments.length),u=String(u),Du("DataSnapshot.child","path",u,!1),new ku(this._database,this._delegate.child(u))}hasChild(u){return(0,V.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Du("DataSnapshot.hasChild","path",u,!1),this._delegate.hasChild(u)}getPriority(){return(0,V.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(u){return(0,V.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,V.Wj)("DataSnapshot.forEach","action",u,!1),this._delegate.forEach(l=>u(new ku(this._database,l)))}hasChildren(){return(0,V.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,V.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,V.Dv)("DataSnapshot.ref",0,0,arguments.length),new ya(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ps{constructor(u,l){this.database=u,this._delegate=l}on(u,l,g,I){var M;(0,V.Dv)("Query.on",2,4,arguments.length),(0,V.Wj)("Query.on","callback",l,!1);const H=ps.getCancelAndContextArgs_("Query.on",g,I),ee=(ve,et)=>{l.call(H.context,new ku(this.database,ve),et)};ee.userCallback=l,ee.context=H.context;const ue=null===(M=H.cancel)||void 0===M?void 0:M.bind(H.context);switch(u){case"value":return Mu(this._delegate,ee,ue),l;case"child_added":return Ec(this._delegate,ee,ue),l;case"child_removed":return wc(this._delegate,ee,ue),l;case"child_changed":return Md(this._delegate,ee,ue),l;case"child_moved":return Cs(this._delegate,ee,ue),l;default:throw new Error((0,V.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(u,l,g){if((0,V.Dv)("Query.off",0,3,arguments.length),function(d,u,l){if(void 0!==u)switch(u){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,V.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,u),(0,V.Wj)("Query.off","callback",l,!0),(0,V.lb)("Query.off","context",g,!0),l){const I=()=>{};I.userCallback=l,I.context=g,Jc(this._delegate,u,I)}else Jc(this._delegate,u)}get(){return function vc(d){return xu((d=(0,V.m9)(d))._repo,d).then(u=>new Kn(u,new ra(d._repo,d._path),d._queryParams.getIndex()))}(this._delegate).then(u=>new ku(this.database,u))}once(u,l,g,I){(0,V.Dv)("Query.once",1,4,arguments.length),(0,V.Wj)("Query.once","callback",l,!0);const M=ps.getCancelAndContextArgs_("Query.once",g,I),H=new V.BH,ee=(ve,et)=>{const lt=new ku(this.database,ve);l&&l.call(M.context,lt,et),H.resolve(lt)};ee.userCallback=l,ee.context=M.context;const ue=ve=>{M.cancel&&M.cancel.call(M.context,ve),H.reject(ve)};switch(u){case"value":Mu(this._delegate,ee,ue,{onlyOnce:!0});break;case"child_added":Ec(this._delegate,ee,ue,{onlyOnce:!0});break;case"child_removed":wc(this._delegate,ee,ue,{onlyOnce:!0});break;case"child_changed":Md(this._delegate,ee,ue,{onlyOnce:!0});break;case"child_moved":Cs(this._delegate,ee,ue,{onlyOnce:!0});break;default:throw new Error((0,V.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return H.promise}limitToFirst(u){return(0,V.Dv)("Query.limitToFirst",1,1,arguments.length),new ps(this.database,Aa(this._delegate,function Lt(d){if("number"!=typeof d||Math.floor(d)!==d||d<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ct(d)}(u)))}limitToLast(u){return(0,V.Dv)("Query.limitToLast",1,1,arguments.length),new ps(this.database,Aa(this._delegate,function $n(d){if("number"!=typeof d||Math.floor(d)!==d||d<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new rn(d)}(u)))}orderByChild(u){return(0,V.Dv)("Query.orderByChild",1,1,arguments.length),new ps(this.database,Aa(this._delegate,function fs(d){if("$key"===d)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===d)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===d)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Du("orderByChild","path",d,!1),new xn(d)}(u)))}orderByKey(){return(0,V.Dv)("Query.orderByKey",0,0,arguments.length),new ps(this.database,Aa(this._delegate,function jl(){return new sa}()))}orderByPriority(){return(0,V.Dv)("Query.orderByPriority",0,0,arguments.length),new ps(this.database,Aa(this._delegate,function Nu(){return new Nd}()))}orderByValue(){return(0,V.Dv)("Query.orderByValue",0,0,arguments.length),new ps(this.database,Aa(this._delegate,function Pu(){return new Ic}()))}startAt(u=null,l){return(0,V.Dv)("Query.startAt",0,2,arguments.length),new ps(this.database,Aa(this._delegate,function z(d=null,u){return bu("startAt","key",u,!0),new T(d,u)}(u,l)))}startAfter(u=null,l){return(0,V.Dv)("Query.startAfter",0,2,arguments.length),new ps(this.database,Aa(this._delegate,function Le(d,u){return bu("startAfter","key",u,!0),new re(d,u)}(u,l)))}endAt(u=null,l){return(0,V.Dv)("Query.endAt",0,2,arguments.length),new ps(this.database,Aa(this._delegate,function w(d,u){return bu("endAt","key",u,!0),new Bs(d,u)}(u,l)))}endBefore(u=null,l){return(0,V.Dv)("Query.endBefore",0,2,arguments.length),new ps(this.database,Aa(this._delegate,function m(d,u){return bu("endBefore","key",u,!0),new f(d,u)}(u,l)))}equalTo(u,l){return(0,V.Dv)("Query.equalTo",1,2,arguments.length),new ps(this.database,Aa(this._delegate,function Cc(d,u){return bu("equalTo","key",u,!0),new Ou(d,u)}(u,l)))}toString(){return(0,V.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,V.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(u){if((0,V.Dv)("Query.isEqual",1,1,arguments.length),!(u instanceof ps))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(u._delegate)}static getCancelAndContextArgs_(u,l,g){const I={cancel:void 0,context:void 0};if(l&&g)I.cancel=l,(0,V.Wj)(u,"cancel",I.cancel,!0),I.context=g,(0,V.lb)(u,"context",I.context,!0);else if(l)if("object"==typeof l&&null!==l)I.context=l;else{if("function"!=typeof l)throw new Error((0,V.gK)(u,"cancelOrContext")+" must either be a cancel callback or a context object.");I.cancel=l}return I}get ref(){return new ya(this.database,new ra(this._delegate._repo,this._delegate._path))}}class ya extends ps{constructor(u,l){super(u,new Ii(l._repo,l._path,new Js,!1)),this.database=u,this._delegate=l}getKey(){return(0,V.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(u){return(0,V.Dv)("Reference.child",1,1,arguments.length),"number"==typeof u&&(u=String(u)),new ya(this.database,Vs(this._delegate,u))}getParent(){(0,V.Dv)("Reference.parent",0,0,arguments.length);const u=this._delegate.parent;return u?new ya(this.database,u):null}getRoot(){return(0,V.Dv)("Reference.root",0,0,arguments.length),new ya(this.database,this._delegate.root)}set(u,l){(0,V.Dv)("Reference.set",1,2,arguments.length),(0,V.Wj)("Reference.set","onComplete",l,!0);const g=yc(this._delegate,u);return l&&g.then(()=>l(null),I=>l(I)),g}update(u,l){if((0,V.Dv)("Reference.update",1,2,arguments.length),Array.isArray(u)){const I={};for(let M=0;M<u.length;++M)I[""+M]=u[M];u=I,vh("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}as("Reference.update",this._delegate._path),(0,V.Wj)("Reference.update","onComplete",l,!0);const g=_c(this._delegate,u);return l&&g.then(()=>l(null),I=>l(I)),g}setWithPriority(u,l,g){(0,V.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,V.Wj)("Reference.setWithPriority","onComplete",g,!0);const I=function ia(d,u,l){if(as("setWithPriority",d._path),Ks("setWithPriority",u,d._path,!1),gl("setWithPriority",l,!1),".length"===d.key||".keys"===d.key)throw"setWithPriority failed: "+d.key+" is a read-only object.";const g=new V.BH;return dc(d._repo,d._path,u,l,g.wrapCallback(()=>{})),g.promise}(this._delegate,u,l);return g&&I.then(()=>g(null),M=>g(M)),I}remove(u){(0,V.Dv)("Reference.remove",0,1,arguments.length),(0,V.Wj)("Reference.remove","onComplete",u,!0);const l=function Ul(d){return as("remove",d._path),yc(d,null)}(this._delegate);return u&&l.then(()=>u(null),g=>u(g)),l}transaction(u,l,g){(0,V.Dv)("Reference.transaction",1,3,arguments.length),(0,V.Wj)("Reference.transaction","transactionUpdate",u,!1),(0,V.Wj)("Reference.transaction","onComplete",l,!0),function(d,u,l,g){if(void 0!==l&&"boolean"!=typeof l)throw new Error((0,V.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,g);const I=function yh(d,u,l){var g;if(d=(0,V.m9)(d),as("Reference.transaction",d._path),".length"===d.key||".keys"===d.key)throw"Reference.transaction failed: "+d.key+" is a read-only object.";const I=null===(g=null==l?void 0:l.applyLocally)||void 0===g||g,M=new V.BH,ee=Mu(d,()=>{});return function Zc(d,u,l,g,I,M){Xu(d,"transaction on "+u);const H={path:u,update:l,onComplete:g,status:null,order:en(),applyLocally:M,retryCount:0,unwatcher:I,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},ee=fc(d,u,void 0);H.currentInputSnapshot=ee;const ue=H.update(ee.val());if(void 0===ue)H.unwatcher(),H.currentOutputSnapshotRaw=null,H.currentOutputSnapshotResolved=null,H.onComplete&&H.onComplete(null,!1,H.currentInputSnapshot);else{Ol("transaction failed: Data returned ",ue,H.path),H.status=0;const ve=Da(d.transactionQueueTree_,u),et=Ja(ve)||[];let lt;et.push(H),ic(ve,et),"object"==typeof ue&&null!==ue&&(0,V.r3)(ue,".priority")?(lt=(0,V.DV)(ue,".priority"),(0,V.hu)(fl(lt),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):lt=(Jr(d.serverSyncTree_,u)||k.EMPTY_NODE).getPriority().val();const bt=uc(d),In=Y(ue,lt),Fn=su(In,ee,bt);H.currentOutputSnapshotRaw=In,H.currentOutputSnapshotResolved=Fn,H.currentWriteId=cc(d);const li=Ai(d.serverSyncTree_,u,Fn,H.currentWriteId,H.applyLocally);jo(d.eventQueue_,u,li),lu(d,d.transactionQueueTree_)}}(d._repo,d._path,u,(ue,ve,et)=>{let lt=null;ue?M.reject(ue):(lt=new Kn(et,new ra(d._repo,d._path),zn),M.resolve(new gf(ve,lt)))},ee,I),M.promise}(this._delegate,u,{applyLocally:g}).then(M=>new Ud(M.committed,new ku(this.database,M.snapshot)));return l&&I.then(M=>l(null,M.committed,M.snapshot),M=>l(M,!1,null)),I}setPriority(u,l){(0,V.Dv)("Reference.setPriority",1,2,arguments.length),(0,V.Wj)("Reference.setPriority","onComplete",l,!0);const g=function Qc(d,u){d=(0,V.m9)(d),as("setPriority",d._path),gl("setPriority",u,!1);const l=new V.BH;return dc(d._repo,nr(d._path,".priority"),u,null,l.wrapCallback(()=>{})),l.promise}(this._delegate,u);return l&&g.then(()=>l(null),I=>l(I)),g}push(u,l){(0,V.Dv)("Reference.push",0,2,arguments.length),(0,V.Wj)("Reference.push","onComplete",l,!0);const g=function mc(d,u){d=(0,V.m9)(d),as("push",d._path),Ks("push",u,d._path,!0);const l=ml(d._repo),g=cr(l),I=Vs(d,g),M=Vs(d,g);let H;return H=null!=u?yc(M,u).then(()=>M):Promise.resolve(M),I.then=H.then.bind(H),I.catch=H.then.bind(H,void 0),I}(this._delegate,u),I=g.then(H=>new ya(this.database,H));l&&I.then(()=>l(null),H=>l(H));const M=new ya(this.database,g);return M.then=I.then.bind(I),M.catch=I.catch.bind(I,void 0),M}onDisconnect(){return as("Reference.onDisconnect",this._delegate._path),new Eh(new Ho(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Gl{constructor(u,l){this._delegate=u,this.app=l,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Ep,forceLongPolling:cf}}useEmulator(u,l,g={}){!function Hl(d,u,l,g={}){(d=(0,V.m9)(d))._checkNotDeleted("useEmulator"),d._instanceStarted&&sr("Cannot call useEmulator() after instance has already been initialized.");const I=d._repoInternal;let M;if(I.repoInfo_.nodeAdmin)g.mockUserToken&&sr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),M=new Ne(Ne.OWNER);else if(g.mockUserToken){const H="string"==typeof g.mockUserToken?g.mockUserToken:(0,V.Sg)(g.mockUserToken,d.app.options.projectId);M=new Ne(H)}!function ed(d,u,l,g){d.repoInfo_=new ur(`${u}:${l}`,!1,d.repoInfo_.namespace,d.repoInfo_.webSocketOnly,d.repoInfo_.nodeAdmin,d.repoInfo_.persistenceKey,d.repoInfo_.includeNamespaceInQueryParams),g&&(d.authTokenProvider_=g)}(I,u,l,M)}(this._delegate,u,l,g)}ref(u){if((0,V.Dv)("database.ref",0,1,arguments.length),u instanceof ya){const l=Ll(this._delegate,u.toString());return new ya(this,l)}{const l=Yc(this._delegate,u);return new ya(this,l)}}refFromURL(u){(0,V.Dv)("database.refFromURL",1,1,arguments.length);const g=Ll(this._delegate,u);return new ya(this,g)}goOffline(){return(0,V.Dv)("database.goOffline",0,0,arguments.length),function df(d){(d=(0,V.m9)(d))._checkNotDeleted("goOffline"),xi(d._repo)}(this._delegate)}goOnline(){return(0,V.Dv)("database.goOnline",0,0,arguments.length),function hf(d){(d=(0,V.m9)(d))._checkNotDeleted("goOnline"),function xd(d){d.persistentConnection_&&d.persistentConnection_.resume(zc)}(d._repo)}(this._delegate)}}Gl.ServerValue={TIMESTAMP:function ff(){return Cp}(),increment:d=>function pf(d){return{".sv":{increment:d}}}(d)};var Ih=Object.freeze({__proto__:null,initStandalone:function wh({app:d,url:u,version:l,customAuthImpl:g,namespace:I,nodeAdmin:M=!1}){Je(l);const H=new Ge.zt("auth-internal",new Ge.H0("database-standalone"));return H.setComponent(new Ge.wA("auth-internal",()=>g,"PRIVATE")),{instance:new Gl(td(d,H,void 0,u,M),d),namespace:I}}});const Il=Gl.ServerValue;!function Wl(d){d.INTERNAL.registerComponent(new Ge.wA("database-compat",(u,{instanceIdentifier:l})=>{const g=u.getProvider("app-compat").getImmediate(),I=u.getProvider("database").getImmediate({identifier:l});return new Gl(I,g)},"PUBLIC").setServiceProps({Reference:ya,Query:ps,Database:Gl,DataSnapshot:ku,enableLogging:Ip,INTERNAL:Ih,ServerValue:Il}).setMultipleInstances(!0)),d.registerVersion("@firebase/database-compat","0.2.2")}(xe.Z);var _a=$(1205),id=$(440),mf=$(127);function Bd(d){return null==d}function bh(d){return"function"==typeof d.set}function yf(d,u){return bh(u)?u:d.ref(u)}function Dh(d,u){if(function ja(d){return"string"==typeof d}(d))return u.stringCase();if(bh(d))return u.firebaseCase();if(function Ch(d){return"function"==typeof d.exportVal}(d))return u.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof d)}function bc(d,u,l="on",g=ne.z){return new ie.y(I=>{let M=null;return M=d[l](u,(H,ee)=>{g.schedule(()=>{I.next({snapshot:H,prevKey:ee})}),"once"===l&&g.schedule(()=>I.complete())},H=>{g.schedule(()=>I.error(H))}),"on"===l?{unsubscribe(){null!=M&&d.off(u,M)}}:{unsubscribe(){}}}).pipe((0,ot.U)(I=>{const{snapshot:M,prevKey:H}=I;let ee=null;return M.exists()&&(ee=M.key),{type:u,payload:M,prevKey:H,key:ee}}),(0,at.B)())}function Dc(d,u){const l=d.length;for(let g=0;g<l;g++)if(d[g].payload.key===u)return g;return-1}function Dp(d,u){const{payload:l,prevKey:g,key:I}=u,M=Dc(d,I),H=function zl(d,u){if(Bd(u))return 0;{const l=Dc(d,u);return-1===l?d.length:l+1}}(d,g);switch(u.type){case"value":if(u.payload&&u.payload.exists()){let ee=null;u.payload.forEach(ue=>{const ve={payload:ue,type:"value",prevKey:ee,key:ue.key};return ee=ue.key,d=[...d,ve],!1})}return d;case"child_added":if(M>-1){const ee=d[M-1];(ee&&ee.key||null)!==g&&(d=d.filter(ue=>ue.payload.key!==l.key)).splice(H,0,u)}else{if(null==g)return[u,...d];(d=d.slice()).splice(H,0,u)}return d;case"child_removed":return d.filter(ee=>ee.payload.key!==l.key);case"child_changed":return d.map(ee=>ee.payload.key===I?u:ee);case"child_moved":if(M>-1){const ee=d.splice(M,1)[0];return(d=d.slice()).splice(H,0,ee),d}return d;default:return d}}function dr(d){return(Bd(d)||0===d.length)&&(d=["child_added","child_removed","child_changed","child_moved"]),d}function Th(d,u,l){return function sd(d,u,l){return bc(d,"value","once",l).pipe((0,Dt.w)(g=>{const I=[(0,be.of)(g)];return u.forEach(M=>I.push(bc(d,M,"on",l))),(0,Ce.T)(...I).pipe((0,nt.R)(Dp,[]))}),(0,ft.x)())}(d,u=dr(u),l)}function Sh(d,u,l){const g=(u=dr(u)).map(I=>bc(d,I,"on",l));return(0,Ce.T)(...g)}function rl(d,u){return function(g,I){return Dh(g,{stringCase:()=>d.child(g)[u](I),firebaseCase:()=>g[u](I),snapshotCase:()=>g.ref[u](I)})}}function vf(d){return function(l){return l?Dh(l,{stringCase:()=>d.child(l).remove(),firebaseCase:()=>l.remove(),snapshotCase:()=>l.ref.remove()}):d.remove()}}function Fu(d,u){return function(){return bc(d,"value","on",u)}}const ad=new _.OlP("angularfire2.realtimeDatabaseURL"),xh=new _.OlP("angularfire2.database.use-emulator");let Ef=(()=>{class d{constructor(l,g,I,M,H,ee,ue,ve,et,lt,bt,In,Fn,li,Xi){this.schedulers=ee;const bl=ue,fu=(0,kt.on)(l,H,g);ve&&(0,_a.nw)(fu,H,et,bt,In,Fn,lt,li),this.database=(0,kt.cc)(`${fu.name}.database.${I}`,"AngularFireDatabase",fu.name,()=>{const ud=H.runOutsideAngular(()=>fu.database(I||void 0));return bl&&ud.useEmulator(...bl),ud},[bl])}list(l,g){const I=this.schedulers.ngZone.runOutsideAngular(()=>yf(this.database,l));let M=I;return g&&(M=g(I)),function Ah(d,u){const l=u.schedulers.outsideAngular,g=u.schedulers.ngZone.run(()=>d.ref);return{query:d,update:rl(g,"update"),set:rl(g,"set"),push:I=>g.push(I),remove:vf(g),snapshotChanges:I=>Th(d,I,l).pipe(De.iC),stateChanges:I=>Sh(d,I,l).pipe(De.iC),auditTrail:I=>function _f(d,u,l){return function Go(d,u,l){return function Cl(d,u){return bc(d,"value","on",u).pipe((0,ot.U)(l=>{let g;return l.payload.forEach(I=>(g=I.key,!1)),{data:l,lastKeyToLoad:g}}))}(d,l).pipe(function Re(...d){const u=(0,ae.jO)(d);return(0,Se.e)((l,g)=>{const I=d.length,M=new Array(I);let H=d.map(()=>!1),ee=!1;for(let ue=0;ue<I;ue++)(0,Me.Xf)(d[ue]).subscribe((0,Ve.x)(g,ve=>{M[ue]=ve,!ee&&!H[ue]&&(H[ue]=!0,(ee=H.every(Be.y))&&(H=null))},ce.Z));l.subscribe((0,Ve.x)(g,ue=>{if(ee){const ve=[ue,...M];g.next(u?u(...ve):ve)}}))})}(u),(0,ot.U)(([I,M])=>{const H=I.lastKeyToLoad,ee=M.map(ue=>ue.key);return{actions:M,lastKeyToLoad:H,loadedKeys:ee}}),function Rt(d){return(0,Se.e)((u,l)=>{let g=!1,I=0;u.subscribe((0,Ve.x)(l,M=>(g||(g=!d(M,I++)))&&l.next(M)))})}(I=>-1===I.loadedKeys.indexOf(I.lastKeyToLoad)),(0,ot.U)(I=>I.actions))}(d,Sh(d,u).pipe((0,nt.R)((I,M)=>[...I,M],[])),l)}(d,I,l).pipe(De.iC),valueChanges:(I,M)=>Th(d,I,l).pipe((0,ot.U)(ee=>ee.map(ue=>M&&M.idField?Object.assign(Object.assign({},ue.payload.val()),{[M.idField]:ue.key}):ue.payload.val())),De.iC)}}(M,this)}object(l){return function od(d,u){return{query:d,snapshotChanges:()=>Fu(d,u.schedulers.outsideAngular)().pipe(De.iC),update:l=>d.ref.update(l),set:l=>d.ref.set(l),remove:()=>d.ref.remove(),valueChanges:()=>Fu(d,u.schedulers.outsideAngular)().pipe(De.iC,(0,ot.U)(g=>g.payload.exists()?g.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>yf(this.database,l)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return d.\u0275fac=function(l){return new(l||d)(_.LFG(kt.Dh),_.LFG(kt.xv,8),_.LFG(ad,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(De.HU),_.LFG(xh,8),_.LFG(_a.zQ,8),_.LFG(_a.Qv,8),_.LFG(_a.L6,8),_.LFG(_a._Q,8),_.LFG(_a.rT,8),_.LFG(_a.lh,8),_.LFG(_a.f7,8),_.LFG(id.nm,8))},d.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"any"}),d})(),Tc=(()=>{class d{constructor(){mf.Z.registerVersion("angularfire",De.q4.full,"rtdb-compat")}}return d.\u0275fac=function(l){return new(l||d)},d.\u0275mod=_.oAB({type:d}),d.\u0275inj=_.cJS({providers:[Ef]}),d})()},7407:(Ft,We,$)=>{$.d(We,{ST:()=>Zg,yb:()=>lv});var _=$(5e3),ne=$(4986),ie=$(8306),be=$(8996),Ce=$(9646),Se=$(5813),Ve=$(4482),Me=$(5403);function Be(){return(0,Ve.e)((i,e)=>{let t,s=!1;i.subscribe((0,Me.x)(e,c=>{const p=t;t=c,s&&e.next([p,c]),s=!0}))})}var V,ce=$(8675),ae=$(4004),Re=$(5026),Rt=$(1884),ot=$(9300),at=$(2011),Dt=$(9808),ft=($(3677),$(3942)),De=$(5861),kt=$(9681),ht=$(4859),xe=$(1877),Ge=$(2090),wt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},It={},ut=ut||{},ge=wt||self;function Oe(){}function Ue(i){var e=typeof i;return"array"==(e="object"!=e?e:i?Array.isArray(i)?"array":e:"null")||"object"==e&&"number"==typeof i.length}function Je(i){var e=typeof i;return"object"==e&&null!=i||"function"==e}var St="closure_uid_"+(1e9*Math.random()>>>0),Pt=0;function Wt(i,e,t){return i.call.apply(i.bind,arguments)}function qt(i,e,t){if(!i)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,s),i.apply(e,c)}}return function(){return i.apply(e,arguments)}}function it(i,e,t){return(it=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Wt:qt).apply(null,arguments)}function en(i,e){var t=Array.prototype.slice.call(arguments,1);return function(){var s=t.slice();return s.push.apply(s,arguments),i.apply(this,s)}}function on(i,e){function t(){}t.prototype=e.prototype,i.Z=e.prototype,i.prototype=new t,i.prototype.constructor=i,i.Vb=function(s,c,p){for(var v=Array(arguments.length-2),x=2;x<arguments.length;x++)v[x-2]=arguments[x];return e.prototype[c].apply(s,v)}}function tn(){this.s=this.s,this.o=this.o}var Tn={};tn.prototype.s=!1,tn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var i=function Ye(i){return Object.prototype.hasOwnProperty.call(i,St)&&i[St]||(i[St]=++Pt)}(this);delete Tn[i]}},tn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const zt=Array.prototype.indexOf?function(i,e){return Array.prototype.indexOf.call(i,e,void 0)}:function(i,e){if("string"==typeof i)return"string"!=typeof e||1!=e.length?-1:i.indexOf(e,0);for(let t=0;t<i.length;t++)if(t in i&&i[t]===e)return t;return-1},Yt=Array.prototype.forEach?function(i,e,t){Array.prototype.forEach.call(i,e,t)}:function(i,e,t){const s=i.length,c="string"==typeof i?i.split(""):i;for(let p=0;p<s;p++)p in c&&e.call(t,c[p],p,i)};function fr(i){return Array.prototype.concat.apply([],arguments)}function sr(i){const e=i.length;if(0<e){const t=Array(e);for(let s=0;s<e;s++)t[s]=i[s];return t}return[]}function Pn(i){return/^[\s\xa0]*$/.test(i)}var Vn,Hr=String.prototype.trim?function(i){return i.trim()}:function(i){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(i)[1]};function Gn(i,e){return-1!=i.indexOf(e)}function Ar(i,e){return i<e?-1:i>e?1:0}e:{var Bt=ge.navigator;if(Bt){var En=Bt.userAgent;if(En){Vn=En;break e}}Vn=""}function Sn(i,e,t){for(const s in i)e.call(t,i[s],s,i)}function ln(i){const e={};for(const t in i)e[t]=i[t];return e}var Ci="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ei(i,e){let t,s;for(let c=1;c<arguments.length;c++){for(t in s=arguments[c],s)i[t]=s[t];for(let p=0;p<Ci.length;p++)t=Ci[p],Object.prototype.hasOwnProperty.call(s,t)&&(i[t]=s[t])}}function Zn(i){return Zn[" "](i),i}Zn[" "]=Oe;var cn,i,ci=Gn(Vn,"Opera"),xr=Gn(Vn,"Trident")||Gn(Vn,"MSIE"),Vt=Gn(Vn,"Edge"),Xt=Vt||xr,nn=Gn(Vn,"Gecko")&&!(Gn(Vn.toLowerCase(),"webkit")&&!Gn(Vn,"Edge"))&&!(Gn(Vn,"Trident")||Gn(Vn,"MSIE"))&&!Gn(Vn,"Edge"),Pr=Gn(Vn.toLowerCase(),"webkit")&&!Gn(Vn,"Edge");function ri(){var i=ge.document;return i?i.documentMode:void 0}e:{var Li="",Lr=(i=Vn,nn?/rv:([^\);]+)(\)|;)/.exec(i):Vt?/Edge\/([\d\.]+)/.exec(i):xr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i):Pr?/WebKit\/(\S+)/.exec(i):ci?/(?:Version)[ \/]?(\S+)/.exec(i):void 0);if(Lr&&(Li=Lr?Lr[1]:""),xr){var vr=ri();if(null!=vr&&vr>parseFloat(Li)){cn=String(vr);break e}}cn=Li}var dn={};var ke=ge.document&&xr&&(ri()||parseInt(cn,10))||void 0,fe=function(){if(!ge.addEventListener||!Object.defineProperty)return!1;var i=!1,e=Object.defineProperty({},"passive",{get:function(){i=!0}});try{ge.addEventListener("test",Oe,e),ge.removeEventListener("test",Oe,e)}catch(t){}return i}();function qe(i,e){this.type=i,this.g=this.target=e,this.defaultPrevented=!1}function At(i,e){if(qe.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var t=this.type=i.type,s=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=e,e=i.relatedTarget){if(nn){e:{try{Zn(e.nodeName);var c=!0;break e}catch(p){}c=!1}c||(e=null)}}else"mouseover"==t?e=i.fromElement:"mouseout"==t&&(e=i.toElement);this.relatedTarget=e,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType="string"==typeof i.pointerType?i.pointerType:$t[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&At.Z.h.call(this)}}qe.prototype.h=function(){this.defaultPrevented=!0},on(At,qe);var $t={2:"touch",3:"pen",4:"mouse"};At.prototype.h=function(){At.Z.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var hn="closure_listenable_"+(1e6*Math.random()|0),or=0;function lr(i,e,t,s,c){this.listener=i,this.proxy=null,this.src=e,this.type=t,this.capture=!!s,this.ia=c,this.key=++or,this.ca=this.fa=!1}function an(i){i.ca=!0,i.listener=null,i.proxy=null,i.src=null,i.ia=null}function ur(i){this.src=i,this.g={},this.h=0}function ts(i,e){var t=e.type;if(t in i.g){var p,s=i.g[t],c=zt(s,e);(p=0<=c)&&Array.prototype.splice.call(s,c,1),p&&(an(e),0==i.g[t].length&&(delete i.g[t],i.h--))}}function Gr(i,e,t,s){for(var c=0;c<i.length;++c){var p=i[c];if(!p.ca&&p.listener==e&&p.capture==!!t&&p.ia==s)return c}return-1}ur.prototype.add=function(i,e,t,s,c){var p=i.toString();(i=this.g[p])||(i=this.g[p]=[],this.h++);var v=Gr(i,e,s,c);return-1<v?(e=i[v],t||(e.fa=!1)):((e=new lr(e,this.src,p,!!s,c)).fa=t,i.push(e)),e};var _i="closure_lm_"+(1e6*Math.random()|0),yn={};function br(i,e,t,s,c){if(s&&s.once)return Vr(i,e,t,s,c);if(Array.isArray(e)){for(var p=0;p<e.length;p++)br(i,e[p],t,s,c);return null}return t=Ui(t),i&&i[hn]?i.N(e,t,Je(s)?!!s.capture:!!s,c):ii(i,e,t,!1,s,c)}function ii(i,e,t,s,c,p){if(!e)throw Error("Invalid event type");var v=Je(c)?!!c.capture:!!c,x=Er(i);if(x||(i[_i]=x=new ur(i)),(t=x.add(e,t,s,v,p)).proxy)return t;if(s=function Zr(){var e=Wr;return function i(t){return e.call(i.src,i.listener,t)}}(),t.proxy=s,s.src=i,s.listener=t,i.addEventListener)fe||(c=v),void 0===c&&(c=!1),i.addEventListener(e.toString(),s,c);else if(i.attachEvent)i.attachEvent(Vi(e.toString()),s);else{if(!i.addListener||!i.removeListener)throw Error("addEventListener and attachEvent are unavailable.");i.addListener(s)}return t}function Vr(i,e,t,s,c){if(Array.isArray(e)){for(var p=0;p<e.length;p++)Vr(i,e[p],t,s,c);return null}return t=Ui(t),i&&i[hn]?i.O(e,t,Je(s)?!!s.capture:!!s,c):ii(i,e,t,!0,s,c)}function si(i,e,t,s,c){if(Array.isArray(e))for(var p=0;p<e.length;p++)si(i,e[p],t,s,c);else s=Je(s)?!!s.capture:!!s,t=Ui(t),i&&i[hn]?(i=i.i,(e=String(e).toString())in i.g&&-1<(t=Gr(p=i.g[e],t,s,c))&&(an(p[t]),Array.prototype.splice.call(p,t,1),0==p.length&&(delete i.g[e],i.h--))):i&&(i=Er(i))&&(e=i.g[e.toString()],i=-1,e&&(i=Gr(e,t,s,c)),(t=-1<i?e[i]:null)&&ys(t))}function ys(i){if("number"!=typeof i&&i&&!i.ca){var e=i.src;if(e&&e[hn])ts(e.i,i);else{var t=i.type,s=i.proxy;e.removeEventListener?e.removeEventListener(t,s,i.capture):e.detachEvent?e.detachEvent(Vi(t),s):e.addListener&&e.removeListener&&e.removeListener(s),(t=Er(e))?(ts(t,i),0==t.h&&(t.src=null,e[_i]=null)):an(i)}}}function Vi(i){return i in yn?yn[i]:yn[i]="on"+i}function Wr(i,e){if(i.ca)i=!0;else{e=new At(e,this);var t=i.listener,s=i.ia||i.src;i.fa&&ys(i),i=t.call(s,e)}return i}function Er(i){return(i=i[_i])instanceof ur?i:null}var wr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ui(i){return"function"==typeof i?i:(i[wr]||(i[wr]=function(e){return i.handleEvent(e)}),i[wr])}function ar(){tn.call(this),this.i=new ur(this),this.P=this,this.I=null}function Tt(i,e){var t,s=i.I;if(s)for(t=[];s;s=s.I)t.push(s);if(i=i.P,s=e.type||e,"string"==typeof e)e=new qe(e,i);else if(e instanceof qe)e.target=e.target||i;else{var c=e;ei(e=new qe(s,i),c)}if(c=!0,t)for(var p=t.length-1;0<=p;p--){var v=e.g=t[p];c=Ht(v,s,!0,e)&&c}if(c=Ht(v=e.g=i,s,!0,e)&&c,c=Ht(v,s,!1,e)&&c,t)for(p=0;p<t.length;p++)c=Ht(v=e.g=t[p],s,!1,e)&&c}function Ht(i,e,t,s){if(!(e=i.i.g[String(e)]))return!0;e=e.concat();for(var c=!0,p=0;p<e.length;++p){var v=e[p];if(v&&!v.ca&&v.capture==t){var x=v.listener,W=v.ia||v.src;v.fa&&ts(i.i,v),c=!1!==x.call(W,s)&&c}}return c&&!s.defaultPrevented}on(ar,tn),ar.prototype[hn]=!0,ar.prototype.removeEventListener=function(i,e,t,s){si(this,i,e,t,s)},ar.prototype.M=function(){if(ar.Z.M.call(this),this.i){var e,i=this.i;for(e in i.g){for(var t=i.g[e],s=0;s<t.length;s++)an(t[s]);delete i.g[e],i.h--}}this.I=null},ar.prototype.N=function(i,e,t,s){return this.i.add(String(i),e,!1,t,s)},ar.prototype.O=function(i,e,t,s){return this.i.add(String(i),e,!0,t,s)};var Hn=ge.JSON.stringify;function zr(){var i=ze;let e=null;return i.g&&(e=i.g,i.g=i.g.next,i.g||(i.h=null),e.next=null),e}var Ee,Rr=new class{constructor(i,e){this.i=i,this.j=e,this.h=0,this.g=null}get(){let i;return 0<this.h?(this.h--,i=this.g,this.g=i.next,i.next=null):i=this.i(),i}}(()=>new Ki,i=>i.reset());class Ki{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function pr(i){ge.setTimeout(()=>{throw i},0)}function Mi(i,e){Ee||function pe(){var i=ge.Promise.resolve(void 0);Ee=function(){i.then(gt)}}(),le||(Ee(),le=!0),ze.add(i,e)}var le=!1,ze=new class bi{constructor(){this.h=this.g=null}add(e,t){const s=Rr.get();s.set(e,t),this.h?this.h.next=s:this.g=s,this.h=s}};function gt(){for(var i;i=zr();){try{i.h.call(i.g)}catch(t){pr(t)}var e=Rr;e.j(i),100>e.h&&(e.h++,i.next=e.g,e.g=i)}le=!1}function Qt(i,e){ar.call(this),this.h=i||1,this.g=e||ge,this.j=it(this.kb,this),this.l=Date.now()}function gn(i){i.da=!1,i.S&&(i.g.clearTimeout(i.S),i.S=null)}function er(i,e,t){if("function"==typeof i)t&&(i=it(i,t));else{if(!i||"function"!=typeof i.handleEvent)throw Error("Invalid listener argument");i=it(i.handleEvent,i)}return 2147483647<Number(e)?-1:ge.setTimeout(i,e||0)}function gr(i){i.g=er(()=>{i.g=null,i.i&&(i.i=!1,gr(i))},i.j);const e=i.h;i.h=null,i.m.apply(null,e)}on(Qt,ar),(V=Qt.prototype).da=!1,V.S=null,V.kb=function(){if(this.da){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-i):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Tt(this,"tick"),this.da&&(gn(this),this.start()))}},V.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},V.M=function(){Qt.Z.M.call(this),gn(this),delete this.g};class Yn extends tn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:gr(this)}M(){super.M(),this.g&&(ge.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qn(i){tn.call(this),this.h=i,this.g={}}on(Qn,tn);var Ys=[];function Kr(i,e,t,s){Array.isArray(t)||(t&&(Ys[0]=t.toString()),t=Ys);for(var c=0;c<t.length;c++){var p=br(e,t[c],s||i.handleEvent,!1,i.h||i);if(!p)break;i.g[p.key]=p}}function di(i){Sn(i.g,function(e,t){this.g.hasOwnProperty(t)&&ys(e)},i),i.g={}}function Di(){this.g=!0}function vi(i,e,t,s){i.info(function(){return"XMLHTTP TEXT ("+e+"): "+function oo(i,e){if(!i.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(i=0;i<t.length;i++)if(Array.isArray(t[i])){var s=t[i];if(!(2>s.length)){var c=s[1];if(Array.isArray(c)&&!(1>c.length)){var p=c[0];if("noop"!=p&&"stop"!=p&&"close"!=p)for(var v=1;v<c.length;v++)c[v]=""}}}return Hn(t)}catch(x){return e}}(i,t)+(s?" "+s:"")})}Qn.prototype.M=function(){Qn.Z.M.call(this),di(this)},Qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Di.prototype.Aa=function(){this.g=!1},Di.prototype.info=function(){};var Ss={},yo=null;function Ir(){return yo=yo||new ar}function us(i){qe.call(this,Ss.Ma,i)}function Fe(i){const e=Ir();Tt(e,new us(e,i))}function Pe(i,e){qe.call(this,Ss.STAT_EVENT,i),this.stat=e}function He(i){const e=Ir();Tt(e,new Pe(e,i))}function tt(i,e){qe.call(this,Ss.Na,i),this.size=e}function pt(i,e){if("function"!=typeof i)throw Error("Fn must not be null and must be a function");return ge.setTimeout(function(){i()},e)}Ss.Ma="serverreachability",on(us,qe),Ss.STAT_EVENT="statevent",on(Pe,qe),Ss.Na="timingevent",on(tt,qe);var _t={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Un={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Mn(){}function rs(){}Mn.prototype.h=null;var vn,Bi={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ao(){qe.call(this,"d")}function nr(){qe.call(this,"c")}function Ur(){}function _s(i,e,t,s){this.l=i,this.j=e,this.m=t,this.X=s||1,this.V=new Qn(this),this.P=ji,this.W=new Qt(i=Xt?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new uo}function uo(){this.i=null,this.g="",this.h=!1}on(ao,qe),on(nr,qe),on(Ur,Mn),Ur.prototype.g=function(){return new XMLHttpRequest},Ur.prototype.i=function(){return{}},vn=new Ur;var ji=45e3,ti={},is={};function ss(i,e,t){i.K=1,i.v=rt(On(e)),i.s=t,i.U=!0,vs(i,null)}function vs(i,e){i.F=Date.now(),Ei(i),i.A=On(i.v);var t=i.A,s=i.X;Array.isArray(s)||(s=[String(s)]),ds(t.h,"t",s),i.C=0,t=i.l.H,i.h=new uo,i.g=ko(i.l,t?e:null,!i.s),0<i.O&&(i.L=new Yn(it(i.Ia,i,i.g),i.O)),Kr(i.V,i.g,"readystatechange",i.gb),e=i.H?ln(i.H):{},i.s?(i.u||(i.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.A,i.u,i.s,e)):(i.u="GET",i.g.ea(i.A,i.u,null,e)),Fe(1),function Qs(i,e,t,s,c,p){i.info(function(){if(i.g)if(p)for(var v="",x=p.split("&"),W=0;W<x.length;W++){var Z=x[W].split("=");if(1<Z.length){var se=Z[0];Z=Z[1];var we=se.split("_");v=2<=we.length&&"type"==we[1]?v+(se+"=")+Z+"&":v+(se+"=redacted&")}}else v=null;else v=p;return"XMLHTTP REQ ("+s+") [attempt "+c+"]: "+e+"\n"+t+"\n"+v})}(i.j,i.u,i.A,i.m,i.X,i.s)}function ls(i){return!!i.g&&"GET"==i.u&&2!=i.K&&i.l.Ba}function Es(i,e,t){let c,s=!0;for(;!i.I&&i.C<t.length;){if(c=Ao(i,t),c==is){4==e&&(i.o=4,He(14),s=!1),vi(i.j,i.m,null,"[Incomplete Response]");break}if(c==ti){i.o=4,He(15),vi(i.j,i.m,t,"[Invalid Chunk]"),s=!1;break}vi(i.j,i.m,c,null),As(i,c)}ls(i)&&c!=is&&c!=ti&&(i.h.g="",i.C=0),4!=e||0!=t.length||i.h.h||(i.o=1,He(16),s=!1),i.i=i.i&&s,s?0<t.length&&!i.aa&&(i.aa=!0,(e=i.l).g==i&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),Xs(e),e.L=!0,He(11))):(vi(i.j,i.m,t,"[Invalid Chunked Response]"),oi(i),co(i))}function Ao(i,e){var t=i.C,s=e.indexOf("\n",t);return-1==s?is:(t=Number(e.substring(t,s)),isNaN(t)?ti:(s+=1)+t>e.length?is:(e=e.substr(s,t),i.C=s+t,e))}function Ei(i){i.Y=Date.now()+i.P,lo(i,i.P)}function lo(i,e){if(null!=i.B)throw Error("WatchDog timer not null");i.B=pt(it(i.eb,i),e)}function wi(i){i.B&&(ge.clearTimeout(i.B),i.B=null)}function co(i){0==i.l.G||i.I||da(i.l,i)}function oi(i){wi(i);var e=i.L;e&&"function"==typeof e.na&&e.na(),i.L=null,gn(i.W),di(i.V),i.g&&(e=i.g,i.g=null,e.abort(),e.na())}function As(i,e){try{var t=i.l;if(0!=t.G&&(t.g==i||oe(t.i,i)))if(t.I=i.N,!i.J&&oe(t.i,i)&&3==t.G){try{var s=t.Ca.g.parse(e)}catch(Z){s=null}if(Array.isArray(s)&&3==s.length){var c=s;if(0==c[0])e:if(t.u)t.ta=c[1],0<t.ta-t.U&&37500>c[2]&&t.N&&0==t.A&&!t.v&&(t.v=pt(it(t.ab,t),6e3));else{if(t.g){if(!(t.g.F+3e3<i.F))break e;mr(t),fo(t)}Po(t),He(18)}if(1>=Y(t.i)&&t.ka){try{t.ka()}catch(Z){}t.ka=void 0}}else Gi(t,11)}else if((i.J||t.g==i)&&mr(t),!Pn(e))for(c=t.Ca.g.parse(e),e=0;e<c.length;e++){let Z=c[e];if(t.U=Z[0],Z=Z[1],2==t.G)if("c"==Z[0]){t.J=Z[1],t.la=Z[2];const se=Z[3];null!=se&&(t.ma=se,t.h.info("VER="+t.ma));const we=Z[4];null!=we&&(t.za=we,t.h.info("SVER="+t.za));const st=Z[5];null!=st&&"number"==typeof st&&0<st&&(t.K=s=1.5*st,t.h.info("backChannelRequestTimeoutMs_="+s)),s=t;const Et=i.g;if(Et){const Nt=Et.g?Et.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nt){var p=s.i;!p.g&&(Gn(Nt,"spdy")||Gn(Nt,"quic")||Gn(Nt,"h2"))&&(p.j=p.l,p.g=new Set,p.h&&(Te(p,p.h),p.h=null))}if(s.D){const mn=Et.g?Et.g.getResponseHeader("X-HTTP-Session-Id"):null;mn&&(s.sa=mn,_e(s.F,s.D,mn))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-i.F,t.h.info("Handshake RTT: "+t.O+"ms"));var v=i;if((s=t).oa=Oo(s,s.H?s.la:null,s.W),v.J){Ke(s.i,v);var x=v,W=s.K;W&&x.setTimeout(W),x.B&&(wi(x),Ei(x)),s.g=v}else Wa(s);0<t.l.length&&wa(t)}else"stop"!=Z[0]&&"close"!=Z[0]||Gi(t,7);else 3==t.G&&("stop"==Z[0]||"close"==Z[0]?"stop"==Z[0]?Gi(t,7):Si(t):"noop"!=Z[0]&&t.j&&t.j.wa(Z),t.A=0)}Fe(4)}catch(Z){}}function ws(i,e){if(i.forEach&&"function"==typeof i.forEach)i.forEach(e,void 0);else if(Ue(i)||"string"==typeof i)Yt(i,e,void 0);else{if(i.T&&"function"==typeof i.T)var t=i.T();else if(i.R&&"function"==typeof i.R)t=void 0;else if(Ue(i)||"string"==typeof i){t=[];for(var s=i.length,c=0;c<s;c++)t.push(c)}else for(c in t=[],s=0,i)t[s++]=c;s=function hi(i){if(i.R&&"function"==typeof i.R)return i.R();if("string"==typeof i)return i.split("");if(Ue(i)){for(var e=[],t=i.length,s=0;s<t;s++)e.push(i[s]);return e}for(s in e=[],t=0,i)e[t++]=i[s];return e}(i),c=s.length;for(var p=0;p<c;p++)e.call(void 0,s[p],t&&t[p],i)}}function Cn(i,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var s=0;s<t;s+=2)this.set(arguments[s],arguments[s+1])}else if(i)if(i instanceof Cn)for(t=i.T(),s=0;s<t.length;s++)this.set(t[s],i.get(t[s]));else for(s in i)this.set(s,i[s])}function xs(i){if(i.i!=i.g.length){for(var e=0,t=0;e<i.g.length;){var s=i.g[e];$i(i.h,s)&&(i.g[t++]=s),e++}i.g.length=t}if(i.i!=i.g.length){var c={};for(t=e=0;e<i.g.length;)$i(c,s=i.g[e])||(i.g[t++]=s,c[s]=1),e++;i.g.length=t}}function $i(i,e){return Object.prototype.hasOwnProperty.call(i,e)}(V=_s.prototype).setTimeout=function(i){this.P=i},V.gb=function(i){i=i.target;const e=this.L;e&&3==Mo(i)?e.l():this.Ia(i)},V.Ia=function(i){try{if(i==this.g)e:{const se=Mo(this.g);var e=this.g.Da();const we=this.g.ba();if(!(3>se)&&(3!=se||Xt||this.g&&(this.h.h||this.g.ga()||ca(this.g)))){this.I||4!=se||7==e||Fe(8==e||0>=we?3:2),wi(this);var t=this.g.ba();this.N=t;t:if(ls(this)){var s=ca(this.g);i="";var c=s.length,p=4==Mo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){oi(this),co(this);var v="";break t}this.h.i=new ge.TextDecoder}for(e=0;e<c;e++)this.h.h=!0,i+=this.h.i.decode(s[e],{stream:p&&e==c-1});s.splice(0,c),this.h.g+=i,this.C=0,v=this.h.g}else v=this.g.ga();if(this.i=200==t,function qi(i,e,t,s,c,p,v){i.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+c+"]: "+e+"\n"+t+"\n"+p+" "+v})}(this.j,this.u,this.A,this.m,this.X,se,t),this.i){if(this.$&&!this.J){t:{if(this.g){var x,W=this.g;if((x=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pn(x)){var Z=x;break t}}Z=null}if(!(t=Z)){this.i=!1,this.o=3,He(12),oi(this),co(this);break e}vi(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,As(this,t)}this.U?(Es(this,se,v),Xt&&this.i&&3==se&&(Kr(this.V,this.W,"tick",this.fb),this.W.start())):(vi(this.j,this.m,v,null),As(this,v)),4==se&&oi(this),this.i&&!this.I&&(4==se?da(this.l,this):(this.i=!1,Ei(this)))}else 400==t&&0<v.indexOf("Unknown SID")?(this.o=3,He(12)):(this.o=0,He(13)),oi(this),co(this)}}}catch(se){}},V.fb=function(){if(this.g){var i=Mo(this.g),e=this.g.ga();this.C<e.length&&(wi(this),Es(this,i,e),this.i&&4!=i&&Ei(this))}},V.cancel=function(){this.I=!0,oi(this)},V.eb=function(){this.B=null;const i=Date.now();0<=i-this.Y?(function ns(i,e){i.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Fe(3),He(17)),oi(this),this.o=2,co(this)):lo(this,this.Y-i)},(V=Cn.prototype).R=function(){xs(this);for(var i=[],e=0;e<this.g.length;e++)i.push(this.h[this.g[e]]);return i},V.T=function(){return xs(this),this.g.concat()},V.get=function(i,e){return $i(this.h,i)?this.h[i]:e},V.set=function(i,e){$i(this.h,i)||(this.i++,this.g.push(i)),this.h[i]=e},V.forEach=function(i,e){for(var t=this.T(),s=0;s<t.length;s++){var c=t[s],p=this.get(c);i.call(e,p,c,this)}};var cs=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rs(i,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,i instanceof Rs){this.g=void 0!==e?e:i.g,B(this,i.j),this.s=i.s,Q(this,i.i),U(this,i.m),this.l=i.l,e=i.h;var t=new pi;t.i=e.i,e.g&&(t.g=new Cn(e.g),t.h=e.h),te(this,t),this.o=i.o}else i&&(t=String(i).match(cs))?(this.g=!!e,B(this,t[1]||"",!0),this.s=wn(t[2]||""),Q(this,t[3]||"",!0),U(this,t[4]),this.l=wn(t[5]||"",!0),te(this,t[6]||"",!0),this.o=wn(t[7]||"")):(this.g=!!e,this.h=new pi(null,this.g))}function On(i){return new Rs(i)}function B(i,e,t){i.j=t?wn(e,!0):e,i.j&&(i.j=i.j.replace(/:$/,""))}function Q(i,e,t){i.i=t?wn(e,!0):e}function U(i,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);i.m=e}else i.m=null}function te(i,e,t){e instanceof pi?(i.h=e,function G(i,e){e&&!i.j&&(fn(i),i.i=null,i.g.forEach(function(t,s){var c=s.toLowerCase();s!=c&&(Zi(this,s),ds(this,c,t))},i)),i.j=e}(i.h,i.g)):(t||(e=Wn(e,$r)),i.h=new pi(e,i.g))}function _e(i,e,t){i.h.set(e,t)}function rt(i){return _e(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function wn(i,e){return i?e?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Wn(i,e,t){return"string"==typeof i?(i=encodeURI(i).replace(e,kn),t&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function kn(i){return"%"+((i=i.charCodeAt(0))>>4&15).toString(16)+(15&i).toString(16)}Rs.prototype.toString=function(){var i=[],e=this.j;e&&i.push(Wn(e,Jn,!0),":");var t=this.i;return(t||"file"==e)&&(i.push("//"),(e=this.s)&&i.push(Wn(e,Jn,!0),"@"),i.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&i.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&i.push("/"),i.push(Wn(t,"/"==t.charAt(0)?Mr:qr,!0))),(t=this.h.toString())&&i.push("?",t),(t=this.o)&&i.push("#",Wn(t,zn)),i.join("")};var Jn=/[#\/\?@]/g,qr=/[#\?:]/g,Mr=/[#\?]/g,$r=/[#\?@]/g,zn=/#/g;function pi(i,e){this.h=this.g=null,this.i=i||null,this.j=!!e}function fn(i){i.g||(i.g=new Cn,i.h=0,i.i&&function fi(i,e){if(i){i=i.split("&");for(var t=0;t<i.length;t++){var s=i[t].indexOf("="),c=null;if(0<=s){var p=i[t].substring(0,s);c=i[t].substring(s+1)}else p=i[t];e(p,c?decodeURIComponent(c.replace(/\+/g," ")):"")}}}(i.i,function(e,t){i.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Zi(i,e){fn(i),e=Ni(i,e),$i(i.g.h,e)&&(i.i=null,i.h-=i.g.get(e).length,$i((i=i.g).h,e)&&(delete i.h[e],i.i--,i.g.length>2*i.i&&xs(i)))}function ho(i,e){return fn(i),e=Ni(i,e),$i(i.g.h,e)}function ds(i,e,t){Zi(i,e),0<t.length&&(i.i=null,i.g.set(Ni(i,e),sr(t)),i.h+=t.length)}function Ni(i,e){return e=String(e),i.j&&(e=e.toLowerCase()),e}function F(i){this.l=i||E,i=ge.PerformanceNavigationTiming?0<(i=ge.performance.getEntriesByType("navigation")).length&&("hq"==i[0].nextHopProtocol||"h2"==i[0].nextHopProtocol):!!(ge.g&&ge.g.Ea&&ge.g.Ea()&&ge.g.Ea().Zb),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(V=pi.prototype).add=function(i,e){fn(this),this.i=null,i=Ni(this,i);var t=this.g.get(i);return t||this.g.set(i,t=[]),t.push(e),this.h+=1,this},V.forEach=function(i,e){fn(this),this.g.forEach(function(t,s){Yt(t,function(c){i.call(e,c,s,this)},this)},this)},V.T=function(){fn(this);for(var i=this.g.R(),e=this.g.T(),t=[],s=0;s<e.length;s++)for(var c=i[s],p=0;p<c.length;p++)t.push(e[s]);return t},V.R=function(i){fn(this);var e=[];if("string"==typeof i)ho(this,i)&&(e=fr(e,this.g.get(Ni(this,i))));else{i=this.g.R();for(var t=0;t<i.length;t++)e=fr(e,i[t])}return e},V.set=function(i,e){return fn(this),this.i=null,ho(this,i=Ni(this,i))&&(this.h-=this.g.get(i).length),this.g.set(i,[e]),this.h+=1,this},V.get=function(i,e){return i&&0<(i=this.R(i)).length?String(i[0]):e},V.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var i=[],e=this.g.T(),t=0;t<e.length;t++){var s=e[t],c=encodeURIComponent(String(s));s=this.R(s);for(var p=0;p<s.length;p++){var v=c;""!==s[p]&&(v+="="+encodeURIComponent(String(s[p]))),i.push(v)}}return this.i=i.join("&")};var E=10;function R(i){return!!i.h||!!i.g&&i.g.size>=i.j}function Y(i){return i.h?1:i.g?i.g.size:0}function oe(i,e){return i.h?i.h==e:!!i.g&&i.g.has(e)}function Te(i,e){i.g?i.g.add(e):i.h=e}function Ke(i,e){i.h&&i.h==e?i.h=null:i.g&&i.g.has(e)&&i.g.delete(e)}function mt(i){if(null!=i.h)return i.i.concat(i.h.D);if(null!=i.g&&0!==i.g.size){let e=i.i;for(const t of i.g.values())e=e.concat(t.D);return e}return sr(i.i)}function Gt(){}function Ut(){this.g=new Gt}function Bn(i,e,t){const s=t||"";try{ws(i,function(c,p){let v=c;Je(c)&&(v=Hn(c)),e.push(s+p+"="+encodeURIComponent(v))})}catch(c){throw e.push(s+"type="+encodeURIComponent("_badmap")),c}}function Br(i,e,t,s,c){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,c(s)}catch(p){}}function Or(i){this.l=i.$b||null,this.j=i.ib||!1}function rr(i,e){ar.call(this),this.D=i,this.u=e,this.m=void 0,this.readyState=Dr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}F.prototype.cancel=function(){if(this.i=mt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const i of this.g.values())i.cancel();this.g.clear()}},Gt.prototype.stringify=function(i){return ge.JSON.stringify(i,void 0)},Gt.prototype.parse=function(i){return ge.JSON.parse(i,void 0)},on(Or,Mn),Or.prototype.g=function(){return new rr(this.l,this.j)},Or.prototype.i=function(i){return function(){return i}}({}),on(rr,ar);var Dr=0;function Ti(i){i.j.read().then(i.Sa.bind(i)).catch(i.ha.bind(i))}function Cr(i){i.readyState=4,i.l=null,i.j=null,i.A=null,gi(i)}function gi(i){i.onreadystatechange&&i.onreadystatechange.call(i)}(V=rr.prototype).open=function(i,e){if(this.readyState!=Dr)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=e,this.readyState=1,gi(this)},V.send=function(i){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(e.body=i),(this.D||ge).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},V.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Cr(this)),this.readyState=Dr},V.Va=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,gi(this)),this.g&&(this.readyState=3,gi(this),this.g)))if("arraybuffer"===this.responseType)i.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==ge.ReadableStream&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ti(this)}else i.text().then(this.Ua.bind(this),this.ha.bind(this))},V.Sa=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var e=i.value?i.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!i.done}))&&(this.response=this.responseText+=e)}i.done?Cr(this):gi(this),3==this.readyState&&Ti(this)}},V.Ua=function(i){this.g&&(this.response=this.responseText=i,Cr(this))},V.Ta=function(i){this.g&&(this.response=i,Cr(this))},V.ha=function(){this.g&&Cr(this)},V.setRequestHeader=function(i,e){this.v.append(i,e)},V.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},V.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],e=this.h.entries();for(var t=e.next();!t.done;)i.push((t=t.value)[0]+": "+t[1]),t=e.next();return i.join("\r\n")},Object.defineProperty(rr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(i){this.m=i?"include":"same-origin"}});var Ms=ge.JSON.parse;function Xn(i){ar.call(this),this.headers=new Cn,this.u=i||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Pi,this.K=this.L=!1}on(Xn,ar);var Pi="",Js=/^https?$/i,_o=["POST","PUT"];function xo(i){return"content-type"==i.toLowerCase()}function Ro(i,e){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=e,i.m=5,ju(i),zo(i)}function ju(i){i.D||(i.D=!0,Tt(i,"complete"),Tt(i,"error"))}function Ea(i){if(i.h&&void 0!==ut&&(!i.C[1]||4!=Mo(i)||2!=i.ba()))if(i.v&&4==Mo(i))er(i.Fa,0,i);else if(Tt(i,"readystatechange"),4==Mo(i)){i.h=!1;try{const x=i.ba();e:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var s;if(s=0===x){var c=String(i.H).match(cs)[1]||null;if(!c&&ge.self&&ge.self.location){var p=ge.self.location.protocol;c=p.substr(0,p.length-1)}s=!Js.test(c?c.toLowerCase():"")}t=s}if(t)Tt(i,"complete"),Tt(i,"success");else{i.m=6;try{var v=2<Mo(i)?i.g.statusText:""}catch(W){v=""}i.j=v+" ["+i.ba()+"]",ju(i)}}finally{zo(i)}}}function zo(i,e){if(i.g){Ko(i);const t=i.g,s=i.C[0]?Oe:null;i.g=null,i.C=null,e||Tt(i,"ready");try{t.onreadystatechange=s}catch(c){}}}function Ko(i){i.g&&i.K&&(i.g.ontimeout=null),i.A&&(ge.clearTimeout(i.A),i.A=null)}function Mo(i){return i.g?i.g.readyState:0}function ca(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.J){case Pi:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ma(i,e,t){e:{for(s in t){var s=!1;break e}s=!0}s||(t=function Ga(i){let e="";return Sn(i,function(t,s){e+=s,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof i?null!=t&&encodeURIComponent(String(t)):_e(i,e,t))}function No(i,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[i]||e}function Na(i){this.za=0,this.l=[],this.h=new Di,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=No("failFast",!1,i),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=No("baseRetryDelayMs",5e3,i),this.$a=No("retryDelaySeedMs",1e4,i),this.Ya=No("forwardChannelMaxRetries",2,i),this.ra=No("forwardChannelRequestTimeoutMs",2e4,i),this.qa=i&&i.xmlHttpFactory||void 0,this.Ba=i&&i.Yb||!1,this.K=void 0,this.H=i&&i.supportsCrossDomainXhr||!1,this.J="",this.i=new F(i&&i.concurrentRequestLimit),this.Ca=new Ut,this.ja=i&&i.fastHandshake||!1,this.Ra=i&&i.Wb||!1,i&&i.Aa&&this.h.Aa(),i&&i.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&i&&i.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!i||!1!==i.Xb}function Si(i){if(Hi(i),3==i.G){var e=i.V++,t=On(i.F);_e(t,"SID",i.J),_e(t,"RID",e),_e(t,"TYPE","terminate"),Pa(i,t),(e=new _s(i,i.h,e,void 0)).K=2,e.v=rt(On(t)),t=!1,ge.navigator&&ge.navigator.sendBeacon&&(t=ge.navigator.sendBeacon(e.v.toString(),"")),!t&&ge.Image&&((new Image).src=e.v,t=!0),t||(e.g=ko(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ei(e)}Oa(i)}function fo(i){i.g&&(Xs(i),i.g.cancel(),i.g=null)}function Hi(i){fo(i),i.u&&(ge.clearTimeout(i.u),i.u=null),mr(i),i.i.cancel(),i.m&&("number"==typeof i.m&&ge.clearTimeout(i.m),i.m=null)}function Sl(i,e){i.l.push(new class{constructor(i,e){this.h=i,this.g=e}}(i.Za++,e)),3==i.G&&wa(i)}function wa(i){R(i.i)||i.m||(i.m=!0,Mi(i.Ha,i),i.C=0)}function tc(i,e){var t;t=e?e.m:i.V++;const s=On(i.F);_e(s,"SID",i.J),_e(s,"RID",t),_e(s,"AID",i.U),Pa(i,s),i.o&&i.s&&Ma(s,i.o,i.s),t=new _s(i,i.h,t,i.C+1),null===i.o&&(t.H=i.s),e&&(i.l=e.D.concat(i.l)),e=vo(i,t,1e3),t.setTimeout(Math.round(.5*i.ra)+Math.round(.5*i.ra*Math.random())),Te(i.i,t),ss(t,s,e)}function Pa(i,e){i.j&&ws({},function(t,s){_e(e,s,t)})}function vo(i,e,t){t=Math.min(i.l.length,t);var s=i.j?it(i.j.Oa,i.j,i):null;e:{var c=i.l;let p=-1;for(;;){const v=["count="+t];-1==p?0<t?(p=c[0].h,v.push("ofs="+p)):p=0:v.push("ofs="+p);let x=!0;for(let W=0;W<t;W++){let Z=c[W].h;const se=c[W].g;if(Z-=p,0>Z)p=Math.max(0,c[W].h-100),x=!1;else try{Bn(se,v,"req"+Z+"_")}catch(we){s&&s(se)}}if(x){s=v.join("&");break e}}}return i=i.l.splice(0,t),e.D=i,s}function Wa(i){i.g||i.u||(i.Y=1,Mi(i.Ga,i),i.A=0)}function Po(i){return!(i.g||i.u||3<=i.A||(i.Y++,i.u=pt(it(i.Ga,i),$s(i,i.A)),i.A++,0))}function Xs(i){null!=i.B&&(ge.clearTimeout(i.B),i.B=null)}function qo(i){i.g=new _s(i,i.h,"rpc",i.Y),null===i.o&&(i.g.H=i.s),i.g.O=0;var e=On(i.oa);_e(e,"RID","rpc"),_e(e,"SID",i.J),_e(e,"CI",i.N?"0":"1"),_e(e,"AID",i.U),Pa(i,e),_e(e,"TYPE","xmlhttp"),i.o&&i.s&&Ma(e,i.o,i.s),i.K&&i.g.setTimeout(i.K);var t=i.g;i=i.la,t.K=1,t.v=rt(On(e)),t.s=null,t.U=!0,vs(t,i)}function mr(i){null!=i.v&&(ge.clearTimeout(i.v),i.v=null)}function da(i,e){var t=null;if(i.g==e){mr(i),Xs(i),i.g=null;var s=2}else{if(!oe(i.i,e))return;t=e.D,Ke(i.i,e),s=1}if(i.I=e.N,0!=i.G)if(e.i)if(1==s){t=e.s?e.s.length:0,e=Date.now()-e.F;var c=i.C;Tt(s=Ir(),new tt(s,t,e,c)),wa(i)}else Wa(i);else if(3==(c=e.o)||0==c&&0<i.I||!(1==s&&function ec(i,e){return!(Y(i.i)>=i.i.j-(i.m?1:0)||(i.m?(i.l=e.D.concat(i.l),0):1==i.G||2==i.G||i.C>=(i.Xa?0:i.Ya)||(i.m=pt(it(i.Ha,i,e),$s(i,i.C)),i.C++,0)))}(i,e)||2==s&&Po(i)))switch(t&&0<t.length&&(e=i.i,e.i=e.i.concat(t)),c){case 1:Gi(i,5);break;case 4:Gi(i,10);break;case 3:Gi(i,6);break;default:Gi(i,2)}}function $s(i,e){let t=i.Pa+Math.floor(Math.random()*i.$a);return i.j||(t*=2),t*e}function Gi(i,e){if(i.h.info("Error code "+e),2==e){var t=null;i.j&&(t=null);var s=it(i.jb,i);t||(t=new Rs("//www.google.com/images/cleardot.gif"),ge.location&&"http"==ge.location.protocol||B(t,"https"),rt(t)),function cr(i,e){const t=new Di;if(ge.Image){const s=new Image;s.onload=en(Br,t,s,"TestLoadImage: loaded",!0,e),s.onerror=en(Br,t,s,"TestLoadImage: error",!1,e),s.onabort=en(Br,t,s,"TestLoadImage: abort",!1,e),s.ontimeout=en(Br,t,s,"TestLoadImage: timeout",!1,e),ge.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i}else e(!1)}(t.toString(),s)}else He(2);i.G=0,i.j&&i.j.va(e),Oa(i),Hi(i)}function Oa(i){i.G=0,i.I=-1,i.j&&((0!=mt(i.i).length||0!=i.l.length)&&(i.i.i.length=0,sr(i.l),i.l.length=0),i.j.ua())}function Oo(i,e,t){let s=function yt(i){return i instanceof Rs?On(i):new Rs(i,void 0)}(t);if(""!=s.i)e&&Q(s,e+"."+s.i),U(s,s.m);else{const c=ge.location;s=function un(i,e,t,s){var c=new Rs(null,void 0);return i&&B(c,i),e&&Q(c,e),t&&U(c,t),s&&(c.l=s),c}(c.protocol,e?e+"."+c.hostname:c.hostname,+c.port,t)}return i.aa&&Sn(i.aa,function(c,p){_e(s,p,c)}),t=i.sa,(e=i.D)&&t&&_e(s,e,t),_e(s,"VER",i.ma),Pa(i,s),s}function ko(i,e,t){if(e&&!i.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Xn(t&&i.Ba&&!i.qa?new Or({ib:!0}):i.qa)).L=i.H,e}function ha(){}function za(){if(xr&&!(10<=Number(ke)))throw Error("Environmental error: no available transport.")}function Ns(i,e){ar.call(this),this.g=new Na(e),this.l=i,this.h=e&&e.messageUrlParams||null,i=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(i?i["X-WebChannel-Content-Type"]=e.messageContentType:i={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(i?i["X-WebChannel-Client-Profile"]=e.ya:i={"X-WebChannel-Client-Profile":e.ya}),this.g.P=i,(i=e&&e.httpHeadersOverwriteParam)&&!Pn(i)&&(this.g.o=i),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Pn(e)&&(this.g.D=e,null!==(i=this.h)&&e in i&&e in(i=this.h)&&delete i[e]),this.j=new mi(this)}function Ka(i){ao.call(this);var e=i.__sm__;if(e){e:{for(const t in e){i=t;break e}i=void 0}(this.i=i)&&(i=this.i,e=null!==e&&i in e?e[i]:void 0),this.data=e}else this.data=i}function $u(){nr.call(this),this.status=1}function mi(i){this.g=i}(V=Xn.prototype).ea=function(i,e,t,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+i);e=e?e.toUpperCase():"GET",this.H=i,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():vn.g(),this.C=function tr(i){return i.h||(i.h=i.i())}(this.u?this.u:vn),this.g.onreadystatechange=it(this.Fa,this);try{this.F=!0,this.g.open(e,String(i),!0),this.F=!1}catch(p){return void Ro(this,p)}i=t||"";const c=new Cn(this.headers);s&&ws(s,function(p,v){c.set(v,p)}),s=function hr(i){e:{var e=xo;const t=i.length,s="string"==typeof i?i.split(""):i;for(let c=0;c<t;c++)if(c in s&&e.call(void 0,s[c],c,i)){e=c;break e}e=-1}return 0>e?null:"string"==typeof i?i.charAt(e):i[e]}(c.T()),t=ge.FormData&&i instanceof ge.FormData,!(0<=zt(_o,e))||s||t||c.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),c.forEach(function(p,v){this.g.setRequestHeader(v,p)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ko(this),0<this.B&&((this.K=function la(i){return xr&&function Ne(){return function Fr(i){var e=dn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=i(9)}(function(){let i=0;const e=Hr(String(cn)).split("."),t=Hr("9").split("."),s=Math.max(e.length,t.length);for(let v=0;0==i&&v<s;v++){var c=e[v]||"",p=t[v]||"";do{if(c=/(\d*)(\D*)(.*)/.exec(c)||["","","",""],p=/(\d*)(\D*)(.*)/.exec(p)||["","","",""],0==c[0].length&&0==p[0].length)break;i=Ar(0==c[1].length?0:parseInt(c[1],10),0==p[1].length?0:parseInt(p[1],10))||Ar(0==c[2].length,0==p[2].length)||Ar(c[2],p[2]),c=c[3],p=p[3]}while(0==i)}return 0<=i})}()&&"number"==typeof i.timeout&&void 0!==i.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=it(this.pa,this)):this.A=er(this.pa,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(p){Ro(this,p)}},V.pa=function(){void 0!==ut&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))},V.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,Tt(this,"complete"),Tt(this,"abort"),zo(this))},V.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),zo(this,!0)),Xn.Z.M.call(this)},V.Fa=function(){this.s||(this.F||this.v||this.l?Ea(this):this.cb())},V.cb=function(){Ea(this)},V.ba=function(){try{return 2<Mo(this)?this.g.status:-1}catch(i){return-1}},V.ga=function(){try{return this.g?this.g.responseText:""}catch(i){return""}},V.Qa=function(i){if(this.g){var e=this.g.responseText;return i&&0==e.indexOf(i)&&(e=e.substring(i.length)),Ms(e)}},V.Da=function(){return this.m},V.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(V=Na.prototype).ma=8,V.G=1,V.hb=function(i){try{this.h.info("Origin Trials invoked: "+i)}catch(e){}},V.Ha=function(i){if(this.m)if(this.m=null,1==this.G){if(!i){this.V=Math.floor(1e5*Math.random()),i=this.V++;const c=new _s(this,this.h,i,void 0);let p=this.s;if(this.P&&(p?(p=ln(p),ei(p,this.P)):p=this.P),null===this.o&&(c.H=p),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var s=this.l[t];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=vo(this,c,e),_e(t=On(this.F),"RID",i),_e(t,"CVER",22),this.D&&_e(t,"X-HTTP-Session-Id",this.D),Pa(this,t),this.o&&p&&Ma(t,this.o,p),Te(this.i,c),this.Ra&&_e(t,"TYPE","init"),this.ja?(_e(t,"$req",e),_e(t,"SID","null"),c.$=!0,ss(c,t,null)):ss(c,t,e),this.G=2}}else 3==this.G&&(i?tc(this,i):0==this.l.length||R(this.i)||tc(this))},V.Ga=function(){if(this.u=null,qo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var i=2*this.O;this.h.info("BP detection timer enabled: "+i),this.B=pt(it(this.bb,this),i)}},V.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,He(10),fo(this),qo(this))},V.ab=function(){null!=this.v&&(this.v=null,fo(this),Po(this),He(19))},V.jb=function(i){i?(this.h.info("Successfully pinged google.com"),He(2)):(this.h.info("Failed to ping google.com"),He(1))},(V=ha.prototype).xa=function(){},V.wa=function(){},V.va=function(){},V.ua=function(){},V.Oa=function(){},za.prototype.g=function(i,e){return new Ns(i,e)},on(Ns,ar),Ns.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var i=this.g,e=this.l,t=this.h||void 0;i.Wa&&(i.h.info("Origin Trials enabled."),Mi(it(i.hb,i,e))),He(0),i.W=e,i.aa=t||{},i.N=i.X,i.F=Oo(i,null,i.W),wa(i)},Ns.prototype.close=function(){Si(this.g)},Ns.prototype.u=function(i){if("string"==typeof i){var e={};e.__data__=i,Sl(this.g,e)}else this.v?((e={}).__data__=Hn(i),Sl(this.g,e)):Sl(this.g,i)},Ns.prototype.M=function(){this.g.j=null,delete this.j,Si(this.g),delete this.g,Ns.Z.M.call(this)},on(Ka,ao),on($u,nr),on(mi,ha),mi.prototype.xa=function(){Tt(this.g,"a")},mi.prototype.wa=function(i){Tt(this.g,new Ka(i))},mi.prototype.va=function(i){Tt(this.g,new $u(i))},mi.prototype.ua=function(){Tt(this.g,"b")},za.prototype.createWebChannel=za.prototype.g,Ns.prototype.send=Ns.prototype.u,Ns.prototype.open=Ns.prototype.m,Ns.prototype.close=Ns.prototype.close,_t.NO_ERROR=0,_t.TIMEOUT=8,_t.HTTP_ERROR=6,Un.COMPLETE="complete",rs.EventType=Bi,Bi.OPEN="a",Bi.CLOSE="b",Bi.ERROR="c",Bi.MESSAGE="d",ar.prototype.listen=ar.prototype.N,Xn.prototype.listenOnce=Xn.prototype.O,Xn.prototype.getLastError=Xn.prototype.La,Xn.prototype.getLastErrorCode=Xn.prototype.Da,Xn.prototype.getStatus=Xn.prototype.ba,Xn.prototype.getResponseJson=Xn.prototype.Qa,Xn.prototype.getResponseText=Xn.prototype.ga,Xn.prototype.send=Xn.prototype.ea;var Zo=It.createWebChannelTransport=function(){return new za},Yo=It.getStatEventTarget=function(){return Ir()},eo=It.ErrorCode=_t,Yr=It.EventType=Un,Eo=It.Event=Ss,Hs=It.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ru=It.FetchXmlHttpFactory=Or,Qr=It.WebChannel=rs,ka=It.XhrIo=Xn;const Gs="@firebase/firestore";class Yi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yi.UNAUTHENTICATED=new Yi(null),Yi.GOOGLE_CREDENTIALS=new Yi("google-credentials-uid"),Yi.FIRST_PARTY=new Yi("first-party-uid"),Yi.MOCK_USER=new Yi("mock-user");let Ps="9.8.4";const Fo=new xe.Yd("@firebase/firestore");function Qo(){return Fo.logLevel}function xt(i,...e){if(Fo.logLevel<=xe.in.DEBUG){const t=e.map(fa);Fo.debug(`Firestore (${Ps}): ${i}`,...t)}}function ai(i,...e){if(Fo.logLevel<=xe.in.ERROR){const t=e.map(fa);Fo.error(`Firestore (${Ps}): ${i}`,...t)}}function Jo(i,...e){if(Fo.logLevel<=xe.in.WARN){const t=e.map(fa);Fo.warn(`Firestore (${Ps}): ${i}`,...t)}}function fa(i){if("string"==typeof i)return i;try{return JSON.stringify(i)}catch(t){return i}}function S(i="Unexpected state"){const e=`FIRESTORE (${Ps}) INTERNAL ASSERTION FAILED: `+i;throw ai(e),new Error(e)}function D(i,e){i||S()}function N(i,e){return i}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Ge.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class de{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Ie{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dt{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yi.UNAUTHENTICATED))}shutdown(){}}class Jt{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class yr{constructor(e){this.t=e,this.currentUser=Yi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var s=this;let c=this.i;const p=Z=>this.i!==c?(c=this.i,t(Z)):Promise.resolve();let v=new de;this.o=()=>{this.i++,this.currentUser=this.u(),v.resolve(),v=new de,e.enqueueRetryable(()=>p(this.currentUser))};const x=()=>{const Z=v;e.enqueueRetryable((0,De.Z)(function*(){yield Z.promise,yield p(s.currentUser)}))},W=Z=>{xt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=Z,this.auth.addAuthTokenListener(this.o),x()};this.t.onInit(Z=>W(Z)),setTimeout(()=>{if(!this.auth){const Z=this.t.getImmediate({optional:!0});Z?W(Z):(xt("FirebaseAuthCredentialsProvider","Auth not yet detected"),v.resolve(),v=new de)}},0),x()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(xt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(D("string"==typeof s.accessToken),new Ie(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return D(null===e||"string"==typeof e),new Yi(e)}}class pn{constructor(e,t,s){this.type="FirstParty",this.user=Yi.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const c=e.auth.getAuthHeaderValueForFirstParty([]);c&&this.headers.set("Authorization",c),s&&this.headers.set("X-Goog-Iam-Authorization-Token",s)}}class Tr{constructor(e,t,s){this.h=e,this.l=t,this.m=s}getToken(){return Promise.resolve(new pn(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Yi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _r{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class to{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const s=p=>{null!=p.error&&xt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${p.error.message}`);const v=p.token!==this.p;return this.p=p.token,xt("FirebaseAppCheckTokenProvider",`Received ${v?"new":"existing"} token.`),v?t(p.token):Promise.resolve()};this.o=p=>{e.enqueueRetryable(()=>s(p))};const c=p=>{xt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=p,this.appCheck.addTokenListener(this.o)};this.g.onInit(p=>c(p)),setTimeout(()=>{if(!this.appCheck){const p=this.g.getImmediate({optional:!0});p?c(p):xt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(D("string"==typeof t.token),this.p=t.token,new _r(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Fa(i){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let s=0;s<i;s++)t[s]=Math.floor(256*Math.random());return t}class Lo{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const c=Fa(40);for(let p=0;p<c.length;++p)s.length<20&&c[p]<t&&(s+=e.charAt(c[p]%e.length))}return s}}function Dn(i,e){return i<e?-1:i>e?1:0}function wo(i,e,t){return i.length===e.length&&i.every((s,c)=>t(s,e[c]))}function Gu(i){return i+"\0"}class ui{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new K(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ui.fromMillis(Date.now())}static fromDate(e){return ui.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*t));return new ui(t,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Dn(this.nanoseconds,e.nanoseconds):Dn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class An{constructor(e){this.timestamp=e}static fromTimestamp(e){return new An(e)}static min(){return new An(new ui(0,0))}static max(){return new An(new ui(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class _u{constructor(e,t,s){void 0===t?t=0:t>e.length&&S(),void 0===s?s=e.length-t:s>e.length-t&&S(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return 0===_u.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _u?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let c=0;c<s;c++){const p=e.get(c),v=t.get(c);if(p<v)return-1;if(p>v)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Nr extends _u{construct(e,t,s){return new Nr(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new K(P.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(c=>c.length>0))}return new Nr(t)}static emptyPath(){return new Nr([])}}const Qi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hs extends _u{construct(e,t,s){return new hs(e,t,s)}static isValidIdentifier(e){return Qi.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new hs(["__name__"])}static fromServerFormat(e){const t=[];let s="",c=0;const p=()=>{if(0===s.length)throw new K(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let v=!1;for(;c<e.length;){const x=e[c];if("\\"===x){if(c+1===e.length)throw new K(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const W=e[c+1];if("\\"!==W&&"."!==W&&"`"!==W)throw new K(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=W,c+=2}else"`"===x?(v=!v,c++):"."!==x||v?(s+=x,c++):(p(),c++)}if(p(),v)throw new K(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hs(t)}static emptyPath(){return new hs([])}}class Zt{constructor(e){this.path=e}static fromPath(e){return new Zt(Nr.fromString(e))}static fromName(e){return new Zt(Nr.fromString(e).popFirst(5))}static empty(){return new Zt(Nr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Nr.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Nr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Zt(new Nr(e.slice()))}}class Al{constructor(e,t,s,c){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=c}}function Wu(i){return i.fields.find(e=>2===e.kind)}function La(i){return i.fields.filter(e=>2!==e.kind)}Al.UNKNOWN_ID=-1;class vu{constructor(e,t){this.fieldPath=e,this.kind=t}}class al{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new al(0,jr.min())}}function iu(i,e){const t=i.toTimestamp().seconds,s=i.toTimestamp().nanoseconds+1,c=An.fromTimestamp(1e9===s?new ui(t+1,0):new ui(t,s));return new jr(c,Zt.empty(),e)}function xl(i){return new jr(i.readTime,i.key,-1)}class jr{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new jr(An.min(),Zt.empty(),-1)}static max(){return new jr(An.max(),Zt.empty(),-1)}}function zu(i,e){let t=i.readTime.compareTo(e.readTime);return 0!==t?t:(t=Zt.comparator(i.documentKey,e.documentKey),0!==t?t:Dn(i.largestBatchId,e.largestBatchId))}const qa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bd{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Ia(i){return Io.apply(this,arguments)}function Io(){return Io=(0,De.Z)(function*(i){if(i.code!==P.FAILED_PRECONDITION||i.message!==qa)throw i;xt("LocalStore","Unexpectedly lost primary lease")}),Io.apply(this,arguments)}class Qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&S(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Qe((s,c)=>{this.nextCallback=p=>{this.wrapSuccess(e,p).next(s,c)},this.catchCallback=p=>{this.wrapFailure(t,p).next(s,c)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Qe?t:Qe.resolve(t)}catch(t){return Qe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Qe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Qe.reject(t)}static resolve(e){return new Qe((t,s)=>{t(e)})}static reject(e){return new Qe((t,s)=>{s(e)})}static waitFor(e){return new Qe((t,s)=>{let c=0,p=0,v=!1;e.forEach(x=>{++c,x.next(()=>{++p,v&&p===c&&t()},W=>s(W))}),v=!0,p===c&&t()})}static or(e){let t=Qe.resolve(!1);for(const s of e)t=t.next(c=>c?Qe.resolve(c):s());return t}static forEach(e,t){const s=[];return e.forEach((c,p)=>{s.push(t.call(this,c,p))}),this.waitFor(s)}static mapArray(e,t){return new Qe((s,c)=>{const p=e.length,v=new Array(p);let x=0;for(let W=0;W<p;W++){const Z=W;t(e[Z]).next(se=>{v[Z]=se,++x,x===p&&s(v)},se=>c(se))}})}static doWhile(e,t){return new Qe((s,c)=>{const p=()=>{!0===e()?t().next(()=>{p()},c):s()};p()})}}class Va{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new de,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new pa(e,t.error)):this.T.resolve()},this.transaction.onerror=s=>{const c=Eu(s.target.error);this.T.reject(new pa(e,c))}}static open(e,t,s,c){try{return new Va(t,e.transaction(c,s))}catch(p){throw new pa(t,p)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(xt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Ca(t)}}class no{constructor(e,t,s){this.name=e,this.version=t,this.P=s,12.2===no.v((0,Ge.z$)())&&ai("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return xt("SimpleDb","Removing database:",e),Vo(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,Ge.hl)())return!1;if(no.S())return!0;const e=(0,Ge.z$)(),t=no.v(e),s=0<t&&t<10,c=no.D(e),p=0<c&&c<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||p)}static S(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static D(e){const t=e.match(/Android ([\d.]+)/i),s=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(s)}k(e){var t=this;return(0,De.Z)(function*(){return t.db||(xt("SimpleDb","Opening database:",t.name),t.db=yield new Promise((s,c)=>{const p=indexedDB.open(t.name,t.version);p.onsuccess=v=>{s(v.target.result)},p.onblocked=()=>{c(new pa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},p.onerror=v=>{const x=v.target.error;c("VersionError"===x.name?new K(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===x.name?new K(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+x):new pa(e,x))},p.onupgradeneeded=v=>{xt("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',v.oldVersion),t.P.O(v.target.result,p.transaction,v.oldVersion,t.version).next(()=>{xt("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.M&&(t.db.onversionchange=s=>t.M(s)),t.db})()}F(e){this.M=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,s,c){var p=this;return(0,De.Z)(function*(){const v="readonly"===t;let x=0;for(;;){++x;try{p.db=yield p.k(e);const W=Va.open(p.db,e,v?"readonly":"readwrite",s),Z=c(W).next(se=>(W.R(),se)).catch(se=>(W.abort(se),Qe.reject(se))).toPromise();return Z.catch(()=>{}),yield W.A,Z}catch(W){const Z=W,se="FirebaseError"!==Z.name&&x<3;if(xt("SimpleDb","Transaction failed with error:",Z.message,"Retrying:",se),p.close(),!se)return Promise.reject(Z)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Za{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Vo(this.$.delete())}}class pa extends K{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Co(i){return"IndexedDbTransactionError"===i.name}class Ca{constructor(e){this.store=e}put(e,t){let s;return void 0!==t?(xt("SimpleDb","PUT",this.store.name,e,t),s=this.store.put(t,e)):(xt("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Vo(s)}add(e){return xt("SimpleDb","ADD",this.store.name,e,e),Vo(this.store.add(e))}get(e){return Vo(this.store.get(e)).next(t=>(void 0===t&&(t=null),xt("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return xt("SimpleDb","DELETE",this.store.name,e),Vo(this.store.delete(e))}count(){return xt("SimpleDb","COUNT",this.store.name),Vo(this.store.count())}K(e,t){const s=this.options(e,t);if(s.index||"function"!=typeof this.store.getAll){const c=this.cursor(s),p=[];return this.G(c,(v,x)=>{p.push(x)}).next(()=>p)}{const c=this.store.getAll(s.range);return new Qe((p,v)=>{c.onerror=x=>{v(x.target.error)},c.onsuccess=x=>{p(x.target.result)}})}}j(e,t){const s=this.store.getAll(e,null===t?void 0:t);return new Qe((c,p)=>{s.onerror=v=>{p(v.target.error)},s.onsuccess=v=>{c(v.target.result)}})}W(e,t){xt("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,t);s.H=!1;const c=this.cursor(s);return this.G(c,(p,v,x)=>x.delete())}J(e,t){let s;t?s=e:(s={},t=e);const c=this.cursor(s);return this.G(c,t)}Y(e){const t=this.cursor({});return new Qe((s,c)=>{t.onerror=p=>{const v=Eu(p.target.error);c(v)},t.onsuccess=p=>{const v=p.target.result;v?e(v.primaryKey,v.value).next(x=>{x?v.continue():s()}):s()}})}G(e,t){const s=[];return new Qe((c,p)=>{e.onerror=v=>{p(v.target.error)},e.onsuccess=v=>{const x=v.target.result;if(!x)return void c();const W=new Za(x),Z=t(x.primaryKey,x.value,W);if(Z instanceof Qe){const se=Z.catch(we=>(W.done(),Qe.reject(we)));s.push(se)}W.isDone?c():null===W.U?x.continue():x.continue(W.U)}}).next(()=>Qe.waitFor(s))}options(e,t){let s;return void 0!==e&&("string"==typeof e?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Vo(i){return new Qe((e,t)=>{i.onsuccess=s=>{e(s.target.result)},i.onerror=s=>{const c=Eu(s.target.error);t(c)}})}let ul=!1;function Eu(i){const e=no.v((0,Ge.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){const s=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ul||(ul=!0,setTimeout(()=>{throw s},0)),s}}return i}class Xo{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;xt("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,De.Z)(function*(){t.task=null;try{xt("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(s){Co(s)?xt("IndexBackiller","Ignoring IndexedDB error during index backfill: ",s):yield Ia(s)}yield t.Z(1)}))}}class ll{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,De.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",s=>t.et(s,e))})()}et(e,t){const s=new Set;let c=t,p=!0;return Qe.doWhile(()=>!0===p&&c>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(v=>{if(null!==v&&!s.has(v))return xt("IndexBackiller",`Processing collection: ${v}`),this.nt(e,v,c).next(x=>{c-=x,s.add(v)});p=!1})).next(()=>t-c)}nt(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(c=>this.localStore.localDocuments.getNextDocuments(e,t,c,s).next(p=>{const v=p.changes;return this.localStore.indexManager.updateIndexEntries(e,v).next(()=>this.st(c,p)).next(x=>(xt("IndexBackiller",`Updating offset: ${x}`),this.localStore.indexManager.updateCollectionGroup(e,t,x))).next(()=>v.size)}))}st(e,t){let s=e;return t.changes.forEach((c,p)=>{const v=xl(p);zu(v,s)>0&&(s=v)}),new jr(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}class os{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.it(s),this.rt=s=>t.writeSequenceNumber(s))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function Rl(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Ya(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function Ua(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}os.ot=-1;class Oi{constructor(e,t){this.comparator=e,this.root=t||Os.EMPTY}insert(e,t){return new Oi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Os.BLACK,null,null))}remove(e){return new Oi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Os.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(0===s)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const c=this.comparator(e,s.key);if(0===c)return t+s.left.size;c<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Uo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Uo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Uo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Uo(this.root,e,this.comparator,!0)}}class Uo{constructor(e,t,s,c){this.isReverse=c,this.nodeStack=[];let p=1;for(;!e.isEmpty();)if(p=t?s(e.key,t):1,t&&c&&(p*=-1),p<0)e=this.isReverse?e.left:e.right;else{if(0===p){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Os{constructor(e,t,s,c,p){this.key=e,this.value=t,this.color=null!=s?s:Os.RED,this.left=null!=c?c:Os.EMPTY,this.right=null!=p?p:Os.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,c,p){return new Os(null!=e?e:this.key,null!=t?t:this.value,null!=s?s:this.color,null!=c?c:this.left,null!=p?p:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let c=this;const p=s(e,c.key);return c=p<0?c.copy(null,null,null,c.left.insert(e,t,s),null):0===p?c.copy(null,t,null,null,null):c.copy(null,null,null,null,c.right.insert(e,t,s)),c.fixUp()}removeMin(){if(this.left.isEmpty())return Os.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,c=this;if(t(e,c.key)<0)c.left.isEmpty()||c.left.isRed()||c.left.left.isRed()||(c=c.moveRedLeft()),c=c.copy(null,null,null,c.left.remove(e,t),null);else{if(c.left.isRed()&&(c=c.rotateRight()),c.right.isEmpty()||c.right.isRed()||c.right.left.isRed()||(c=c.moveRedRight()),0===t(e,c.key)){if(c.right.isEmpty())return Os.EMPTY;s=c.right.min(),c=c.copy(s.key,s.value,null,null,c.right.removeMin())}c=c.copy(null,null,null,null,c.right.remove(e,t))}return c.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Os.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Os.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw S();const e=this.left.check();if(e!==this.right.check())throw S();return e+(this.isRed()?0:1)}}Os.EMPTY=null,Os.RED=!0,Os.BLACK=!1,Os.EMPTY=new class{constructor(){this.size=0}get key(){throw S()}get value(){throw S()}get color(){throw S()}get left(){throw S()}get right(){throw S()}copy(i,e,t,s,c){return this}insert(i,e,t){return new Os(i,e)}remove(i,e){return this}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Sr{constructor(e){this.comparator=e,this.data=new Oi(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const c=s.getNext();if(this.comparator(c.key,e[1])>=0)return;t(c.key)}}forEachWhile(e,t){let s;for(s=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ea(this.data.getIterator())}getIteratorFrom(e){return new ea(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Sr)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const c=t.getNext().key,p=s.getNext().key;if(0!==this.comparator(c,p))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Sr(this.comparator);return t.data=e,t}}class ea{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ws(i){return i.hasNext()?i.getNext():void 0}class Wi{constructor(e){this.fields=e,e.sort(hs.comparator)}static empty(){return new Wi([])}unionWith(e){let t=new Sr(hs.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Wi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wo(this.fields,e.fields,(t,s)=>t.isEqual(s))}}class ki{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new ki(t)}static fromUint8Array(e){const t=function(s){let c="";for(let p=0;p<s.length;++p)c+=String.fromCharCode(s[p]);return c}(e);return new ki(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Dn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ki.EMPTY_BYTE_STRING=new ki("");const Ku=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bo(i){if(D(!!i),"string"==typeof i){let e=0;const t=Ku.exec(i);if(D(!!t),t[1]){let c=t[1];c=(c+"000000000").substr(0,9),e=Number(c)}const s=new Date(i);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Ai(i.seconds),nanos:Ai(i.nanos)}}function Ai(i){return"number"==typeof i?i:"string"==typeof i?Number(i):0}function L(i){return"string"==typeof i?ki.fromBase64String(i):ki.fromUint8Array(i)}function j(i){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==i?void 0:i.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function X(i){const e=i.mapValue.fields.__previous_value__;return j(e)?X(e):e}function me(i){const e=bo(i.mapValue.fields.__local_write_time__.timestampValue);return new ui(e.seconds,e.nanos)}class $e{constructor(e,t,s,c,p,v,x,W){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=c,this.ssl=p,this.forceLongPolling=v,this.autoDetectLongPolling=x,this.useFetchStreams=W}}class Xe{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Xe("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Xe&&e.projectId===this.projectId&&e.database===this.database}}function Ct(i){return null==i}function Ot(i){return 0===i&&1/i==-1/0}function Nn(i){return"number"==typeof i&&Number.isInteger(i)&&!Ot(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const jn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ir={nullValue:"NULL_VALUE"};function _n(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?j(i)?4:nc(i)?9007199254740991:10:S()}function Jr(i,e){if(i===e)return!0;const t=_n(i);if(t!==_n(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return me(i).isEqual(me(e));case 3:return function(s,c){if("string"==typeof s.timestampValue&&"string"==typeof c.timestampValue&&s.timestampValue.length===c.timestampValue.length)return s.timestampValue===c.timestampValue;const p=bo(s.timestampValue),v=bo(c.timestampValue);return p.seconds===v.seconds&&p.nanos===v.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return c=e,L(i.bytesValue).isEqual(L(c.bytesValue));case 7:return i.referenceValue===e.referenceValue;case 8:return function(s,c){return Ai(s.geoPointValue.latitude)===Ai(c.geoPointValue.latitude)&&Ai(s.geoPointValue.longitude)===Ai(c.geoPointValue.longitude)}(i,e);case 2:return function(s,c){if("integerValue"in s&&"integerValue"in c)return Ai(s.integerValue)===Ai(c.integerValue);if("doubleValue"in s&&"doubleValue"in c){const p=Ai(s.doubleValue),v=Ai(c.doubleValue);return p===v?Ot(p)===Ot(v):isNaN(p)&&isNaN(v)}return!1}(i,e);case 9:return wo(i.arrayValue.values||[],e.arrayValue.values||[],Jr);case 10:return function(s,c){const p=s.mapValue.fields||{},v=c.mapValue.fields||{};if(Rl(p)!==Rl(v))return!1;for(const x in p)if(p.hasOwnProperty(x)&&(void 0===v[x]||!Jr(p[x],v[x])))return!1;return!0}(i,e);default:return S()}var c}function zs(i,e){return void 0!==(i.values||[]).find(t=>Jr(t,e))}function ks(i,e){if(i===e)return 0;const t=_n(i),s=_n(e);if(t!==s)return Dn(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Dn(i.booleanValue,e.booleanValue);case 2:return function(c,p){const v=Ai(c.integerValue||c.doubleValue),x=Ai(p.integerValue||p.doubleValue);return v<x?-1:v>x?1:v===x?0:isNaN(v)?isNaN(x)?0:-1:1}(i,e);case 3:return Bo(i.timestampValue,e.timestampValue);case 4:return Bo(me(i),me(e));case 5:return Dn(i.stringValue,e.stringValue);case 6:return function(c,p){const v=L(c),x=L(p);return v.compareTo(x)}(i.bytesValue,e.bytesValue);case 7:return function(c,p){const v=c.split("/"),x=p.split("/");for(let W=0;W<v.length&&W<x.length;W++){const Z=Dn(v[W],x[W]);if(0!==Z)return Z}return Dn(v.length,x.length)}(i.referenceValue,e.referenceValue);case 8:return function(c,p){const v=Dn(Ai(c.latitude),Ai(p.latitude));return 0!==v?v:Dn(Ai(c.longitude),Ai(p.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return function(c,p){const v=c.values||[],x=p.values||[];for(let W=0;W<v.length&&W<x.length;++W){const Z=ks(v[W],x[W]);if(Z)return Z}return Dn(v.length,x.length)}(i.arrayValue,e.arrayValue);case 10:return function(c,p){if(c===jn.mapValue&&p===jn.mapValue)return 0;if(c===jn.mapValue)return 1;if(p===jn.mapValue)return-1;const v=c.fields||{},x=Object.keys(v),W=p.fields||{},Z=Object.keys(W);x.sort(),Z.sort();for(let se=0;se<x.length&&se<Z.length;++se){const we=Dn(x[se],Z[se]);if(0!==we)return we;const st=ks(v[x[se]],W[Z[se]]);if(0!==st)return st}return Dn(x.length,Z.length)}(i.mapValue,e.mapValue);default:throw S()}}function Bo(i,e){if("string"==typeof i&&"string"==typeof e&&i.length===e.length)return Dn(i,e);const t=bo(i),s=bo(e),c=Dn(t.seconds,s.seconds);return 0!==c?c:Dn(t.nanos,s.nanos)}function Fs(i){return wu(i)}function wu(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(s){const c=bo(s);return`time(${c.seconds},${c.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?L(i.bytesValue).toBase64():"referenceValue"in i?Zt.fromName(i.referenceValue).toString():"geoPointValue"in i?`geo(${(e=i.geoPointValue).latitude},${e.longitude})`:"arrayValue"in i?function(s){let c="[",p=!0;for(const v of s.values||[])p?p=!1:c+=",",c+=wu(v);return c+"]"}(i.arrayValue):"mapValue"in i?function(s){const c=Object.keys(s.fields||{}).sort();let p="{",v=!0;for(const x of c)v?v=!1:p+=",",p+=`${x}:${wu(s.fields[x])}`;return p+"}"}(i.mapValue):S();var e}function Is(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function ba(i){return!!i&&"integerValue"in i}function go(i){return!!i&&"arrayValue"in i}function ta(i){return!!i&&"nullValue"in i}function Ba(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Ml(i){return!!i&&"mapValue"in i}function Qa(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&"object"==typeof i.timestampValue)return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return Ya(i.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Qa(s)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qa(i.arrayValue.values[t]);return e}return Object.assign({},i)}function nc(i){return"__max__"===(((i.mapValue||{}).fields||{}).__type__||{}).stringValue}function cl(i){return"nullValue"in i?ir:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?Is(Xe.empty(),Zt.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:S()}function Nl(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?Is(Xe.empty(),Zt.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?jn:S()}function rc(i,e){const t=ks(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function Pl(i,e){const t=ks(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}class ro{constructor(e){this.value=e}static empty(){return new ro({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Ml(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qa(t)}setAll(e){let t=hs.emptyPath(),s={},c=[];e.forEach((v,x)=>{if(!t.isImmediateParentOf(x)){const W=this.getFieldsMap(t);this.applyChanges(W,s,c),s={},c=[],t=x.popLast()}v?s[x.lastSegment()]=Qa(v):c.push(x.lastSegment())});const p=this.getFieldsMap(t);this.applyChanges(p,s,c)}delete(e){const t=this.field(e.popLast());Ml(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Jr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let c=t.mapValue.fields[e.get(s)];Ml(c)&&c.mapValue.fields||(c={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=c),t=c}return t.mapValue.fields}applyChanges(e,t,s){Ya(t,(c,p)=>e[c]=p);for(const c of s)delete e[c]}clone(){return new ro(Qa(this.value))}}function Hc(i){const e=[];return Ya(i.fields,(t,s)=>{const c=new hs([t]);if(Ml(s)){const p=Hc(s.mapValue).fields;if(0===p.length)e.push(c);else for(const v of p)e.push(c.child(v))}else e.push(c)}),new Wi(e)}class Fi{constructor(e,t,s,c,p,v){this.key=e,this.documentType=t,this.version=s,this.readTime=c,this.data=p,this.documentState=v}static newInvalidDocument(e){return new Fi(e,0,An.min(),An.min(),ro.empty(),0)}static newFoundDocument(e,t,s){return new Fi(e,1,t,An.min(),s,0)}static newNoDocument(e,t){return new Fi(e,2,t,An.min(),ro.empty(),0)}static newUnknownDocument(e,t){return new Fi(e,3,t,An.min(),ro.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ro.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ro.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=An.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Fi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fi(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class hh{constructor(e,t=null,s=[],c=[],p=null,v=null,x=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=c,this.limit=p,this.startAt=v,this.endAt=x,this.ut=null}}function dl(i,e=null,t=[],s=[],c=null,p=null,v=null){return new hh(i,e,t,s,c,p,v)}function su(i){const e=N(i);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>{return(c=s).field.canonicalString()+c.op.toString()+Fs(c.value);var c}).join(","),t+="|ob:",t+=e.orderBy.map(s=>{return(c=s).field.canonicalString()+c.dir;var c}).join(","),Ct(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>Fs(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>Fs(s)).join(",")),e.ut=t}return e.ut}function ou(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let c=0;c<i.orderBy.length;c++)if(!uu(i.orderBy[c],e.orderBy[c]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let c=0;c<i.filters.length;c++)if((t=i.filters[c]).op!==(s=e.filters[c]).op||!t.field.isEqual(s.field)||!Jr(t.value,s.value))return!1;var t,s;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!fl(i.startAt,e.startAt)&&fl(i.endAt,e.endAt)}function Da(i){return Zt.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length}function Ja(i,e){return i.filters.filter(t=>t instanceof Ls&&t.field.isEqual(e))}function ic(i,e,t){let s=ir,c=!0;for(const p of Ja(i,e)){let v=ir,x=!0;switch(p.op){case"<":case"<=":v=cl(p.value);break;case"==":case"in":case">=":v=p.value;break;case">":v=p.value,x=!1;break;case"!=":case"not-in":v=ir}rc({value:s,inclusive:c},{value:v,inclusive:x})<0&&(s=v,c=x)}if(null!==t)for(let p=0;p<i.orderBy.length;++p)if(i.orderBy[p].field.isEqual(e)){const v=t.position[p];rc({value:s,inclusive:c},{value:v,inclusive:t.inclusive})<0&&(s=v,c=t.inclusive);break}return{value:s,inclusive:c}}function Dd(i,e,t){let s=jn,c=!0;for(const p of Ja(i,e)){let v=jn,x=!0;switch(p.op){case">=":case">":v=Nl(p.value),x=!1;break;case"==":case"in":case"<=":v=p.value;break;case"<":v=p.value,x=!1;break;case"!=":case"not-in":v=jn}Pl({value:s,inclusive:c},{value:v,inclusive:x})>0&&(s=v,c=x)}if(null!==t)for(let p=0;p<i.orderBy.length;++p)if(i.orderBy[p].field.isEqual(e)){const v=t.position[p];Pl({value:s,inclusive:c},{value:v,inclusive:t.inclusive})>0&&(s=v,c=t.inclusive);break}return{value:s,inclusive:c}}class Ls extends class{}{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,s):new Iu(e,t,s):"array-contains"===t?new sc(e,s):"in"===t?new fh(e,s):"not-in"===t?new Sd(e,s):"array-contains-any"===t?new ph(e,s):new Ls(e,t,s)}static ct(e,t,s){return"in"===t?new Gc(e,s):new Td(e,s)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(ks(t,this.value)):null!==t&&_n(this.value)===_n(t)&&this.at(ks(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return S()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Iu extends Ls{constructor(e,t,s){super(e,t,s),this.key=Zt.fromName(s.referenceValue)}matches(e){const t=Zt.comparator(e.key,this.key);return this.at(t)}}class Gc extends Ls{constructor(e,t){super(e,"in",t),this.keys=qu(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Td extends Ls{constructor(e,t){super(e,"not-in",t),this.keys=qu(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function qu(i,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(s=>Zt.fromName(s.referenceValue))}class sc extends Ls{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return go(t)&&zs(t.arrayValue,this.value)}}class fh extends Ls{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&zs(this.value.arrayValue,t)}}class Sd extends Ls{constructor(e,t){super(e,"not-in",t)}matches(e){if(zs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!zs(this.value.arrayValue,t)}}class ph extends Ls{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!go(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>zs(this.value.arrayValue,s))}}class Xa{constructor(e,t){this.position=e,this.inclusive=t}}class au{constructor(e,t="asc"){this.field=e,this.dir=t}}function uu(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}function Cu(i,e,t){let s=0;for(let c=0;c<i.position.length;c++){const p=e[c],v=i.position[c];if(s=p.field.isKeyField()?Zt.comparator(Zt.fromName(v.referenceValue),t.key):ks(v,t.data.field(p.field)),"desc"===p.dir&&(s*=-1),0!==s)break}return s}function fl(i,e){if(null===i)return null===e;if(null===e||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Jr(i.position[t],e.position[t]))return!1;return!0}class Ks{constructor(e,t=null,s=[],c=[],p=null,v="F",x=null,W=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=c,this.limit=p,this.limitType=v,this.startAt=x,this.endAt=W,this.lt=null,this.ft=null}}function Ol(i,e,t,s,c,p,v,x){return new Ks(i,e,t,s,c,p,v,x)}function pl(i){return new Ks(i)}function gl(i){return i.explicitOrderBy.length>0?i.explicitOrderBy[0].field:null}function bu(i){for(const e of i.filters)if(e.ht())return e.field;return null}function Du(i){return null!==i.collectionGroup}function Zu(i){const e=N(i);if(null===e.lt){e.lt=[];const t=bu(e),s=gl(e);if(null!==t&&null===s)t.isKeyField()||e.lt.push(new au(t)),e.lt.push(new au(hs.keyField(),"asc"));else{let c=!1;for(const p of e.explicitOrderBy)e.lt.push(p),p.field.isKeyField()&&(c=!0);if(!c){const p=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new au(hs.keyField(),p))}}}return e.lt}function as(i){const e=N(i);if(!e.ft)if("F"===e.limitType)e.ft=dl(e.path,e.collectionGroup,Zu(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const p of Zu(e))t.push(new au(p.field,"desc"===p.dir?"asc":"desc"));const s=e.endAt?new Xa(e.endAt.position,e.endAt.inclusive):null,c=e.startAt?new Xa(e.startAt.position,e.startAt.inclusive):null;e.ft=dl(e.path,e.collectionGroup,t,e.filters,e.limit,s,c)}return e.ft}function Wc(i,e,t){return new Ks(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function oc(i,e){return ou(as(i),as(e))&&i.limitType===e.limitType}function ac(i){return`${su(as(i))}|lt:${i.limitType}`}function ga(i){return`Query(target=${function hl(i){let e=i.path.canonicalString();return null!==i.collectionGroup&&(e+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(e+=`, filters: [${i.filters.map(t=>{return`${(s=t).field.canonicalString()} ${s.op} ${Fs(s.value)}`;var s}).join(", ")}]`),Ct(i.limit)||(e+=", limit: "+i.limit),i.orderBy.length>0&&(e+=`, orderBy: [${i.orderBy.map(t=>{return`${(s=t).field.canonicalString()} (${s.dir})`;var s}).join(", ")}]`),i.startAt&&(e+=", startAt: ",e+=i.startAt.inclusive?"b:":"a:",e+=i.startAt.position.map(t=>Fs(t)).join(",")),i.endAt&&(e+=", endAt: ",e+=i.endAt.inclusive?"a:":"b:",e+=i.endAt.position.map(t=>Fs(t)).join(",")),`Target(${e})`}(as(i))}; limitType=${i.limitType})`}function jo(i,e){return e.isFoundDocument()&&function(t,s){const c=s.key.path;return null!==t.collectionGroup?s.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(c):Zt.isDocumentKey(t.path)?t.path.isEqual(c):t.path.isImmediateParentOf(c)}(i,e)&&function(t,s){for(const c of t.explicitOrderBy)if(!c.field.isKeyField()&&null===s.data.field(c.field))return!1;return!0}(i,e)&&function(t,s){for(const c of t.filters)if(!c.matches(s))return!1;return!0}(i,e)&&(s=e,!((t=i).startAt&&!function(c,p,v){const x=Cu(c,p,v);return c.inclusive?x<=0:x<0}(t.startAt,Zu(t),s)||t.endAt&&!function(c,p,v){const x=Cu(c,p,v);return c.inclusive?x>=0:x>0}(t.endAt,Zu(t),s)));var t,s}function Ta(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function Tu(i){return(e,t)=>{let s=!1;for(const c of Zu(i)){const p=zc(c,e,t);if(0!==p)return p;s=s||c.field.isKeyField()}return 0}}function zc(i,e,t){const s=i.field.isKeyField()?Zt.comparator(e.key,t.key):function(c,p,v){const x=p.data.field(c),W=v.data.field(c);return null!==x&&null!==W?ks(x,W):S()}(i.field,e,t);switch(i.dir){case"asc":return s;case"desc":return-1*s;default:return S()}}function kl(i,e){if(i.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ot(e)?"-0":e}}function Kc(i){return{integerValue:""+i}}function mh(i,e){return Nn(e)?Kc(e):kl(i,e)}class ml{constructor(){this._=void 0}}function uc(i,e,t){return i instanceof Su?function(s,c){const p={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return c&&(p.fields.__previous_value__=c),{mapValue:p}}(t,e):i instanceof Au?cc(i,e):i instanceof xu?dc(i,e):function(s,c){const p=Yu(s,c),v=hc(p)+hc(s._t);return ba(p)&&ba(s._t)?Kc(v):kl(s.wt,v)}(i,e)}function lc(i,e,t){return i instanceof Au?cc(i,e):i instanceof xu?dc(i,e):t}function Yu(i,e){return i instanceof Qu?ba(t=e)||(s=t)&&"doubleValue"in s?e:{integerValue:0}:null;var s,t}class Su extends ml{}class Au extends ml{constructor(e){super(),this.elements=e}}function cc(i,e){const t=Ad(e);for(const s of i.elements)t.some(c=>Jr(c,s))||t.push(s);return{arrayValue:{values:t}}}class xu extends ml{constructor(e){super(),this.elements=e}}function dc(i,e){let t=Ad(e);for(const s of i.elements)t=t.filter(c=>!Jr(c,s));return{arrayValue:{values:t}}}class Qu extends ml{constructor(e,t){super(),this.wt=e,this._t=t}}function hc(i){return Ai(i.integerValue||i.doubleValue)}function Ad(i){return go(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class Ju{constructor(e,t){this.field=e,this.transform=t}}class qc{constructor(e,t){this.version=e,this.transformResults=t}}class zi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new zi}static exists(e){return new zi(void 0,e)}static updateTime(e){return new zi(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _l(i,e){return void 0!==i.updateTime?e.isFoundDocument()&&e.version.isEqual(i.updateTime):void 0===i.exists||i.exists===e.isFoundDocument()}class xi{}function xd(i,e){if(!i.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return i.isNoDocument()?new tl(i.key,zi.none()):new lu(i.key,i.data,zi.none());{const t=i.data,s=ro.empty();let c=new Sr(hs.comparator);for(let p of e.fields)if(!c.has(p)){let v=t.field(p);null===v&&p.length>1&&(p=p.popLast(),v=t.field(p)),null===v?s.delete(p):s.set(p,v),c=c.add(p)}return new cu(i.key,s,new Wi(c.toArray()),zi.none())}}function Xu(i,e,t){i instanceof lu?function(s,c,p){const v=s.value.clone(),x=vl(s.fieldTransforms,c,p.transformResults);v.setAll(x),c.convertToFoundDocument(p.version,v).setHasCommittedMutations()}(i,e,t):i instanceof cu?function(s,c,p){if(!_l(s.precondition,c))return void c.convertToUnknownDocument(p.version);const v=vl(s.fieldTransforms,c,p.transformResults),x=c.data;x.setAll(el(s)),x.setAll(v),c.convertToFoundDocument(p.version,x).setHasCommittedMutations()}(i,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function na(i,e,t,s){return i instanceof lu?function(c,p,v,x){if(!_l(c.precondition,p))return v;const W=c.value.clone(),Z=Rd(c.fieldTransforms,x,p);return W.setAll(Z),p.convertToFoundDocument(p.version,W).setHasLocalMutations(),null}(i,e,t,s):i instanceof cu?function(c,p,v,x){if(!_l(c.precondition,p))return v;const W=Rd(c.fieldTransforms,x,p),Z=p.data;return Z.setAll(el(c)),Z.setAll(W),p.convertToFoundDocument(p.version,Z).setHasLocalMutations(),null===v?null:v.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(se=>se.field))}(i,e,t,s):(v=t,_l(i.precondition,p=e)?(p.convertToNoDocument(p.version).setHasLocalMutations(),null):v);var p,v}function Zc(i,e){let t=null;for(const s of i.fieldTransforms){const c=e.data.field(s.field),p=Yu(s.transform,c||null);null!=p&&(null===t&&(t=ro.empty()),t.set(s.field,p))}return t||null}function fc(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&(s=e.fieldTransforms,!!(void 0===(t=i.fieldTransforms)&&void 0===s||t&&s&&wo(t,s,(c,p)=>function yl(i,e){return i.field.isEqual(e.field)&&(s=e.transform,(t=i.transform)instanceof Au&&s instanceof Au||t instanceof xu&&s instanceof xu?wo(t.elements,s.elements,Jr):t instanceof Qu&&s instanceof Qu?Jr(t._t,s._t):t instanceof Su&&s instanceof Su);var t,s}(c,p))))&&(0===i.type?i.value.isEqual(e.value):1!==i.type||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask));var t,s}class lu extends xi{constructor(e,t,s,c=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=c,this.type=0}getFieldMask(){return null}}class cu extends xi{constructor(e,t,s,c,p=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=c,this.fieldTransforms=p,this.type=1}getFieldMask(){return this.fieldMask}}function el(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=i.data.field(t);e.set(t,s)}}),e}function vl(i,e,t){const s=new Map;D(i.length===t.length);for(let c=0;c<t.length;c++){const p=i[c],v=p.transform,x=e.data.field(p.field);s.set(p.field,lc(v,x,t[c]))}return s}function Rd(i,e,t){const s=new Map;for(const c of i){const p=c.transform,v=t.data.field(c.field);s.set(c.field,uc(p,v,e))}return s}class tl extends xi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ru extends xi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class io{constructor(e){this.count=e}}var Ji,kr;function pc(i){switch(i){default:return S();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function qs(i){if(void 0===i)return ai("GRPC error has no .code"),P.UNKNOWN;switch(i){case Ji.OK:return P.OK;case Ji.CANCELLED:return P.CANCELLED;case Ji.UNKNOWN:return P.UNKNOWN;case Ji.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Ji.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Ji.INTERNAL:return P.INTERNAL;case Ji.UNAVAILABLE:return P.UNAVAILABLE;case Ji.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Ji.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Ji.NOT_FOUND:return P.NOT_FOUND;case Ji.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Ji.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Ji.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Ji.ABORTED:return P.ABORTED;case Ji.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Ji.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Ji.DATA_LOSS:return P.DATA_LOSS;default:return S()}}(kr=Ji||(Ji={}))[kr.OK=0]="OK",kr[kr.CANCELLED=1]="CANCELLED",kr[kr.UNKNOWN=2]="UNKNOWN",kr[kr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kr[kr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kr[kr.NOT_FOUND=5]="NOT_FOUND",kr[kr.ALREADY_EXISTS=6]="ALREADY_EXISTS",kr[kr.PERMISSION_DENIED=7]="PERMISSION_DENIED",kr[kr.UNAUTHENTICATED=16]="UNAUTHENTICATED",kr[kr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kr[kr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kr[kr.ABORTED=10]="ABORTED",kr[kr.OUT_OF_RANGE=11]="OUT_OF_RANGE",kr[kr.UNIMPLEMENTED=12]="UNIMPLEMENTED",kr[kr.INTERNAL=13]="INTERNAL",kr[kr.UNAVAILABLE=14]="UNAVAILABLE",kr[kr.DATA_LOSS=15]="DATA_LOSS";class Do{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(void 0!==s)for(const[c,p]of s)if(this.equalsFn(c,e))return p}has(e){return void 0!==this.get(e)}set(e,t){const s=this.mapKeyFn(e),c=this.inner[s];if(void 0===c)return this.inner[s]=[[e,t]],void this.innerSize++;for(let p=0;p<c.length;p++)if(this.equalsFn(c[p][0],e))return void(c[p]=[e,t]);c.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(void 0===s)return!1;for(let c=0;c<s.length;c++)if(this.equalsFn(s[c][0],e))return 1===s.length?delete this.inner[t]:s.splice(c,1),this.innerSize--,!0;return!1}forEach(e){Ya(this.inner,(t,s)=>{for(const[c,p]of s)e(c,p)})}isEmpty(){return Ua(this.inner)}size(){return this.innerSize}}const gc=new Oi(Zt.comparator);function $o(){return gc}const Fl=new Oi(Zt.comparator);function nl(...i){let e=Fl;for(const t of i)e=e.insert(t.key,t);return e}function Ho(i){let e=Fl;return i.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Ii(){return ma()}function El(){return ma()}function ma(){return new Do(i=>i.toString(),(i,e)=>i.isEqual(e))}const wl=new Oi(Zt.comparator),ra=new Sr(Zt.comparator);function Kn(...i){let e=ra;for(const t of i)e=e.add(t);return e}const Yc=new Sr(Dn);function Ll(){return Yc}class Vs{constructor(e,t,s,c,p){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=c,this.resolvedLimboDocuments=p}static createSynthesizedRemoteEventForCurrentChange(e,t){const s=new Map;return s.set(e,Vl.createSynthesizedTargetChangeForCurrentChange(e,t)),new Vs(An.min(),s,Ll(),$o(),Kn())}}class Vl{constructor(e,t,s,c,p){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=c,this.removedDocuments=p}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Vl(ki.EMPTY_BYTE_STRING,t,Kn(),Kn(),Kn())}}class mc{constructor(e,t,s,c){this.gt=e,this.removedTargetIds=t,this.key=s,this.yt=c}}class Ul{constructor(e,t){this.targetId=e,this.It=t}}class yc{constructor(e,t,s=ki.EMPTY_BYTE_STRING,c=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=c}}class Qc{constructor(){this.Tt=0,this.Et=vc(),this.At=ki.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=Kn(),t=Kn(),s=Kn();return this.Et.forEach((c,p)=>{switch(p){case 0:e=e.add(c);break;case 2:t=t.add(c);break;case 1:s=s.add(c);break;default:S()}}),new Vl(this.At,this.Rt,e,t,s)}Dt(){this.bt=!1,this.Et=vc()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class ia{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=$o(),this.Bt=_c(),this.Lt=new Sr(Dn)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const s=this.Qt(t);switch(e.state){case 0:this.jt(t)&&s.Vt(e.resumeToken);break;case 1:s.kt(),s.Pt||s.Dt(),s.Vt(e.resumeToken);break;case 2:s.kt(),s.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(s.Ot(),s.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),s.Vt(e.resumeToken));break;default:S()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((s,c)=>{this.jt(c)&&t(c)})}zt(e){const t=e.targetId,s=e.It.count,c=this.Ht(t);if(c){const p=c.target;if(Da(p))if(0===s){const v=new Zt(p.path);this.Kt(t,v,Fi.newNoDocument(v,An.min()))}else D(1===s);else this.Jt(t)!==s&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((p,v)=>{const x=this.Ht(v);if(x){if(p.current&&Da(x.target)){const W=new Zt(x.target.path);null!==this.$t.get(W)||this.Xt(v,W)||this.Kt(v,W,Fi.newNoDocument(W,e))}p.vt&&(t.set(v,p.St()),p.Dt())}});let s=Kn();this.Bt.forEach((p,v)=>{let x=!0;v.forEachWhile(W=>{const Z=this.Ht(W);return!Z||2===Z.purpose||(x=!1,!1)}),x&&(s=s.add(p))}),this.$t.forEach((p,v)=>v.setReadTime(e));const c=new Vs(e,t,this.Lt,this.$t,s);return this.$t=$o(),this.Bt=_c(),this.Lt=new Sr(Dn),c}qt(e,t){if(!this.jt(e))return;const s=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,s),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,s){if(!this.jt(e))return;const c=this.Qt(e);this.Xt(e,t)?c.Ct(t,1):c.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),s&&(this.$t=this.$t.insert(t,s))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new Qc,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new Sr(Dn),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||xt("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new Qc),this.Mt.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function _c(){return new Oi(Zt.comparator)}function vc(){return new Oi(Zt.comparator)}const Bl={asc:"ASCENDING",desc:"DESCENDING"},Sa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class du{constructor(e,t){this.databaseId=e,this.dt=t}}function Mu(i,e){return i.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ec(i,e){return i.dt?e.toBase64():e.toUint8Array()}function Md(i,e){return Mu(i,e.toTimestamp())}function Cs(i){return D(!!i),An.fromTimestamp(function(e){const t=bo(e);return new ui(t.seconds,t.nanos)}(i))}function wc(i,e){return(t=i,new Nr(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function Jc(i){const e=Nr.fromString(i);return D($l(e)),e}function Us(i,e){return wc(i.databaseId,e.path)}function Bs(i,e){const t=Jc(e);if(t.get(1)!==i.databaseId.projectId)throw new K(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new K(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new Zt(T(t))}function w(i,e){return wc(i.databaseId,e)}function f(i){const e=Jc(i);return 4===e.length?Nr.emptyPath():T(e)}function m(i){return new Nr(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function T(i){return D(i.length>4&&"documents"===i.get(4)),i.popFirst(5)}function z(i,e,t){return{name:Us(i,e),fields:t.value.mapValue.fields}}function re(i,e,t){const s=Bs(i,e.name),c=Cs(e.updateTime),p=new ro({mapValue:{fields:e.fields}}),v=Fi.newFoundDocument(s,c,p);return t&&v.setHasCommittedMutations(),t?v.setHasCommittedMutations():v}function Lt(i,e){let t;if(e instanceof lu)t={update:z(i,e.key,e.value)};else if(e instanceof tl)t={delete:Us(i,e.key)};else if(e instanceof cu)t={update:z(i,e.key,e.data),updateMask:Xc(e.fieldMask)};else{if(!(e instanceof Ru))return S();t={verify:Us(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(c,p){const v=p.transform;if(v instanceof Su)return{fieldPath:p.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(v instanceof Au)return{fieldPath:p.field.canonicalString(),appendMissingElements:{values:v.elements}};if(v instanceof xu)return{fieldPath:p.field.canonicalString(),removeAllFromArray:{values:v.elements}};if(v instanceof Qu)return{fieldPath:p.field.canonicalString(),increment:v._t};throw S()}(0,s))),e.precondition.isNone||(t.currentDocument=void 0!==(c=e.precondition).updateTime?{updateTime:Md(i,c.updateTime)}:void 0!==c.exists?{exists:c.exists}:S()),t;var c}function rn(i,e){const t=e.currentDocument?void 0!==(c=e.currentDocument).updateTime?zi.updateTime(Cs(c.updateTime)):void 0!==c.exists?zi.exists(c.exists):zi.none():zi.none(),s=e.updateTransforms?e.updateTransforms.map(c=>function(p,v){let x=null;"setToServerValue"in v?(D("REQUEST_TIME"===v.setToServerValue),x=new Su):"appendMissingElements"in v?x=new Au(v.appendMissingElements.values||[]):"removeAllFromArray"in v?x=new xu(v.removeAllFromArray.values||[]):"increment"in v?x=new Qu(p,v.increment):S();const W=hs.fromServerFormat(v.fieldPath);return new Ju(W,x)}(i,c)):[];var c;if(e.update){const c=Bs(i,e.update.name),p=new ro({mapValue:{fields:e.update.fields}});if(e.updateMask){const v=new Wi((e.updateMask.fieldPaths||[]).map(Z=>hs.fromServerFormat(Z)));return new cu(c,p,v,t,s)}return new lu(c,p,t,s)}if(e.delete){const c=Bs(i,e.delete);return new tl(c,t)}if(e.verify){const c=Bs(i,e.verify);return new Ru(c,t)}return S()}function xn(i,e){return{documents:[w(i,e.path)]}}function fs(i,e){const t={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(t.parent=w(i,s),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=w(i,s.popLast()),t.structuredQuery.from=[{collectionId:s.lastSegment()}]);const c=function(W){if(0===W.length)return;const Z=W.map(se=>function(we){if("=="===we.op){if(Ba(we.value))return{unaryFilter:{field:Pu(we.field),op:"IS_NAN"}};if(ta(we.value))return{unaryFilter:{field:Pu(we.field),op:"IS_NULL"}}}else if("!="===we.op){if(Ba(we.value))return{unaryFilter:{field:Pu(we.field),op:"IS_NOT_NAN"}};if(ta(we.value))return{unaryFilter:{field:Pu(we.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pu(we.field),op:Ic(we.op),value:we.value}}}(se));return 1===Z.length?Z[0]:{compositeFilter:{op:"AND",filters:Z}}}(e.filters);c&&(t.structuredQuery.where=c);const p=function(W){if(0!==W.length)return W.map(Z=>{return{field:Pu((se=Z).field),direction:Nu(se.dir)};var se})}(e.orderBy);p&&(t.structuredQuery.orderBy=p);const v=(Z=e.limit,i.dt||Ct(Z)?Z:{value:Z});var Z,x,W;return null!==v&&(t.structuredQuery.limit=v),e.startAt&&(t.structuredQuery.startAt={before:(x=e.startAt).inclusive,values:x.position}),e.endAt&&(t.structuredQuery.endAt={before:!(W=e.endAt).inclusive,values:W.position}),t}function sa(i){let e=f(i.parent);const t=i.structuredQuery,s=t.from?t.from.length:0;let c=null;if(s>0){D(1===s);const se=t.from[0];se.allDescendants?c=se.collectionId:e=e.child(se.collectionId)}let p=[];t.where&&(p=Nd(t.where));let v=[];t.orderBy&&(v=t.orderBy.map(se=>{return new au(Ou((we=se).field),function(st){switch(st){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(we.direction));var we}));let x=null;t.limit&&(x=function(se){let we;return we="object"==typeof se?se.value:se,Ct(we)?null:we}(t.limit));let W=null;var se;t.startAt&&(W=new Xa((se=t.startAt).values||[],!!se.before));let Z=null;return t.endAt&&(Z=function(se){return new Xa(se.values||[],!se.before)}(t.endAt)),Ol(e,c,v,p,x,"F",W,Z)}function Nd(i){return i?void 0!==i.unaryFilter?[Aa(i)]:void 0!==i.fieldFilter?[Cc(i)]:void 0!==i.compositeFilter?i.compositeFilter.filters.map(e=>Nd(e)).reduce((e,t)=>e.concat(t)):S():[]}function Nu(i){return Bl[i]}function Ic(i){return Sa[i]}function Pu(i){return{fieldPath:i.canonicalString()}}function Ou(i){return hs.fromServerFormat(i.fieldPath)}function Cc(i){return Ls.create(Ou(i.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return S()}}(i.fieldFilter.op),i.fieldFilter.value)}function Aa(i){switch(i.unaryFilter.op){case"IS_NAN":const e=Ou(i.unaryFilter.field);return Ls.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=Ou(i.unaryFilter.field);return Ls.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ou(i.unaryFilter.field);return Ls.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Ou(i.unaryFilter.field);return Ls.create(c,"!=",{nullValue:"NULL_VALUE"});default:return S()}}function Xc(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function $l(i){return i.length>=4&&"projects"===i.get(0)&&"databases"===i.get(2)}function To(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=td(e)),e=ed(i.get(t),e);return td(e)}function ed(i,e){let t=e;const s=i.length;for(let c=0;c<s;c++){const p=i.charAt(c);switch(p){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=p}}return t}function td(i){return i+"\x01\x01"}function hu(i){const e=i.length;if(D(e>=2),2===e)return D("\x01"===i.charAt(0)&&"\x01"===i.charAt(1)),Nr.emptyPath();const t=e-2,s=[];let c="";for(let p=0;p<e;){const v=i.indexOf("\x01",p);switch((v<0||v>t)&&S(),i.charAt(v+1)){case"\x01":const x=i.substring(p,v);let W;0===c.length?W=x:(c+=x,W=c,c=""),s.push(W);break;case"\x10":c+=i.substring(p,v),c+="\0";break;case"\x11":c+=i.substring(p,v+1);break;default:S()}p=v+2}return new Nr(s)}const Pd=["userId","batchId"];function nd(i,e){return[i,To(e)]}function Od(i,e,t){return[i,To(e),t]}const lf={},Ep=["prefixPath","collectionGroup","readTime","documentId"],cf=["prefixPath","collectionGroup","documentId"],wp=["collectionGroup","readTime","prefixPath","documentId"],Hl=["canonicalId","targetId"],df=["targetId","path"],hf=["path","targetId"],Ip=["collectionId","parent"],kd=["indexId","uid"],Cp=["uid","sequenceNumber"],ff=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pf=["indexId","uid","orderedDocumentKey"],gf=["userId","collectionPath","documentId"],yh=["userId","collectionPath","largestBatchId"],bp=["userId","collectionGroup","largestBatchId"],Fd=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ld=[...Fd,"documentOverlays"],_h=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Vd=_h,vh=[...Vd,"indexConfiguration","indexState","indexEntries"];class rd extends bd{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function js(i,e){const t=N(i);return no.N(t.ee,e)}class Eh{constructor(e,t,s,c){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=c}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let c=0;c<this.mutations.length;c++){const p=this.mutations[c];p.key.isEqual(e.key)&&Xu(p,e,s[c])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=na(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=na(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=El();return this.mutations.forEach(c=>{const p=e.get(c.key),v=p.overlayedDocument;let x=this.applyToLocalView(v,p.mutatedFields);x=t.has(c.key)?null:x;const W=xd(v,x);null!==W&&s.set(c.key,W),v.isValidDocument()||v.convertToNoDocument(An.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Kn())}isEqual(e){return this.batchId===e.batchId&&wo(this.mutations,e.mutations,(t,s)=>fc(t,s))&&wo(this.baseMutations,e.baseMutations,(t,s)=>fc(t,s))}}class Ud{constructor(e,t,s,c){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=c}static from(e,t,s){D(e.mutations.length===s.length);let c=wl;const p=e.mutations;for(let v=0;v<p.length;v++)c=c.insert(p[v].key,s[v].version);return new Ud(e,t,s,c)}}class ku{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ps{constructor(e,t,s,c,p=An.min(),v=An.min(),x=ki.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=c,this.snapshotVersion=p,this.lastLimboFreeSnapshotVersion=v,this.resumeToken=x}withSequenceNumber(e){return new ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class ya{constructor(e){this.ne=e}}function wh(i,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Ih(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document={name:Us(c=i.ne,(p=e).key),fields:p.data.value.mapValue.fields,updateTime:Mu(c,p.version.toTimestamp())};else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Il(e.version)};else{if(!e.isUnknownDocument())return S();s.unknownDocument={path:t.path.toArray(),version:Il(e.version)}}var c,p;return s}function Ih(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function Il(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Wl(i){const e=new ui(i.seconds,i.nanoseconds);return An.fromTimestamp(e)}function _a(i,e){const t=(e.baseMutations||[]).map(p=>rn(i.ne,p));for(let p=0;p<e.mutations.length-1;++p){const v=e.mutations[p];p+1<e.mutations.length&&void 0!==e.mutations[p+1].transform&&(v.updateTransforms=e.mutations[p+1].transform.fieldTransforms,e.mutations.splice(p+1,1),++p)}const s=e.mutations.map(p=>rn(i.ne,p)),c=ui.fromMillis(e.localWriteTimeMs);return new Eh(e.batchId,c,t,s)}function id(i){const e=Wl(i.readTime),t=void 0!==i.lastLimboFreeSnapshotVersion?Wl(i.lastLimboFreeSnapshotVersion):An.min();let s;var c;return void 0!==i.query.documents?(D(1===(c=i.query).documents.length),s=as(pl(f(c.documents[0])))):s=as(sa(i.query)),new ps(s,i.targetId,0,i.lastListenSequenceNumber,e,t,ki.fromBase64String(i.resumeToken))}function mf(i,e){const t=Il(e.snapshotVersion),s=Il(e.lastLimboFreeSnapshotVersion);let c;c=Da(e.target)?xn(i.ne,e.target):fs(i.ne,e.target);const p=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:su(e.target),readTime:t,resumeToken:p,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:c}}function ja(i){const e=sa({parent:i.parent,structuredQuery:i.structuredQuery});return"LAST"===i.limitType?Wc(e,e.limit,"L"):e}function Ch(i,e){return new ku(e.largestBatchId,rn(i.ne,e.overlayMutation))}function Bd(i,e){const t=e.path.lastSegment();return[i,To(e.path.popLast()),t]}function bh(i,e,t,s){return{indexId:i,uid:e.uid||"",sequenceNumber:t,readTime:Il(s.readTime),documentKey:To(s.documentKey.path),largestBatchId:s.largestBatchId}}class yf{getBundleMetadata(e,t){return Dh(e).get(t).next(s=>{if(s)return{id:(c=s).bundleId,createTime:Wl(c.createTime),version:c.version};var c})}saveBundleMetadata(e,t){return Dh(e).put({bundleId:(s=t).id,createTime:Il(Cs(s.createTime)),version:s.version});var s}getNamedQuery(e,t){return bc(e).get(t).next(s=>{if(s)return{name:(c=s).name,query:ja(c.bundledQuery),readTime:Wl(c.readTime)};var c})}saveNamedQuery(e,t){return bc(e).put({name:(s=t).name,readTime:Il(Cs(s.readTime)),bundledQuery:s.bundledQuery});var s}}function Dh(i){return js(i,"bundles")}function bc(i){return js(i,"namedQueries")}class sd{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new sd(e,t.uid||"")}getOverlay(e,t){return Dc(e).get(Bd(this.userId,t)).next(s=>s?Ch(this.wt,s):null)}getOverlays(e,t){const s=Ii();return Qe.forEach(t,c=>this.getOverlay(e,c).next(p=>{null!==p&&s.set(c,p)})).next(()=>s)}saveOverlays(e,t,s){const c=[];return s.forEach((p,v)=>{const x=new ku(t,v);c.push(this.ie(e,x))}),Qe.waitFor(c)}removeOverlaysForBatchId(e,t,s){const c=new Set;t.forEach(v=>c.add(To(v.getCollectionPath())));const p=[];return c.forEach(v=>{const x=IDBKeyRange.bound([this.userId,v,s],[this.userId,v,s+1],!1,!0);p.push(Dc(e).W("collectionPathOverlayIndex",x))}),Qe.waitFor(p)}getOverlaysForCollection(e,t,s){const c=Ii(),p=To(t),v=IDBKeyRange.bound([this.userId,p,s],[this.userId,p,Number.POSITIVE_INFINITY],!0);return Dc(e).K("collectionPathOverlayIndex",v).next(x=>{for(const W of x){const Z=Ch(this.wt,W);c.set(Z.getKey(),Z)}return c})}getOverlaysForCollectionGroup(e,t,s,c){const p=Ii();let v;const x=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dc(e).J({index:"collectionGroupOverlayIndex",range:x},(W,Z,se)=>{const we=Ch(this.wt,Z);p.size()<c||we.largestBatchId===v?(p.set(we.getKey(),we),v=we.largestBatchId):se.done()}).next(()=>p)}ie(e,t){return Dc(e).put(function(s,c,p){const[v,x,W]=Bd(c,p.mutation.key);return{userId:c,collectionPath:x,documentId:W,collectionGroup:p.mutation.key.getCollectionGroup(),largestBatchId:p.largestBatchId,overlayMutation:Lt(s.ne,p.mutation)}}(this.wt,this.userId,t))}}function Dc(i){return js(i,"documentOverlays")}class zl{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(Ai(e.integerValue));else if("doubleValue"in e){const s=Ai(e.doubleValue);isNaN(s)?this.ce(t,13):(this.ce(t,15),Ot(s)?t.ae(0):t.ae(s))}else if("timestampValue"in e){const s=e.timestampValue;this.ce(t,20),"string"==typeof s?t.he(s):(t.he(`${s.seconds||""}`),t.ae(s.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(L(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.ce(t,45),t.ae(s.latitude||0),t.ae(s.longitude||0)}else"mapValue"in e?nc(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):S()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const s=e.fields||{};this.ce(t,55);for(const c of Object.keys(s))this.le(c,t),this.oe(s[c],t)}me(e,t){const s=e.values||[];this.ce(t,50);for(const c of s)this.oe(c,t)}_e(e,t){this.ce(t,37),Zt.fromName(e).path.forEach(s=>{this.ce(t,60),this.ge(s,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function Dp(i){if(0===i)return 8;let e=0;return i>>4==0&&(e+=4,i<<=4),i>>6==0&&(e+=2,i<<=2),i>>7==0&&(e+=1),e}function dr(i){const e=64-function(t){let s=0;for(let c=0;c<8;++c){const p=Dp(255&t[c]);if(s+=p,8!==p)break}return s}(i);return Math.ceil(e/8)}zl.ye=new zl;class Th{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Ie(s.value),s=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Ae(s.value),s=t.next();this.Re()}be(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Ie(s);else if(s<2048)this.Ie(960|s>>>6),this.Ie(128|63&s);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s);else{const c=t.codePointAt(0);this.Ie(240|c>>>18),this.Ie(128|63&c>>>12),this.Ie(128|63&c>>>6),this.Ie(128|63&c)}}this.Te()}Pe(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Ae(s);else if(s<2048)this.Ae(960|s>>>6),this.Ae(128|63&s);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s);else{const c=t.codePointAt(0);this.Ae(240|c>>>18),this.Ae(128|63&c>>>12),this.Ae(128|63&c>>>6),this.Ae(128|63&c)}}this.Re()}ve(e){const t=this.Ve(e),s=dr(t);this.Se(1+s),this.buffer[this.position++]=255&s;for(let c=t.length-s;c<t.length;++c)this.buffer[this.position++]=255&t[c]}De(e){const t=this.Ve(e),s=dr(t);this.Se(1+s),this.buffer[this.position++]=~(255&s);for(let c=t.length-s;c<t.length;++c)this.buffer[this.position++]=~(255&t[c])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(c){const p=new DataView(new ArrayBuffer(8));return p.setFloat64(0,c,!1),new Uint8Array(p.buffer)}(e),s=0!=(128&t[0]);t[0]^=s?255:128;for(let c=1;c<t.length;++c)t[c]^=s?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const c=new Uint8Array(s);c.set(this.buffer),this.buffer=c}}class Sh{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class _f{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class Cl{constructor(){this.Me=new Th,this.Fe=new Sh(this.Me),this.$e=new _f(this.Me)}seed(e){this.Me.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}class Go{constructor(e,t,s,c){this.indexId=e,this.documentKey=t,this.arrayValue=s,this.directionalValue=c}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,s=new Uint8Array(t);return s.set(this.directionalValue,0),t!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new Go(this.indexId,this.documentKey,this.arrayValue,s)}}function rl(i,e){let t=i.indexId-e.indexId;return 0!==t?t:(t=vf(i.arrayValue,e.arrayValue),0!==t?t:(t=vf(i.directionalValue,e.directionalValue),0!==t?t:Zt.comparator(i.documentKey,e.documentKey)))}function vf(i,e){for(let t=0;t<i.length&&t<e.length;++t){const s=i[t]-e[t];if(0!==s)return s}return i.length-e.length}class Ah{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const s=t;s.ht()?this.Ke=s:this.qe.push(s)}}Ge(e){const t=Wu(e);if(void 0!==t&&!this.Qe(t))return!1;const s=La(e);let c=0,p=0;for(;c<s.length&&this.Qe(s[c]);++c);if(c===s.length)return!0;if(void 0!==this.Ke){const v=s[c];if(!this.je(this.Ke,v)||!this.We(this.Ue[p++],v))return!1;++c}for(;c<s.length;++c){const v=s[c];if(p>=this.Ue.length||!this.We(this.Ue[p++],v))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class Fu{constructor(){this.ze=new od}addToCollectionParentIndex(e,t){return this.ze.add(t),Qe.resolve()}getCollectionParents(e,t){return Qe.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return Qe.resolve()}deleteFieldIndex(e,t){return Qe.resolve()}getDocumentsMatchingTarget(e,t){return Qe.resolve(null)}getIndexType(e,t){return Qe.resolve(0)}getFieldIndexes(e,t){return Qe.resolve([])}getNextCollectionGroupToUpdate(e){return Qe.resolve(null)}getMinOffset(e,t){return Qe.resolve(jr.min())}getMinOffsetFromCollectionGroup(e,t){return Qe.resolve(jr.min())}updateCollectionGroup(e,t,s){return Qe.resolve()}updateIndexEntries(e,t){return Qe.resolve()}}class od{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),c=this.index[t]||new Sr(Nr.comparator),p=!c.has(s);return this.index[t]=c.add(s),p}has(e){const t=e.lastSegment(),s=e.popLast(),c=this.index[t];return c&&c.has(s)}getEntries(e){return(this.index[e]||new Sr(Nr.comparator)).toArray()}}const ad=new Uint8Array(0);class xh{constructor(e,t){this.user=e,this.databaseId=t,this.He=new od,this.Je=new Do(s=>su(s),(s,c)=>ou(s,c)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const s=t.lastSegment(),c=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const p={collectionId:s,parent:To(c)};return Ef(e).put(p)}return Qe.resolve()}getCollectionParents(e,t){const s=[],c=IDBKeyRange.bound([t,""],[Gu(t),""],!1,!0);return Ef(e).K(c).next(p=>{for(const v of p){if(v.collectionId!==t)break;s.push(hu(v.parent))}return s})}addFieldIndex(e,t){const s=d(e),c={indexId:(v=t).indexId,collectionGroup:v.collectionGroup,fields:v.fields.map(x=>[x.fieldPath.canonicalString(),x.kind])};var v;delete c.indexId;const p=s.add(c);if(t.indexState){const v=u(e);return p.next(x=>{v.put(bh(x,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return p.next()}deleteFieldIndex(e,t){const s=d(e),c=u(e),p=Tc(e);return s.delete(t.indexId).next(()=>c.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>p.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const s=Tc(e);let c=!0;const p=new Map;return Qe.forEach(this.Ye(t),v=>this.Xe(e,v).next(x=>{c&&(c=!!x),p.set(v,x)})).next(()=>{if(c){let v=Kn();const x=[];return Qe.forEach(p,(W,Z)=>{var se;xt("IndexedDbIndexManager",`Using index ${se=W,`id=${se.indexId}|cg=${se.collectionGroup}|f=${se.fields.map(yi=>`${yi.fieldPath}:${yi.kind}`).join(",")}`} to execute ${su(t)}`);const we=function(yi,So){const ms=Wu(So);if(void 0===ms)return null;for(const Zs of Ja(yi,ms.fieldPath))switch(Zs.op){case"array-contains-any":return Zs.value.arrayValue.values||[];case"array-contains":return[Zs.value]}return null}(Z,W),st=function(yi,So){const ms=new Map;for(const Zs of La(So))for(const va of Ja(yi,Zs.fieldPath))switch(va.op){case"==":case"in":ms.set(Zs.fieldPath.canonicalString(),va.value);break;case"not-in":case"!=":return ms.set(Zs.fieldPath.canonicalString(),va.value),Array.from(ms.values())}return null}(Z,W),Et=function(yi,So){const ms=[];let Zs=!0;for(const va of La(So)){const sf=0===va.kind?ic(yi,va.fieldPath,yi.startAt):Dd(yi,va.fieldPath,yi.startAt);ms.push(sf.value),Zs&&(Zs=sf.inclusive)}return new Xa(ms,Zs)}(Z,W),Nt=function(yi,So){const ms=[];let Zs=!0;for(const va of La(So)){const sf=0===va.kind?Dd(yi,va.fieldPath,yi.endAt):ic(yi,va.fieldPath,yi.endAt);ms.push(sf.value),Zs&&(Zs=sf.inclusive)}return new Xa(ms,Zs)}(Z,W),mn=this.Ze(W,Z,Et),Rn=this.Ze(W,Z,Nt),Ri=this.tn(W,Z,st),Ts=this.en(W.indexId,we,mn,Et.inclusive,Rn,Nt.inclusive,Ri);return Qe.forEach(Ts,yi=>s.j(yi,t.limit).next(So=>{So.forEach(ms=>{const Zs=Zt.fromSegments(ms.documentKey);v.has(Zs)||(v=v.add(Zs),x.push(Zs))})}))}).next(()=>x)}return Qe.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,s,c,p,v,x){const W=(null!=t?t.length:1)*Math.max(s.length,p.length),Z=W/(null!=t?t.length:1),se=[];for(let we=0;we<W;++we){const st=t?this.nn(t[we/Z]):ad,Et=this.sn(e,st,s[we%Z],c),Nt=this.rn(e,st,p[we%Z],v),mn=x.map(Rn=>this.sn(e,st,Rn,!0));se.push(...this.createRange(Et,Nt,mn))}return se}sn(e,t,s,c){const p=new Go(e,Zt.empty(),t,s);return c?p:p.Le()}rn(e,t,s,c){const p=new Go(e,Zt.empty(),t,s);return c?p.Le():p}Xe(e,t){const s=new Ah(t),c=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,c).next(p=>{let v=null;for(const x of p)s.Ge(x)&&(!v||x.fields.length>v.fields.length)&&(v=x);return v})}getIndexType(e,t){let s=2;return Qe.forEach(this.Ye(t),c=>this.Xe(e,c).next(p=>{p?0!==s&&p.fields.length<function(v){let x=new Sr(hs.comparator),W=!1;for(const Z of v.filters){const se=Z;se.field.isKeyField()||("array-contains"===se.op||"array-contains-any"===se.op?W=!0:x=x.add(se.field))}for(const Z of v.orderBy)Z.field.isKeyField()||(x=x.add(Z.field));return x.size+(W?1:0)}(c)&&(s=1):s=0})).next(()=>s)}on(e,t){const s=new Cl;for(const c of La(e)){const p=t.data.field(c.fieldPath);if(null==p)return null;const v=s.Be(c.kind);zl.ye.re(p,v)}return s.Oe()}nn(e){const t=new Cl;return zl.ye.re(e,t.Be(0)),t.Oe()}un(e,t){const s=new Cl;return zl.ye.re(Is(this.databaseId,t),s.Be(function(c){const p=La(c);return 0===p.length?0:p[p.length-1].kind}(e))),s.Oe()}tn(e,t,s){if(null===s)return[];let c=[];c.push(new Cl);let p=0;for(const v of La(e)){const x=s[p++];for(const W of c)if(this.cn(t,v.fieldPath)&&go(x))c=this.an(c,v,x);else{const Z=W.Be(v.kind);zl.ye.re(x,Z)}}return this.hn(c)}Ze(e,t,s){return this.tn(e,t,s.position)}hn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].Oe();return t}an(e,t,s){const c=[...e],p=[];for(const v of s.arrayValue.values||[])for(const x of c){const W=new Cl;W.seed(x.Oe()),zl.ye.re(v,W.Be(t.kind)),p.push(W)}return p}cn(e,t){return!!e.filters.find(s=>s instanceof Ls&&s.field.isEqual(t)&&("in"===s.op||"not-in"===s.op))}getFieldIndexes(e,t){const s=d(e),c=u(e);return(t?s.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):s.K()).next(p=>{const v=[];return Qe.forEach(p,x=>c.get([x.indexId,this.uid]).next(W=>{v.push(function(Z,se){const we=se?new al(se.sequenceNumber,new jr(Wl(se.readTime),new Zt(hu(se.documentKey)),se.largestBatchId)):al.empty(),st=Z.fields.map(([Et,Nt])=>new vu(hs.fromServerFormat(Et),Nt));return new Al(Z.indexId,Z.collectionGroup,st,we)}(x,W))})).next(()=>v)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((s,c)=>{const p=s.indexState.sequenceNumber-c.indexState.sequenceNumber;return 0!==p?p:Dn(s.collectionGroup,c.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const c=d(e),p=u(e);return this.ln(e).next(v=>c.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(x=>Qe.forEach(x,W=>p.put(bh(W.indexId,this.user,v,s)))))}updateIndexEntries(e,t){const s=new Map;return Qe.forEach(t,(c,p)=>{const v=s.get(c.collectionGroup);return(v?Qe.resolve(v):this.getFieldIndexes(e,c.collectionGroup)).next(x=>(s.set(c.collectionGroup,x),Qe.forEach(x,W=>this.fn(e,c,W).next(Z=>{const se=this.dn(p,W);return Z.isEqual(se)?Qe.resolve():this._n(e,p,W,Z,se)}))))})}wn(e,t,s,c){return Tc(e).put({indexId:c.indexId,uid:this.uid,arrayValue:c.arrayValue,directionalValue:c.directionalValue,orderedDocumentKey:this.un(s,t.key),documentKey:t.key.path.toArray()})}mn(e,t,s,c){return Tc(e).delete([c.indexId,this.uid,c.arrayValue,c.directionalValue,this.un(s,t.key),t.key.path.toArray()])}fn(e,t,s){const c=Tc(e);let p=new Sr(rl);return c.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.un(s,t)])},(v,x)=>{p=p.add(new Go(s.indexId,t,x.arrayValue,x.directionalValue))}).next(()=>p)}dn(e,t){let s=new Sr(rl);const c=this.on(t,e);if(null==c)return s;const p=Wu(t);if(null!=p){const v=e.data.field(p.fieldPath);if(go(v))for(const x of v.arrayValue.values||[])s=s.add(new Go(t.indexId,e.key,this.nn(x),c))}else s=s.add(new Go(t.indexId,e.key,ad,c));return s}_n(e,t,s,c,p){xt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const v=[];return function(x,W,Z,se,we){const st=x.getIterator(),Et=W.getIterator();let Nt=Ws(st),mn=Ws(Et);for(;Nt||mn;){let Rn=!1,Ri=!1;if(Nt&&mn){const Ts=Z(Nt,mn);Ts<0?Ri=!0:Ts>0&&(Rn=!0)}else null!=Nt?Ri=!0:Rn=!0;Rn?(se(mn),mn=Ws(Et)):Ri?(we(Nt),Nt=Ws(st)):(Nt=Ws(st),mn=Ws(Et))}}(c,p,rl,x=>{v.push(this.wn(e,t,s,x))},x=>{v.push(this.mn(e,t,s,x))}),Qe.waitFor(v)}ln(e){let t=1;return u(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,c,p)=>{p.done(),t=c.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((v,x)=>rl(v,x)).filter((v,x,W)=>!x||0!==rl(v,W[x-1]));const c=[];c.push(e);for(const v of s){const x=rl(v,e),W=rl(v,t);if(0===x)c[0]=e.Le();else if(x>0&&W<0)c.push(v),c.push(v.Le());else if(W>0)break}c.push(t);const p=[];for(let v=0;v<c.length;v+=2)p.push(IDBKeyRange.bound([c[v].indexId,this.uid,c[v].arrayValue,c[v].directionalValue,ad,[]],[c[v+1].indexId,this.uid,c[v+1].arrayValue,c[v+1].directionalValue,ad,[]]));return p}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(l)}getMinOffset(e,t){return Qe.mapArray(this.Ye(t),s=>this.Xe(e,s).next(c=>c||S())).next(l)}}function Ef(i){return js(i,"collectionParents")}function Tc(i){return js(i,"indexEntries")}function d(i){return js(i,"indexConfiguration")}function u(i){return js(i,"indexState")}function l(i){D(0!==i.length);let e=i[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<i.length;s++){const c=i[s].indexState.offset;zu(c,e)<0&&(e=c),t<c.largestBatchId&&(t=c.largestBatchId)}return new jr(e.readTime,e.documentKey,t)}const g={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class I{constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new I(e,I.DEFAULT_COLLECTION_PERCENTILE,I.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function M(i,e,t){const s=i.store("mutations"),c=i.store("documentMutations"),p=[],v=IDBKeyRange.only(t.batchId);let x=0;const W=s.J({range:v},(se,we,st)=>(x++,st.delete()));p.push(W.next(()=>{D(1===x)}));const Z=[];for(const se of t.mutations){const we=Od(e,se.key.path,t.batchId);p.push(c.delete(we)),Z.push(se.key)}return Qe.waitFor(p).next(()=>Z)}function H(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw S();e=i.noDocument}return JSON.stringify(e).length}I.DEFAULT_COLLECTION_PERCENTILE=10,I.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,I.DEFAULT=new I(41943040,I.DEFAULT_COLLECTION_PERCENTILE,I.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),I.DISABLED=new I(-1,0,0);class ee{constructor(e,t,s,c){this.userId=e,this.wt=t,this.indexManager=s,this.referenceDelegate=c,this.gn={}}static se(e,t,s,c){D(""!==e.uid);const p=e.isAuthenticated()?e.uid:"";return new ee(p,t,s,c)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ve(e).J({index:"userMutationsIndex",range:s},(c,p,v)=>{t=!1,v.done()}).next(()=>t)}addMutationBatch(e,t,s,c){const p=et(e),v=ve(e);return v.add({}).next(x=>{D("number"==typeof x);const W=new Eh(x,t,s,c),Z=function(st,Et,Nt){const mn=Nt.baseMutations.map(Ri=>Lt(st.ne,Ri)),Rn=Nt.mutations.map(Ri=>Lt(st.ne,Ri));return{userId:Et,batchId:Nt.batchId,localWriteTimeMs:Nt.localWriteTime.toMillis(),baseMutations:mn,mutations:Rn}}(this.wt,this.userId,W),se=[];let we=new Sr((st,Et)=>Dn(st.canonicalString(),Et.canonicalString()));for(const st of c){const Et=Od(this.userId,st.key.path,x);we=we.add(st.key.path.popLast()),se.push(v.put(Z)),se.push(p.put(Et,lf))}return we.forEach(st=>{se.push(this.indexManager.addToCollectionParentIndex(e,st))}),e.addOnCommittedListener(()=>{this.gn[x]=W.keys()}),Qe.waitFor(se).next(()=>W)})}lookupMutationBatch(e,t){return ve(e).get(t).next(s=>s?(D(s.userId===this.userId),_a(this.wt,s)):null)}yn(e,t){return this.gn[t]?Qe.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const c=s.keys();return this.gn[t]=c,c}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,c=IDBKeyRange.lowerBound([this.userId,s]);let p=null;return ve(e).J({index:"userMutationsIndex",range:c},(v,x,W)=>{x.userId===this.userId&&(D(x.batchId>=s),p=_a(this.wt,x)),W.done()}).next(()=>p)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return ve(e).J({index:"userMutationsIndex",range:t,reverse:!0},(c,p,v)=>{s=p.batchId,v.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ve(e).K("userMutationsIndex",t).next(s=>s.map(c=>_a(this.wt,c)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=nd(this.userId,t.path),c=IDBKeyRange.lowerBound(s),p=[];return et(e).J({range:c},(v,x,W)=>{const[Z,se,we]=v,st=hu(se);if(Z===this.userId&&t.path.isEqual(st))return ve(e).get(we).next(Et=>{if(!Et)throw S();D(Et.userId===this.userId),p.push(_a(this.wt,Et))});W.done()}).next(()=>p)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Sr(Dn);const c=[];return t.forEach(p=>{const v=nd(this.userId,p.path),x=IDBKeyRange.lowerBound(v),W=et(e).J({range:x},(Z,se,we)=>{const[st,Et,Nt]=Z,mn=hu(Et);st===this.userId&&p.path.isEqual(mn)?s=s.add(Nt):we.done()});c.push(W)}),Qe.waitFor(c).next(()=>this.pn(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,c=s.length+1,p=nd(this.userId,s),v=IDBKeyRange.lowerBound(p);let x=new Sr(Dn);return et(e).J({range:v},(W,Z,se)=>{const[we,st,Et]=W,Nt=hu(st);we===this.userId&&s.isPrefixOf(Nt)?Nt.length===c&&(x=x.add(Et)):se.done()}).next(()=>this.pn(e,x))}pn(e,t){const s=[],c=[];return t.forEach(p=>{c.push(ve(e).get(p).next(v=>{if(null===v)throw S();D(v.userId===this.userId),s.push(_a(this.wt,v))}))}),Qe.waitFor(c).next(()=>s)}removeMutationBatch(e,t){return M(e.ee,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),Qe.forEach(s,c=>this.referenceDelegate.markPotentiallyOrphaned(e,c))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Qe.resolve();const s=IDBKeyRange.lowerBound([this.userId]),c=[];return et(e).J({range:s},(p,v,x)=>{if(p[0]===this.userId){const W=hu(p[1]);c.push(W)}else x.done()}).next(()=>{D(0===c.length)})})}containsKey(e,t){return ue(e,this.userId,t)}Tn(e){return lt(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function ue(i,e,t){const s=nd(e,t.path),c=s[1],p=IDBKeyRange.lowerBound(s);let v=!1;return et(i).J({range:p,H:!0},(x,W,Z)=>{const[se,we,st]=x;se===e&&we===c&&(v=!0),Z.done()}).next(()=>v)}function ve(i){return js(i,"mutations")}function et(i){return js(i,"documentMutations")}function lt(i){return js(i,"mutationQueues")}class bt{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new bt(0)}static Rn(){return new bt(-1)}}class In{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const s=new bt(t.highestTargetId);return t.highestTargetId=s.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>An.fromTimestamp(new ui(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.bn(e).next(c=>(c.highestListenSequenceNumber=t,s&&(c.lastRemoteSnapshotVersion=s.toTimestamp()),t>c.highestListenSequenceNumber&&(c.highestListenSequenceNumber=t),this.Pn(e,c)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(s=>(s.targetCount+=1,this.Vn(t,s),this.Pn(e,s))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Fn(e).delete(t.targetId)).next(()=>this.bn(e)).next(s=>(D(s.targetCount>0),s.targetCount-=1,this.Pn(e,s)))}removeTargets(e,t,s){let c=0;const p=[];return Fn(e).J((v,x)=>{const W=id(x);W.sequenceNumber<=t&&null===s.get(W.targetId)&&(c++,p.push(this.removeTargetData(e,W)))}).next(()=>Qe.waitFor(p)).next(()=>c)}forEachTarget(e,t){return Fn(e).J((s,c)=>{const p=id(c);t(p)})}bn(e){return li(e).get("targetGlobalKey").next(t=>(D(null!==t),t))}Pn(e,t){return li(e).put("targetGlobalKey",t)}vn(e,t){return Fn(e).put(mf(this.wt,t))}Vn(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const s=su(t),c=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let p=null;return Fn(e).J({range:c,index:"queryTargetsIndex"},(v,x,W)=>{const Z=id(x);ou(t,Z.target)&&(p=Z,W.done())}).next(()=>p)}addMatchingKeys(e,t,s){const c=[],p=Xi(e);return t.forEach(v=>{const x=To(v.path);c.push(p.put({targetId:s,path:x})),c.push(this.referenceDelegate.addReference(e,s,v))}),Qe.waitFor(c)}removeMatchingKeys(e,t,s){const c=Xi(e);return Qe.forEach(t,p=>{const v=To(p.path);return Qe.waitFor([c.delete([s,v]),this.referenceDelegate.removeReference(e,s,p)])})}removeMatchingKeysForTargetId(e,t){const s=Xi(e),c=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(c)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),c=Xi(e);let p=Kn();return c.J({range:s,H:!0},(v,x,W)=>{const Z=hu(v[1]),se=new Zt(Z);p=p.add(se)}).next(()=>p)}containsKey(e,t){const s=To(t.path),c=IDBKeyRange.bound([s],[Gu(s)],!1,!0);let p=0;return Xi(e).J({index:"documentTargetsIndex",H:!0,range:c},([v,x],W,Z)=>{0!==v&&(p++,Z.done())}).next(()=>p>0)}te(e,t){return Fn(e).get(t).next(s=>s?id(s):null)}}function Fn(i){return js(i,"targets")}function li(i){return js(i,"targetGlobal")}function Xi(i){return js(i,"targetDocuments")}function bl([i,e],[t,s]){const c=Dn(i,t);return 0===c?Dn(e,s):c}class fu{constructor(e){this.Sn=e,this.buffer=new Sr(bl),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();bl(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ud{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;xt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,De.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(s){Co(s)?xt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",s):yield Ia(s)}yield t.kn(3e5)}))}}class nm{constructor(e,t){this.On=e,this.params=t}calculateTargetCount(e,t){return this.On.Mn(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(0===t)return Qe.resolve(os.ot);const s=new fu(t);return this.On.forEachTarget(e,c=>s.xn(c.sequenceNumber)).next(()=>this.On.Fn(e,c=>s.xn(c))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.On.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.On.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(xt("LruGarbageCollector","Garbage collection skipped; disabled"),Qe.resolve(g)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(xt("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),g):this.$n(e,t))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,t){let s,c,p,v,x,W,Z;const se=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(we=>(we>this.params.maximumSequenceNumbersToCollect?(xt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${we}`),c=this.params.maximumSequenceNumbersToCollect):c=we,v=Date.now(),this.nthSequenceNumber(e,c))).next(we=>(s=we,x=Date.now(),this.removeTargets(e,s,t))).next(we=>(p=we,W=Date.now(),this.removeOrphanedDocuments(e,s))).next(we=>(Z=Date.now(),Qo()<=xe.in.DEBUG&&xt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${v-se}ms\n\tDetermined least recently used ${c} in `+(x-v)+`ms\n\tRemoved ${p} targets in `+(W-x)+`ms\n\tRemoved ${we} documents in `+(Z-W)+`ms\nTotal Duration: ${Z-se}ms`),Qe.resolve({didRun:!0,sequenceNumbersCollected:c,targetsRemoved:p,documentsRemoved:we})))}}class n0{constructor(e,t){this.db=e,this.garbageCollector=new nm(this,t)}Mn(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(c=>s+c))}Bn(e){let t=0;return this.Fn(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(s,c)=>t(c))}addReference(e,t,s){return Tp(e,s)}removeReference(e,t,s){return Tp(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Tp(e,t)}Un(e,t){return function(s,c){let p=!1;return lt(s).Y(v=>ue(s,v,c).next(x=>(x&&(p=!0),Qe.resolve(!x)))).next(()=>p)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),c=[];let p=0;return this.Ln(e,(v,x)=>{if(x<=t){const W=this.Un(e,v).next(Z=>{if(!Z)return p++,s.getEntry(e,v).next(()=>(s.removeEntry(v,An.min()),Xi(e).delete([0,To(v.path)])))});c.push(W)}}).next(()=>Qe.waitFor(c)).next(()=>s.apply(e)).next(()=>p)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Tp(e,t)}Ln(e,t){const s=Xi(e);let c,p=os.ot;return s.J({index:"documentTargetsIndex"},([v,x],{path:W,sequenceNumber:Z})=>{0===v?(p!==os.ot&&t(new Zt(hu(c)),p),p=Z,c=W):p=os.ot}).next(()=>{p!==os.ot&&t(new Zt(hu(c)),p)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tp(i,e){return Xi(i).put((s=i.currentSequenceNumber,{targetId:0,path:To(e.path),sequenceNumber:s}));var s}class Yy{constructor(){this.changes=new Do(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return void 0!==s?Qe.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class r0{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return jd(e).put(s)}removeEntry(e,t,s){return jd(e).delete(function(c,p){const v=c.path.toArray();return[v.slice(0,v.length-2),v[v.length-2],Ih(p),v[v.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.qn(e,s)))}getEntry(e,t){let s=Fi.newInvalidDocument(t);return jd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Lu(t))},(c,p)=>{s=this.Kn(t,p)}).next(()=>s)}Gn(e,t){let s={size:0,document:Fi.newInvalidDocument(t)};return jd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Lu(t))},(c,p)=>{s={document:this.Kn(t,p),size:H(p)}}).next(()=>s)}getEntries(e,t){let s=$o();return this.Qn(e,t,(c,p)=>{const v=this.Kn(c,p);s=s.insert(c,v)}).next(()=>s)}jn(e,t){let s=$o(),c=new Oi(Zt.comparator);return this.Qn(e,t,(p,v)=>{const x=this.Kn(p,v);s=s.insert(p,x),c=c.insert(p,H(v))}).next(()=>({documents:s,Wn:c}))}Qn(e,t,s){if(t.isEmpty())return Qe.resolve();let c=new Sr(rm);t.forEach(W=>c=c.add(W));const p=IDBKeyRange.bound(Lu(c.first()),Lu(c.last())),v=c.getIterator();let x=v.getNext();return jd(e).J({index:"documentKeyIndex",range:p},(W,Z,se)=>{const we=Zt.fromSegments([...Z.prefixPath,Z.collectionGroup,Z.documentId]);for(;x&&rm(x,we)<0;)s(x,null),x=v.getNext();x&&x.isEqual(we)&&(s(x,Z),x=v.hasNext()?v.getNext():null),x?se.q(Lu(x)):se.done()}).next(()=>{for(;x;)s(x,null),x=v.hasNext()?v.getNext():null})}getAllFromCollection(e,t,s){const c=[t.popLast().toArray(),t.lastSegment(),Ih(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],p=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return jd(e).K(IDBKeyRange.bound(c,p,!0)).next(v=>{let x=$o();for(const W of v){const Z=this.Kn(Zt.fromSegments(W.prefixPath.concat(W.collectionGroup,W.documentId)),W);x=x.insert(Z.key,Z)}return x})}getAllFromCollectionGroup(e,t,s,c){let p=$o();const v=wf(t,s),x=wf(t,jr.max());return jd(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(v,x,!0)},(W,Z,se)=>{const we=this.Kn(Zt.fromSegments(Z.prefixPath.concat(Z.collectionGroup,Z.documentId)),Z);p=p.insert(we.key,we),p.size===c&&se.done()}).next(()=>p)}newChangeBuffer(e){return new s0(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Jy(e).get("remoteDocumentGlobalKey").next(t=>(D(!!t),t))}qn(e,t){return Jy(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const s=function Gl(i,e){let t;if(e.document)t=re(i.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Zt.fromSegments(e.noDocument.path),c=Wl(e.noDocument.readTime);t=Fi.newNoDocument(s,c),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return S();{const s=Zt.fromSegments(e.unknownDocument.path),c=Wl(e.unknownDocument.version);t=Fi.newUnknownDocument(s,c)}}return e.readTime&&t.setReadTime(function(s){const c=new ui(s[0],s[1]);return An.fromTimestamp(c)}(e.readTime)),t}(this.wt,t);if(!s.isNoDocument()||!s.version.isEqual(An.min()))return s}return Fi.newInvalidDocument(e)}}function Qy(i){return new r0(i)}class s0 extends Yy{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new Do(s=>s.toString(),(s,c)=>s.isEqual(c))}applyChanges(e){const t=[];let s=0,c=new Sr((p,v)=>Dn(p.canonicalString(),v.canonicalString()));return this.changes.forEach((p,v)=>{const x=this.Hn.get(p);if(t.push(this.zn.removeEntry(e,p,x.readTime)),v.isValidDocument()){const W=wh(this.zn.wt,v);c=c.add(p.path.popLast()),s+=H(W)-x.size,t.push(this.zn.addEntry(e,p,W))}else if(s-=x.size,this.trackRemovals){const W=wh(this.zn.wt,v.convertToNoDocument(An.min()));t.push(this.zn.addEntry(e,p,W))}}),c.forEach(p=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,p))}),t.push(this.zn.updateMetadata(e,s)),Qe.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(s=>(this.Hn.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:s,Wn:c})=>(c.forEach((p,v)=>{this.Hn.set(p,{size:v,readTime:s.get(p).readTime})}),s))}}function Jy(i){return js(i,"remoteDocumentGlobal")}function jd(i){return js(i,"remoteDocumentsV14")}function Lu(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wf(i,e){const t=e.documentKey.path.toArray();return[i,Ih(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function rm(i,e){const t=i.path.toArray(),s=e.path.toArray();let c=0;for(let p=0;p<t.length-2&&p<s.length-2;++p)if(c=Dn(t[p],s[p]),c)return c;return c=Dn(t.length,s.length),c||(c=Dn(t[t.length-2],s[s.length-2]),c||Dn(t[t.length-1],s[s.length-1]))}class im{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class If{constructor(e,t,s,c){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=c}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(c=>(s=c,this.getBaseDocument(e,t,s))).next(c=>(null!==s&&na(s.mutation,c,Wi.empty(),ui.now()),c))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,Kn()).next(()=>s))}getLocalViewOfDocuments(e,t,s=Kn()){const c=Ii();return this.populateOverlays(e,c,t).next(()=>this.computeViews(e,t,c,s).next(p=>{let v=nl();return p.forEach((x,W)=>{v=v.insert(x,W.overlayedDocument)}),v}))}getOverlayedDocuments(e,t){const s=Ii();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,Kn()))}populateOverlays(e,t,s){const c=[];return s.forEach(p=>{t.has(p)||c.push(p)}),this.documentOverlayCache.getOverlays(e,c).next(p=>{p.forEach((v,x)=>{t.set(v,x)})})}computeViews(e,t,s,c){let p=$o();const v=ma(),x=ma();return t.forEach((W,Z)=>{const se=s.get(Z.key);c.has(Z.key)&&(void 0===se||se.mutation instanceof cu)?p=p.insert(Z.key,Z):void 0!==se&&(v.set(Z.key,se.mutation.getFieldMask()),na(se.mutation,Z,se.mutation.getFieldMask(),ui.now()))}),this.recalculateAndSaveOverlays(e,p).next(W=>(W.forEach((Z,se)=>v.set(Z,se)),t.forEach((Z,se)=>{var we;return x.set(Z,new im(se,null!==(we=v.get(Z))&&void 0!==we?we:null))}),x))}recalculateAndSaveOverlays(e,t){const s=ma();let c=new Oi((v,x)=>v-x),p=Kn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(v=>{for(const x of v)x.keys().forEach(W=>{const Z=t.get(W);if(null===Z)return;let se=s.get(W)||Wi.empty();se=x.applyToLocalView(Z,se),s.set(W,se);const we=(c.get(x.batchId)||Kn()).add(W);c=c.insert(x.batchId,we)})}).next(()=>{const v=[],x=c.getReverseIterator();for(;x.hasNext();){const W=x.getNext(),Z=W.key,se=W.value,we=El();se.forEach(st=>{if(!p.has(st)){const Et=xd(t.get(st),s.get(st));null!==Et&&we.set(st,Et),p=p.add(st)}}),v.push(this.documentOverlayCache.saveOverlays(e,Z,we))}return Qe.waitFor(v)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s){return Zt.isDocumentKey((c=t).path)&&null===c.collectionGroup&&0===c.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Du(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s):this.getDocumentsMatchingCollectionQuery(e,t,s);var c}getNextDocuments(e,t,s,c){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,c).next(p=>{const v=c-p.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,c-p.size):Qe.resolve(Ii());let x=-1,W=p;return v.next(Z=>Qe.forEach(Z,(se,we)=>(x<we.largestBatchId&&(x=we.largestBatchId),p.get(se)?Qe.resolve():this.getBaseDocument(e,se,we).next(st=>{W=W.insert(se,st)}))).next(()=>this.populateOverlays(e,Z,p)).next(()=>this.computeViews(e,W,Z,Kn())).next(se=>({batchId:x,changes:Ho(se)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Zt(t)).next(s=>{let c=nl();return s.isFoundDocument()&&(c=c.insert(s.key,s)),c})}getDocumentsMatchingCollectionGroupQuery(e,t,s){const c=t.collectionGroup;let p=nl();return this.indexManager.getCollectionParents(e,c).next(v=>Qe.forEach(v,x=>{const W=(Z=t,se=x.child(c),new Ks(se,null,Z.explicitOrderBy.slice(),Z.filters.slice(),Z.limit,Z.limitType,Z.startAt,Z.endAt));var Z,se;return this.getDocumentsMatchingCollectionQuery(e,W,s).next(Z=>{Z.forEach((se,we)=>{p=p.insert(se,we)})})}).next(()=>p))}getDocumentsMatchingCollectionQuery(e,t,s){let c;return this.remoteDocumentCache.getAllFromCollection(e,t.path,s).next(p=>(c=p,this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId))).next(p=>{p.forEach((x,W)=>{const Z=W.getKey();null===c.get(Z)&&(c=c.insert(Z,Fi.newInvalidDocument(Z)))});let v=nl();return c.forEach((x,W)=>{const Z=p.get(x);void 0!==Z&&na(Z.mutation,W,Wi.empty(),ui.now()),jo(t,W)&&(v=v.insert(x,W))}),v})}getBaseDocument(e,t,s){return null===s||1===s.mutation.type?this.remoteDocumentCache.getEntry(e,t):Qe.resolve(Fi.newInvalidDocument(t))}}class sm{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return Qe.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var s;return this.Jn.set(t.id,{id:(s=t).id,version:s.version,createTime:Cs(s.createTime)}),Qe.resolve()}getNamedQuery(e,t){return Qe.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(s=t).name,query:ja(s.bundledQuery),readTime:Cs(s.readTime)}),Qe.resolve();var s}}class Sp{constructor(){this.overlays=new Oi(Zt.comparator),this.Xn=new Map}getOverlay(e,t){return Qe.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Ii();return Qe.forEach(t,c=>this.getOverlay(e,c).next(p=>{null!==p&&s.set(c,p)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((c,p)=>{this.ie(e,t,p)}),Qe.resolve()}removeOverlaysForBatchId(e,t,s){const c=this.Xn.get(s);return void 0!==c&&(c.forEach(p=>this.overlays=this.overlays.remove(p)),this.Xn.delete(s)),Qe.resolve()}getOverlaysForCollection(e,t,s){const c=Ii(),p=t.length+1,v=new Zt(t.child("")),x=this.overlays.getIteratorFrom(v);for(;x.hasNext();){const W=x.getNext().value,Z=W.getKey();if(!t.isPrefixOf(Z.path))break;Z.path.length===p&&W.largestBatchId>s&&c.set(W.getKey(),W)}return Qe.resolve(c)}getOverlaysForCollectionGroup(e,t,s,c){let p=new Oi((Z,se)=>Z-se);const v=this.overlays.getIterator();for(;v.hasNext();){const Z=v.getNext().value;if(Z.getKey().getCollectionGroup()===t&&Z.largestBatchId>s){let se=p.get(Z.largestBatchId);null===se&&(se=Ii(),p=p.insert(Z.largestBatchId,se)),se.set(Z.getKey(),Z)}}const x=Ii(),W=p.getIterator();for(;W.hasNext()&&(W.getNext().value.forEach((Z,se)=>x.set(Z,se)),!(x.size()>=c)););return Qe.resolve(x)}ie(e,t,s){const c=this.overlays.get(s.key);if(null!==c){const v=this.Xn.get(c.largestBatchId).delete(s.key);this.Xn.set(c.largestBatchId,v)}this.overlays=this.overlays.insert(s.key,new ku(t,s));let p=this.Xn.get(t);void 0===p&&(p=Kn(),this.Xn.set(t,p)),this.Xn.set(t,p.add(s.key))}}class Ap{constructor(){this.Zn=new Sr(bs.ts),this.es=new Sr(bs.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const s=new bs(e,t);this.Zn=this.Zn.add(s),this.es=this.es.add(s)}ss(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.rs(new bs(e,t))}os(e,t){e.forEach(s=>this.removeReference(s,t))}us(e){const t=new Zt(new Nr([])),s=new bs(t,e),c=new bs(t,e+1),p=[];return this.es.forEachInRange([s,c],v=>{this.rs(v),p.push(v.key)}),p}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new Zt(new Nr([])),s=new bs(t,e),c=new bs(t,e+1);let p=Kn();return this.es.forEachInRange([s,c],v=>{p=p.add(v.key)}),p}containsKey(e){const t=new bs(e,0),s=this.Zn.firstAfterOrEqual(t);return null!==s&&e.isEqual(s.key)}}class bs{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return Zt.comparator(e.key,t.key)||Dn(e.ls,t.ls)}static ns(e,t){return Dn(e.ls,t.ls)||Zt.comparator(e.key,t.key)}}class om{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new Sr(bs.ts)}checkEmpty(e){return Qe.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,s,c){const p=this.fs;this.fs++;const v=new Eh(p,t,s,c);this.mutationQueue.push(v);for(const x of c)this.ds=this.ds.add(new bs(x.key,p)),this.indexManager.addToCollectionParentIndex(e,x.key.path.popLast());return Qe.resolve(v)}lookupMutationBatch(e,t){return Qe.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const c=this.ws(t+1),p=c<0?0:c;return Qe.resolve(this.mutationQueue.length>p?this.mutationQueue[p]:null)}getHighestUnacknowledgedBatchId(){return Qe.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return Qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new bs(t,0),c=new bs(t,Number.POSITIVE_INFINITY),p=[];return this.ds.forEachInRange([s,c],v=>{const x=this._s(v.ls);p.push(x)}),Qe.resolve(p)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Sr(Dn);return t.forEach(c=>{const p=new bs(c,0),v=new bs(c,Number.POSITIVE_INFINITY);this.ds.forEachInRange([p,v],x=>{s=s.add(x.ls)})}),Qe.resolve(this.gs(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,c=s.length+1;let p=s;Zt.isDocumentKey(p)||(p=p.child(""));const v=new bs(new Zt(p),0);let x=new Sr(Dn);return this.ds.forEachWhile(W=>{const Z=W.key.path;return!!s.isPrefixOf(Z)&&(Z.length===c&&(x=x.add(W.ls)),!0)},v),Qe.resolve(this.gs(x))}gs(e){const t=[];return e.forEach(s=>{const c=this._s(s);null!==c&&t.push(c)}),t}removeMutationBatch(e,t){D(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let s=this.ds;return Qe.forEach(t.mutations,c=>{const p=new bs(c.key,t.batchId);return s=s.delete(p),this.referenceDelegate.markPotentiallyOrphaned(e,c.key)}).next(()=>{this.ds=s})}In(e){}containsKey(e,t){const s=new bs(t,0),c=this.ds.firstAfterOrEqual(s);return Qe.resolve(t.isEqual(c&&c.key))}performConsistencyCheck(e){return Qe.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Xy{constructor(e){this.ps=e,this.docs=new Oi(Zt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,c=this.docs.get(s),p=c?c.size:0,v=this.ps(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:v}),this.size+=v-p,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Qe.resolve(s?s.document.mutableCopy():Fi.newInvalidDocument(t))}getEntries(e,t){let s=$o();return t.forEach(c=>{const p=this.docs.get(c);s=s.insert(c,p?p.document.mutableCopy():Fi.newInvalidDocument(c))}),Qe.resolve(s)}getAllFromCollection(e,t,s){let c=$o();const p=new Zt(t.child("")),v=this.docs.getIteratorFrom(p);for(;v.hasNext();){const{key:x,value:{document:W}}=v.getNext();if(!t.isPrefixOf(x.path))break;x.path.length>t.length+1||zu(xl(W),s)<=0||(c=c.insert(W.key,W.mutableCopy()))}return Qe.resolve(c)}getAllFromCollectionGroup(e,t,s,c){S()}Is(e,t){return Qe.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new xp(this)}getSize(e){return Qe.resolve(this.size)}}class xp extends Yy{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((s,c)=>{c.isValidDocument()?t.push(this.zn.addEntry(e,c)):this.zn.removeEntry(s)}),Qe.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class e_{constructor(e){this.persistence=e,this.Ts=new Do(t=>su(t),ou),this.lastRemoteSnapshotVersion=An.min(),this.highestTargetId=0,this.Es=0,this.As=new Ap,this.targetCount=0,this.Rs=bt.An()}forEachTarget(e,t){return this.Ts.forEach((s,c)=>t(c)),Qe.resolve()}getLastRemoteSnapshotVersion(e){return Qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Qe.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),Qe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.Es&&(this.Es=t),Qe.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new bt(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,Qe.resolve()}updateTargetData(e,t){return this.vn(t),Qe.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,Qe.resolve()}removeTargets(e,t,s){let c=0;const p=[];return this.Ts.forEach((v,x)=>{x.sequenceNumber<=t&&null===s.get(x.targetId)&&(this.Ts.delete(v),p.push(this.removeMatchingKeysForTargetId(e,x.targetId)),c++)}),Qe.waitFor(p).next(()=>c)}getTargetCount(e){return Qe.resolve(this.targetCount)}getTargetData(e,t){const s=this.Ts.get(t)||null;return Qe.resolve(s)}addMatchingKeys(e,t,s){return this.As.ss(t,s),Qe.resolve()}removeMatchingKeys(e,t,s){this.As.os(t,s);const c=this.persistence.referenceDelegate,p=[];return c&&t.forEach(v=>{p.push(c.markPotentiallyOrphaned(e,v))}),Qe.waitFor(p)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),Qe.resolve()}getMatchingKeysForTargetId(e,t){const s=this.As.hs(t);return Qe.resolve(s)}containsKey(e,t){return Qe.resolve(this.As.containsKey(t))}}class Rp{constructor(e,t){this.bs={},this.overlays={},this.Ps=new os(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new e_(this),this.indexManager=new Fu,this.remoteDocumentCache=new Xy(s=>this.referenceDelegate.Ss(s)),this.wt=new ya(t),this.Ds=new sm(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Sp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.bs[e.toKey()];return s||(s=new om(t,this.referenceDelegate),this.bs[e.toKey()]=s),s}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,s){xt("MemoryPersistence","Starting transaction:",e);const c=new t_(this.Ps.next());return this.referenceDelegate.Cs(),s(c).next(p=>this.referenceDelegate.xs(c).next(()=>p)).toPromise().then(p=>(c.raiseOnCommittedEvent(),p))}Ns(e,t){return Qe.or(Object.values(this.bs).map(s=>()=>s.containsKey(e,t)))}}class t_ extends bd{constructor(e){super(),this.currentSequenceNumber=e}}class Cf{constructor(e){this.persistence=e,this.ks=new Ap,this.Os=null}static Ms(e){return new Cf(e)}get Fs(){if(this.Os)return this.Os;throw S()}addReference(e,t,s){return this.ks.addReference(s,t),this.Fs.delete(s.toString()),Qe.resolve()}removeReference(e,t,s){return this.ks.removeReference(s,t),this.Fs.add(s.toString()),Qe.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),Qe.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(c=>this.Fs.add(c.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(c=>{c.forEach(p=>this.Fs.add(p.toString()))}).next(()=>s.removeTargetData(e,t))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qe.forEach(this.Fs,s=>{const c=Zt.fromPath(s);return this.$s(e,c).next(p=>{p||t.removeEntry(c,An.min())})}).next(()=>(this.Os=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(s=>{s?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return Qe.or([()=>Qe.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class Rh{constructor(e){this.wt=e}O(e,t,s,c){const p=new Va("createOrUpgrade",t);var x;s<1&&c>=1&&(e.createObjectStore("owner"),(x=e).createObjectStore("mutationQueues",{keyPath:"userId"}),x.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Pd,{unique:!0}),x.createObjectStore("documentMutations"),ld(e),function(x){x.createObjectStore("remoteDocuments")}(e));let v=Qe.resolve();return s<3&&c>=3&&(0!==s&&(function(x){x.deleteObjectStore("targetDocuments"),x.deleteObjectStore("targets"),x.deleteObjectStore("targetGlobal")}(e),ld(e)),v=v.next(()=>function(x){const W=x.store("targetGlobal"),Z={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:An.min().toTimestamp(),targetCount:0};return W.put("targetGlobalKey",Z)}(p))),s<4&&c>=4&&(0!==s&&(v=v.next(()=>function(x,W){return W.store("mutations").K().next(Z=>{x.deleteObjectStore("mutations"),x.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Pd,{unique:!0});const se=W.store("mutations"),we=Z.map(st=>se.put(st));return Qe.waitFor(we)})}(e,p))),v=v.next(()=>{!function(x){x.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),s<5&&c>=5&&(v=v.next(()=>this.Bs(p))),s<6&&c>=6&&(v=v.next(()=>(function(x){x.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(p)))),s<7&&c>=7&&(v=v.next(()=>this.Us(p))),s<8&&c>=8&&(v=v.next(()=>this.qs(e,p))),s<9&&c>=9&&(v=v.next(()=>{!function(x){x.objectStoreNames.contains("remoteDocumentChanges")&&x.deleteObjectStore("remoteDocumentChanges")}(e)})),s<10&&c>=10&&(v=v.next(()=>this.Ks(p))),s<11&&c>=11&&(v=v.next(()=>{(function(x){x.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(x){x.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&c>=12&&(v=v.next(()=>{!function(x){const W=x.createObjectStore("documentOverlays",{keyPath:gf});W.createIndex("collectionPathOverlayIndex",yh,{unique:!1}),W.createIndex("collectionGroupOverlayIndex",bp,{unique:!1})}(e)})),s<13&&c>=13&&(v=v.next(()=>function(x){const W=x.createObjectStore("remoteDocumentsV14",{keyPath:Ep});W.createIndex("documentKeyIndex",cf),W.createIndex("collectionGroupIndex",wp)}(e)).next(()=>this.Gs(e,p)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&c>=14&&(v=v.next(()=>this.Qs(e,p))),s<15&&c>=15&&(v=v.next(()=>function(x){x.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),x.createObjectStore("indexState",{keyPath:kd}).createIndex("sequenceNumberIndex",Cp,{unique:!1}),x.createObjectStore("indexEntries",{keyPath:ff}).createIndex("documentKeyIndex",pf,{unique:!1})}(e))),v}Ls(e){let t=0;return e.store("remoteDocuments").J((s,c)=>{t+=H(c)}).next(()=>{const s={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Bs(e){const t=e.store("mutationQueues"),s=e.store("mutations");return t.K().next(c=>Qe.forEach(c,p=>{const v=IDBKeyRange.bound([p.userId,-1],[p.userId,p.lastAcknowledgedBatchId]);return s.K("userMutationsIndex",v).next(x=>Qe.forEach(x,W=>{D(W.userId===p.userId);const Z=_a(this.wt,W);return M(e,p.userId,Z).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(c=>{const p=[];return s.J((v,x)=>{const W=new Nr(v),Z=[0,To(W)];p.push(t.get(Z).next(se=>se?Qe.resolve():t.put({targetId:0,path:To(W),sequenceNumber:c.highestListenSequenceNumber})))}).next(()=>Qe.waitFor(p))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:Ip});const s=t.store("collectionParents"),c=new od,p=v=>{if(c.add(v)){const x=v.lastSegment(),W=v.popLast();return s.put({collectionId:x,parent:To(W)})}};return t.store("remoteDocuments").J({H:!0},(v,x)=>{const W=new Nr(v);return p(W.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([v,x,W],Z)=>{const se=hu(x);return p(se.popLast())}))}Ks(e){const t=e.store("targets");return t.J((s,c)=>{const p=id(c),v=mf(this.wt,p);return t.put(v)})}Gs(e,t){const s=t.store("remoteDocuments"),c=[];return s.J((p,v)=>{const x=t.store("remoteDocumentsV14"),W=(Z=v,Z.document?new Zt(Nr.fromString(Z.document.name).popFirst(5)):Z.noDocument?Zt.fromSegments(Z.noDocument.path):Z.unknownDocument?Zt.fromSegments(Z.unknownDocument.path):S()).path.toArray();var Z;const se={prefixPath:W.slice(0,W.length-2),collectionGroup:W[W.length-2],documentId:W[W.length-1],readTime:v.readTime||[0,0],unknownDocument:v.unknownDocument,noDocument:v.noDocument,document:v.document,hasCommittedMutations:!!v.hasCommittedMutations};c.push(x.put(se))}).next(()=>Qe.waitFor(c))}Qs(e,t){const s=t.store("mutations"),c=Qy(this.wt),p=new Rp(Cf.Ms,this.wt.ne);return s.K().next(v=>{const x=new Map;return v.forEach(W=>{var Z;let se=null!==(Z=x.get(W.userId))&&void 0!==Z?Z:Kn();_a(this.wt,W).keys().forEach(we=>se=se.add(we)),x.set(W.userId,se)}),Qe.forEach(x,(W,Z)=>{const se=new Yi(Z),we=sd.se(this.wt,se),st=p.getIndexManager(se),Et=ee.se(se,this.wt,st,p.referenceDelegate);return new If(c,Et,we,st).recalculateAndSaveOverlaysForDocumentKeys(new rd(t,os.ot),W).next()})})}}function ld(i){i.createObjectStore("targetDocuments",{keyPath:df}).createIndex("documentTargetsIndex",hf,{unique:!0}),i.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Hl,{unique:!0}),i.createObjectStore("targetGlobal")}const Mh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Sc{constructor(e,t,s,c,p,v,x,W,Z,se,we=14){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.js=p,this.window=v,this.document=x,this.Ws=Z,this.zs=se,this.Hs=we,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=st=>Promise.resolve(),!Sc.V())throw new K(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new n0(this,c),this.ei=t+"main",this.wt=new ya(W),this.ni=new no(this.ei,this.Hs,new Rh(this.wt)),this.Vs=new In(this.referenceDelegate,this.wt),this.remoteDocumentCache=Qy(this.wt),this.Ds=new yf,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===se&&ai("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K(P.FAILED_PRECONDITION,Mh);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new os(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var s=(0,De.Z)(function*(c){if(t.started)return e(c)});return function(c){return s.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,De.Z)(function*(s){null===s.newVersion&&(yield e())});return function(s){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,De.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ql(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(Co(e))return xt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return xt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return Kl(e).get("owner").next(t=>Qe.resolve(this.di(t)))}_i(e){return ql(e).delete(this.clientId)}wi(){var e=this;return(0,De.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",s=>{const c=js(s,"clientMetadata");return c.K().next(p=>{const v=e.gi(p,18e5),x=p.filter(W=>-1===v.indexOf(W));return Qe.forEach(x,W=>c.delete(W.clientId)).next(()=>x)})}).catch(()=>[]);if(e.si)for(const s of t)e.si.removeItem(e.yi(s.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?Qe.resolve(!0):Kl(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new K(P.FAILED_PRECONDITION,Mh);return!1}}return!(!this.networkEnabled||!this.inForeground)||ql(e).K().next(s=>void 0===this.gi(s,5e3).find(c=>{if(this.clientId!==c.clientId){const v=!this.inForeground&&c.inForeground,x=this.networkEnabled===c.networkEnabled;if(!this.networkEnabled&&c.networkEnabled||v&&x)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&xt("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,De.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const s=new rd(t,os.ot);return e.li(s).next(()=>e._i(s))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(s=>this.mi(s.updateTimeMs,t)&&!this.pi(s.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>ql(e).K().next(t=>this.gi(t,18e5).map(s=>s.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return ee.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xh(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return sd.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,s){xt("IndexedDbPersistence","Starting transaction:",e);const c="readonly"===t?"readonly":"readwrite",p=15===(v=this.Hs)?vh:14===v?Vd:13===v?_h:12===v?Ld:11===v?Fd:void S();var v;let x;return this.ni.runTransaction(e,c,p,W=>(x=new rd(W,this.Ps?this.Ps.next():os.ot),"readwrite-primary"===t?this.ai(x).next(Z=>!!Z||this.hi(x)).next(Z=>{if(!Z)throw ai(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new K(P.FAILED_PRECONDITION,qa);return s(x)}).next(Z=>this.fi(x).next(()=>Z)):this.bi(x).next(()=>s(x)))).then(W=>(x.raiseOnCommittedEvent(),W))}bi(e){return Kl(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new K(P.FAILED_PRECONDITION,Mh)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Kl(e).put("owner",t)}static V(){return no.V()}li(e){const t=Kl(e);return t.get("owner").next(s=>this.di(s)?(xt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Qe.resolve())}mi(e,t){const s=Date.now();return!(e<s-t||e>s&&(ai(`Detected an update time that is in the future: ${e} > ${s}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,Ge.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const s=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return xt("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ai("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ai("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch(e){}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Kl(i){return js(i,"owner")}function ql(i){return js(i,"clientMetadata")}function Mp(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}class bf{constructor(e,t,s,c){this.targetId=e,this.fromCache=t,this.Pi=s,this.vi=c}static Vi(e,t){let s=Kn(),c=Kn();for(const p of t.docChanges)switch(p.type){case 0:s=s.add(p.doc.key);break;case 1:c=c.add(p.doc.key)}return new bf(e,t.fromCache,s,c)}}class Np{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,s,c){return this.Ci(e,t).next(p=>p||this.xi(e,t,c,s)).next(p=>p||this.Ni(e,t))}Ci(e,t){return Qe.resolve(null)}xi(e,t,s,c){return function gh(i){return 0===i.filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())}(t)||c.isEqual(An.min())?this.Ni(e,t):this.Di.getDocuments(e,s).next(p=>{const v=this.ki(t,p);return this.Oi(t,v,s,c)?this.Ni(e,t):(Qo()<=xe.in.DEBUG&&xt("QueryEngine","Re-using previous result from %s to execute query: %s",c.toString(),ga(t)),this.Mi(e,v,t,iu(c,-1)))})}ki(e,t){let s=new Sr(Tu(e));return t.forEach((c,p)=>{jo(e,p)&&(s=s.add(p))}),s}Oi(e,t,s,c){if(null===e.limit)return!1;if(s.size!==t.size)return!0;const p="F"===e.limitType?t.last():t.first();return!!p&&(p.hasPendingWrites||p.version.compareTo(c)>0)}Ni(e,t){return Qo()<=xe.in.DEBUG&&xt("QueryEngine","Using full collection scan to execute query:",ga(t)),this.Di.getDocumentsMatchingQuery(e,t,jr.min())}Mi(e,t,s,c){return this.Di.getDocumentsMatchingQuery(e,s,c).next(p=>(t.forEach(v=>{p=p.insert(v.key,v)}),p))}}class Pp{constructor(e,t,s,c){this.persistence=e,this.Fi=t,this.wt=c,this.$i=new Oi(Dn),this.Bi=new Do(p=>su(p),ou),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(s)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new If(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function Df(i,e,t,s){return new Pp(i,e,t,s)}function Op(i,e){return $d.apply(this,arguments)}function $d(){return $d=(0,De.Z)(function*(i,e){const t=N(i);return yield t.persistence.runTransaction("Handle user change","readonly",s=>{let c;return t.mutationQueue.getAllMutationBatches(s).next(p=>(c=p,t.qi(e),t.mutationQueue.getAllMutationBatches(s))).next(p=>{const v=[],x=[];let W=Kn();for(const Z of c){v.push(Z.batchId);for(const se of Z.mutations)W=W.add(se.key)}for(const Z of p){x.push(Z.batchId);for(const se of Z.mutations)W=W.add(se.key)}return t.localDocuments.getDocuments(s,W).next(Z=>({Ki:Z,removedBatchIds:v,addedBatchIds:x}))})})}),$d.apply(this,arguments)}function n_(i,e){const t=N(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const c=e.batch.keys(),p=t.Ui.newChangeBuffer({trackRemovals:!0});return function(v,x,W,Z){const se=W.batch,we=se.keys();let st=Qe.resolve();return we.forEach(Et=>{st=st.next(()=>Z.getEntry(x,Et)).next(Nt=>{const mn=W.docVersions.get(Et);D(null!==mn),Nt.version.compareTo(mn)<0&&(se.applyToRemoteDocument(Nt,W),Nt.isValidDocument()&&(Nt.setReadTime(W.commitVersion),Z.addEntry(Nt)))})}),st.next(()=>v.mutationQueue.removeMutationBatch(x,se))}(t,s,e,p).next(()=>p.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,c,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(v){let x=Kn();for(let W=0;W<v.mutationResults.length;++W)v.mutationResults[W].transformResults.length>0&&(x=x.add(v.batch.mutations[W].key));return x}(e))).next(()=>t.localDocuments.getDocuments(s,c))})}function kp(i){const e=N(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function o0(i,e){const t=N(i),s=e.snapshotVersion;let c=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",p=>{const v=t.Ui.newChangeBuffer({trackRemovals:!0});c=t.$i;const x=[];e.targetChanges.forEach((se,we)=>{const st=c.get(we);if(!st)return;x.push(t.Vs.removeMatchingKeys(p,se.removedDocuments,we).next(()=>t.Vs.addMatchingKeys(p,se.addedDocuments,we)));let Et=st.withSequenceNumber(p.currentSequenceNumber);var Nt,mn,Rn;e.targetMismatches.has(we)?Et=Et.withResumeToken(ki.EMPTY_BYTE_STRING,An.min()).withLastLimboFreeSnapshotVersion(An.min()):se.resumeToken.approximateByteSize()>0&&(Et=Et.withResumeToken(se.resumeToken,s)),c=c.insert(we,Et),mn=Et,Rn=se,(0===(Nt=st).resumeToken.approximateByteSize()||mn.snapshotVersion.toMicroseconds()-Nt.snapshotVersion.toMicroseconds()>=3e8||Rn.addedDocuments.size+Rn.modifiedDocuments.size+Rn.removedDocuments.size>0)&&x.push(t.Vs.updateTargetData(p,Et))});let W=$o(),Z=Kn();if(e.documentUpdates.forEach(se=>{e.resolvedLimboDocuments.has(se)&&x.push(t.persistence.referenceDelegate.updateLimboDocument(p,se))}),x.push(Fp(p,v,e.documentUpdates).next(se=>{W=se.Gi,Z=se.Qi})),!s.isEqual(An.min())){const se=t.Vs.getLastRemoteSnapshotVersion(p).next(we=>t.Vs.setTargetsMetadata(p,p.currentSequenceNumber,s));x.push(se)}return Qe.waitFor(x).next(()=>v.apply(p)).next(()=>t.localDocuments.getLocalViewOfDocuments(p,W,Z)).next(()=>W)}).then(p=>(t.$i=c,p))}function Fp(i,e,t){let s=Kn(),c=Kn();return t.forEach(p=>s=s.add(p)),e.getEntries(i,s).next(p=>{let v=$o();return t.forEach((x,W)=>{const Z=p.get(x);W.isFoundDocument()!==Z.isFoundDocument()&&(c=c.add(x)),W.isNoDocument()&&W.version.isEqual(An.min())?(e.removeEntry(x,W.readTime),v=v.insert(x,W)):!Z.isValidDocument()||W.version.compareTo(Z.version)>0||0===W.version.compareTo(Z.version)&&Z.hasPendingWrites?(e.addEntry(W),v=v.insert(x,W)):xt("LocalStore","Ignoring outdated watch update for ",x,". Current version:",Z.version," Watch version:",W.version)}),{Gi:v,Qi:c}})}function am(i,e){const t=N(i);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function Hd(i,e){const t=N(i);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let c;return t.Vs.getTargetData(s,e).next(p=>p?(c=p,Qe.resolve(c)):t.Vs.allocateTargetId(s).next(v=>(c=new ps(e,v,0,s.currentSequenceNumber),t.Vs.addTargetData(s,c).next(()=>c))))}).then(s=>{const c=t.$i.get(s.targetId);return(null===c||s.snapshotVersion.compareTo(c.snapshotVersion)>0)&&(t.$i=t.$i.insert(s.targetId,s),t.Bi.set(e,s.targetId)),s})}function cd(i,e,t){return Lp.apply(this,arguments)}function Lp(){return Lp=(0,De.Z)(function*(i,e,t){const s=N(i),c=s.$i.get(e),p=t?"readwrite":"readwrite-primary";try{t||(yield s.persistence.runTransaction("Release target",p,v=>s.persistence.referenceDelegate.removeTarget(v,c)))}catch(v){if(!Co(v))throw v;xt("LocalStore",`Failed to update sequence numbers for target ${e}: ${v}`)}s.$i=s.$i.remove(e),s.Bi.delete(c.target)}),Lp.apply(this,arguments)}function Tf(i,e,t){const s=N(i);let c=An.min(),p=Kn();return s.persistence.runTransaction("Execute query","readonly",v=>function(x,W,Z){const se=N(x),we=se.Bi.get(Z);return void 0!==we?Qe.resolve(se.$i.get(we)):se.Vs.getTargetData(W,Z)}(s,v,as(e)).next(x=>{if(x)return c=x.lastLimboFreeSnapshotVersion,s.Vs.getMatchingKeysForTargetId(v,x.targetId).next(W=>{p=W})}).next(()=>s.Fi.getDocumentsMatchingQuery(v,e,t?c:An.min(),t?p:Kn())).next(x=>(lm(s,Ta(e),x),{documents:x,ji:p})))}function eu(i,e){const t=N(i),s=N(t.Vs),c=t.$i.get(e);return c?Promise.resolve(c.target):t.persistence.runTransaction("Get target data","readonly",p=>s.te(p,e).next(v=>v?v.target:null))}function um(i,e){const t=N(i),s=t.Li.get(e)||An.min();return t.persistence.runTransaction("Get new document changes","readonly",c=>t.Ui.getAllFromCollectionGroup(c,e,iu(s,-1),Number.MAX_SAFE_INTEGER)).then(c=>(lm(t,e,c),c))}function lm(i,e,t){let s=An.min();t.forEach((c,p)=>{p.readTime.compareTo(s)>0&&(s=p.readTime)}),i.Li.set(e,s)}function cm(){return cm=(0,De.Z)(function*(i,e,t,s){const c=N(i);let p=Kn(),v=$o();for(const Z of t){const se=e.Wi(Z.metadata.name);Z.document&&(p=p.add(se));const we=e.zi(Z);we.setReadTime(e.Hi(Z.metadata.readTime)),v=v.insert(se,we)}const x=c.Ui.newChangeBuffer({trackRemovals:!0}),W=yield Hd(c,(Z=s,as(pl(Nr.fromString(`__bundle__/docs/${Z}`)))));var Z;return c.persistence.runTransaction("Apply bundle documents","readwrite",Z=>Fp(Z,x,v).next(se=>(x.apply(Z),se)).next(se=>c.Vs.removeMatchingKeysForTargetId(Z,W.targetId).next(()=>c.Vs.addMatchingKeys(Z,p,W.targetId)).next(()=>c.localDocuments.getLocalViewOfDocuments(Z,se.Gi,se.Qi)).next(()=>se.Gi)))}),cm.apply(this,arguments)}function dm(i,e){return hm.apply(this,arguments)}function hm(){return hm=(0,De.Z)(function*(i,e,t=Kn()){const s=yield Hd(i,as(ja(e.bundledQuery))),c=N(i);return c.persistence.runTransaction("Save named query","readwrite",p=>{const v=Cs(e.readTime);if(s.snapshotVersion.compareTo(v)>=0)return c.Ds.saveNamedQuery(p,e);const x=s.withResumeToken(ki.EMPTY_BYTE_STRING,v);return c.$i=c.$i.insert(x.targetId,x),c.Vs.updateTargetData(p,x).next(()=>c.Vs.removeMatchingKeysForTargetId(p,s.targetId)).next(()=>c.Vs.addMatchingKeys(p,t,s.targetId)).next(()=>c.Ds.saveNamedQuery(p,e))})}),hm.apply(this,arguments)}function fm(i,e){return`firestore_clients_${i}_${e}`}function Sf(i,e,t){let s=`firestore_mutations_${i}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function Af(i,e){return`firestore_targets_${i}_${e}`}class xf{constructor(e,t,s,c){this.user=e,this.batchId=t,this.state=s,this.error=c}static Ji(e,t,s){const c=JSON.parse(s);let p,v="object"==typeof c&&-1!==["pending","acknowledged","rejected"].indexOf(c.state)&&(void 0===c.error||"object"==typeof c.error);return v&&c.error&&(v="string"==typeof c.error.message&&"string"==typeof c.error.code,v&&(p=new K(c.error.code,c.error.message))),v?new xf(e,t,c.state,p):(ai("SharedClientState",`Failed to parse mutation state for ID '${t}': ${s}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Nh{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static Ji(e,t){const s=JSON.parse(t);let c,p="object"==typeof s&&-1!==["not-current","current","rejected"].indexOf(s.state)&&(void 0===s.error||"object"==typeof s.error);return p&&s.error&&(p="string"==typeof s.error.message&&"string"==typeof s.error.code,p&&(c=new K(s.error.code,s.error.message))),p?new Nh(e,s.state,c):(ai("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Rf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const s=JSON.parse(t);let c="object"==typeof s&&s.activeTargetIds instanceof Array,p=Ll();for(let v=0;c&&v<s.activeTargetIds.length;++v)c=Nn(s.activeTargetIds[v]),p=p.add(s.activeTargetIds[v]);return c?new Rf(e,p):(ai("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Mf{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Mf(t.clientId,t.onlineState):(ai("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Vp{constructor(){this.activeTargetIds=Ll()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Nf{constructor(e,t,s,c,p){this.window=e,this.js=t,this.persistenceKey=s,this.tr=c,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new Oi(Dn),this.started=!1,this.ir=[];const v=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=p,this.rr=fm(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new Vp),this.cr=new RegExp(`^firestore_clients_${v}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${v}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${v}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(x){return`firestore_bundle_loaded_v2_${x}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,De.Z)(function*(){const t=yield e.syncEngine.Ri();for(const c of t){if(c===e.tr)continue;const p=e.getItem(fm(e.persistenceKey,c));if(p){const v=Rf.Ji(c,p);v&&(e.sr=e.sr.insert(v.clientId,v))}}e._r();const s=e.storage.getItem(e.lr);if(s){const c=e.wr(s);c&&e.mr(c)}for(const c of e.ir)e.nr(c);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((s,c)=>{c.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,s){this.yr(e,t,s),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Af(this.persistenceKey,e));if(s){const c=Nh.Ji(e,s);c&&(t=c.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Af(this.persistenceKey,e))}updateQueryState(e,t,s){this.Tr(e,t,s)}handleUserChange(e,t,s){t.forEach(c=>{this.pr(c)}),this.currentUser=e,s.forEach(c=>{this.addPendingMutation(c)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return xt("SharedClientState","READ",e,t),t}setItem(e,t){xt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){xt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const s=e;if(s.storageArea===this.storage){if(xt("SharedClientState","EVENT",s.key,s.newValue),s.key===this.rr)return void ai("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,De.Z)(function*(){if(t.started){if(null!==s.key)if(t.cr.test(s.key)){if(null==s.newValue){const c=t.Rr(s.key);return t.br(c,null)}{const c=t.Pr(s.key,s.newValue);if(c)return t.br(c.clientId,c)}}else if(t.ar.test(s.key)){if(null!==s.newValue){const c=t.vr(s.key,s.newValue);if(c)return t.Vr(c)}}else if(t.hr.test(s.key)){if(null!==s.newValue){const c=t.Sr(s.key,s.newValue);if(c)return t.Dr(c)}}else if(s.key===t.lr){if(null!==s.newValue){const c=t.wr(s.newValue);if(c)return t.mr(c)}}else if(s.key===t.ur){const c=function(p){let v=os.ot;if(null!=p)try{const x=JSON.parse(p);D("number"==typeof x),v=x}catch(x){ai("SharedClientState","Failed to read sequence number from WebStorage",x)}return v}(s.newValue);c!==os.ot&&t.sequenceNumberHandler(c)}else if(s.key===t.dr){const c=t.Cr(s.newValue);yield Promise.all(c.map(p=>t.syncEngine.Nr(p)))}}else t.ir.push(s)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,s){const c=new xf(this.currentUser,e,t,s),p=Sf(this.persistenceKey,this.currentUser,e);this.setItem(p,c.Yi())}pr(e){const t=Sf(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,s){const c=Af(this.persistenceKey,e),p=new Nh(e,t,s);this.setItem(c,p.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const s=this.Rr(e);return Rf.Ji(s,t)}vr(e,t){const s=this.ar.exec(e),c=Number(s[1]);return xf.Ji(new Yi(void 0!==s[2]?s[2]:null),c,t)}Sr(e,t){const s=this.hr.exec(e),c=Number(s[1]);return Nh.Ji(c,t)}wr(e){return Mf.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,De.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);xt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,t){const s=t?this.sr.insert(e,t):this.sr.remove(e),c=this.gr(this.sr),p=this.gr(s),v=[],x=[];return p.forEach(W=>{c.has(W)||v.push(W)}),c.forEach(W=>{p.has(W)||x.push(W)}),this.syncEngine.Mr(v,x).then(()=>{this.sr=s})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=Ll();return e.forEach((s,c)=>{t=t.unionWith(c.activeTargetIds)}),t}}class pm{constructor(){this.Fr=new Vp,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,s){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Vp,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class r_{Br(e){}shutdown(){}}class Up{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){xt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){xt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const gm={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class i_{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class Dl extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,s,c,p){const v=this.oo(e,t);xt("RestConnection","Sending: ",v,s);const x={};return this.uo(x,c,p),this.co(e,v,x,s).then(W=>(xt("RestConnection","Received: ",W),W),W=>{throw Jo("RestConnection",`${e} failed with error: `,W,"url: ",v,"request:",s),W})}ao(e,t,s,c,p,v){return this.ro(e,t,s,c,p)}uo(e,t,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ps,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((c,p)=>e[p]=c),s&&s.headers.forEach((c,p)=>e[p]=c)}oo(e,t){return`${this.so}/v1/${t}:${gm[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,s,c){return new Promise((p,v)=>{const x=new ka;x.listenOnce(Yr.COMPLETE,()=>{try{switch(x.getLastErrorCode()){case eo.NO_ERROR:const Z=x.getResponseJson();xt("Connection","XHR received:",JSON.stringify(Z)),p(Z);break;case eo.TIMEOUT:xt("Connection",'RPC "'+e+'" timed out'),v(new K(P.DEADLINE_EXCEEDED,"Request time out"));break;case eo.HTTP_ERROR:const se=x.getStatus();if(xt("Connection",'RPC "'+e+'" failed with status:',se,"response text:",x.getResponseText()),se>0){const we=x.getResponseJson().error;if(we&&we.status&&we.message){const st=function(Et){const Nt=Et.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(Nt)>=0?Nt:P.UNKNOWN}(we.status);v(new K(st,we.message))}else v(new K(P.UNKNOWN,"Server responded with status "+x.getStatus()))}else v(new K(P.UNAVAILABLE,"Connection failed."));break;default:S()}}finally{xt("Connection",'RPC "'+e+'" completed.')}});const W=JSON.stringify(c);x.send(t,"POST",W,s,15)})}ho(e,t,s){const c=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],p=Zo(),v=Yo(),x={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(x.xmlHttpFactory=new ru({})),this.uo(x.initMessageHeaders,t,s),(0,Ge.uI)()||(0,Ge.b$)()||(0,Ge.d)()||(0,Ge.w1)()||(0,Ge.Mn)()||(0,Ge.ru)()||(x.httpHeadersOverwriteParam="$httpHeaders");const W=c.join("");xt("Connection","Creating WebChannel: "+W,x);const Z=p.createWebChannel(W,x);let se=!1,we=!1;const st=new i_({jr:Nt=>{we?xt("Connection","Not sending because WebChannel is closed:",Nt):(se||(xt("Connection","Opening WebChannel transport."),Z.open(),se=!0),xt("Connection","WebChannel sending:",Nt),Z.send(Nt))},Wr:()=>Z.close()}),Et=(Nt,mn,Rn)=>{Nt.listen(mn,Ri=>{try{Rn(Ri)}catch(Ts){setTimeout(()=>{throw Ts},0)}})};return Et(Z,Qr.EventType.OPEN,()=>{we||xt("Connection","WebChannel transport opened.")}),Et(Z,Qr.EventType.CLOSE,()=>{we||(we=!0,xt("Connection","WebChannel transport closed"),st.eo())}),Et(Z,Qr.EventType.ERROR,Nt=>{we||(we=!0,Jo("Connection","WebChannel transport errored:",Nt),st.eo(new K(P.UNAVAILABLE,"The operation could not be completed")))}),Et(Z,Qr.EventType.MESSAGE,Nt=>{var mn;if(!we){const Rn=Nt.data[0];D(!!Rn);const Ri=Rn,Ts=Ri.error||(null===(mn=Ri[0])||void 0===mn?void 0:mn.error);if(Ts){xt("Connection","WebChannel received error:",Ts);const yi=Ts.status;let So=function(Zs){const va=Ji[Zs];if(void 0!==va)return qs(va)}(yi),ms=Ts.message;void 0===So&&(So=P.INTERNAL,ms="Unknown error status: "+yi+" with message "+Ts.message),we=!0,st.eo(new K(So,ms)),Z.close()}else xt("Connection","WebChannel received:",Rn),st.no(Rn)}}),Et(v,Eo.STAT_EVENT,Nt=>{Nt.stat===Hs.PROXY?xt("Connection","Detected buffering proxy"):Nt.stat===Hs.NOPROXY&&xt("Connection","Detected no buffering proxy")}),setTimeout(()=>{st.Zr()},0),st}}function Pf(){return"undefined"!=typeof window?window:null}function Of(){return"undefined"!=typeof document?document:null}function Ph(i){return new du(i,!0)}class mm{constructor(e,t,s=1e3,c=1.5,p=6e4){this.js=e,this.timerId=t,this.lo=s,this.fo=c,this._o=p,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),s=Math.max(0,Date.now()-this.yo),c=Math.max(0,t-s);c>0&&xt("ExponentialBackoff",`Backing off for ${c} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,c,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class Bp{constructor(e,t,s,c,p,v,x,W){this.js=e,this.Ao=s,this.Ro=c,this.bo=p,this.authCredentialsProvider=v,this.appCheckCredentialsProvider=x,this.listener=W,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new mm(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,De.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}Oo(){var e=this;return(0,De.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var s=this;return(0,De.Z)(function*(){s.Fo(),s.$o(),s.So.cancel(),s.Po++,4!==e?s.So.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(ai(t.toString()),ai("Using maximum backoff delay to prevent overloading the backend."),s.So.po()):t&&t.code===P.UNAUTHENTICATED&&3!==s.state&&(s.authCredentialsProvider.invalidateToken(),s.appCheckCredentialsProvider.invalidateToken()),null!==s.stream&&(s.Bo(),s.stream.close(),s.stream=null),s.state=e,yield s.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,c])=>{this.Po===t&&this.Uo(s,c)},s=>{e(()=>{const c=new K(P.UNKNOWN,"Fetching auth token failed: "+s.message);return this.qo(c)})})}Uo(e,t){const s=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{s(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(c=>{s(()=>this.qo(c))}),this.stream.onMessage(c=>{s(()=>this.onMessage(c))})}xo(){var e=this;this.state=5,this.So.Io((0,De.Z)(function*(){e.state=0,e.start()}))}qo(e){return xt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(xt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class s_ extends Bp{constructor(e,t,s,c,p,v){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,c,v),this.wt=p}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function ct(i,e){let t;if("targetChange"in e){const s="NO_CHANGE"===(W=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===W?1:"REMOVE"===W?2:"CURRENT"===W?3:"RESET"===W?4:S(),c=e.targetChange.targetIds||[],p=function(W,Z){return W.dt?(D(void 0===Z||"string"==typeof Z),ki.fromBase64String(Z||"")):(D(void 0===Z||Z instanceof Uint8Array),ki.fromUint8Array(Z||new Uint8Array))}(i,e.targetChange.resumeToken),v=e.targetChange.cause,x=v&&function(W){const Z=void 0===W.code?P.UNKNOWN:qs(W.code);return new K(Z,W.message||"")}(v);t=new yc(s,c,p,x||null)}else if("documentChange"in e){const s=e.documentChange,c=Bs(i,s.document.name),p=Cs(s.document.updateTime),v=new ro({mapValue:{fields:s.document.fields}}),x=Fi.newFoundDocument(c,p,v);t=new mc(s.targetIds||[],s.removedTargetIds||[],x.key,x)}else if("documentDelete"in e){const s=e.documentDelete,c=Bs(i,s.document),p=s.readTime?Cs(s.readTime):An.min(),v=Fi.newNoDocument(c,p);t=new mc([],s.removedTargetIds||[],v.key,v)}else if("documentRemove"in e){const s=e.documentRemove,c=Bs(i,s.document);t=new mc([],s.removedTargetIds||[],c,null)}else{if(!("filter"in e))return S();{const s=e.filter,p=new io(s.count||0);t=new Ul(s.targetId,p)}}var W;return t}(this.wt,e),s=function(c){if(!("targetChange"in c))return An.min();const p=c.targetChange;return p.targetIds&&p.targetIds.length?An.min():p.readTime?Cs(p.readTime):An.min()}(e);return this.listener.Go(t,s)}Qo(e){const t={};t.database=m(this.wt),t.addTarget=function(c,p){let v;const x=p.target;return v=Da(x)?{documents:xn(c,x)}:{query:fs(c,x)},v.targetId=p.targetId,p.resumeToken.approximateByteSize()>0?v.resumeToken=Ec(c,p.resumeToken):p.snapshotVersion.compareTo(An.min())>0&&(v.readTime=Mu(c,p.snapshotVersion.toTimestamp())),v}(this.wt,e);const s=function jl(i,e){const t=function(s,c){switch(c){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return S()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);s&&(t.labels=s),this.Mo(t)}jo(e){const t={};t.database=m(this.wt),t.removeTarget=e,this.Mo(t)}}class o_ extends Bp{constructor(e,t,s,c,p,v){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,c,v),this.wt=p,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(D(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function $n(i,e){return i&&i.length>0?(D(void 0!==e),i.map(t=>function(s,c){let p=Cs(s.updateTime?s.updateTime:c);return p.isEqual(An.min())&&(p=Cs(c)),new qc(p,s.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),s=Cs(e.commitTime);return this.listener.Jo(s,t)}return D(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=m(this.wt),this.Mo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>Lt(this.wt,s))};this.Mo(t)}}class a_ extends class{}{constructor(e,t,s,c){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=s,this.wt=c,this.Zo=!1}tu(){if(this.Zo)throw new K(P.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,p])=>this.bo.ro(e,t,s,c,p)).catch(c=>{throw"FirebaseError"===c.name?(c.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new K(P.UNKNOWN,c.toString())})}ao(e,t,s,c){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([p,v])=>this.bo.ao(e,t,s,p,v,c)).catch(p=>{throw"FirebaseError"===p.name?(p.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),p):new K(P.UNKNOWN,p.toString())})}terminate(){this.Zo=!0}}class jp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ai(t),this.su=!1):xt("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class u_{constructor(e,t,s,c,p){var v=this;this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=p,this.du.Br(x=>{s.enqueueAndForget((0,De.Z)(function*(){var W;hd(v)&&(xt("RemoteStore","Restarting streams for network reachability change."),yield(W=(0,De.Z)(function*(Z){const se=N(Z);se.lu.add(4),yield Ac(se),se._u.set("Unknown"),se.lu.delete(4),yield Oh(se)}),function(Z){return W.apply(this,arguments)})(v))}))}),this._u=new jp(s,c)}}function Oh(i){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,De.Z)(function*(i){if(hd(i))for(const e of i.fu)yield e(!0)}),Gd.apply(this,arguments)}function Ac(i){return $p.apply(this,arguments)}function $p(){return $p=(0,De.Z)(function*(i){for(const e of i.fu)yield e(!1)}),$p.apply(this,arguments)}function Wd(i,e){const t=N(i);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),kh(t)?Hp(t):Kd(t).Co()&&kf(t,e))}function dd(i,e){const t=N(i),s=Kd(t);t.hu.delete(e),s.Co()&&ym(t,e),0===t.hu.size&&(s.Co()?s.ko():hd(t)&&t._u.set("Unknown"))}function kf(i,e){i.wu.Nt(e.targetId),Kd(i).Qo(e)}function ym(i,e){i.wu.Nt(e),Kd(i).jo(e)}function Hp(i){i.wu=new ia({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),te:e=>i.hu.get(e)||null}),Kd(i).start(),i._u.iu()}function kh(i){return hd(i)&&!Kd(i).Do()&&i.hu.size>0}function hd(i){return 0===N(i).lu.size}function _m(i){i.wu=void 0}function vm(i){return Ff.apply(this,arguments)}function Ff(){return Ff=(0,De.Z)(function*(i){i.hu.forEach((e,t)=>{kf(i,e)})}),Ff.apply(this,arguments)}function Em(i,e){return Lf.apply(this,arguments)}function Lf(){return Lf=(0,De.Z)(function*(i,e){_m(i),kh(i)?(i._u.uu(e),Hp(i)):i._u.set("Unknown")}),Lf.apply(this,arguments)}function wm(i,e,t){return il.apply(this,arguments)}function il(){return il=(0,De.Z)(function*(i,e,t){if(i._u.set("Online"),e instanceof yc&&2===e.state&&e.cause)try{yield(s=(0,De.Z)(function*(c,p){const v=p.cause;for(const x of p.targetIds)c.hu.has(x)&&(yield c.remoteSyncer.rejectListen(x,v),c.hu.delete(x),c.wu.removeTarget(x))}),function(c,p){return s.apply(this,arguments)})(i,e)}catch(s){xt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),yield fd(i,s)}else if(e instanceof mc?i.wu.Ut(e):e instanceof Ul?i.wu.zt(e):i.wu.Gt(e),!t.isEqual(An.min()))try{const s=yield kp(i.localStore);t.compareTo(s)>=0&&(yield function(c,p){const v=c.wu.Yt(p);return v.targetChanges.forEach((x,W)=>{if(x.resumeToken.approximateByteSize()>0){const Z=c.hu.get(W);Z&&c.hu.set(W,Z.withResumeToken(x.resumeToken,p))}}),v.targetMismatches.forEach(x=>{const W=c.hu.get(x);if(!W)return;c.hu.set(x,W.withResumeToken(ki.EMPTY_BYTE_STRING,W.snapshotVersion)),ym(c,x);const Z=new ps(W.target,x,1,W.sequenceNumber);kf(c,Z)}),c.remoteSyncer.applyRemoteEvent(v)}(i,t))}catch(s){xt("RemoteStore","Failed to raise snapshot:",s),yield fd(i,s)}var s}),il.apply(this,arguments)}function fd(i,e,t){return Gp.apply(this,arguments)}function Gp(){return Gp=(0,De.Z)(function*(i,e,t){if(!Co(e))throw e;i.lu.add(1),yield Ac(i),i._u.set("Offline"),t||(t=()=>kp(i.localStore)),i.asyncQueue.enqueueRetryable((0,De.Z)(function*(){xt("RemoteStore","Retrying IndexedDB access"),yield t(),i.lu.delete(1),yield Oh(i)}))}),Gp.apply(this,arguments)}function Im(i,e){return e().catch(t=>fd(i,t,e))}function Fh(i){return Lh.apply(this,arguments)}function Lh(){return Lh=(0,De.Z)(function*(i){const e=N(i),t=pu(e);let s=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;Cm(e);)try{const c=yield am(e.localStore,s);if(null===c){0===e.au.length&&t.ko();break}s=c.batchId,Wp(e,c)}catch(c){yield fd(e,c)}zd(e)&&bm(e)}),Lh.apply(this,arguments)}function Cm(i){return hd(i)&&i.au.length<10}function Wp(i,e){i.au.push(e);const t=pu(i);t.Co()&&t.zo&&t.Ho(e.mutations)}function zd(i){return hd(i)&&!pu(i).Do()&&i.au.length>0}function bm(i){pu(i).start()}function zp(i){return Vf.apply(this,arguments)}function Vf(){return Vf=(0,De.Z)(function*(i){pu(i).Xo()}),Vf.apply(this,arguments)}function Dm(i){return Uf.apply(this,arguments)}function Uf(){return Uf=(0,De.Z)(function*(i){const e=pu(i);for(const t of i.au)e.Ho(t.mutations)}),Uf.apply(this,arguments)}function l_(i,e,t){return Vh.apply(this,arguments)}function Vh(){return Vh=(0,De.Z)(function*(i,e,t){const s=i.au.shift(),c=Ud.from(s,e,t);yield Im(i,()=>i.remoteSyncer.applySuccessfulWrite(c)),yield Fh(i)}),Vh.apply(this,arguments)}function c_(i,e){return Kp.apply(this,arguments)}function Kp(){return Kp=(0,De.Z)(function*(i,e){var t;e&&pu(i).zo&&(yield(t=(0,De.Z)(function*(s,c){if(pc(p=c.code)&&p!==P.ABORTED){const v=s.au.shift();pu(s).No(),yield Im(s,()=>s.remoteSyncer.rejectFailedWrite(v.batchId,c)),yield Fh(s)}var p}),function(s,c){return t.apply(this,arguments)})(i,e)),zd(i)&&bm(i)}),Kp.apply(this,arguments)}function qp(i,e){return xc.apply(this,arguments)}function xc(){return xc=(0,De.Z)(function*(i,e){const t=N(i);t.asyncQueue.verifyOperationInProgress(),xt("RemoteStore","RemoteStore received new credentials");const s=hd(t);t.lu.add(3),yield Ac(t),s&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield Oh(t)}),xc.apply(this,arguments)}function Bf(i,e){return Zp.apply(this,arguments)}function Zp(){return Zp=(0,De.Z)(function*(i,e){const t=N(i);e?(t.lu.delete(2),yield Oh(t)):e||(t.lu.add(2),yield Ac(t),t._u.set("Unknown"))}),Zp.apply(this,arguments)}function Kd(i){return i.mu||(i.mu=function(e,t,s){const c=N(e);return c.tu(),new s_(t,c.bo,c.authCredentials,c.appCheckCredentials,c.wt,s)}(i.datastore,i.asyncQueue,{zr:vm.bind(null,i),Jr:Em.bind(null,i),Go:wm.bind(null,i)}),i.fu.push(function(){var e=(0,De.Z)(function*(t){t?(i.mu.No(),kh(i)?Hp(i):i._u.set("Unknown")):(yield i.mu.stop(),_m(i))});return function(t){return e.apply(this,arguments)}}())),i.mu}function pu(i){return i.gu||(i.gu=function(e,t,s){const c=N(e);return c.tu(),new o_(t,c.bo,c.authCredentials,c.appCheckCredentials,c.wt,s)}(i.datastore,i.asyncQueue,{zr:zp.bind(null,i),Jr:c_.bind(null,i),Yo:Dm.bind(null,i),Jo:l_.bind(null,i)}),i.fu.push(function(){var e=(0,De.Z)(function*(t){t?(i.gu.No(),yield Fh(i)):(yield i.gu.stop(),i.au.length>0&&(xt("RemoteStore",`Stopping write stream with ${i.au.length} pending writes`),i.au=[]))});return function(t){return e.apply(this,arguments)}}())),i.gu}class Yp{constructor(e,t,s,c,p){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=c,this.removalCallback=p,this.deferred=new de,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(v=>{})}static createAndSchedule(e,t,s,c,p){const v=Date.now()+s,x=new Yp(e,t,v,c,p);return x.start(s),x}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new K(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qd(i,e){if(ai("AsyncQueue",`${e}: ${i}`),Co(i))return new K(P.UNAVAILABLE,`${e}: ${i}`);throw i}class Zd{constructor(e){this.comparator=e?(t,s)=>e(t,s)||Zt.comparator(t.key,s.key):(t,s)=>Zt.comparator(t.key,s.key),this.keyedMap=nl(),this.sortedSet=new Oi(this.comparator)}static emptySet(e){return new Zd(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const c=t.getNext().key,p=s.getNext().key;if(!c.isEqual(p))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const s=new Zd;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class Tm{constructor(){this.yu=new Oi(Zt.comparator)}track(e){const t=e.doc.key,s=this.yu.get(t);s?0!==e.type&&3===s.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==s.type?this.yu=this.yu.insert(t,{type:s.type,doc:e.doc}):2===e.type&&2===s.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===s.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===s.type?this.yu=this.yu.remove(t):1===e.type&&2===s.type?this.yu=this.yu.insert(t,{type:1,doc:s.doc}):0===e.type&&1===s.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):S():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,s)=>{e.push(s)}),e}}class xa{constructor(e,t,s,c,p,v,x,W){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=c,this.mutatedKeys=p,this.fromCache=v,this.syncStateChanged=x,this.excludesMetadataChanges=W}static fromInitialDocuments(e,t,s,c){const p=[];return t.forEach(v=>{p.push({type:0,doc:v})}),new xa(e,t,Zd.emptySet(t),p,s,c,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let c=0;c<t.length;c++)if(t[c].type!==s[c].type||!t[c].doc.isEqual(s[c].doc))return!1;return!0}}class Qp{constructor(){this.Iu=void 0,this.listeners=[]}}class Sm{constructor(){this.queries=new Do(e=>ac(e),oc),this.onlineState="Unknown",this.Tu=new Set}}function jf(i,e){return $f.apply(this,arguments)}function $f(){return $f=(0,De.Z)(function*(i,e){const t=N(i),s=e.query;let c=!1,p=t.queries.get(s);if(p||(c=!0,p=new Qp),c)try{p.Iu=yield t.onListen(s)}catch(v){const x=qd(v,`Initialization of query '${ga(e.query)}' failed`);return void e.onError(x)}t.queries.set(s,p),p.listeners.push(e),e.Eu(t.onlineState),p.Iu&&e.Au(p.Iu)&&Xp(t)}),$f.apply(this,arguments)}function Hf(i,e){return Jp.apply(this,arguments)}function Jp(){return Jp=(0,De.Z)(function*(i,e){const t=N(i),s=e.query;let c=!1;const p=t.queries.get(s);if(p){const v=p.listeners.indexOf(e);v>=0&&(p.listeners.splice(v,1),c=0===p.listeners.length)}if(c)return t.queries.delete(s),t.onUnlisten(s)}),Jp.apply(this,arguments)}function d_(i,e){const t=N(i);let s=!1;for(const c of e){const v=t.queries.get(c.query);if(v){for(const x of v.listeners)x.Au(c)&&(s=!0);v.Iu=c}}s&&Xp(t)}function h_(i,e,t){const s=N(i),c=s.queries.get(e);if(c)for(const p of c.listeners)p.onError(t);s.queries.delete(e)}function Xp(i){i.Tu.forEach(e=>{e.next()})}class Gf{constructor(e,t,s){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=s||{}}Au(e){if(!this.options.includeMetadataChanges){const s=[];for(const c of e.docChanges)3!==c.type&&s.push(c);e=new xa(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=xa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class u0{constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class eg{constructor(e){this.wt=e}Wi(e){return Bs(this.wt,e)}zi(e){return e.metadata.exists?re(this.wt,e.document,!1):Fi.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Cs(e)}}class f_{constructor(e,t,s){this.xu=e,this.localStore=t,this.wt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Am(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const s=Nr.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,s=new eg(this.wt);for(const c of e)if(c.metadata.queries){const p=s.Wi(c.metadata.name);for(const v of c.metadata.queries){const x=(t.get(v)||Kn()).add(p);t.set(v,x)}}return t}complete(){var e=this;return(0,De.Z)(function*(){const t=yield function a0(i,e,t,s){return cm.apply(this,arguments)}(e.localStore,new eg(e.wt),e.documents,e.xu.id),s=e.ku(e.documents);for(const c of e.queries)yield dm(e.localStore,c,s.get(c.name));return e.progress.taskState="Success",{progress:e.progress,Ou:e.collectionGroups,Mu:t}})()}}function Am(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}class p_{constructor(e){this.key=e}}class g_{constructor(e){this.key=e}}class Wf{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=Kn(),this.mutatedKeys=Kn(),this.Lu=Tu(e),this.Uu=new Zd(this.Lu)}get qu(){return this.Fu}Ku(e,t){const s=t?t.Gu:new Tm,c=t?t.Uu:this.Uu;let p=t?t.mutatedKeys:this.mutatedKeys,v=c,x=!1;const W="F"===this.query.limitType&&c.size===this.query.limit?c.last():null,Z="L"===this.query.limitType&&c.size===this.query.limit?c.first():null;if(e.inorderTraversal((se,we)=>{const st=c.get(se),Et=jo(this.query,we)?we:null,Nt=!!st&&this.mutatedKeys.has(st.key),mn=!!Et&&(Et.hasLocalMutations||this.mutatedKeys.has(Et.key)&&Et.hasCommittedMutations);let Rn=!1;st&&Et?st.data.isEqual(Et.data)?Nt!==mn&&(s.track({type:3,doc:Et}),Rn=!0):this.Qu(st,Et)||(s.track({type:2,doc:Et}),Rn=!0,(W&&this.Lu(Et,W)>0||Z&&this.Lu(Et,Z)<0)&&(x=!0)):!st&&Et?(s.track({type:0,doc:Et}),Rn=!0):st&&!Et&&(s.track({type:1,doc:st}),Rn=!0,(W||Z)&&(x=!0)),Rn&&(Et?(v=v.add(Et),p=mn?p.add(se):p.delete(se)):(v=v.delete(se),p=p.delete(se)))}),null!==this.query.limit)for(;v.size>this.query.limit;){const se="F"===this.query.limitType?v.last():v.first();v=v.delete(se.key),p=p.delete(se.key),s.track({type:1,doc:se})}return{Uu:v,Gu:s,Oi:x,mutatedKeys:p}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s){const c=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const p=e.Gu.pu();p.sort((Z,se)=>function(we,st){const Et=Nt=>{switch(Nt){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return S()}};return Et(we)-Et(st)}(Z.type,se.type)||this.Lu(Z.doc,se.doc)),this.ju(s);const v=t?this.Wu():[],x=0===this.Bu.size&&this.current?1:0,W=x!==this.$u;return this.$u=x,0!==p.length||W?{snapshot:new xa(this.query,e.Uu,c,p,e.mutatedKeys,0===x,W,!1),zu:v}:{zu:v}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new Tm,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=Kn(),this.Uu.forEach(s=>{this.Hu(s.key)&&(this.Bu=this.Bu.add(s.key))});const t=[];return e.forEach(s=>{this.Bu.has(s)||t.push(new g_(s))}),this.Bu.forEach(s=>{e.has(s)||t.push(new p_(s))}),t}Ju(e){this.Fu=e.ji,this.Bu=Kn();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return xa.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class m_{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class xm{constructor(e){this.key=e,this.Xu=!1}}class Rm{constructor(e,t,s,c,p,v){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=c,this.currentUser=p,this.maxConcurrentLimboResolutions=v,this.Zu={},this.tc=new Do(x=>ac(x),oc),this.ec=new Map,this.nc=new Set,this.sc=new Oi(Zt.comparator),this.ic=new Map,this.rc=new Ap,this.oc={},this.uc=new Map,this.cc=bt.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function l0(i,e){return gu.apply(this,arguments)}function gu(){return gu=(0,De.Z)(function*(i,e){const t=Jf(i);let s,c;const p=t.tc.get(e);if(p)s=p.targetId,t.sharedClientState.addLocalQueryTarget(s),c=p.view.Yu();else{const v=yield Hd(t.localStore,as(e));t.isPrimaryClient&&Wd(t.remoteStore,v);const x=t.sharedClientState.addLocalQueryTarget(v.targetId);s=v.targetId,c=yield Mm(t,e,s,"current"===x)}return c}),gu.apply(this,arguments)}function Mm(i,e,t,s){return Nm.apply(this,arguments)}function Nm(){return Nm=(0,De.Z)(function*(i,e,t,s){i.hc=(se,we,st)=>{return(Et=(0,De.Z)(function*(Nt,mn,Rn,Ri){let Ts=mn.view.Ku(Rn);Ts.Oi&&(Ts=yield Tf(Nt.localStore,mn.query,!1).then(({documents:ms})=>mn.view.Ku(ms,Ts)));const yi=Ri&&Ri.targetChanges.get(mn.targetId),So=mn.view.applyChanges(Ts,Nt.isPrimaryClient,yi);return sg(Nt,mn.targetId,So.zu),So.snapshot}),function(Nt,mn,Rn,Ri){return Et.apply(this,arguments)})(i,se,we,st);var Et};const c=yield Tf(i.localStore,e,!0),p=new Wf(e,c.ji),v=p.Ku(c.documents),x=Vl.createSynthesizedTargetChangeForCurrentChange(t,s&&"Offline"!==i.onlineState),W=p.applyChanges(v,i.isPrimaryClient,x);sg(i,t,W.zu);const Z=new m_(e,t,p);return i.tc.set(e,Z),i.ec.has(t)?i.ec.get(t).push(e):i.ec.set(t,[e]),W.snapshot}),Nm.apply(this,arguments)}function Pm(i,e){return zf.apply(this,arguments)}function zf(){return zf=(0,De.Z)(function*(i,e){const t=N(i),s=t.tc.get(e),c=t.ec.get(s.targetId);if(c.length>1)return t.ec.set(s.targetId,c.filter(p=>!oc(p,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(s.targetId),t.sharedClientState.isActiveQueryTarget(s.targetId)||(yield cd(t.localStore,s.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(s.targetId),dd(t.remoteStore,s.targetId),Qd(t,s.targetId)}).catch(Ia))):(Qd(t,s.targetId),yield cd(t.localStore,s.targetId,!0))}),zf.apply(this,arguments)}function tg(){return tg=(0,De.Z)(function*(i,e,t){const s=Xf(i);try{const c=yield function(p,v){const x=N(p),W=ui.now(),Z=v.reduce((st,Et)=>st.add(Et.key),Kn());let se,we;return x.persistence.runTransaction("Locally write mutations","readwrite",st=>{let Et=$o(),Nt=Kn();return x.Ui.getEntries(st,Z).next(mn=>{Et=mn,Et.forEach((Rn,Ri)=>{Ri.isValidDocument()||(Nt=Nt.add(Rn))})}).next(()=>x.localDocuments.getOverlayedDocuments(st,Et)).next(mn=>{se=mn;const Rn=[];for(const Ri of v){const Ts=Zc(Ri,se.get(Ri.key).overlayedDocument);null!=Ts&&Rn.push(new cu(Ri.key,Ts,Hc(Ts.value.mapValue),zi.exists(!0)))}return x.mutationQueue.addMutationBatch(st,W,Rn,v)}).next(mn=>{we=mn;const Rn=mn.applyToLocalDocumentSet(se,Nt);return x.documentOverlayCache.saveOverlays(st,mn.batchId,Rn)})}).then(()=>({batchId:we.batchId,changes:Ho(se)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(c.batchId),function(p,v,x){let W=p.oc[p.currentUser.toKey()];W||(W=new Oi(Dn)),W=W.insert(v,x),p.oc[p.currentUser.toKey()]=W}(s,c.batchId,t),yield oa(s,c.changes),yield Fh(s.remoteStore)}catch(c){const p=qd(c,"Failed to persist write");t.reject(p)}}),tg.apply(this,arguments)}function y_(i,e){return Kf.apply(this,arguments)}function Kf(){return Kf=(0,De.Z)(function*(i,e){const t=N(i);try{const s=yield o0(t.localStore,e);e.targetChanges.forEach((c,p)=>{const v=t.ic.get(p);v&&(D(c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size<=1),c.addedDocuments.size>0?v.Xu=!0:c.modifiedDocuments.size>0?D(v.Xu):c.removedDocuments.size>0&&(D(v.Xu),v.Xu=!1))}),yield oa(t,s,e)}catch(s){yield Ia(s)}}),Kf.apply(this,arguments)}function qf(i,e,t){const s=N(i);if(s.isPrimaryClient&&0===t||!s.isPrimaryClient&&1===t){const c=[];s.tc.forEach((p,v)=>{const x=v.view.Eu(e);x.snapshot&&c.push(x.snapshot)}),function(p,v){const x=N(p);x.onlineState=v;let W=!1;x.queries.forEach((Z,se)=>{for(const we of se.listeners)we.Eu(v)&&(W=!0)}),W&&Xp(x)}(s.eventManager,e),c.length&&s.Zu.Go(c),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}function __(i,e,t){return Uh.apply(this,arguments)}function Uh(){return Uh=(0,De.Z)(function*(i,e,t){const s=N(i);s.sharedClientState.updateQueryState(e,"rejected",t);const c=s.ic.get(e),p=c&&c.key;if(p){let v=new Oi(Zt.comparator);v=v.insert(p,Fi.newNoDocument(p,An.min()));const x=Kn().add(p),W=new Vs(An.min(),new Map,new Sr(Dn),v,x);yield y_(s,W),s.sc=s.sc.remove(p),s.ic.delete(e),Bh(s)}else yield cd(s.localStore,e,!1).then(()=>Qd(s,e,t)).catch(Ia)}),Uh.apply(this,arguments)}function v_(i,e){return ng.apply(this,arguments)}function ng(){return ng=(0,De.Z)(function*(i,e){const t=N(i),s=e.batch.batchId;try{const c=yield n_(t.localStore,e);Rc(t,s,null),Yd(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),yield oa(t,c)}catch(c){yield Ia(c)}}),ng.apply(this,arguments)}function E_(i,e,t){return rg.apply(this,arguments)}function rg(){return rg=(0,De.Z)(function*(i,e,t){const s=N(i);try{const c=yield function(p,v){const x=N(p);return x.persistence.runTransaction("Reject batch","readwrite-primary",W=>{let Z;return x.mutationQueue.lookupMutationBatch(W,v).next(se=>(D(null!==se),Z=se.keys(),x.mutationQueue.removeMutationBatch(W,se))).next(()=>x.mutationQueue.performConsistencyCheck(W)).next(()=>x.documentOverlayCache.removeOverlaysForBatchId(W,Z,v)).next(()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(W,Z)).next(()=>x.localDocuments.getDocuments(W,Z))})}(s.localStore,e);Rc(s,e,t),Yd(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),yield oa(s,c)}catch(c){yield Ia(c)}}),rg.apply(this,arguments)}function ig(){return ig=(0,De.Z)(function*(i,e){const t=N(i);hd(t.remoteStore)||xt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=yield function(p){const v=N(p);return v.persistence.runTransaction("Get highest unacknowledged batch id","readonly",x=>v.mutationQueue.getHighestUnacknowledgedBatchId(x))}(t.localStore);if(-1===s)return void e.resolve();const c=t.uc.get(s)||[];c.push(e),t.uc.set(s,c)}catch(s){const c=qd(s,"Initialization of waitForPendingWrites() operation failed");e.reject(c)}}),ig.apply(this,arguments)}function Yd(i,e){(i.uc.get(e)||[]).forEach(t=>{t.resolve()}),i.uc.delete(e)}function Rc(i,e,t){const s=N(i);let c=s.oc[s.currentUser.toKey()];if(c){const p=c.get(e);p&&(t?p.reject(t):p.resolve(),c=c.remove(e)),s.oc[s.currentUser.toKey()]=c}}function Qd(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const s of i.ec.get(e))i.tc.delete(s),t&&i.Zu.lc(s,t);i.ec.delete(e),i.isPrimaryClient&&i.rc.us(e).forEach(s=>{i.rc.containsKey(s)||Jd(i,s)})}function Jd(i,e){i.nc.delete(e.path.canonicalString());const t=i.sc.get(e);null!==t&&(dd(i.remoteStore,t),i.sc=i.sc.remove(e),i.ic.delete(t),Bh(i))}function sg(i,e,t){for(const s of t)s instanceof p_?(i.rc.addReference(s.key,e),I_(i,s)):s instanceof g_?(xt("SyncEngine","Document no longer in limbo: "+s.key),i.rc.removeReference(s.key,e),i.rc.containsKey(s.key)||Jd(i,s.key)):S()}function I_(i,e){const t=e.key,s=t.path.canonicalString();i.sc.get(t)||i.nc.has(s)||(xt("SyncEngine","New document in limbo: "+t),i.nc.add(s),Bh(i))}function Bh(i){for(;i.nc.size>0&&i.sc.size<i.maxConcurrentLimboResolutions;){const e=i.nc.values().next().value;i.nc.delete(e);const t=new Zt(Nr.fromString(e)),s=i.cc.next();i.ic.set(s,new xm(t)),i.sc=i.sc.insert(t,s),Wd(i.remoteStore,new ps(as(pl(t.path)),s,2,os.ot))}}function oa(i,e,t){return pd.apply(this,arguments)}function pd(){return pd=(0,De.Z)(function*(i,e,t){const s=N(i),c=[],p=[],v=[];var x;s.tc.isEmpty()||(s.tc.forEach((x,W)=>{v.push(s.hc(W,e,t).then(Z=>{if(Z){s.isPrimaryClient&&s.sharedClientState.updateQueryState(W.targetId,Z.fromCache?"not-current":"current"),c.push(Z);const se=bf.Vi(W.targetId,Z);p.push(se)}}))}),yield Promise.all(v),s.Zu.Go(c),yield(x=(0,De.Z)(function*(W,Z){const se=N(W);try{yield se.persistence.runTransaction("notifyLocalViewChanges","readwrite",we=>Qe.forEach(Z,st=>Qe.forEach(st.Pi,Et=>se.persistence.referenceDelegate.addReference(we,st.targetId,Et)).next(()=>Qe.forEach(st.vi,Et=>se.persistence.referenceDelegate.removeReference(we,st.targetId,Et)))))}catch(we){if(!Co(we))throw we;xt("LocalStore","Failed to update sequence numbers: "+we)}for(const we of Z){const st=we.targetId;if(!we.fromCache){const Et=se.$i.get(st),mn=Et.withLastLimboFreeSnapshotVersion(Et.snapshotVersion);se.$i=se.$i.insert(st,mn)}}}),function(W,Z){return x.apply(this,arguments)})(s.localStore,p))}),pd.apply(this,arguments)}function Ra(i,e){return Zl.apply(this,arguments)}function Zl(){return Zl=(0,De.Z)(function*(i,e){const t=N(i);if(!t.currentUser.isEqual(e)){xt("SyncEngine","User change. New user:",e.toKey());const s=yield Op(t.localStore,e);t.currentUser=e,(c=t).uc.forEach(v=>{v.forEach(x=>{x.reject(new K(P.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),c.uc.clear(),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),yield oa(t,s.Ki)}var c}),Zl.apply(this,arguments)}function Zf(i,e){const t=N(i),s=t.ic.get(e);if(s&&s.Xu)return Kn().add(s.key);{let c=Kn();const p=t.ec.get(e);if(!p)return c;for(const v of p){const x=t.tc.get(v);c=c.unionWith(x.view.qu)}return c}}function Vu(i,e){return jh.apply(this,arguments)}function jh(){return jh=(0,De.Z)(function*(i,e){const t=N(i),s=yield Tf(t.localStore,e.query,!0),c=e.view.Ju(s);return t.isPrimaryClient&&sg(t,e.targetId,c.zu),c}),jh.apply(this,arguments)}function Xd(i,e){return Mc.apply(this,arguments)}function Mc(){return Mc=(0,De.Z)(function*(i,e){const t=N(i);return um(t.localStore,e).then(s=>oa(t,s))}),Mc.apply(this,arguments)}function eh(i,e,t,s){return Nc.apply(this,arguments)}function Nc(){return Nc=(0,De.Z)(function*(i,e,t,s){const c=N(i),p=yield function(v,x){const W=N(v),Z=N(W.mutationQueue);return W.persistence.runTransaction("Lookup mutation documents","readonly",se=>Z.yn(se,x).next(we=>we?W.localDocuments.getDocuments(se,we):Qe.resolve(null)))}(c.localStore,e);var x;null!==p?("pending"===t?yield Fh(c.remoteStore):"acknowledged"===t||"rejected"===t?(Rc(c,e,s||null),Yd(c,e),x=e,N(N(c.localStore).mutationQueue).In(x)):S(),yield oa(c,p)):xt("SyncEngine","Cannot apply mutation batch with id: "+e)}),Nc.apply(this,arguments)}function Pc(){return Pc=(0,De.Z)(function*(i,e){const t=N(i);if(Jf(t),Xf(t),!0===e&&!0!==t.ac){const s=t.sharedClientState.getAllActiveQueryTargets(),c=yield gd(t,s.toArray());t.ac=!0,yield Bf(t.remoteStore,!0);for(const p of c)Wd(t.remoteStore,p)}else if(!1===e&&!1!==t.ac){const s=[];let c=Promise.resolve();t.ec.forEach((p,v)=>{t.sharedClientState.isLocalQueryTarget(v)?s.push(v):c=c.then(()=>(Qd(t,v),cd(t.localStore,v,!0))),dd(t.remoteStore,v)}),yield c,yield gd(t,s),function(p){const v=N(p);v.ic.forEach((x,W)=>{dd(v.remoteStore,W)}),v.rc.cs(),v.ic=new Map,v.sc=new Oi(Zt.comparator)}(t),t.ac=!1,yield Bf(t.remoteStore,!1)}}),Pc.apply(this,arguments)}function gd(i,e,t){return Oc.apply(this,arguments)}function Oc(){return Oc=(0,De.Z)(function*(i,e,t){const s=N(i),c=[],p=[];for(const v of e){let x;const W=s.ec.get(v);if(W&&0!==W.length){x=yield Hd(s.localStore,as(W[0]));for(const Z of W){const se=s.tc.get(Z),we=yield Vu(s,se);we.snapshot&&p.push(we.snapshot)}}else{const Z=yield eu(s.localStore,v);x=yield Hd(s.localStore,Z),yield Mm(s,md(Z),v,!1)}c.push(x)}return s.Zu.Go(p),c}),Oc.apply(this,arguments)}function md(i){return Ol(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function km(i){const e=N(i);return N(N(e.localStore).persistence).Ri()}function Fm(i,e,t,s){return Yf.apply(this,arguments)}function Yf(){return Yf=(0,De.Z)(function*(i,e,t,s){const c=N(i);if(c.ac)return void xt("SyncEngine","Ignoring unexpected query state notification.");const p=c.ec.get(e);if(p&&p.length>0)switch(t){case"current":case"not-current":{const v=yield um(c.localStore,Ta(p[0])),x=Vs.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield oa(c,v,x);break}case"rejected":yield cd(c.localStore,e,!0),Qd(c,e,s);break;default:S()}}),Yf.apply(this,arguments)}function Lm(i,e,t){return Qf.apply(this,arguments)}function Qf(){return Qf=(0,De.Z)(function*(i,e,t){const s=Jf(i);if(s.ac){for(const c of e){if(s.ec.has(c)){xt("SyncEngine","Adding an already active target "+c);continue}const p=yield eu(s.localStore,c),v=yield Hd(s.localStore,p);yield Mm(s,md(p),v.targetId,!1),Wd(s.remoteStore,v)}for(const c of t)s.ec.has(c)&&(yield cd(s.localStore,c,!1).then(()=>{dd(s.remoteStore,c),Qd(s,c)}).catch(Ia))}}),Qf.apply(this,arguments)}function Jf(i){const e=N(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=y_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zf.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__.bind(null,e),e.Zu.Go=d_.bind(null,e.eventManager),e.Zu.lc=h_.bind(null,e.eventManager),e}function Xf(i){const e=N(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=v_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=E_.bind(null,e),e}class og{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,De.Z)(function*(){t.wt=Ph(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return Df(this.persistence,new Np,e.initialUser,this.wt)}_c(e){return new Rp(Cf.Ms,this.wt)}dc(e){return new pm}terminate(){var e=this;return(0,De.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Um extends og{constructor(e,t,s){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,s=this;return(0,De.Z)(function*(){yield t().call(s,e),yield s.yc.initialize(s,e),yield Xf(s.yc.syncEngine),yield Fh(s.yc.remoteStore),yield s.persistence.ci(()=>(s.gcScheduler&&!s.gcScheduler.started&&s.gcScheduler.start(),s.indexBackfillerScheduler&&!s.indexBackfillerScheduler.started&&s.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return Df(this.persistence,new Np,e.initialUser,this.wt)}mc(e,t){return new ud(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const s=new ll(t,this.persistence);return new Xo(e.asyncQueue,s)}_c(e){const t=Mp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=void 0!==this.cacheSizeBytes?I.withCacheSize(this.cacheSizeBytes):I.DEFAULT;return new Sc(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,Pf(),Of(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new pm}}class Bm extends Um{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,s=this;return(0,De.Z)(function*(){yield t().call(s,e);const c=s.yc.syncEngine;s.sharedClientState instanceof Nf&&(s.sharedClientState.syncEngine={kr:eh.bind(null,c),Or:Fm.bind(null,c),Mr:Lm.bind(null,c),Ri:km.bind(null,c),Nr:Xd.bind(null,c)},yield s.sharedClientState.start()),yield s.persistence.ci(function(){var p=(0,De.Z)(function*(v){yield function th(i,e){return Pc.apply(this,arguments)}(s.yc.syncEngine,v),s.gcScheduler&&(v&&!s.gcScheduler.started?s.gcScheduler.start():v||s.gcScheduler.stop()),s.indexBackfillerScheduler&&(v&&!s.indexBackfillerScheduler.started?s.indexBackfillerScheduler.start():v||s.indexBackfillerScheduler.stop())});return function(v){return p.apply(this,arguments)}}())})()}dc(e){const t=Pf();if(!Nf.V(t))throw new K(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Mp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Nf(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class ag{initialize(e,t){var s=this;return(0,De.Z)(function*(){s.localStore||(s.localStore=e.localStore,s.sharedClientState=e.sharedClientState,s.datastore=s.createDatastore(t),s.remoteStore=s.createRemoteStore(t),s.eventManager=s.createEventManager(t),s.syncEngine=s.createSyncEngine(t,!e.synchronizeTabs),s.sharedClientState.onlineStateHandler=c=>qf(s.syncEngine,c,1),s.remoteStore.remoteSyncer.handleCredentialChange=Ra.bind(null,s.syncEngine),yield Bf(s.remoteStore,s.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Sm}createDatastore(e){const t=Ph(e.databaseInfo.databaseId),s=new Dl(e.databaseInfo);return new a_(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return t=this.localStore,s=this.datastore,c=e.asyncQueue,p=x=>qf(this.syncEngine,x,0),v=Up.V()?new Up:new r_,new u_(t,s,c,p,v);var t,s,c,p,v}createSyncEngine(e,t){return function(s,c,p,v,x,W,Z){const se=new Rm(s,c,p,v,x,W);return Z&&(se.ac=!0),se}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,De.Z)(function*(t){const s=N(t);xt("RemoteStore","RemoteStore shutting down."),s.lu.add(5),yield Ac(s),s.du.shutdown(),s._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function ug(i,e=10240){let t=0;return{read:()=>(0,De.Z)(function*(){if(t<i.byteLength){const s={value:i.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}})(),cancel:()=>(0,De.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class $h{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class C_{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new de,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(s=>{s&&s.Cu()?this.metadata.resolve(s.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==s?void 0:s.payload)}`))},s=>this.metadata.reject(s))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,De.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,De.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,De.Z)(function*(){const t=yield e.bc();if(null===t)return null;const s=e.Ac.decode(t),c=Number(s);isNaN(c)&&e.Pc(`length string (${s}) is not valid number`);const p=yield e.vc(c);return new u0(JSON.parse(p),t.length+c)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,De.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const s=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),s})()}vc(e){var t=this;return(0,De.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const s=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),s})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,De.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const s=new Uint8Array(e.buffer.length+t.value.length);s.set(e.buffer),s.set(t.value,e.buffer.length),e.buffer=s}return t.done})()}}class b_{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,De.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new K(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const s=yield(c=(0,De.Z)(function*(p,v){const x=N(p),W=m(x.wt)+"/documents",Z={documents:v.map(Et=>Us(x.wt,Et))},se=yield x.ao("BatchGetDocuments",W,Z,v.length),we=new Map;se.forEach(Et=>{const Nt=function Le(i,e){return"found"in e?function(t,s){D(!!s.found);const c=Bs(t,s.found.name),p=Cs(s.found.updateTime),v=new ro({mapValue:{fields:s.found.fields}});return Fi.newFoundDocument(c,p,v)}(i,e):"missing"in e?function(t,s){D(!!s.missing),D(!!s.readTime);const c=Bs(t,s.missing),p=Cs(s.readTime);return Fi.newNoDocument(c,p)}(i,e):S()}(x.wt,Et);we.set(Nt.key.toString(),Nt)});const st=[];return v.forEach(Et=>{const Nt=we.get(Et.toString());D(!!Nt),st.push(Nt)}),st}),function(p,v){return c.apply(this,arguments)})(t.datastore,e);var c;return s.forEach(c=>t.recordVersion(c)),s})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new tl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,De.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var s;e.mutations.forEach(s=>{t.delete(s.key.toString())}),t.forEach((s,c)=>{const p=Zt.fromPath(c);e.mutations.push(new Ru(p,e.precondition(p)))}),yield(s=(0,De.Z)(function*(c,p){const v=N(c),x=m(v.wt)+"/documents",W={writes:p.map(Z=>Lt(v.wt,Z))};yield v.ro("Commit",x,W)}),function(c,p){return s.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw S();t=An.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new K(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?zi.updateTime(t):zi.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(An.min()))throw new K(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return zi.updateTime(t)}return zi.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class jm{constructor(e,t,s,c,p){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=c,this.deferred=p,this.Dc=s.maxAttempts,this.So=new mm(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,De.Z)(function*(){const t=new b_(e.datastore),s=e.xc(t);s&&s.then(c=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(c)}).catch(p=>{e.Nc(p)}))}).catch(c=>{e.Nc(c)})}))}xc(e){try{const t=this.updateFunction(e);return!Ct(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!pc(t)}return!1}}class D_{constructor(e,t,s,c){var p=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=c,this.user=Yi.UNAUTHENTICATED,this.clientId=Lo.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,function(){var v=(0,De.Z)(function*(x){xt("FirestoreClient","Received user=",x.uid),yield p.authCredentialListener(x),p.user=x});return function(x){return v.apply(this,arguments)}}()),this.appCheckCredentials.start(s,v=>(xt("FirestoreClient","Received new app check token=",v),this.appCheckCredentialListener(v,this.user)))}getConfiguration(){var e=this;return(0,De.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new K(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new de;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,De.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(s){const c=qd(s,"Failed to shutdown persistence");t.reject(c)}})),t.promise}}function lg(i,e){return cg.apply(this,arguments)}function cg(){return cg=(0,De.Z)(function*(i,e){i.asyncQueue.verifyOperationInProgress(),xt("FirestoreClient","Initializing OfflineComponentProvider");const t=yield i.getConfiguration();yield e.initialize(t);let s=t.initialUser;i.setCredentialChangeListener(function(){var c=(0,De.Z)(function*(p){s.isEqual(p)||(yield Op(e.localStore,p),s=p)});return function(p){return c.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i.offlineComponents=e}),cg.apply(this,arguments)}function $m(i,e){return Hm.apply(this,arguments)}function Hm(){return Hm=(0,De.Z)(function*(i,e){i.asyncQueue.verifyOperationInProgress();const t=yield dg(i);xt("FirestoreClient","Initializing OnlineComponentProvider");const s=yield i.getConfiguration();yield e.initialize(t,s),i.setCredentialChangeListener(c=>qp(e.remoteStore,c)),i.setAppCheckTokenChangeListener((c,p)=>qp(e.remoteStore,p)),i.onlineComponents=e}),Hm.apply(this,arguments)}function dg(i){return Hh.apply(this,arguments)}function Hh(){return Hh=(0,De.Z)(function*(i){return i.offlineComponents||(xt("FirestoreClient","Using default OfflineComponentProvider"),yield lg(i,new og)),i.offlineComponents}),Hh.apply(this,arguments)}function nh(i){return hg.apply(this,arguments)}function hg(){return hg=(0,De.Z)(function*(i){return i.onlineComponents||(xt("FirestoreClient","Using default OnlineComponentProvider"),yield $m(i,new ag)),i.onlineComponents}),hg.apply(this,arguments)}function T_(i){return dg(i).then(e=>e.persistence)}function Gm(i){return dg(i).then(e=>e.localStore)}function S_(i){return nh(i).then(e=>e.remoteStore)}function fg(i){return nh(i).then(e=>e.syncEngine)}function yd(i){return Wm.apply(this,arguments)}function Wm(){return Wm=(0,De.Z)(function*(i){const e=yield nh(i),t=e.eventManager;return t.onListen=l0.bind(null,e.syncEngine),t.onUnlisten=Pm.bind(null,e.syncEngine),t}),Wm.apply(this,arguments)}function pg(i,e,t={}){const s=new de;return i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return function(c,p,v,x,W){const Z=new $h({next:we=>{p.enqueueAndForget(()=>Hf(c,se));const st=we.docs.has(v);!st&&we.fromCache?W.reject(new K(P.UNAVAILABLE,"Failed to get document because the client is offline.")):st&&we.fromCache&&x&&"server"===x.source?W.reject(new K(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):W.resolve(we)},error:we=>W.reject(we)}),se=new Gf(pl(v.path),Z,{includeMetadataChanges:!0,Du:!0});return jf(c,se)}(yield yd(i),i.asyncQueue,e,t,s)})),s.promise}function gg(i,e,t={}){const s=new de;return i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return function(c,p,v,x,W){const Z=new $h({next:we=>{p.enqueueAndForget(()=>Hf(c,se)),we.fromCache&&"server"===x.source?W.reject(new K(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):W.resolve(we)},error:we=>W.reject(we)}),se=new Gf(v,Z,{includeMetadataChanges:!0,Du:!0});return jf(c,se)}(yield yd(i),i.asyncQueue,e,t,s)})),s.promise}const Km=new Map;function mg(i,e,t){if(!t)throw new K(P.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function qm(i,e,t,s){if(!0===e&&!0===s)throw new K(P.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function Zm(i){if(!Zt.isDocumentKey(i))throw new K(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function yg(i){if(Zt.isDocumentKey(i))throw new K(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function tp(i){if(void 0===i)return"undefined";if(null===i)return"null";if("string"==typeof i)return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if("number"==typeof i||"boolean"==typeof i)return""+i;if("object"==typeof i){if(i instanceof Array)return"an array";{const e=(t=i).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof i?"a function":S()}function Xr(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new K(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tp(i);throw new K(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function _g(i,e){if(e<=0)throw new K(P.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}class np{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new K(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new K(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,qm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rp{constructor(e,t,s){this._authCredentials=t,this._appCheckCredentials=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new np({}),this._settingsFrozen=!1,e instanceof Xe?this._databaseId=e:(this._app=e,this._databaseId=function(c){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new K(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xe(c.options.projectId)}(e))}get app(){if(!this._app)throw new K(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new K(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new np(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new dt;switch(t.type){case"gapi":const s=t.client;return D(!("object"!=typeof s||null===s||!s.auth||!s.auth.getAuthHeaderValueForFirstParty)),new Tr(s,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new K(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Km.get(e);t&&(xt("ComponentProvider","Removing Datastore"),Km.delete(e),t.terminate())}(this),Promise.resolve()}}class Ds{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ds(this.firestore,e,this._key)}}class $a{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new $a(this.firestore,e,this._query)}}class tu extends $a{constructor(e,t,s){super(e,t,pl(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ds(this.firestore,null,new Zt(e))}withConverter(e){return new tu(this.firestore,e,this._path)}}function Eg(i,e,...t){if(i=(0,Ge.m9)(i),mg("collection","path",e),i instanceof rp){const s=Nr.fromString(e,...t);return yg(s),new tu(i,null,s)}{if(!(i instanceof Ds||i instanceof tu))throw new K(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(Nr.fromString(e,...t));return yg(s),new tu(i.firestore,null,s)}}function ih(i,e,...t){if(i=(0,Ge.m9)(i),1===arguments.length&&(e=Lo.I()),mg("doc","path",e),i instanceof rp){const s=Nr.fromString(e,...t);return Zm(s),new Ds(i,null,new Zt(s))}{if(!(i instanceof Ds||i instanceof tu))throw new K(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(Nr.fromString(e,...t));return Zm(s),new Ds(i.firestore,i instanceof tu?i.converter:null,new Zt(s))}}function Ym(i,e){return i=(0,Ge.m9)(i),e=(0,Ge.m9)(e),(i instanceof Ds||i instanceof tu)&&(e instanceof Ds||e instanceof tu)&&i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter}function Gh(i,e){return i=(0,Ge.m9)(i),e=(0,Ge.m9)(e),i instanceof $a&&e instanceof $a&&i.firestore===e.firestore&&oc(i._query,e._query)&&i.converter===e.converter}class ip{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new mm(this,"async_queue_retry"),this.Kc=()=>{const t=Of();t&&xt("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=Of();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=Of();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new de;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}jc(){var e=this;return(0,De.Z)(function*(){if(0!==e.Mc.length){try{yield e.Mc[0](),e.Mc.shift(),e.So.reset()}catch(t){if(!Co(t))throw t;xt("AsyncQueue","Operation failed with retryable error: "+t)}e.Mc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Oc.then(()=>(this.Lc=!0,e().catch(s=>{throw this.Bc=s,this.Lc=!1,ai("INTERNAL UNHANDLED ERROR: ",function(p){let v=p.message||"";return p.stack&&(v=p.stack.includes(p.message)?p.stack:p.message+"\n"+p.stack),v}(s)),s}).then(s=>(this.Lc=!1,s))));return this.Oc=t,t}enqueueAfterDelay(e,t,s){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const c=Yp.createAndSchedule(this,e,t,s,p=>this.Wc(p));return this.$c.push(c),c}Gc(){this.Bc&&S()}verifyOperationInProgress(){}zc(){var e=this;return(0,De.Z)(function*(){let t;do{t=e.Oc,yield t}while(t!==e.Oc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function Wh(i){return function(e,t){if("object"!=typeof e||null===e)return!1;const s=e;for(const c of["next","error","complete"])if(c in s&&"function"==typeof s[c])return!0;return!1}(i)}class c0{constructor(){this._progressObserver={},this._taskCompletionResolver=new de,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class gs extends rp{constructor(e,t,s){super(e,t,s),this.type="firestore",this._queue=new ip,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||sp(this),this._firestoreClient.terminate()}}function mo(i){return i._firestoreClient||sp(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function sp(i){var e;const t=i._freezeSettings(),s=(p=(null===(e=i._app)||void 0===e?void 0:e.options.appId)||"",new $e(i._databaseId,p,i._persistenceKey,(x=t).host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,x.useFetchStreams));var p,x;i._firestoreClient=new D_(i._authCredentials,i._appCheckCredentials,i._queue,s)}function op(i,e,t){const s=new de;return i.asyncQueue.enqueue((0,De.Z)(function*(){try{yield lg(i,t),yield $m(i,e),s.resolve()}catch(c){const p=c;if(!("FirebaseError"===(v=p).name?v.code===P.FAILED_PRECONDITION||v.code===P.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&v instanceof DOMException)||22===v.code||20===v.code||11===v.code))throw p;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+p),s.reject(p)}var v})).then(()=>s.promise)}function Ig(i){if(i._initialized||i._terminated)throw new K(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Tl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new K(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Uu(ki.fromBase64String(e))}catch(t){throw new K(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Uu(ki.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class kc{constructor(e){this._methodName=e}}class zh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Dn(this._lat,e._lat)||Dn(this._long,e._long)}}const sy=/^__.*__$/;class oy{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return null!==this.fieldMask?new cu(e,this.data,this.fieldMask,t,this.fieldTransforms):new lu(e,this.data,t,this.fieldTransforms)}}class Cg{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new cu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function bg(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw S()}}class Kh{constructor(e,t,s,c,p,v){this.settings=e,this.databaseId=t,this.wt=s,this.ignoreUndefinedProperties=c,void 0===p&&this.Xc(),this.fieldTransforms=p||[],this.fieldMask=v||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Kh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const s=null===(t=this.path)||void 0===t?void 0:t.child(e),c=this.ta({path:s,na:!1});return c.sa(e),c}ia(e){var t;const s=null===(t=this.path)||void 0===t?void 0:t.child(e),c=this.ta({path:s,na:!1});return c.Xc(),c}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Zh(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(bg(this.Zc)&&sy.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class ay{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=s||Ph(e)}aa(e,t,s,c=!1){return new Kh({Zc:e,methodName:t,ca:s,path:hs.emptyPath(),na:!1,ua:c},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function sh(i){const e=i._freezeSettings(),t=Ph(i._databaseId);return new ay(i._databaseId,!!e.ignoreUndefinedProperties,t)}function ap(i,e,t,s,c,p={}){const v=i.aa(p.merge||p.mergeFields?2:0,e,t,c);xg("Data must be an object, but it was:",v,s);const x=Ag(s,v);let W,Z;if(p.merge)W=new Wi(v.fieldMask),Z=v.fieldTransforms;else if(p.mergeFields){const se=[];for(const we of p.mergeFields){const st=Rg(e,we,t);if(!v.contains(st))throw new K(P.INVALID_ARGUMENT,`Field '${st}' is specified in your field mask but missing from your input data.`);U_(se,st)||se.push(st)}W=new Wi(se),Z=v.fieldTransforms.filter(we=>W.covers(we.field))}else W=null,Z=v.fieldTransforms;return new oy(new ro(x),W,Z)}class qh extends kc{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qh}}function Dg(i,e,t){return new Kh({Zc:3,ca:e.settings.ca,methodName:i._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class Tg extends kc{_toFieldTransform(e){return new Ju(e.path,new Su)}isEqual(e){return e instanceof Tg}}class Wo extends kc{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=Dg(this,e,!0),s=this.ha.map(p=>Fc(p,t)),c=new Au(s);return new Ju(e.path,c)}isEqual(e){return this===e}}class uy extends kc{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=Dg(this,e,!0),s=this.ha.map(p=>Fc(p,t)),c=new xu(s);return new Ju(e.path,c)}isEqual(e){return this===e}}class V_ extends kc{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new Qu(e.wt,mh(e.wt,this.la));return new Ju(e.path,t)}isEqual(e){return this===e}}function Sg(i,e,t,s){const c=i.aa(1,e,t);xg("Data must be an object, but it was:",c,s);const p=[],v=ro.empty();Ya(s,(W,Z)=>{const se=lp(e,W,t);Z=(0,Ge.m9)(Z);const we=c.ia(se);if(Z instanceof qh)p.push(se);else{const st=Fc(Z,we);null!=st&&(p.push(se),v.set(se,st))}});const x=new Wi(p);return new Cg(v,x,c.fieldTransforms)}function up(i,e,t,s,c,p){const v=i.aa(1,e,t),x=[Rg(e,s,t)],W=[c];if(p.length%2!=0)throw new K(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let st=0;st<p.length;st+=2)x.push(Rg(e,p[st])),W.push(p[st+1]);const Z=[],se=ro.empty();for(let st=x.length-1;st>=0;--st)if(!U_(Z,x[st])){const Et=x[st];let Nt=W[st];Nt=(0,Ge.m9)(Nt);const mn=v.ia(Et);if(Nt instanceof qh)Z.push(Et);else{const Rn=Fc(Nt,mn);null!=Rn&&(Z.push(Et),se.set(Et,Rn))}}const we=new Wi(Z);return new Cg(se,we,v.fieldTransforms)}function ly(i,e,t,s=!1){return Fc(t,i.aa(s?4:3,e))}function Fc(i,e){if(_d(i=(0,Ge.m9)(i)))return xg("Unsupported field value:",e,i),Ag(i,e);if(i instanceof kc)return function(t,s){if(!bg(s.Zc))throw s.oa(`${t._methodName}() can only be used with update() and set()`);if(!s.path)throw s.oa(`${t._methodName}() is not currently supported inside arrays`);const c=t._toFieldTransform(s);c&&s.fieldTransforms.push(c)}(i,e),null;if(void 0===i&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,s){const c=[];let p=0;for(const v of t){let x=Fc(v,s.ra(p));null==x&&(x={nullValue:"NULL_VALUE"}),c.push(x),p++}return{arrayValue:{values:c}}}(i,e)}return function(t,s){if(null===(t=(0,Ge.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return mh(s.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const c=ui.fromDate(t);return{timestampValue:Mu(s.wt,c)}}if(t instanceof ui){const c=new ui(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mu(s.wt,c)}}if(t instanceof zh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Uu)return{bytesValue:Ec(s.wt,t._byteString)};if(t instanceof Ds){const c=s.databaseId,p=t.firestore._databaseId;if(!p.isEqual(c))throw s.oa(`Document reference is for database ${p.projectId}/${p.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:wc(t.firestore._databaseId||s.databaseId,t._key.path)}}throw s.oa(`Unsupported field value: ${tp(t)}`)}(i,e)}function Ag(i,e){const t={};return Ua(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ya(i,(s,c)=>{const p=Fc(c,e.ea(s));null!=p&&(t[s]=p)}),{mapValue:{fields:t}}}function _d(i){return!("object"!=typeof i||null===i||i instanceof Array||i instanceof Date||i instanceof ui||i instanceof zh||i instanceof Uu||i instanceof Ds||i instanceof kc)}function xg(i,e,t){if(!_d(t)||"object"!=typeof(s=t)||null===s||Object.getPrototypeOf(s)!==Object.prototype&&null!==Object.getPrototypeOf(s)){const s=tp(t);throw e.oa("an object"===s?i+" a custom object":i+" "+s)}var s}function Rg(i,e,t){if((e=(0,Ge.m9)(e))instanceof Tl)return e._internalPath;if("string"==typeof e)return lp(i,e);throw Zh("Field path arguments must be of type string or ",i,!1,void 0,t)}const cy=new RegExp("[~\\*/\\[\\]]");function lp(i,e,t){if(e.search(cy)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new Tl(...e.split("."))._internalPath}catch(s){throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Zh(i,e,t,s,c){const p=s&&!s.isEmpty(),v=void 0!==c;let x=`Function ${e}() called with invalid data`;t&&(x+=" (via `toFirestore()`)"),x+=". ";let W="";return(p||v)&&(W+=" (found",p&&(W+=` in field ${s}`),v&&(W+=` in document ${c}`),W+=")"),new K(P.INVALID_ARGUMENT,x+i+W)}function U_(i,e){return i.some(t=>t.isEqual(e))}class oh{constructor(e,t,s,c,p){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=c,this._converter=p}get id(){return this._key.path.lastSegment()}get ref(){return new Ds(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Mg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mu("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Mg extends oh{data(){return super.data()}}function mu(i,e){return"string"==typeof e?lp(i,e):e instanceof Tl?e._internalPath:e._delegate._internalPath}class vd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yl extends oh{constructor(e,t,s,c,p,v){super(e,t,s,c,v),this._firestore=e,this._firestoreImpl=e,this.metadata=p}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new nu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(mu("DocumentSnapshot.get",e));if(null!==s)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class nu extends Yl{data(e={}){return super.data(e)}}class aa{constructor(e,t,s,c){this._firestore=e,this._userDataWriter=t,this._snapshot=c,this.metadata=new vd(c.hasPendingWrites,c.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new nu(this._firestore,this._userDataWriter,s.key,s,new vd(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new K(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,c){if(s._snapshot.oldDocs.isEmpty()){let p=0;return s._snapshot.docChanges.map(v=>({type:"added",doc:new nu(s._firestore,s._userDataWriter,v.doc.key,v.doc,new vd(s._snapshot.mutatedKeys.has(v.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:p++}))}{let p=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(v=>c||3!==v.type).map(v=>{const x=new nu(s._firestore,s._userDataWriter,v.doc.key,v.doc,new vd(s._snapshot.mutatedKeys.has(v.doc.key),s._snapshot.fromCache),s.query.converter);let W=-1,Z=-1;return 0!==v.type&&(W=p.indexOf(v.doc.key),p=p.delete(v.doc.key)),1!==v.type&&(p=p.add(v.doc),Z=p.indexOf(v.doc.key)),{type:sl(v.type),doc:x,oldIndex:W,newIndex:Z}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function sl(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return S()}}function Ng(i,e){return i instanceof Yl&&e instanceof Yl?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(null===i._document?null===e._document:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof aa&&e instanceof aa&&i._firestore===e._firestore&&Gh(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot)}function Pg(i){if("L"===i.limitType&&0===i.explicitOrderBy.length)throw new K(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yh{}function Lc(i,...e){for(const t of e)i=t._apply(i);return i}class B_ extends Yh{constructor(e,t,s){super(),this.fa=e,this.da=t,this._a=s,this.type="where"}_apply(e){const t=sh(e.firestore),s=function(c,p,v,x,W,Z,se){let we;if(W.isKeyField()){if("array-contains"===Z||"array-contains-any"===Z)throw new K(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${Z}' queries on documentId().`);if("in"===Z||"not-in"===Z){Fg(se,Z);const Et=[];for(const Nt of se)Et.push(Jh(x,c,Nt));we={arrayValue:{values:Et}}}else we=Jh(x,c,se)}else"in"!==Z&&"not-in"!==Z&&"array-contains-any"!==Z||Fg(se,Z),we=ly(v,"where",se,"in"===Z||"not-in"===Z);const st=Ls.create(W,Z,we);return function(Et,Nt){if(Nt.ht()){const Rn=bu(Et);if(null!==Rn&&!Rn.isEqual(Nt.field))throw new K(P.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Rn.toString()}' and '${Nt.field.toString()}'`);const Ri=gl(Et);null!==Ri&&Lg(0,Nt.field,Ri)}const mn=function(Rn,Ri){for(const Ts of Rn.filters)if(Ri.indexOf(Ts.op)>=0)return Ts.op;return null}(Et,function(Rn){switch(Rn){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(Nt.op));if(null!==mn)throw new K(P.INVALID_ARGUMENT,mn===Nt.op?`Invalid query. You cannot use more than one '${Nt.op.toString()}' filter.`:`Invalid query. You cannot use '${Nt.op.toString()}' filters with '${mn.toString()}' filters.`)}(c,st),st}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new $a(e.firestore,e.converter,function(c,p){const v=c.filters.concat([p]);return new Ks(c.path,c.collectionGroup,c.explicitOrderBy.slice(),v,c.limit,c.limitType,c.startAt,c.endAt)}(e._query,s))}}class Og extends Yh{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(s,c,p){if(null!==s.startAt)throw new K(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==s.endAt)throw new K(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const v=new au(c,p);return function(x,W){if(null===gl(x)){const Z=bu(x);null!==Z&&Lg(0,Z,W.field)}}(s,v),v}(e._query,this.fa,this.wa);return new $a(e.firestore,e.converter,function(s,c){const p=s.explicitOrderBy.concat([c]);return new Ks(s.path,s.collectionGroup,p,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}class dy extends Yh{constructor(e,t,s){super(),this.type=e,this.ma=t,this.ga=s}_apply(e){return new $a(e.firestore,e.converter,Wc(e._query,this.ma,this.ga))}}class kg extends Yh{constructor(e,t,s){super(),this.type=e,this.ya=t,this.pa=s}_apply(e){const t=dp(e,this.type,this.ya,this.pa);return new $a(e.firestore,e.converter,(c=t,new Ks((s=e._query).path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,c,s.endAt)));var s,c}}class py extends Yh{constructor(e,t,s){super(),this.type=e,this.ya=t,this.pa=s}_apply(e){const t=dp(e,this.type,this.ya,this.pa);return new $a(e.firestore,e.converter,(c=t,new Ks((s=e._query).path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,c)));var s,c}}function dp(i,e,t,s){if(t[0]=(0,Ge.m9)(t[0]),t[0]instanceof oh)return function(c,p,v,x,W){if(!x)throw new K(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${v}().`);const Z=[];for(const se of Zu(c))if(se.field.isKeyField())Z.push(Is(p,x.key));else{const we=x.data.field(se.field);if(j(we))throw new K(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+se.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===we){const st=se.field.canonicalString();throw new K(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${st}' (used as the orderBy) does not exist.`)}Z.push(we)}return new Xa(Z,W)}(i._query,i.firestore._databaseId,e,t[0]._document,s);{const c=sh(i.firestore);return function(p,v,x,W,Z,se){const we=p.explicitOrderBy;if(Z.length>we.length)throw new K(P.INVALID_ARGUMENT,`Too many arguments provided to ${W}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const st=[];for(let Et=0;Et<Z.length;Et++){const Nt=Z[Et];if(we[Et].field.isKeyField()){if("string"!=typeof Nt)throw new K(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${W}(), but got a ${typeof Nt}`);if(!Du(p)&&-1!==Nt.indexOf("/"))throw new K(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${W}() must be a plain document ID, but '${Nt}' contains a slash.`);const mn=p.path.child(Nr.fromString(Nt));if(!Zt.isDocumentKey(mn))throw new K(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${W}() must result in a valid document path, but '${mn}' is not because it contains an odd number of segments.`);const Rn=new Zt(mn);st.push(Is(v,Rn))}else{const mn=ly(x,W,Nt);st.push(mn)}}return new Xa(st,se)}(i._query,i.firestore._databaseId,c,e,t,s)}}function Jh(i,e,t){if("string"==typeof(t=(0,Ge.m9)(t))){if(""===t)throw new K(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Du(e)&&-1!==t.indexOf("/"))throw new K(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Nr.fromString(t));if(!Zt.isDocumentKey(s))throw new K(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Is(i,new Zt(s))}if(t instanceof Ds)return Is(i,t._key);throw new K(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tp(t)}.`)}function Fg(i,e){if(!Array.isArray(i)||0===i.length)throw new K(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(i.length>10)throw new K(P.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Lg(i,e,t){if(!t.isEqual(e))throw new K(P.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const yy={maxAttempts:5};class hp{convertValue(e,t="none"){switch(_n(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ai(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(L(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw S()}}convertObject(e,t){const s={};return Ya(e.fields,(c,p)=>{s[c]=this.convertValue(p,t)}),s}convertGeoPoint(e){return new zh(Ai(e.latitude),Ai(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=X(e);return null==s?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(me(e));default:return null}}convertTimestamp(e){const t=bo(e);return new ui(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Nr.fromString(e);D($l(s));const c=new Xe(s.get(1),s.get(3)),p=new Zt(s.popFirst(5));return c.isEqual(t)||ai(`Document ${p} contains a document reference within a different database (${c.projectId}/${c.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),p}}function Xh(i,e,t){let s;return s=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,s}class _y extends hp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Uu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ds(this.firestore,null,t)}}class Vg{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=sh(e)}set(e,t,s){this._verifyNotCommitted();const c=Ql(e,this._firestore),p=Xh(c.converter,t,s),v=ap(this._dataReader,"WriteBatch.set",c._key,p,null!==c.converter,s);return this._mutations.push(v.toMutation(c._key,zi.none())),this}update(e,t,s,...c){this._verifyNotCommitted();const p=Ql(e,this._firestore);let v;return v="string"==typeof(t=(0,Ge.m9)(t))||t instanceof Tl?up(this._dataReader,"WriteBatch.update",p._key,t,s,c):Sg(this._dataReader,"WriteBatch.update",p._key,t),this._mutations.push(v.toMutation(p._key,zi.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ql(e,this._firestore);return this._mutations=this._mutations.concat(new tl(t._key,zi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new K(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ql(i,e){if((i=(0,Ge.m9)(i)).firestore!==e)throw new K(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}class Ed extends hp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Uu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ds(this.firestore,null,t)}}function vy(i,e,t){i=Xr(i,Ds);const s=Xr(i.firestore,gs),c=Xh(i.converter,e,t);return ah(s,[ap(sh(s),"setDoc",i._key,c,null!==i.converter,t).toMutation(i._key,zi.none())])}function Ey(i,e,t,...s){i=Xr(i,Ds);const c=Xr(i.firestore,gs),p=sh(c);let v;return v="string"==typeof(e=(0,Ge.m9)(e))||e instanceof Tl?up(p,"updateDoc",i._key,e,t,s):Sg(p,"updateDoc",i._key,e),ah(c,[v.toMutation(i._key,zi.exists(!0))])}function wy(i,...e){var t,s,c;i=(0,Ge.m9)(i);let p={includeMetadataChanges:!1},v=0;"object"!=typeof e[v]||Wh(e[v])||(p=e[v],v++);const x={includeMetadataChanges:p.includeMetadataChanges};if(Wh(e[v])){const we=e[v];e[v]=null===(t=we.next)||void 0===t?void 0:t.bind(we),e[v+1]=null===(s=we.error)||void 0===s?void 0:s.bind(we),e[v+2]=null===(c=we.complete)||void 0===c?void 0:c.bind(we)}let W,Z,se;if(i instanceof Ds)Z=Xr(i.firestore,gs),se=pl(i._key.path),W={next:we=>{e[v]&&e[v](Ug(Z,i,we))},error:e[v+1],complete:e[v+2]};else{const we=Xr(i,$a);Z=Xr(we.firestore,gs),se=we._query;const st=new Ed(Z);W={next:Et=>{e[v]&&e[v](new aa(Z,st,we,Et))},error:e[v+1],complete:e[v+2]},Pg(i._query)}return function(we,st,Et,Nt){const mn=new $h(Nt),Rn=new Gf(st,mn,Et);return we.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return jf(yield yd(we),Rn)})),()=>{mn.Tc(),we.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return Hf(yield yd(we),Rn)}))}}(mo(Z),se,x,W)}function ah(i,e){return function(t,s){const c=new de;return t.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return function Om(i,e,t){return tg.apply(this,arguments)}(yield fg(t),s,c)})),c.promise}(mo(i),e)}function Ug(i,e,t){const s=t.docs.get(e._key),c=new Ed(i);return new Yl(i,c,e._key,s,new vd(t.hasPendingWrites,t.fromCache),e.converter)}class J_ extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=sh(e)}get(e){const t=Ql(e,this._firestore),s=new _y(this._firestore);return this._transaction.lookup([t._key]).then(c=>{if(!c||1!==c.length)return S();const p=c[0];if(p.isFoundDocument())return new oh(this._firestore,s,p.key,p,t.converter);if(p.isNoDocument())return new oh(this._firestore,s,t._key,null,t.converter);throw S()})}set(e,t,s){const c=Ql(e,this._firestore),p=Xh(c.converter,t,s),v=ap(this._dataReader,"Transaction.set",c._key,p,null!==c.converter,s);return this._transaction.set(c._key,v),this}update(e,t,s,...c){const p=Ql(e,this._firestore);let v;return v="string"==typeof(t=(0,Ge.m9)(t))||t instanceof Tl?up(this._dataReader,"Transaction.update",p._key,t,s,c):Sg(this._dataReader,"Transaction.update",p._key,t),this._transaction.update(p._key,v),this}delete(e){const t=Ql(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ql(e,this._firestore),s=new Ed(this._firestore);return super.get(e).then(c=>new Yl(this._firestore,s,t._key,c._document,new vd(!1,!1),t.converter))}}function fp(i,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new K("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}function jg(){if("undefined"==typeof Uint8Array)throw new K("unimplemented","Uint8Arrays are not available in this environment.")}function Vc(){if(!function dh(){return"undefined"!=typeof atob}())throw new K("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(i,e=!0){Ps=kt.SDK_VERSION,(0,kt._registerComponent)(new ht.wA("firestore",(t,{options:s})=>{const c=t.getProvider("app").getImmediate(),p=new gs(c,new yr(t.getProvider("auth-internal")),new to(t.getProvider("app-check-internal")));return s=Object.assign({useFetchStreams:e},s),p._setSettings(s),p},"PUBLIC")),(0,kt.registerVersion)(Gs,"3.4.11",i),(0,kt.registerVersion)(Gs,"3.4.11","esm2017")}();class ef{constructor(e){this._delegate=e}static fromBase64String(e){return Vc(),new ef(Uu.fromBase64String(e))}static fromUint8Array(e){return jg(),new ef(Uu.fromUint8Array(e))}toBase64(){return Vc(),this._delegate.toBase64()}toUint8Array(){return jg(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function $g(i){return function uh(i,e){if("object"!=typeof i||null===i)return!1;const t=i;for(const s of e)if(s in t&&"function"==typeof t[s])return!0;return!1}(i,["next","error","complete"])}class d0{enableIndexedDbPersistence(e,t){return function Jm(i,e){Ig(i=Xr(i,gs));const t=mo(i),s=i._freezeSettings(),c=new ag;return op(t,c,new Um(c,s.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Xm(i){Ig(i=Xr(i,gs));const e=mo(i),t=i._freezeSettings(),s=new ag;return op(e,s,new Bm(s,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function ey(i){if(i._initialized&&!i._terminated)throw new K(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new de;return i._queue.enqueueAndForgetEvenWhileRestricted((0,De.Z)(function*(){try{yield(t=(0,De.Z)(function*(s){if(!no.V())return Promise.resolve();const c=s+"main";yield no.delete(c)}),function(s){return t.apply(this,arguments)})(Mp(i._databaseId,i._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class pp{constructor(e,t,s){this._delegate=t,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof Xe||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Jo("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,s={}){!function vg(i,e,t,s={}){var c;const p=(i=Xr(i,rp))._getSettings();if("firestore.googleapis.com"!==p.host&&p.host!==e&&Jo("Host has been set in both settings() and useEmulator(), emulator host will be used"),i._setSettings(Object.assign(Object.assign({},p),{host:`${e}:${t}`,ssl:!1})),s.mockUserToken){let v,x;if("string"==typeof s.mockUserToken)v=s.mockUserToken,x=Yi.MOCK_USER;else{v=(0,Ge.Sg)(s.mockUserToken,null===(c=i._app)||void 0===c?void 0:c.options.projectId);const W=s.mockUserToken.sub||s.mockUserToken.user_id;if(!W)throw new K(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new Yi(W)}i._authCredentials=new Jt(new Ie(v,x))}}(this._delegate,e,t,s)}enableNetwork(){return function ty(i){return function A_(i){return i.asyncQueue.enqueue((0,De.Z)(function*(){const e=yield T_(i),t=yield S_(i);return e.setNetworkEnabled(!0),function(s){const c=N(s);return c.lu.delete(0),Oh(c)}(t)}))}(mo(i=Xr(i,gs)))}(this._delegate)}disableNetwork(){return function ny(i){return function rh(i){return i.asyncQueue.enqueue((0,De.Z)(function*(){const e=yield T_(i),t=yield S_(i);return e.setNetworkEnabled(!1),(s=(0,De.Z)(function*(c){const p=N(c);p.lu.add(0),yield Ac(p),p._u.set("Offline")}),function(c){return s.apply(this,arguments)})(t);var s}))}(mo(i=Xr(i,gs)))}(this._delegate)}enablePersistence(e){let t=!1,s=!1;return e&&(t=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,qm("synchronizeTabs",t,"experimentalForceOwningTab",s)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function k_(i){return function(e){const t=new de;return e.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return function w_(i,e){return ig.apply(this,arguments)}(yield fg(e),t)})),t.promise}(mo(i=Xr(i,gs)))}(this._delegate)}onSnapshotsInSync(e){return function Q_(i,e){return function ep(i,e){const t=new $h(e);return i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return s=yield yd(i),c=t,N(s).Tu.add(c),void c.next();var s,c})),()=>{t.Tc(),i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return s=yield yd(i),c=t,void N(s).Tu.delete(c);var s,c}))}}(mo(i=Xr(i,gs)),Wh(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new K("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new wd(this,Eg(this._delegate,e))}catch(t){throw Ha(t,"collection()","Firestore.collection()")}}doc(e){try{return new Bu(this,ih(this._delegate,e))}catch(t){throw Ha(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ua(this,function wg(i,e){if(i=Xr(i,rp),mg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new K(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new $a(i,null,(t=e,new Ks(Nr.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ha(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function X_(i,e,t){i=Xr(i,gs);const s=Object.assign(Object.assign({},yy),t);return function(c){if(c.maxAttempts<1)throw new K(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function M_(i,e,t){const s=new de;return i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){const c=yield(p=i,nh(p).then(v=>v.datastore));var p;new jm(i.asyncQueue,c,t,e,s).run()})),s.promise}(mo(i),c=>e(new J_(i,c)),s)}(this._delegate,t=>e(new Gg(this,t)))}batch(){return mo(this._delegate),new rv(new Vg(this._delegate,e=>ah(this._delegate,e)))}loadBundle(e){return function iy(i,e){const t=mo(i=Xr(i,gs)),s=new c0;return function zm(i,e,t,s){const c=function(p,v){let x;return x="string"==typeof p?(new TextEncoder).encode(p):p,W=function(W,Z){if(W instanceof Uint8Array)return ug(W,Z);if(W instanceof ArrayBuffer)return ug(new Uint8Array(W),Z);if(W instanceof ReadableStream)return W.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(x),new C_(W,v);var W}(t,Ph(e));i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){!function Vm(i,e,t){const s=N(i);var c;(c=(0,De.Z)(function*(p,v,x){try{const W=yield v.getMetadata();if(yield function(st,Et){const Nt=N(st),mn=Cs(Et.createTime);return Nt.persistence.runTransaction("hasNewerBundle","readonly",Rn=>Nt.Ds.getBundleMetadata(Rn,Et.id)).then(Rn=>!!Rn&&Rn.createTime.compareTo(mn)>=0)}(p.localStore,W))return yield v.close(),x._completeWith({taskState:"Success",documentsLoaded:(st=W).totalDocuments,bytesLoaded:st.totalBytes,totalDocuments:st.totalDocuments,totalBytes:st.totalBytes}),Promise.resolve(new Set);x._updateProgress(Am(W));const Z=new f_(W,p.localStore,v.wt);let se=yield v.fc();for(;se;){const st=yield Z.Nu(se);st&&x._updateProgress(st),se=yield v.fc()}const we=yield Z.complete();return yield oa(p,we.Mu,void 0),yield function(st,Et){const Nt=N(st);return Nt.persistence.runTransaction("Save bundle","readwrite",mn=>Nt.Ds.saveBundleMetadata(mn,Et))}(p.localStore,W),x._completeWith(we.progress),Promise.resolve(we.Ou)}catch(W){return Jo("SyncEngine",`Loading bundle failed with ${W}`),x._failWith(W),Promise.resolve(new Set)}var st}),function(p,v,x){return c.apply(this,arguments)})(s,e,t).then(c=>{s.sharedClientState.notifyBundleLoaded(c)})}(yield fg(i),c,s)}))}(t,i._databaseId,e,s),s}(this._delegate,e)}namedQuery(e){return function F_(i,e){return function N_(i,e){return i.asyncQueue.enqueue((0,De.Z)(function*(){return function(t,s){const c=N(t);return c.persistence.runTransaction("Get named query","readonly",p=>c.Ds.getNamedQuery(p,s))}(yield Gm(i),e)}))}(mo(i=Xr(i,gs)),e).then(t=>t?new $a(i,null,t.query):null)}(this._delegate,e).then(t=>t?new ua(this,t):null)}}class Hg extends hp{constructor(e){super(),this.firestore=e}convertBytes(e){return new ef(new Uu(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Bu.forKey(t,this.firestore,null)}}class Gg{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Hg(e)}get(e){const t=Id(e);return this._delegate.get(t).then(s=>new nf(this._firestore,new Yl(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,t.converter)))}set(e,t,s){const c=Id(e);return s?(fp("Transaction.set",s),this._delegate.set(c,t,s)):this._delegate.set(c,t),this}update(e,t,s,...c){const p=Id(e);return 2===arguments.length?this._delegate.update(p,t):this._delegate.update(p,t,s,...c),this}delete(e){const t=Id(e);return this._delegate.delete(t),this}}class rv{constructor(e){this._delegate=e}set(e,t,s){const c=Id(e);return s?(fp("WriteBatch.set",s),this._delegate.set(c,t,s)):this._delegate.set(c,t),this}update(e,t,s,...c){const p=Id(e);return 2===arguments.length?this._delegate.update(p,t):this._delegate.update(p,t,s,...c),this}delete(e){const t=Id(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Ln{constructor(e,t,s){this._firestore=e,this._userDataWriter=t,this._delegate=s}fromFirestore(e,t){const s=new nu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Uc(this._firestore,s),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const s=Ln.INSTANCES;let c=s.get(e);c||(c=new WeakMap,s.set(e,c));let p=c.get(t);return p||(p=new Ln(e,new Hg(e),t),c.set(t,p)),p}}Ln.INSTANCES=new WeakMap;class Bu{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Hg(e)}static forPath(e,t,s){if(e.length%2!=0)throw new K("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Bu(t,new Ds(t._delegate,s,new Zt(e)))}static forKey(e,t,s){return new Bu(t,new Ds(t._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new wd(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new wd(this.firestore,Eg(this._delegate,e))}catch(t){throw Ha(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Ge.m9)(e))instanceof Ds&&Ym(this._delegate,e)}set(e,t){t=fp("DocumentReference.set",t);try{return t?vy(this._delegate,e,t):vy(this._delegate,e)}catch(s){throw Ha(s,"setDoc()","DocumentReference.set()")}}update(e,t,...s){try{return 1===arguments.length?Ey(this._delegate,e):Ey(this._delegate,e,t,...s)}catch(c){throw Ha(c,"updateDoc()","DocumentReference.update()")}}delete(){return function Z_(i){return ah(Xr(i.firestore,gs),[new tl(i._key,zi.none())])}(this._delegate)}onSnapshot(...e){const t=xy(e),s=tf(e,c=>new nf(this.firestore,new Yl(this.firestore._delegate,this._userDataWriter,c._key,c._document,c.metadata,this._delegate.converter)));return wy(this._delegate,t,s)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function G_(i){i=Xr(i,Ds);const e=Xr(i.firestore,gs),t=mo(e),s=new Ed(e);return function x_(i,e){const t=new de;return i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return(s=(0,De.Z)(function*(c,p,v){try{const x=yield function(W,Z){const se=N(W);return se.persistence.runTransaction("read document","readonly",we=>se.localDocuments.getDocument(we,Z))}(c,p);x.isFoundDocument()?v.resolve(x):x.isNoDocument()?v.resolve(null):v.reject(new K(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(x){const W=qd(x,`Failed to get document '${p} from cache`);v.reject(W)}}),function(c,p,v){return s.apply(this,arguments)})(yield Gm(i),e,t);var s})),t.promise}(t,i._key).then(c=>new Yl(e,s,i._key,c,new vd(null!==c&&c.hasLocalMutations,!0),i.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function W_(i){i=Xr(i,Ds);const e=Xr(i.firestore,gs);return pg(mo(e),i._key,{source:"server"}).then(t=>Ug(e,i,t))}(this._delegate):function H_(i){i=Xr(i,Ds);const e=Xr(i.firestore,gs);return pg(mo(e),i._key).then(t=>Ug(e,i,t))}(this._delegate),t.then(s=>new nf(this.firestore,new Yl(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new Bu(this.firestore,this._delegate.withConverter(e?Ln.getInstance(this.firestore,e):null))}}function Ha(i,e,t){return i.message=i.message.replace(e,t),i}function xy(i){for(const e of i)if("object"==typeof e&&!$g(e))return e;return{}}function tf(i,e){var t,s;let c;return c=$g(i[0])?i[0]:$g(i[1])?i[1]:"function"==typeof i[0]?{next:i[0],error:i[1],complete:i[2]}:{next:i[1],error:i[2],complete:i[3]},{next:p=>{c.next&&c.next(e(p))},error:null===(t=c.error)||void 0===t?void 0:t.bind(c),complete:null===(s=c.complete)||void 0===s?void 0:s.bind(c)}}class nf{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Bu(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Ng(this._delegate,e._delegate)}}class Uc extends nf{data(e){const t=this._delegate.data(e);return function b(i,e){i||S()}(void 0!==t),t}}class ua{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Hg(e)}where(e,t,s){try{return new ua(this.firestore,Lc(this._delegate,function j_(i,e,t){const s=e,c=mu("where",i);return new B_(c,s,t)}(e,t,s)))}catch(c){throw Ha(c,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new ua(this.firestore,Lc(this._delegate,function Qh(i,e="asc"){const t=e,s=mu("orderBy",i);return new Og(s,t)}(e,t)))}catch(s){throw Ha(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ua(this.firestore,Lc(this._delegate,function hy(i){return _g("limit",i),new dy("limit",i,"F")}(e)))}catch(t){throw Ha(t,"limit()","Query.limit()")}}limitToLast(e){try{return new ua(this.firestore,Lc(this._delegate,function $_(i){return _g("limitToLast",i),new dy("limitToLast",i,"L")}(e)))}catch(t){throw Ha(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ua(this.firestore,Lc(this._delegate,function fy(...i){return new kg("startAt",i,!0)}(...e)))}catch(t){throw Ha(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ua(this.firestore,Lc(this._delegate,function cp(...i){return new kg("startAfter",i,!1)}(...e)))}catch(t){throw Ha(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ua(this.firestore,Lc(this._delegate,function gy(...i){return new py("endBefore",i,!1)}(...e)))}catch(t){throw Ha(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ua(this.firestore,Lc(this._delegate,function my(...i){return new py("endAt",i,!0)}(...e)))}catch(t){throw Ha(t,"endAt()","Query.endAt()")}}isEqual(e){return Gh(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function K_(i){i=Xr(i,$a);const e=Xr(i.firestore,gs),t=mo(e),s=new Ed(e);return function R_(i,e){const t=new de;return i.asyncQueue.enqueueAndForget((0,De.Z)(function*(){return(s=(0,De.Z)(function*(c,p,v){try{const x=yield Tf(c,p,!0),W=new Wf(p,x.ji),Z=W.Ku(x.documents),se=W.applyChanges(Z,!1);v.resolve(se.snapshot)}catch(x){const W=qd(x,`Failed to execute query '${p} against cache`);v.reject(W)}}),function(c,p,v){return s.apply(this,arguments)})(yield Gm(i),e,t);var s})),t.promise}(t,i._query).then(c=>new aa(e,s,i,c))}(this._delegate):"server"===(null==e?void 0:e.source)?function q_(i){i=Xr(i,$a);const e=Xr(i.firestore,gs),t=mo(e),s=new Ed(e);return gg(t,i._query,{source:"server"}).then(c=>new aa(e,s,i,c))}(this._delegate):function z_(i){i=Xr(i,$a);const e=Xr(i.firestore,gs),t=mo(e),s=new Ed(e);return Pg(i._query),gg(t,i._query).then(c=>new aa(e,s,i,c))}(this._delegate),t.then(s=>new Ry(this.firestore,new aa(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const t=xy(e),s=tf(e,c=>new Ry(this.firestore,new aa(this.firestore._delegate,this._userDataWriter,this._delegate,c._snapshot)));return wy(this._delegate,t,s)}withConverter(e){return new ua(this.firestore,this._delegate.withConverter(e?Ln.getInstance(this.firestore,e):null))}}class so{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Uc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ry{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ua(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Uc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new so(this._firestore,t))}forEach(e,t){this._delegate.forEach(s=>{e.call(t,new Uc(this._firestore,s))})}isEqual(e){return Ng(this._delegate,e._delegate)}}class wd extends ua{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Bu(this.firestore,e):null}doc(e){try{return new Bu(this.firestore,void 0===e?ih(this._delegate):ih(this._delegate,e))}catch(t){throw Ha(t,"doc()","CollectionReference.doc()")}}add(e){return function Y_(i,e){const t=Xr(i.firestore,gs),s=ih(i),c=Xh(i.converter,e);return ah(t,[ap(sh(i.firestore),"addDoc",s._key,c,null!==i.converter,{}).toMutation(s._key,zi.exists(!1))]).then(()=>s)}(this._delegate,e).then(t=>new Bu(this.firestore,t))}isEqual(e){return Ym(this._delegate,e._delegate)}withConverter(e){return new wd(this.firestore,this._delegate.withConverter(e?Ln.getInstance(this.firestore,e):null))}}function Id(i){return Xr(i,Ds)}class Wg{constructor(...e){this._delegate=new Tl(...e)}static documentId(){return new Wg(hs.keyField().canonicalString())}isEqual(e){return(e=(0,Ge.m9)(e))instanceof Tl&&this._delegate._internalPath.isEqual(e._internalPath)}}class Bc{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Iy(){return new Tg("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Bc(e)}static delete(){const e=function ev(){return new qh("deleteField")}();return e._methodName="FieldValue.delete",new Bc(e)}static arrayUnion(...e){const t=function Cy(...i){return new Wo("arrayUnion",i)}(...e);return t._methodName="FieldValue.arrayUnion",new Bc(t)}static arrayRemove(...e){const t=function by(...i){return new uy("arrayRemove",i)}(...e);return t._methodName="FieldValue.arrayRemove",new Bc(t)}static increment(e){const t=function Dy(i){return new V_("increment",i)}(e);return t._methodName="FieldValue.increment",new Bc(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const My={Firestore:pp,GeoPoint:zh,Timestamp:ui,Blob:ef,Transaction:Gg,WriteBatch:rv,DocumentReference:Bu,DocumentSnapshot:nf,Query:ua,QueryDocumentSnapshot:Uc,QuerySnapshot:Ry,CollectionReference:wd,FieldPath:Wg,FieldValue:Bc,setLogLevel:function Ay(i){!function Hu(i){Fo.setLogLevel(i)}(i)},CACHE_SIZE_UNLIMITED:-1};!function Py(i){(function Ny(i,e){i.INTERNAL.registerComponent(new ht.wA("firestore-compat",t=>{const s=t.getProvider("app-compat").getImmediate(),c=t.getProvider("firestore").getImmediate();return e(s,c)},"PUBLIC").setServiceProps(Object.assign({},My)))})(i,(e,t)=>new pp(e,t,new d0)),i.registerVersion("@firebase/firestore-compat","0.1.20")}(ft.Z);var jc=$(1205),iv=$(440),sv=$(127);function Oy(i,e){return function rf(i,e=ne.z){return new ie.y(t=>{let s;return null!=e?e.schedule(()=>{s=i.onSnapshot({includeMetadataChanges:!0},t)}):s=i.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=s&&s()}})}(i,e)}function zg(i,e){return Oy(i,e).pipe((0,ae.U)(t=>({payload:t,type:"query"})))}function Cd(i,e){return zg(i,e).pipe((0,ce.O)(void 0),Be(),(0,ae.U)(([t,s])=>{const c=s.payload.docChanges(),p=c.map(v=>({type:v.type,payload:v}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(s.payload.metadata)&&s.payload.docs.forEach((v,x)=>{const W=c.find(se=>se.doc.ref.isEqual(v.ref)),Z=null==t?void 0:t.payload.docs.find(se=>se.ref.isEqual(v.ref));W&&JSON.stringify(W.doc.metadata)===JSON.stringify(v.metadata)||!W&&Z&&JSON.stringify(Z.metadata)===JSON.stringify(v.metadata)||p.push({type:"modified",payload:{oldIndex:x,newIndex:x,type:"modified",doc:v}})}),p}))}function Kg(i,e,t){return Cd(i,t).pipe((0,Re.R)((s,c)=>function ky(i,e,t){return e.forEach(s=>{t.indexOf(s.type)>-1&&(i=function av(i,e){switch(e.type){case"added":if(!i[e.newIndex]||!i[e.newIndex].doc.ref.isEqual(e.doc.ref))return gp(i,e.newIndex,0,e);break;case"modified":if(null==i[e.oldIndex]||i[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=i.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return gp(i,e.newIndex,1,e)}break;case"removed":if(i[e.oldIndex]&&i[e.oldIndex].doc.ref.isEqual(e.doc.ref))return gp(i,e.oldIndex,1)}return i}(i,s))}),i}(s,c.map(p=>p.payload),e),[]),(0,Rt.x)(),(0,ae.U)(s=>s.map(c=>({type:c.type,payload:c}))))}function gp(i,e,t,...s){const c=i.slice();return c.splice(e,t,...s),c}function lh(i){return(!i||0===i.length)&&(i=["added","removed","modified"]),i}class ch{constructor(e,t,s){this.ref=e,this.query=t,this.afs=s}stateChanges(e){let t=Cd(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ae.U)(s=>s.filter(c=>e.indexOf(c.type)>-1)))),t.pipe((0,ce.O)(void 0),Be(),(0,ot.h)(([s,c])=>c.length>0||!s),(0,ae.U)(([s,c])=>c),Se.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Re.R)((t,s)=>[...t,...s],[]))}snapshotChanges(e){const t=lh(e);return Kg(this.query,t,this.afs.schedulers.outsideAngular).pipe(Se.iC)}valueChanges(e={}){return zg(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(t=>t.payload.docs.map(s=>e.idField?Object.assign(Object.assign({},s.data()),{[e.idField]:s.id}):s.data())),Se.iC)}get(e){return(0,be.D)(this.query.get(e)).pipe(Se.iC)}add(e){return this.ref.add(e)}doc(e){return new Fy(this.ref.doc(e),this.afs)}}class Fy{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const s=this.ref.collection(e),{ref:c,query:p}=By(s,t);return new ch(c,p,this.afs)}snapshotChanges(){return function ov(i,e){return Oy(i,e).pipe((0,ce.O)(void 0),Be(),(0,ae.U)(([t,s])=>s.exists?(null==t?void 0:t.exists)?{payload:s,type:"modified"}:{payload:s,type:"added"}:{payload:s,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Se.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ae.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,be.D)(this.ref.get(e)).pipe(Se.iC)}}class uv{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Cd(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(t=>t.filter(s=>e.indexOf(s.type)>-1)),(0,ot.h)(t=>t.length>0),Se.iC):Cd(this.query,this.afs.schedulers.outsideAngular).pipe(Se.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Re.R)((t,s)=>[...t,...s],[]))}snapshotChanges(e){const t=lh(e);return Kg(this.query,t,this.afs.schedulers.outsideAngular).pipe(Se.iC)}valueChanges(e={}){return zg(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(s=>s.payload.docs.map(c=>e.idField?Object.assign({[e.idField]:c.id},c.data()):c.data())),Se.iC)}get(e){return(0,be.D)(this.query.get(e)).pipe(Se.iC)}}const Ly=new _.OlP("angularfire2.enableFirestorePersistence"),qg=new _.OlP("angularfire2.firestore.persistenceSettings"),Vy=new _.OlP("angularfire2.firestore.settings"),Uy=new _.OlP("angularfire2.firestore.use-emulator");function By(i,e=(t=>t)){return{query:e(i),ref:i}}let Zg=(()=>{class i{constructor(t,s,c,p,v,x,W,Z,se,we,st,Et,Nt,mn,Rn,Ri,Ts){this.schedulers=W;const yi=(0,at.on)(t,x,s),So=se;we&&(0,jc.nw)(yi,x,st,Nt,mn,Rn,Et,Ri),[this.firestore,this.persistenceEnabled$]=(0,at.cc)(`${yi.name}.firestore`,"AngularFirestore",yi.name,()=>{const ms=x.runOutsideAngular(()=>yi.firestore());if(p&&ms.settings(p),So&&ms.useEmulator(...So),c&&!(0,Dt.PM)(v)){const Zs=()=>{try{return(0,be.D)(ms.enablePersistence(Z||void 0).then(()=>!0,()=>!1))}catch(va){return"undefined"!=typeof console&&console.warn(va),(0,Ce.of)(!1)}};return[ms,x.runOutsideAngular(Zs)]}return[ms,(0,Ce.of)(!1)]},[p,So,c])}collection(t,s){let c;c="string"==typeof t?this.firestore.collection(t):t;const{ref:p,query:v}=By(c,s),x=this.schedulers.ngZone.run(()=>p);return new ch(x,v,this)}collectionGroup(t,s){const c=s||(v=>v),p=this.firestore.collectionGroup(t);return new uv(c(p),this)}doc(t){let s;s="string"==typeof t?this.firestore.doc(t):t;const c=this.schedulers.ngZone.run(()=>s);return new Fy(c,this)}createId(){return this.firestore.collection("_").doc().id}}return i.\u0275fac=function(t){return new(t||i)(_.LFG(at.Dh),_.LFG(at.xv,8),_.LFG(Ly,8),_.LFG(Vy,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(Se.HU),_.LFG(qg,8),_.LFG(Uy,8),_.LFG(jc.zQ,8),_.LFG(jc.Qv,8),_.LFG(jc.L6,8),_.LFG(jc._Q,8),_.LFG(jc.rT,8),_.LFG(jc.lh,8),_.LFG(jc.f7,8),_.LFG(iv.nm,8))},i.\u0275prov=_.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),lv=(()=>{class i{constructor(){sv.Z.registerVersion("angularfire",Se.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:i,providers:[{provide:Ly,useValue:!0},{provide:qg,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=_.oAB({type:i}),i.\u0275inj=_.cJS({providers:[Zg]}),i})()},2084:(Ft,We,$)=>{$.d(We,{TE:()=>F});var _=$(8306),ne=$(9646),ie=$(8996),be=$(4986),Ce=$(4482),Se=$(5403),Me=$(4004),Be=$(3900),ce=$(5813),ae=$(5e3),Re=$(2011),Rt=$(3942),ot=$(5861),at=$(9681),Dt=$(2090),nt=$(4859);const ft="firebasestorage.googleapis.com",De="storageBucket";class xe extends Dt.ZR{constructor(R,Y){super(Ge(R),`Firebase Storage: ${Y} (${Ge(R)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xe.prototype)}_codeEquals(R){return Ge(R)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(R){this.customData.serverResponse=R,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function Ge(E){return"storage/"+E}function wt(){return new xe("unknown","An unknown error occurred, please check the error payload for server response.")}function Je(){return new xe("canceled","User canceled the upload/download.")}function Wt(){return new xe("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function en(E){return new xe("invalid-argument",E)}function on(){return new xe("app-deleted","The Firebase app was deleted.")}function tn(E){return new xe("invalid-root-operation","The operation '"+E+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Kt(E,R){return new xe("invalid-format","String does not match format '"+E+"': "+R)}function Tn(E){throw new xe("internal-error","Internal error: "+E)}class zt{constructor(R,Y){this.bucket=R,this.path_=Y}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const R=encodeURIComponent;return"/b/"+R(this.bucket)+"/o/"+R(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(R,Y){let oe;try{oe=zt.makeFromUrl(R,Y)}catch(Te){return new zt(R,"")}if(""===oe.path)return oe;throw function St(E){return new xe("invalid-default-bucket","Invalid default bucket '"+E+"'.")}(R)}static makeFromUrl(R,Y){let oe=null;const Te="([A-Za-z0-9.\\-_]+)",Gt=new RegExp("^gs://"+Te+"(/(.*))?$","i");function Bn(Pi){Pi.path_=decodeURIComponent(Pi.path)}const Br=Y.replace(/[.]/g,"\\."),Xn=[{regex:Gt,indices:{bucket:1,path:3},postModify:function Ke(Pi){"/"===Pi.path.charAt(Pi.path.length-1)&&(Pi.path_=Pi.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Br}/v[A-Za-z0-9_]+/b/${Te}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:Bn},{regex:new RegExp(`^https?://${Y===ft?"(?:storage.googleapis.com|storage.cloud.google.com)":Y}/${Te}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:Bn}];for(let Pi=0;Pi<Xn.length;Pi++){const Js=Xn[Pi],_o=Js.regex.exec(R);if(_o){let xo=_o[Js.indices.path];xo||(xo=""),oe=new zt(_o[Js.indices.bucket],xo),Js.postModify(oe);break}}if(null==oe)throw function Ye(E){return new xe("invalid-url","Invalid URL '"+E+"'.")}(R);return oe}}class Yt{constructor(R){this.promise_=Promise.reject(R)}getPromise(){return this.promise_}cancel(R=!1){}}function Gn(E){return"string"==typeof E||E instanceof String}function Ar(E){return Vn()&&E instanceof Blob}function Vn(){return"undefined"!=typeof Blob}function Bt(E,R,Y,oe){if(oe<R)throw en(`Invalid value for '${E}'. Expected ${R} or greater.`);if(oe>Y)throw en(`Invalid value for '${E}'. Expected ${Y} or less.`)}function En(E,R,Y){let oe=R;return null==Y&&(oe=`https://${R}`),`${Y}://${oe}/v0${E}`}function Sn(E){const R=encodeURIComponent;let Y="?";for(const oe in E)E.hasOwnProperty(oe)&&(Y=Y+(R(oe)+"=")+R(E[oe])+"&");return Y=Y.slice(0,-1),Y}var ln=(()=>{return(E=ln||(ln={}))[E.NO_ERROR=0]="NO_ERROR",E[E.NETWORK_ERROR=1]="NETWORK_ERROR",E[E.ABORT=2]="ABORT",ln;var E})();class Ci{constructor(R,Y,oe,Te,Ke,mt,Gt,Ut,Bn,cr,Br){this.url_=R,this.method_=Y,this.headers_=oe,this.body_=Te,this.successCodes_=Ke,this.additionalRetryCodes_=mt,this.callback_=Gt,this.errorCallback_=Ut,this.timeout_=Bn,this.progressCallback_=cr,this.connectionFactory_=Br,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Or,rr)=>{this.resolve_=Or,this.reject_=rr,this.start_()})}start_(){const Y=(oe,Te)=>{const Ke=this.resolve_,mt=this.reject_,Gt=Te.connection;if(Te.wasSuccessCode)try{const Ut=this.callback_(Gt,Gt.getResponse());!function sr(E){return void 0!==E}(Ut)?Ke():Ke(Ut)}catch(Ut){mt(Ut)}else if(null!==Gt){const Ut=wt();Ut.serverResponse=Gt.getErrorText(),mt(this.errorCallback_?this.errorCallback_(Gt,Ut):Ut)}else mt(Te.canceled?this.appDelete_?on():Je():function Ue(){return new xe("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?Y(0,new ei(!1,null,!0)):this.backoffId_=function hr(E,R,Y){let oe=1,Te=null,Ke=null,mt=!1,Gt=0;function Ut(){return 2===Gt}let Bn=!1;function cr(...Cr){Bn||(Bn=!0,R.apply(null,Cr))}function Br(Cr){Te=setTimeout(()=>{Te=null,E(rr,Ut())},Cr)}function Or(){Ke&&clearTimeout(Ke)}function rr(Cr,...gi){if(Bn)return void Or();if(Cr)return Or(),void cr.call(null,Cr,...gi);if(Ut()||mt)return Or(),void cr.call(null,Cr,...gi);let Xn;oe<64&&(oe*=2),1===Gt?(Gt=2,Xn=0):Xn=1e3*(oe+Math.random()),Br(Xn)}let Dr=!1;function Ti(Cr){Dr||(Dr=!0,Or(),!Bn&&(null!==Te?(Cr||(Gt=2),clearTimeout(Te),Br(0)):Cr||(Gt=1)))}return Br(0),Ke=setTimeout(()=>{mt=!0,Ti(!0)},Y),Ti}((oe,Te)=>{if(Te)return void oe(!1,new ei(!1,null,!0));const Ke=this.connectionFactory_();this.pendingConnection_=Ke;const mt=Gt=>{null!==this.progressCallback_&&this.progressCallback_(Gt.loaded,Gt.lengthComputable?Gt.total:-1)};null!==this.progressCallback_&&Ke.addUploadProgressListener(mt),Ke.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&Ke.removeUploadProgressListener(mt),this.pendingConnection_=null;const Gt=Ke.getErrorCode()===ln.NO_ERROR,Ut=Ke.getStatus();if(!Gt||this.isRetryStatusCode_(Ut)){const cr=Ke.getErrorCode()===ln.ABORT;return void oe(!1,new ei(!1,null,cr))}const Bn=-1!==this.successCodes_.indexOf(Ut);oe(!0,new ei(Bn,Ke))})},Y,this.timeout_)}getPromise(){return this.promise_}cancel(R){this.canceled_=!0,this.appDelete_=R||!1,null!==this.backoffId_&&function fr(E){E(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(R){const Y=R>=500&&R<600,Te=-1!==[408,429].indexOf(R),Ke=-1!==this.additionalRetryCodes_.indexOf(R);return Y||Te||Ke}}class ei{constructor(R,Y,oe){this.wasSuccessCode=R,this.connection=Y,this.canceled=!!oe}}function nn(...E){const R=function Xt(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}();if(void 0!==R){const Y=new R;for(let oe=0;oe<E.length;oe++)Y.append(E[oe]);return Y.getBlob()}if(Vn())return new Blob(E);throw new xe("unsupported-environment","This browser doesn't seem to support creating Blobs")}const cn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Li{constructor(R,Y){this.data=R,this.contentType=Y||null}}function Lr(E,R){switch(E){case cn.RAW:return new Li(vr(R));case cn.BASE64:case cn.BASE64URL:return new Li(Ne(E,R));case cn.DATA_URL:return new Li(function je(E){const R=new ye(E);return R.base64?Ne(cn.BASE64,R.rest):function dn(E){let R;try{R=decodeURIComponent(E)}catch(Y){throw Kt(cn.DATA_URL,"Malformed data URL.")}return vr(R)}(R.rest)}(R),function ke(E){return new ye(E).contentType}(R))}throw wt()}function vr(E){const R=[];for(let Y=0;Y<E.length;Y++){let oe=E.charCodeAt(Y);oe<=127?R.push(oe):oe<=2047?R.push(192|oe>>6,128|63&oe):55296==(64512&oe)?Y<E.length-1&&56320==(64512&E.charCodeAt(Y+1))?(oe=65536|(1023&oe)<<10|1023&E.charCodeAt(++Y),R.push(240|oe>>18,128|oe>>12&63,128|oe>>6&63,128|63&oe)):R.push(239,191,189):56320==(64512&oe)?R.push(239,191,189):R.push(224|oe>>12,128|oe>>6&63,128|63&oe)}return new Uint8Array(R)}function Ne(E,R){switch(E){case cn.BASE64:{const Te=-1!==R.indexOf("-"),Ke=-1!==R.indexOf("_");if(Te||Ke)throw Kt(E,"Invalid character '"+(Te?"-":"_")+"' found: is it base64url encoded?");break}case cn.BASE64URL:{const Te=-1!==R.indexOf("+"),Ke=-1!==R.indexOf("/");if(Te||Ke)throw Kt(E,"Invalid character '"+(Te?"+":"/")+"' found: is it base64 encoded?");R=R.replace(/-/g,"+").replace(/_/g,"/");break}}let Y;try{Y=function ri(E){return atob(E)}(R)}catch(Te){throw Kt(E,"Invalid character found")}const oe=new Uint8Array(Y.length);for(let Te=0;Te<Y.length;Te++)oe[Te]=Y.charCodeAt(Te);return oe}class ye{constructor(R){this.base64=!1,this.contentType=null;const Y=R.match(/^data:([^,]+)?,/);if(null===Y)throw Kt(cn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const oe=Y[1]||null;null!=oe&&(this.base64=function fe(E,R){return E.length>=R.length&&E.substring(E.length-R.length)===R}(oe,";base64"),this.contentType=this.base64?oe.substring(0,oe.length-7):oe),this.rest=R.substring(R.indexOf(",")+1)}}class qe{constructor(R,Y){let oe=0,Te="";Ar(R)?(this.data_=R,oe=R.size,Te=R.type):R instanceof ArrayBuffer?(Y?this.data_=new Uint8Array(R):(this.data_=new Uint8Array(R.byteLength),this.data_.set(new Uint8Array(R))),oe=this.data_.length):R instanceof Uint8Array&&(Y?this.data_=R:(this.data_=new Uint8Array(R.length),this.data_.set(R)),oe=R.length),this.size_=oe,this.type_=Te}size(){return this.size_}type(){return this.type_}slice(R,Y){if(Ar(this.data_)){const Te=function Pr(E,R,Y){return E.webkitSlice?E.webkitSlice(R,Y):E.mozSlice?E.mozSlice(R,Y):E.slice?E.slice(R,Y):null}(this.data_,R,Y);return null===Te?null:new qe(Te)}{const oe=new Uint8Array(this.data_.buffer,R,Y-R);return new qe(oe,!0)}}static getBlob(...R){if(Vn()){const Y=R.map(oe=>oe instanceof qe?oe.data_:oe);return new qe(nn.apply(null,Y))}{const Y=R.map(mt=>Gn(mt)?Lr(cn.RAW,mt).data:mt.data_);let oe=0;Y.forEach(mt=>{oe+=mt.byteLength});const Te=new Uint8Array(oe);let Ke=0;return Y.forEach(mt=>{for(let Gt=0;Gt<mt.length;Gt++)Te[Ke++]=mt[Gt]}),new qe(Te,!0)}}uploadData(){return this.data_}}function At(E){let R;try{R=JSON.parse(E)}catch(Y){return null}return function Hr(E){return"object"==typeof E&&!Array.isArray(E)}(R)?R:null}function or(E){const R=E.lastIndexOf("/",E.length-2);return-1===R?E:E.slice(R+1)}function lr(E,R){return R}class an{constructor(R,Y,oe,Te){this.server=R,this.local=Y||R,this.writable=!!oe,this.xform=Te||lr}}let ur=null;function Gr(){if(ur)return ur;const E=[];E.push(new an("bucket")),E.push(new an("generation")),E.push(new an("metageneration")),E.push(new an("name","fullPath",!0));const Y=new an("name");Y.xform=function R(Ke,mt){return function ts(E){return!Gn(E)||E.length<2?E:or(E)}(mt)},E.push(Y);const Te=new an("size");return Te.xform=function oe(Ke,mt){return void 0!==mt?Number(mt):mt},E.push(Te),E.push(new an("timeCreated")),E.push(new an("updated")),E.push(new an("md5Hash",null,!0)),E.push(new an("cacheControl",null,!0)),E.push(new an("contentDisposition",null,!0)),E.push(new an("contentEncoding",null,!0)),E.push(new an("contentLanguage",null,!0)),E.push(new an("contentType",null,!0)),E.push(new an("metadata","customMetadata",!0)),ur=E,ur}function br(E,R,Y){const oe=At(R);return null===oe?null:function yn(E,R,Y){const oe={type:"file"},Te=Y.length;for(let Ke=0;Ke<Te;Ke++){const mt=Y[Ke];oe[mt.local]=mt.xform(oe,R[mt.server])}return function _i(E,R){Object.defineProperty(E,"ref",{get:function Y(){const Ke=new zt(E.bucket,E.fullPath);return R._makeStorageReference(Ke)}})}(oe,E),oe}(E,oe,Y)}function Zr(E,R){const Y={},oe=R.length;for(let Te=0;Te<oe;Te++){const Ke=R[Te];Ke.writable&&(Y[Ke.server]=E[Ke.local])}return JSON.stringify(Y)}const Vr="prefixes";class Wr{constructor(R,Y,oe,Te){this.url=R,this.method=Y,this.handler=oe,this.timeout=Te,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Er(E){if(!E)throw wt()}function wr(E,R){return function Y(oe,Te){const Ke=br(E,Te,R);return Er(null!==Ke),Ke}}function Tt(E){return function R(Y,oe){let Te;return Te=401===Y.getStatus()?Y.getErrorText().includes("Firebase App Check token is invalid")?function ge(){return new xe("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function ut(){return new xe("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===Y.getStatus()?function V(E){return new xe("quota-exceeded","Quota for bucket '"+E+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(E.bucket):403===Y.getStatus()?function Oe(E){return new xe("unauthorized","User does not have permission to access '"+E+"'.")}(E.path):oe,Te.serverResponse=oe.serverResponse,Te}}function Ht(E){const R=Tt(E);return function Y(oe,Te){let Ke=R(oe,Te);return 404===oe.getStatus()&&(Ke=function It(E){return new xe("object-not-found","Object '"+E+"' does not exist.")}(E.path)),Ke.serverResponse=Te.serverResponse,Ke}}function Hn(E,R,Y){const Te=En(R.fullServerUrl(),E.host,E._protocol),mt=E.maxOperationRetryTime,Gt=new Wr(Te,"GET",wr(E,Y),mt);return Gt.errorHandler=Ht(R),Gt}function zr(E,R,Y,oe,Te){const Ke={};Ke.prefix=R.isRoot?"":R.path+"/",Y&&Y.length>0&&(Ke.delimiter=Y),oe&&(Ke.pageToken=oe),Te&&(Ke.maxResults=Te);const Gt=En(R.bucketOnlyServerUrl(),E.host,E._protocol),Bn=E.maxOperationRetryTime,cr=new Wr(Gt,"GET",function Ui(E,R){return function Y(oe,Te){const Ke=function Vi(E,R,Y){const oe=At(Y);return null===oe?null:function ys(E,R,Y){const oe={prefixes:[],items:[],nextPageToken:Y.nextPageToken};if(Y[Vr])for(const Te of Y[Vr]){const Ke=Te.replace(/\/$/,""),mt=E._makeStorageReference(new zt(R,Ke));oe.prefixes.push(mt)}if(Y.items)for(const Te of Y.items){const Ke=E._makeStorageReference(new zt(R,Te.name));oe.items.push(Ke)}return oe}(E,R,oe)}(E,R,Te);return Er(null!==Ke),Ke}}(E,R.bucket),Bn);return cr.urlParams=Ke,cr.errorHandler=Tt(R),cr}function Ee(E,R,Y){const oe=Object.assign({},Y);return oe.fullPath=E.path,oe.size=R.size(),oe.contentType||(oe.contentType=function Mi(E,R){return E&&E.contentType||R&&R.type()||"application/octet-stream"}(null,R)),oe}class le{constructor(R,Y,oe,Te){this.current=R,this.total=Y,this.finalized=!!oe,this.metadata=Te||null}}function ze(E,R){let Y=null;try{Y=E.getResponseHeader("X-Goog-Upload-Status")}catch(Te){Er(!1)}return Er(!!Y&&-1!==(R||["active"]).indexOf(Y)),Y}const gr={STATE_CHANGED:"state_changed"},Yn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Qn(E){switch(E){case"running":case"pausing":case"canceling":return Yn.RUNNING;case"paused":return Yn.PAUSED;case"success":return Yn.SUCCESS;case"canceled":return Yn.CANCELED;default:return Yn.ERROR}}class Ys{constructor(R,Y,oe){if(function Pn(E){return"function"==typeof E}(R)||null!=Y||null!=oe)this.next=R,this.error=null!=Y?Y:void 0,this.complete=null!=oe?oe:void 0;else{const Ke=R;this.next=Ke.next,this.error=Ke.error,this.complete=Ke.complete}}}function Kr(E){return(...R)=>{Promise.resolve().then(()=>E(...R))}}class Qs extends class Di{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ln.NO_ERROR,this.sendPromise_=new Promise(R=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ln.ABORT,R()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ln.NETWORK_ERROR,R()}),this.xhr_.addEventListener("load",()=>{R()})})}send(R,Y,oe,Te){if(this.sent_)throw Tn("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(Y,R,!0),void 0!==Te)for(const Ke in Te)Te.hasOwnProperty(Ke)&&this.xhr_.setRequestHeader(Ke,Te[Ke].toString());return void 0!==oe?this.xhr_.send(oe):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Tn("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Tn("cannot .getStatus() before sending");try{return this.xhr_.status}catch(R){return-1}}getResponse(){if(!this.sent_)throw Tn("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Tn("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(R){return this.xhr_.getResponseHeader(R)}addUploadProgressListener(R){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",R)}removeUploadProgressListener(R){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",R)}}{initXhr(){this.xhr_.responseType="text"}}function qi(){return new Qs}class yo{constructor(R,Y,oe=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=R,this._blob=Y,this._metadata=oe,this._mappings=Gr(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=Te=>{this._request=void 0,this._chunkMultiplier=1,Te._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=Te,this._transition("error"))},this._metadataErrorHandler=Te=>{this._request=void 0,Te._codeEquals("canceled")?this.completeTransitions_():(this._error=Te,this._transition("error"))},this._promise=new Promise((Te,Ke)=>{this._resolve=Te,this._reject=Ke,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const R=this._transferred;return Y=>this._updateProgress(R+Y)}_shouldDoResumable(R){return R.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(R){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([Y,oe])=>{switch(this._state){case"running":R(Y,oe);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((R,Y)=>{const oe=function gt(E,R,Y,oe,Te){const Ke=R.bucketOnlyServerUrl(),mt=Ee(R,oe,Te),Gt={name:mt.fullPath},Ut=En(Ke,E.host,E._protocol),cr={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${oe.size()}`,"X-Goog-Upload-Header-Content-Type":mt.contentType,"Content-Type":"application/json; charset=utf-8"},Br=Zr(mt,Y),Dr=new Wr(Ut,"POST",function rr(Ti){let Cr;ze(Ti);try{Cr=Ti.getResponseHeader("X-Goog-Upload-URL")}catch(gi){Er(!1)}return Er(Gn(Cr)),Cr},E.maxUploadRetryTime);return Dr.urlParams=Gt,Dr.headers=cr,Dr.body=Br,Dr.errorHandler=Tt(R),Dr}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),Te=this._ref.storage._makeRequest(oe,qi,R,Y);this._request=Te,Te.getPromise().then(Ke=>{this._request=void 0,this._uploadUrl=Ke,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const R=this._uploadUrl;this._resolveToken((Y,oe)=>{const Te=function Qt(E,R,Y,oe){const Ut=new Wr(Y,"POST",function Ke(Bn){const cr=ze(Bn,["active","final"]);let Br=null;try{Br=Bn.getResponseHeader("X-Goog-Upload-Size-Received")}catch(rr){Er(!1)}Br||Er(!1);const Or=Number(Br);return Er(!isNaN(Or)),new le(Or,oe.size(),"final"===cr)},E.maxUploadRetryTime);return Ut.headers={"X-Goog-Upload-Command":"query"},Ut.errorHandler=Tt(R),Ut}(this._ref.storage,this._ref._location,R,this._blob),Ke=this._ref.storage._makeRequest(Te,qi,Y,oe);this._request=Ke,Ke.getPromise().then(mt=>{mt=mt,this._request=void 0,this._updateProgress(mt.current),this._needToFetchStatus=!1,mt.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const R=262144*this._chunkMultiplier,Y=new le(this._transferred,this._blob.size()),oe=this._uploadUrl;this._resolveToken((Te,Ke)=>{let mt;try{mt=function er(E,R,Y,oe,Te,Ke,mt,Gt){const Ut=new le(0,0);if(mt?(Ut.current=mt.current,Ut.total=mt.total):(Ut.current=0,Ut.total=oe.size()),oe.size()!==Ut.total)throw function qt(){return new xe("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const Bn=Ut.total-Ut.current;let cr=Bn;Te>0&&(cr=Math.min(cr,Te));const Br=Ut.current,Dr={"X-Goog-Upload-Command":cr===Bn?"upload, finalize":"upload","X-Goog-Upload-Offset":`${Ut.current}`},Ti=oe.slice(Br,Br+cr);if(null===Ti)throw Wt();const Xn=new Wr(Y,"POST",function Cr(Pi,Js){const _o=ze(Pi,["active","final"]),la=Ut.current+cr,xo=oe.size();let Ro;return Ro="final"===_o?wr(R,Ke)(Pi,Js):null,new le(la,xo,"final"===_o,Ro)},R.maxUploadRetryTime);return Xn.headers=Dr,Xn.body=Ti.uploadData(),Xn.progressCallback=Gt||null,Xn.errorHandler=Tt(E),Xn}(this._ref._location,this._ref.storage,oe,this._blob,R,this._mappings,Y,this._makeProgressCallback())}catch(Ut){return this._error=Ut,void this._transition("error")}const Gt=this._ref.storage._makeRequest(mt,qi,Te,Ke);this._request=Gt,Gt.getPromise().then(Ut=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(Ut.current),Ut.finalized?(this._metadata=Ut.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((R,Y)=>{const oe=Hn(this._ref.storage,this._ref._location,this._mappings),Te=this._ref.storage._makeRequest(oe,qi,R,Y);this._request=Te,Te.getPromise().then(Ke=>{this._request=void 0,this._metadata=Ke,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((R,Y)=>{const oe=function pe(E,R,Y,oe,Te){const Ke=R.bucketOnlyServerUrl(),mt={"X-Goog-Upload-Protocol":"multipart"},Ut=function Gt(){let Xn="";for(let Pi=0;Pi<2;Pi++)Xn+=Math.random().toString().slice(2);return Xn}();mt["Content-Type"]="multipart/related; boundary="+Ut;const Bn=Ee(R,oe,Te),cr=Zr(Bn,Y),rr=qe.getBlob("--"+Ut+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+cr+"\r\n--"+Ut+"\r\nContent-Type: "+Bn.contentType+"\r\n\r\n",oe,"\r\n--"+Ut+"--");if(null===rr)throw Wt();const Dr={name:Bn.fullPath},Ti=En(Ke,E.host,E._protocol),gi=E.maxUploadRetryTime,Ms=new Wr(Ti,"POST",wr(E,Y),gi);return Ms.urlParams=Dr,Ms.headers=mt,Ms.body=rr.uploadData(),Ms.errorHandler=Tt(R),Ms}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),Te=this._ref.storage._makeRequest(oe,qi,R,Y);this._request=Te,Te.getPromise().then(Ke=>{this._request=void 0,this._metadata=Ke,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(R){const Y=this._transferred;this._transferred=R,this._transferred!==Y&&this._notifyObservers()}_transition(R){if(this._state!==R)switch(R){case"canceling":case"pausing":this._state=R,void 0!==this._request&&this._request.cancel();break;case"running":const Y="paused"===this._state;this._state=R,Y&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=R,this._notifyObservers();break;case"canceled":this._error=Je(),this._state=R,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const R=Qn(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:R,metadata:this._metadata,task:this,ref:this._ref}}on(R,Y,oe,Te){const Ke=new Ys(Y||void 0,oe||void 0,Te||void 0);return this._addObserver(Ke),()=>{this._removeObserver(Ke)}}then(R,Y){return this._promise.then(R,Y)}catch(R){return this.then(null,R)}_addObserver(R){this._observers.push(R),this._notifyObserver(R)}_removeObserver(R){const Y=this._observers.indexOf(R);-1!==Y&&this._observers.splice(Y,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(Y=>{this._notifyObserver(Y)})}_finishPromise(){if(void 0!==this._resolve){let R=!0;switch(Qn(this._state)){case Yn.SUCCESS:Kr(this._resolve.bind(null,this.snapshot))();break;case Yn.CANCELED:case Yn.ERROR:Kr(this._reject.bind(null,this._error))();break;default:R=!1}R&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(R){switch(Qn(this._state)){case Yn.RUNNING:case Yn.PAUSED:R.next&&Kr(R.next.bind(R,this.snapshot))();break;case Yn.SUCCESS:R.complete&&Kr(R.complete.bind(R))();break;default:R.error&&Kr(R.error.bind(R,this._error))()}}resume(){const R="paused"===this._state||"pausing"===this._state;return R&&this._transition("running"),R}pause(){const R="running"===this._state;return R&&this._transition("pausing"),R}cancel(){const R="running"===this._state||"pausing"===this._state;return R&&this._transition("canceling"),R}}class Ir{constructor(R,Y){this._service=R,this._location=Y instanceof zt?Y:zt.makeFromUrl(Y,R.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(R,Y){return new Ir(R,Y)}get root(){const R=new zt(this._location.bucket,"");return this._newRef(this._service,R)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return or(this._location.path)}get storage(){return this._service}get parent(){const R=function $t(E){if(0===E.length)return null;const R=E.lastIndexOf("/");return-1===R?"":E.slice(0,R)}(this._location.path);if(null===R)return null;const Y=new zt(this._location.bucket,R);return new Ir(this._service,Y)}_throwIfRoot(R){if(""===this._location.path)throw tn(R)}}function _t(E,R,Y){return Un.apply(this,arguments)}function Un(){return(Un=(0,ot.Z)(function*(E,R,Y){const Te=yield Mn(E,{pageToken:Y});R.prefixes.push(...Te.prefixes),R.items.push(...Te.items),null!=Te.nextPageToken&&(yield _t(E,R,Te.nextPageToken))})).apply(this,arguments)}function Mn(E,R){null!=R&&"number"==typeof R.maxResults&&Bt("options.maxResults",1,1e3,R.maxResults);const Y=R||{},oe=zr(E.storage,E._location,"/",Y.pageToken,Y.maxResults);return E.storage.makeRequestWithTokens(oe,qi)}function Bi(E){E._throwIfRoot("getDownloadURL");const R=function Rr(E,R,Y){const Te=En(R.fullServerUrl(),E.host,E._protocol),mt=E.maxOperationRetryTime,Gt=new Wr(Te,"GET",function ar(E,R){return function Y(oe,Te){const Ke=br(E,Te,R);return Er(null!==Ke),function ii(E,R,Y,oe){const Te=At(R);if(null===Te||!Gn(Te.downloadTokens))return null;const Ke=Te.downloadTokens;if(0===Ke.length)return null;const mt=encodeURIComponent;return Ke.split(",").map(Bn=>{const Br=E.fullPath;return En("/b/"+mt(E.bucket)+"/o/"+mt(Br),Y,oe)+Sn({alt:"media",token:Bn})})[0]}(Ke,Te,E.host,E._protocol)}}(E,Y),mt);return Gt.errorHandler=Ht(R),Gt}(E.storage,E._location,Gr());return E.storage.makeRequestWithTokens(R,qi).then(Y=>{if(null===Y)throw function it(){return new xe("no-download-url","The given file does not have any download URLs.")}();return Y})}function nr(E,R){const Y=function hn(E,R){const Y=R.split("/").filter(oe=>oe.length>0).join("/");return 0===E.length?Y:E+"/"+Y}(E._location.path,R),oe=new zt(E._location.bucket,Y);return new Ir(E.storage,oe)}function _s(E,R){if(E instanceof is){const Y=E;if(null==Y._bucket)throw function Pt(){return new xe("no-default-bucket","No default bucket found. Did you set the '"+De+"' property when initializing the app?")}();const oe=new Ir(Y,Y._bucket);return null!=R?_s(oe,R):oe}return void 0!==R?nr(E,R):E}function uo(E,R){if(R&&function vn(E){return/^[A-Za-z]+:\/\//.test(E)}(R)){if(E instanceof is)return function Ur(E,R){return new Ir(E,R)}(E,R);throw en("To use ref(service, url), the first argument must be a Storage instance.")}return _s(E,R)}function ji(E,R){const Y=null==R?void 0:R[De];return null==Y?null:zt.makeFromBucketSpec(Y,E)}class is{constructor(R,Y,oe,Te,Ke){this.app=R,this._authProvider=Y,this._appCheckProvider=oe,this._url=Te,this._firebaseVersion=Ke,this._bucket=null,this._host=ft,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=Te?zt.makeFromBucketSpec(Te,this._host):ji(this._host,this.app.options)}get host(){return this._host}set host(R){this._host=R,this._bucket=null!=this._url?zt.makeFromBucketSpec(this._url,R):ji(R,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(R){Bt("time",0,Number.POSITIVE_INFINITY,R),this._maxUploadRetryTime=R}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(R){Bt("time",0,Number.POSITIVE_INFINITY,R),this._maxOperationRetryTime=R}_getAuthToken(){var R=this;return(0,ot.Z)(function*(){if(R._overrideAuthToken)return R._overrideAuthToken;const Y=R._authProvider.getImmediate({optional:!0});if(Y){const oe=yield Y.getToken();if(null!==oe)return oe.accessToken}return null})()}_getAppCheckToken(){var R=this;return(0,ot.Z)(function*(){const Y=R._appCheckProvider.getImmediate({optional:!0});return Y?(yield Y.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(R=>R.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(R){return new Ir(this,R)}_makeRequest(R,Y,oe,Te){if(this._deleted)return new Yt(on());{const Ke=function Vt(E,R,Y,oe,Te,Ke){const mt=Sn(E.urlParams),Gt=E.url+mt,Ut=Object.assign({},E.headers);return function ci(E,R){R&&(E["X-Firebase-GMPID"]=R)}(Ut,R),function Zn(E,R){null!==R&&R.length>0&&(E.Authorization="Firebase "+R)}(Ut,Y),function Fr(E,R){E["X-Firebase-Storage-Version"]="webjs/"+(null!=R?R:"AppManager")}(Ut,Ke),function xr(E,R){null!==R&&(E["X-Firebase-AppCheck"]=R)}(Ut,oe),new Ci(Gt,E.method,Ut,E.body,E.successCodes,E.additionalRetryCodes,E.handler,E.errorHandler,E.timeout,E.progressCallback,Te)}(R,this._appId,oe,Te,Y,this._firebaseVersion);return this._requests.add(Ke),Ke.getPromise().then(()=>this._requests.delete(Ke),()=>this._requests.delete(Ke)),Ke}}makeRequestWithTokens(R,Y){var oe=this;return(0,ot.Z)(function*(){const[Te,Ke]=yield Promise.all([oe._getAuthToken(),oe._getAppCheckToken()]);return oe._makeRequest(R,Y,Te,Ke).getPromise()})()}}const ss="@firebase/storage";function Cn(E,R){return uo(E=(0,Dt.m9)(E),R)}function On(E,{instanceIdentifier:R}){const Y=E.getProvider("app").getImmediate(),oe=E.getProvider("auth-internal"),Te=E.getProvider("app-check-internal");return new is(Y,oe,Te,R,at.SDK_VERSION)}!function B(){(0,at._registerComponent)(new nt.wA("storage",On,"PUBLIC").setMultipleInstances(!0)),(0,at.registerVersion)(ss,"0.9.8",""),(0,at.registerVersion)(ss,"0.9.8","esm2017")}();class Q{constructor(R,Y,oe){this._delegate=R,this.task=Y,this.ref=oe}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class U{constructor(R,Y){this._delegate=R,this._ref=Y,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Q(this._delegate.snapshot,this,this._ref)}then(R,Y){return this._delegate.then(oe=>{if(R)return R(new Q(oe,this,this._ref))},Y)}on(R,Y,oe,Te){let Ke;return Y&&(Ke="function"==typeof Y?mt=>Y(new Q(mt,this,this._ref)):{next:Y.next?mt=>Y.next(new Q(mt,this,this._ref)):void 0,complete:Y.complete||void 0,error:Y.error||void 0}),this._delegate.on(R,Ke,oe||void 0,Te||void 0)}}class te{constructor(R,Y){this._delegate=R,this._service=Y}get prefixes(){return this._delegate.prefixes.map(R=>new _e(R,this._service))}get items(){return this._delegate.items.map(R=>new _e(R,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class _e{constructor(R,Y){this._delegate=R,this.storage=Y}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(R){const Y=function xs(E,R){return nr(E,R)}(this._delegate,R);return new _e(Y,this.storage)}get root(){return new _e(this._delegate.root,this.storage)}get parent(){const R=this._delegate.parent;return null==R?null:new _e(R,this.storage)}put(R,Y){return this._throwIfRoot("put"),new U(function lo(E,R,Y){return function He(E,R,Y){return E._throwIfRoot("uploadBytesResumable"),new yo(E,new qe(R),Y)}(E=(0,Dt.m9)(E),R,Y)}(this._delegate,R,Y),this)}putString(R,Y=cn.RAW,oe){this._throwIfRoot("putString");const Te=Lr(Y,R),Ke=Object.assign({},oe);return null==Ke.contentType&&null!=Te.contentType&&(Ke.contentType=Te.contentType),new U(new yo(this._delegate,new qe(Te.data,!0),Ke),this)}listAll(){return function As(E){return function pt(E){const R={prefixes:[],items:[]};return _t(E,R).then(()=>R)}(E=(0,Dt.m9)(E))}(this._delegate).then(R=>new te(R,this.storage))}list(R){return function oi(E,R){return Mn(E=(0,Dt.m9)(E),R)}(this._delegate,R||void 0).then(Y=>new te(Y,this.storage))}getMetadata(){return function wi(E){return function tr(E){E._throwIfRoot("getMetadata");const R=Hn(E.storage,E._location,Gr());return E.storage.makeRequestWithTokens(R,qi)}(E=(0,Dt.m9)(E))}(this._delegate)}updateMetadata(R){return function co(E,R){return function rs(E,R){E._throwIfRoot("updateMetadata");const Y=function Ki(E,R,Y,oe){const Ke=En(R.fullServerUrl(),E.host,E._protocol),Gt=Zr(Y,oe),Bn=E.maxOperationRetryTime,cr=new Wr(Ke,"PATCH",wr(E,oe),Bn);return cr.headers={"Content-Type":"application/json; charset=utf-8"},cr.body=Gt,cr.errorHandler=Ht(R),cr}(E.storage,E._location,R,Gr());return E.storage.makeRequestWithTokens(Y,qi)}(E=(0,Dt.m9)(E),R)}(this._delegate,R)}getDownloadURL(){return function hi(E){return Bi(E=(0,Dt.m9)(E))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function ws(E){return function ao(E){E._throwIfRoot("deleteObject");const R=function pr(E,R){const oe=En(R.fullServerUrl(),E.host,E._protocol),Gt=new Wr(oe,"DELETE",function mt(Ut,Bn){},E.maxOperationRetryTime);return Gt.successCodes=[200,204],Gt.errorHandler=Ht(R),Gt}(E.storage,E._location);return E.storage.makeRequestWithTokens(R,qi)}(E=(0,Dt.m9)(E))}(this._delegate)}_throwIfRoot(R){if(""===this._delegate._location.path)throw tn(R)}}class rt{constructor(R,Y){this.app=R,this._delegate=Y}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(R){if(yt(R))throw en("ref() expected a child path but got a URL, use refFromURL instead.");return new _e(Cn(this._delegate,R),this)}refFromURL(R){if(!yt(R))throw en("refFromURL() expected a full URL but got a child path, use ref() instead.");try{zt.makeFromUrl(R,this._delegate.host)}catch(Y){throw en("refFromUrl() expected a valid full URL but got an invalid one.")}return new _e(Cn(this._delegate,R),this)}setMaxUploadRetryTime(R){this._delegate.maxUploadRetryTime=R}setMaxOperationRetryTime(R){this._delegate.maxOperationRetryTime=R}useEmulator(R,Y,oe={}){!function cs(E,R,Y,oe={}){!function ti(E,R,Y,oe={}){E.host=`${R}:${Y}`,E._protocol="http";const{mockUserToken:Te}=oe;Te&&(E._overrideAuthToken="string"==typeof Te?Te:(0,Dt.Sg)(Te,E.app.options.projectId))}(E,R,Y,oe)}(this._delegate,R,Y,oe)}}function yt(E){return/^[A-Za-z]+:\/\//.test(E)}function kn(E,{instanceIdentifier:R}){const Y=E.getProvider("app-compat").getImmediate(),oe=E.getProvider("storage").getImmediate({identifier:R});return new rt(Y,oe)}!function Jn(E){const R={TaskState:Yn,TaskEvent:gr,StringFormat:cn,Storage:rt,Reference:_e};E.INTERNAL.registerComponent(new nt.wA("storage-compat",kn,"PUBLIC").setServiceProps(R).setMultipleInstances(!0)),E.registerVersion("@firebase/storage-compat","0.1.16")}(Rt.Z);var qr=$(440),Mr=$(127);function zn(E){const R=function $r(E){return new _.y(R=>{const Y=mt=>R.next(mt);Y(E.snapshot);const Ke=E.on("state_changed",Y);return E.then(mt=>{Y(mt),R.complete()},mt=>{Y(E.snapshot),(mt=>{R.error(mt)})(mt)}),function(){Ke()}}).pipe(function Ve(E,R=be.z){return(0,Ce.e)((Y,oe)=>{let Te=null,Ke=null,mt=null;const Gt=()=>{if(Te){Te.unsubscribe(),Te=null;const Bn=Ke;Ke=null,oe.next(Bn)}};function Ut(){const Bn=mt+E,cr=R.now();if(cr<Bn)return Te=this.schedule(void 0,Bn-cr),void oe.add(Te);Gt()}Y.subscribe((0,Se.x)(oe,Bn=>{Ke=Bn,mt=R.now(),Te||(Te=R.schedule(Ut,E),oe.add(Te))},()=>{Gt(),oe.complete()},void 0,()=>{Ke=Te=null}))})}(0))}(E);return{task:E,then:E.then.bind(E),catch:E.catch.bind(E),pause:E.pause.bind(E),cancel:E.cancel.bind(E),resume:E.resume.bind(E),snapshotChanges:()=>R,percentageChanges:()=>R.pipe((0,Me.U)(Y=>Y.bytesTransferred/Y.totalBytes*100))}}function pi(E){return{getDownloadURL:()=>(0,ne.of)(void 0).pipe(ce.fc,(0,Be.w)(()=>E.getDownloadURL()),ce.iC),getMetadata:()=>(0,ne.of)(void 0).pipe(ce.fc,(0,Be.w)(()=>E.getMetadata()),ce.iC),delete:()=>(0,ie.D)(E.delete()),child:R=>pi(E.child(R)),updateMetadata:R=>(0,ie.D)(E.updateMetadata(R)),put:(R,Y)=>zn(E.put(R,Y)),putString:(R,Y,oe)=>zn(E.putString(R,Y,oe)),list:R=>(0,ie.D)(E.list(R)),listAll:()=>(0,ie.D)(E.listAll())}}const fn=new ae.OlP("angularfire2.storageBucket"),Zi=new ae.OlP("angularfire2.storage.maxUploadRetryTime"),ho=new ae.OlP("angularfire2.storage.maxOperationRetryTime"),ds=new ae.OlP("angularfire2.storage.use-emulator");let Ni=(()=>{class E{constructor(Y,oe,Te,Ke,mt,Gt,Ut,Bn,cr,Br){const Or=(0,Re.on)(Y,mt,oe);this.storage=(0,Re.cc)(`${Or.name}.storage.${Te}`,"AngularFireStorage",Or.name,()=>{const rr=mt.runOutsideAngular(()=>Or.storage(Te||void 0)),Dr=cr;return Dr&&rr.useEmulator(...Dr),Ut&&rr.setMaxUploadRetryTime(Ut),Bn&&rr.setMaxOperationRetryTime(Bn),rr},[Ut,Bn])}ref(Y){return pi(this.storage.ref(Y))}refFromURL(Y){return pi(this.storage.refFromURL(Y))}upload(Y,oe,Te){return pi(this.storage.ref(Y)).put(oe,Te)}}return E.\u0275fac=function(Y){return new(Y||E)(ae.LFG(Re.Dh),ae.LFG(Re.xv,8),ae.LFG(fn,8),ae.LFG(ae.Lbi),ae.LFG(ae.R0b),ae.LFG(ce.HU),ae.LFG(Zi,8),ae.LFG(ho,8),ae.LFG(ds,8),ae.LFG(qr.nm,8))},E.\u0275prov=ae.Yz7({token:E,factory:E.\u0275fac,providedIn:"any"}),E})(),k=(()=>{class E{}return E.\u0275fac=function(Y){return new(Y||E)},E.\u0275mod=ae.oAB({type:E}),E.\u0275inj=ae.cJS({}),E})(),F=(()=>{class E{constructor(){Mr.Z.registerVersion("angularfire",ce.q4.full,"gcs-compat")}}return E.\u0275fac=function(Y){return new(Y||E)},E.\u0275mod=ae.oAB({type:E}),E.\u0275inj=ae.cJS({providers:[Ni],imports:[k]}),E})()},2011:(Ft,We,$)=>{$.d(We,{hO:()=>Rt,xv:()=>Be,Dh:()=>Me,GT:()=>Se,cc:()=>ot,on:()=>ce,pX:()=>Ce});var _=$(5e3),ne=$(127),ie=$(5813);Ft=$.hmd(Ft);const be=["ngOnDestroy"],Ce=(ft,De,kt,ht={})=>new Proxy(ft,{get:(xe,Ge)=>kt.runOutsideAngular(()=>{var wt;if(ft[Ge])return(null===(wt=null==ht?void 0:ht.spy)||void 0===wt?void 0:wt.get)&&ht.spy.get(Ge,ft[Ge]),ft[Ge];if(be.indexOf(Ge)>-1)return()=>{};const It=De.toPromise().then(V=>{const ut=V&&V[Ge];return"function"==typeof ut?ut.bind(V):ut&&ut.then?ut.then(ge=>kt.run(()=>ge)):kt.run(()=>ut)});return new Proxy(()=>{},{get:(V,ut)=>It[ut],apply:(V,ut,ge)=>It.then(Oe=>{var Ue;const Je=Oe&&Oe(...ge);return(null===(Ue=null==ht?void 0:ht.spy)||void 0===Ue?void 0:Ue.apply)&&ht.spy.apply(Ge,ge,Je),Je})})})}),Se=(ft,De)=>{De.forEach(kt=>{Object.getOwnPropertyNames(kt.prototype||kt).forEach(ht=>{Object.defineProperty(ft.prototype,ht,Object.getOwnPropertyDescriptor(kt.prototype||kt,ht))})})};class Ve{constructor(De){return De}}const Me=new _.OlP("angularfire2.app.options"),Be=new _.OlP("angularfire2.app.name");function ce(ft,De,kt){const xe="object"==typeof kt&&kt||{};xe.name=xe.name||"string"==typeof kt&&kt||"[DEFAULT]";const wt=ne.Z.apps.filter(It=>It&&It.name===xe.name)[0]||De.runOutsideAngular(()=>ne.Z.initializeApp(ft,xe));try{JSON.stringify(ft)!==JSON.stringify(wt.options)&&ae("error",`${wt.name} Firebase App already initialized with different options${Ft.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(It){}return new Ve(wt)}const ae=(ft,...De)=>{(0,_.X6Q)()&&"undefined"!=typeof console&&console[ft](...De)},Re={provide:Ve,useFactory:ce,deps:[Me,_.R0b,[new _.FiY,Be]]};let Rt=(()=>{class ft{constructor(kt){ne.Z.registerVersion("angularfire",ie.q4.full,"core"),ne.Z.registerVersion("angularfire",ie.q4.full,"app-compat"),ne.Z.registerVersion("angular",_.q4F.full,kt.toString())}static initializeApp(kt,ht){return{ngModule:ft,providers:[{provide:Me,useValue:kt},{provide:Be,useValue:ht}]}}}return ft.\u0275fac=function(kt){return new(kt||ft)(_.LFG(_.Lbi))},ft.\u0275mod=_.oAB({type:ft}),ft.\u0275inj=_.cJS({providers:[Re]}),ft})();function ot(ft,De,kt,ht,xe){const[,Ge,wt]=globalThis.\u0275AngularfireInstanceCache.find(It=>It[0]===ft)||[];if(Ge)return function at(ft,De){try{return ft.toString()===De.toString()}catch(kt){return ft===De}}(xe,wt)||(nt("error",`${De} was already initialized on the ${kt} Firebase App with different settings.${Dt?" You may need to reload as Firebase is not HMR aware.":""}`),nt("warn",{is:xe,was:wt})),Ge;{const It=ht();return globalThis.\u0275AngularfireInstanceCache.push([ft,It,xe]),It}}const Dt=!!Ft.hot,nt=(ft,...De)=>{(0,_.X6Q)()&&"undefined"!=typeof console&&console[ft](...De)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(Ft,We,$)=>{$.d(We,{q4:()=>no,iC:()=>ki,fc:()=>Wi,HU:()=>Os,vb:()=>Ya,JM:()=>Rl});var _=$(5e3),ne=$(5867),ie=$(5861),be=$(9681),Ce=$(2090),Se=$(4859),Ve=$(1877),Me=$(8766);const Be="@firebase/installations",ce="0.5.11",Re=`w:${ce}`,Rt="FIS_v2",De=new Ce.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function kt(L){return L instanceof Ce.ZR&&L.code.includes("request-failed")}function ht({projectId:L}){return`https://firebaseinstallations.googleapis.com/v1/projects/${L}/installations`}function xe(L){return{token:L.token,requestStatus:2,expiresIn:Oe(L.expiresIn),creationTime:Date.now()}}function Ge(L,j){return wt.apply(this,arguments)}function wt(){return(wt=(0,ie.Z)(function*(L,j){const me=(yield j.json()).error;return De.create("request-failed",{requestName:L,serverCode:me.code,serverMessage:me.message,serverStatus:me.status})})).apply(this,arguments)}function It({apiKey:L}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":L})}function V(L,{refreshToken:j}){const X=It(L);return X.append("Authorization",function Ue(L){return`${Rt} ${L}`}(j)),X}function ut(L){return ge.apply(this,arguments)}function ge(){return(ge=(0,ie.Z)(function*(L){const j=yield L();return j.status>=500&&j.status<600?L():j})).apply(this,arguments)}function Oe(L){return Number(L.replace("s","000"))}function Je(L,j){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,ie.Z)(function*({appConfig:L,heartbeatServiceProvider:j},{fid:X}){const me=ht(L),$e=It(L),Xe=j.getImmediate({optional:!0});if(Xe){const jn=yield Xe.getHeartbeatsHeader();jn&&$e.append("x-firebase-client",jn)}const Ot={method:"POST",headers:$e,body:JSON.stringify({fid:X,authVersion:Rt,appId:L.appId,sdkVersion:Re})},Nn=yield ut(()=>fetch(me,Ot));if(Nn.ok){const jn=yield Nn.json();return{fid:jn.fid||X,registrationStatus:2,refreshToken:jn.refreshToken,authToken:xe(jn.authToken)}}throw yield Ge("Create Installation",Nn)})).apply(this,arguments)}function St(L){return new Promise(j=>{setTimeout(j,L)})}const Wt=/^[cdef][\w-]{21}$/;function it(){try{const L=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(L),L[0]=112+L[0]%16;const X=function en(L){return function Pt(L){return btoa(String.fromCharCode(...L)).replace(/\+/g,"-").replace(/\//g,"_")}(L).substr(0,22)}(L);return Wt.test(X)?X:""}catch(L){return""}}function on(L){return`${L.appName}!${L.appId}`}const tn=new Map;function Kt(L,j){const X=on(L);Yt(X,j),function hr(L,j){const X=function sr(){return!fr&&"BroadcastChannel"in self&&(fr=new BroadcastChannel("[Firebase] FID Change"),fr.onmessage=L=>{Yt(L.data.key,L.data.fid)}),fr}();X&&X.postMessage({key:L,fid:j}),function Pn(){0===tn.size&&fr&&(fr.close(),fr=null)}()}(X,j)}function Yt(L,j){const X=tn.get(L);if(X)for(const me of X)me(j)}let fr=null;const Ar="firebase-installations-store";let Vn=null;function Bt(){return Vn||(Vn=(0,Me.X3)("firebase-installations-database",1,{upgrade:(L,j)=>{0===j&&L.createObjectStore(Ar)}})),Vn}function En(L,j){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,ie.Z)(function*(L,j){const X=on(L),$e=(yield Bt()).transaction(Ar,"readwrite"),Xe=$e.objectStore(Ar),Ct=yield Xe.get(X);return yield Xe.put(j,X),yield $e.done,(!Ct||Ct.fid!==j.fid)&&Kt(L,j.fid),j})).apply(this,arguments)}function ln(L){return Ci.apply(this,arguments)}function Ci(){return(Ci=(0,ie.Z)(function*(L){const j=on(L),me=(yield Bt()).transaction(Ar,"readwrite");yield me.objectStore(Ar).delete(j),yield me.done})).apply(this,arguments)}function ei(L,j){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,ie.Z)(function*(L,j){const X=on(L),$e=(yield Bt()).transaction(Ar,"readwrite"),Xe=$e.objectStore(Ar),Ct=yield Xe.get(X),Ot=j(Ct);return void 0===Ot?yield Xe.delete(X):yield Xe.put(Ot,X),yield $e.done,Ot&&(!Ct||Ct.fid!==Ot.fid)&&Kt(L,Ot.fid),Ot})).apply(this,arguments)}function Fr(L){return ci.apply(this,arguments)}function ci(){return(ci=(0,ie.Z)(function*(L){let j;const X=yield ei(L.appConfig,me=>{const $e=xr(me),Xe=Vt(L,$e);return j=Xe.registrationPromise,Xe.installationEntry});return""===X.fid?{installationEntry:yield j}:{installationEntry:X,registrationPromise:j}})).apply(this,arguments)}function xr(L){return Li(L||{fid:it(),registrationStatus:0})}function Vt(L,j){if(0===j.registrationStatus){if(!navigator.onLine)return{installationEntry:j,registrationPromise:Promise.reject(De.create("app-offline"))};const X={fid:j.fid,registrationStatus:1,registrationTime:Date.now()},me=function Xt(L,j){return nn.apply(this,arguments)}(L,X);return{installationEntry:X,registrationPromise:me}}return 1===j.registrationStatus?{installationEntry:j,registrationPromise:Pr(L)}:{installationEntry:j}}function nn(){return(nn=(0,ie.Z)(function*(L,j){try{const X=yield Je(L,j);return En(L.appConfig,X)}catch(X){throw kt(X)&&409===X.customData.serverCode?yield ln(L.appConfig):yield En(L.appConfig,{fid:j.fid,registrationStatus:0}),X}})).apply(this,arguments)}function Pr(L){return ri.apply(this,arguments)}function ri(){return(ri=(0,ie.Z)(function*(L){let j=yield cn(L.appConfig);for(;1===j.registrationStatus;)yield St(100),j=yield cn(L.appConfig);if(0===j.registrationStatus){const{installationEntry:X,registrationPromise:me}=yield Fr(L);return me||X}return j})).apply(this,arguments)}function cn(L){return ei(L,j=>{if(!j)throw De.create("installation-not-found");return Li(j)})}function Li(L){return function Lr(L){return 1===L.registrationStatus&&L.registrationTime+1e4<Date.now()}(L)?{fid:L.fid,registrationStatus:0}:L}function vr(L,j){return dn.apply(this,arguments)}function dn(){return(dn=(0,ie.Z)(function*({appConfig:L,heartbeatServiceProvider:j},X){const me=Ne(L,X),$e=V(L,X),Xe=j.getImmediate({optional:!0});if(Xe){const jn=yield Xe.getHeartbeatsHeader();jn&&$e.append("x-firebase-client",jn)}const Ot={method:"POST",headers:$e,body:JSON.stringify({installation:{sdkVersion:Re,appId:L.appId}})},Nn=yield ut(()=>fetch(me,Ot));if(Nn.ok)return xe(yield Nn.json());throw yield Ge("Generate Auth Token",Nn)})).apply(this,arguments)}function Ne(L,{fid:j}){return`${ht(L)}/${j}/authTokens:generate`}function ye(L){return je.apply(this,arguments)}function je(){return(je=(0,ie.Z)(function*(L,j=!1){let X;const me=yield ei(L.appConfig,Xe=>{if(!hn(Xe))throw De.create("not-registered");const Ct=Xe.authToken;if(!j&&or(Ct))return Xe;if(1===Ct.requestStatus)return X=ke(L,j),Xe;{if(!navigator.onLine)throw De.create("app-offline");const Ot=an(Xe);return X=At(L,Ot),Ot}});return X?yield X:me.authToken})).apply(this,arguments)}function ke(L,j){return fe.apply(this,arguments)}function fe(){return(fe=(0,ie.Z)(function*(L,j){let X=yield qe(L.appConfig);for(;1===X.authToken.requestStatus;)yield St(100),X=yield qe(L.appConfig);const me=X.authToken;return 0===me.requestStatus?ye(L,j):me})).apply(this,arguments)}function qe(L){return ei(L,j=>{if(!hn(j))throw De.create("not-registered");return function ur(L){return 1===L.requestStatus&&L.requestTime+1e4<Date.now()}(j.authToken)?Object.assign(Object.assign({},j),{authToken:{requestStatus:0}}):j})}function At(L,j){return $t.apply(this,arguments)}function $t(){return($t=(0,ie.Z)(function*(L,j){try{const X=yield vr(L,j),me=Object.assign(Object.assign({},j),{authToken:X});return yield En(L.appConfig,me),X}catch(X){if(!kt(X)||401!==X.customData.serverCode&&404!==X.customData.serverCode){const me=Object.assign(Object.assign({},j),{authToken:{requestStatus:0}});yield En(L.appConfig,me)}else yield ln(L.appConfig);throw X}})).apply(this,arguments)}function hn(L){return void 0!==L&&2===L.registrationStatus}function or(L){return 2===L.requestStatus&&!function lr(L){const j=Date.now();return j<L.creationTime||L.creationTime+L.expiresIn<j+36e5}(L)}function an(L){const j={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},L),{authToken:j})}function Gr(){return(Gr=(0,ie.Z)(function*(L){const j=L,{installationEntry:X,registrationPromise:me}=yield Fr(j);return me?me.catch(console.error):ye(j).catch(console.error),X.fid})).apply(this,arguments)}function yn(){return(yn=(0,ie.Z)(function*(L,j=!1){const X=L;return yield br(X),(yield ye(X,j)).token})).apply(this,arguments)}function br(L){return ii.apply(this,arguments)}function ii(){return(ii=(0,ie.Z)(function*(L){const{registrationPromise:j}=yield Fr(L);j&&(yield j)})).apply(this,arguments)}function Ui(L){return De.create("missing-app-config-values",{valueName:L})}const ar="installations",Ht=L=>{const j=L.getProvider("app").getImmediate(),X=function wr(L){if(!L||!L.options)throw Ui("App Configuration");if(!L.name)throw Ui("App Name");const j=["projectId","apiKey","appId"];for(const X of j)if(!L.options[X])throw Ui(X);return{appName:L.name,projectId:L.options.projectId,apiKey:L.options.apiKey,appId:L.options.appId}}(j);return{app:j,appConfig:X,heartbeatServiceProvider:(0,be._getProvider)(j,"heartbeat"),_delete:()=>Promise.resolve()}},Hn=L=>{const j=L.getProvider("app").getImmediate(),X=(0,be._getProvider)(j,ar).getImmediate();return{getId:()=>function ts(L){return Gr.apply(this,arguments)}(X),getToken:$e=>function _i(L){return yn.apply(this,arguments)}(X,$e)}};(function zr(){(0,be._registerComponent)(new Se.wA(ar,Ht,"PUBLIC")),(0,be._registerComponent)(new Se.wA("installations-internal",Hn,"PRIVATE"))})(),(0,be.registerVersion)(Be,ce),(0,be.registerVersion)(Be,ce,"esm2017");const bi="@firebase/remote-config",Ee=new Ce.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Ss{constructor(j,X,me,$e){this.client=j,this.storage=X,this.storageCache=me,this.logger=$e}isCachedDataFresh(j,X){if(!X)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const me=Date.now()-X,$e=me<=j;return this.logger.debug(`Config fetch cache check. Cache age millis: ${me}. Cache max age millis (minimumFetchIntervalMillis setting): ${j}. Is cache hit: ${$e}.`),$e}fetch(j){var X=this;return(0,ie.Z)(function*(){const[me,$e]=yield Promise.all([X.storage.getLastSuccessfulFetchTimestampMillis(),X.storage.getLastSuccessfulFetchResponse()]);if($e&&X.isCachedDataFresh(j.cacheMaxAgeMillis,me))return $e;j.eTag=$e&&$e.eTag;const Xe=yield X.client.fetch(j),Ct=[X.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Xe.status&&Ct.push(X.storage.setLastSuccessfulFetchResponse(Xe)),yield Promise.all(Ct),Xe})()}}function yo(L=navigator){return L.languages&&L.languages[0]||L.language}class Ir{constructor(j,X,me,$e,Xe,Ct){this.firebaseInstallations=j,this.sdkVersion=X,this.namespace=me,this.projectId=$e,this.apiKey=Xe,this.appId=Ct}fetch(j){var X=this;return(0,ie.Z)(function*(){var me,$e,Xe;const[Ct,Ot]=yield Promise.all([X.firebaseInstallations.getId(),X.firebaseInstallations.getToken()]),jn=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${X.projectId}/namespaces/${X.namespace}:fetch?key=${X.apiKey}`,ir={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":j.eTag||"*"},_n={sdk_version:X.sdkVersion,app_instance_id:Ct,app_instance_id_token:Ot,app_id:X.appId,language_code:yo()},Jr={method:"POST",headers:ir,body:JSON.stringify(_n)},zs=fetch(jn,Jr),ks=new Promise((go,ta)=>{j.signal.addEventListener(()=>{const Ba=new Error("The operation was aborted.");Ba.name="AbortError",ta(Ba)})});let Bo;try{yield Promise.race([zs,ks]),Bo=yield zs}catch(go){let ta="fetch-client-network";throw"AbortError"===(null===(me=go)||void 0===me?void 0:me.name)&&(ta="fetch-timeout"),Ee.create(ta,{originalErrorMessage:null===($e=go)||void 0===$e?void 0:$e.message})}let Fs=Bo.status;const wu=Bo.headers.get("ETag")||void 0;let Is,ba;if(200===Bo.status){let go;try{go=yield Bo.json()}catch(ta){throw Ee.create("fetch-client-parse",{originalErrorMessage:null===(Xe=ta)||void 0===Xe?void 0:Xe.message})}Is=go.entries,ba=go.state}if("INSTANCE_STATE_UNSPECIFIED"===ba?Fs=500:"NO_CHANGE"===ba?Fs=304:("NO_TEMPLATE"===ba||"EMPTY_CONFIG"===ba)&&(Is={}),304!==Fs&&200!==Fs)throw Ee.create("fetch-status",{httpStatus:Fs});return{status:Fs,eTag:wu,config:Is}})()}}class Pe{constructor(j,X){this.client=j,this.storage=X}fetch(j){var X=this;return(0,ie.Z)(function*(){const me=(yield X.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return X.attemptFetch(j,me)})()}attemptFetch(j,{throttleEndTimeMillis:X,backoffCount:me}){var $e=this;return(0,ie.Z)(function*(){yield function us(L,j){return new Promise((X,me)=>{const $e=Math.max(j-Date.now(),0),Xe=setTimeout(X,$e);L.addEventListener(()=>{clearTimeout(Xe),me(Ee.create("fetch-throttle",{throttleEndTimeMillis:j}))})})}(j.signal,X);try{const Xe=yield $e.client.fetch(j);return yield $e.storage.deleteThrottleMetadata(),Xe}catch(Xe){if(!function Fe(L){if(!(L instanceof Ce.ZR&&L.customData))return!1;const j=Number(L.customData.httpStatus);return 429===j||500===j||503===j||504===j}(Xe))throw Xe;const Ct={throttleEndTimeMillis:Date.now()+(0,Ce.$s)(me),backoffCount:me+1};return yield $e.storage.setThrottleMetadata(Ct),$e.attemptFetch(j,Ct)}})()}}class pt{constructor(j,X,me,$e,Xe){this.app=j,this._client=X,this._storageCache=me,this._storage=$e,this._logger=Xe,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function _t(L,j){var X;const me=L.target.error||void 0;return Ee.create(j,{originalErrorMessage:me&&(null===(X=me)||void 0===X?void 0:X.message)})}const Un="app_namespace_store";class Bi{constructor(j,X,me,$e=function rs(){return new Promise((L,j)=>{var X;try{const me=indexedDB.open("firebase_remote_config",1);me.onerror=$e=>{j(_t($e,"storage-open"))},me.onsuccess=$e=>{L($e.target.result)},me.onupgradeneeded=$e=>{0===$e.oldVersion&&$e.target.result.createObjectStore(Un,{keyPath:"compositeKey"})}}catch(me){j(Ee.create("storage-open",{originalErrorMessage:null===(X=me)||void 0===X?void 0:X.message}))}})}()){this.appId=j,this.appName=X,this.namespace=me,this.openDbPromise=$e}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(j){return this.set("last_fetch_status",j)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(j){return this.set("last_successful_fetch_timestamp_millis",j)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(j){return this.set("last_successful_fetch_response",j)}getActiveConfig(){return this.get("active_config")}setActiveConfig(j){return this.set("active_config",j)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(j){return this.set("active_config_etag",j)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(j){return this.set("throttle_metadata",j)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(j){var X=this;return(0,ie.Z)(function*(){const me=yield X.openDbPromise;return new Promise(($e,Xe)=>{var Ct;const Nn=me.transaction([Un],"readonly").objectStore(Un),jn=X.createCompositeKey(j);try{const ir=Nn.get(jn);ir.onerror=_n=>{Xe(_t(_n,"storage-get"))},ir.onsuccess=_n=>{const Jr=_n.target.result;$e(Jr?Jr.value:void 0)}}catch(ir){Xe(Ee.create("storage-get",{originalErrorMessage:null===(Ct=ir)||void 0===Ct?void 0:Ct.message}))}})})()}set(j,X){var me=this;return(0,ie.Z)(function*(){const $e=yield me.openDbPromise;return new Promise((Xe,Ct)=>{var Ot;const jn=$e.transaction([Un],"readwrite").objectStore(Un),ir=me.createCompositeKey(j);try{const _n=jn.put({compositeKey:ir,value:X});_n.onerror=Jr=>{Ct(_t(Jr,"storage-set"))},_n.onsuccess=()=>{Xe()}}catch(_n){Ct(Ee.create("storage-set",{originalErrorMessage:null===(Ot=_n)||void 0===Ot?void 0:Ot.message}))}})})()}delete(j){var X=this;return(0,ie.Z)(function*(){const me=yield X.openDbPromise;return new Promise(($e,Xe)=>{var Ct;const Nn=me.transaction([Un],"readwrite").objectStore(Un),jn=X.createCompositeKey(j);try{const ir=Nn.delete(jn);ir.onerror=_n=>{Xe(_t(_n,"storage-delete"))},ir.onsuccess=()=>{$e()}}catch(ir){Xe(Ee.create("storage-delete",{originalErrorMessage:null===(Ct=ir)||void 0===Ct?void 0:Ct.message}))}})})()}createCompositeKey(j){return[this.appId,this.appName,this.namespace,j].join()}}class ao{constructor(j){this.storage=j}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var j=this;return(0,ie.Z)(function*(){const X=j.storage.getLastFetchStatus(),me=j.storage.getLastSuccessfulFetchTimestampMillis(),$e=j.storage.getActiveConfig(),Xe=yield X;Xe&&(j.lastFetchStatus=Xe);const Ct=yield me;Ct&&(j.lastSuccessfulFetchTimestampMillis=Ct);const Ot=yield $e;Ot&&(j.activeConfig=Ot)})()}setLastFetchStatus(j){return this.lastFetchStatus=j,this.storage.setLastFetchStatus(j)}setLastSuccessfulFetchTimestampMillis(j){return this.lastSuccessfulFetchTimestampMillis=j,this.storage.setLastSuccessfulFetchTimestampMillis(j)}setActiveConfig(j){return this.activeConfig=j,this.storage.setActiveConfig(j)}}function _s(){return uo.apply(this,arguments)}function uo(){return(uo=(0,ie.Z)(function*(){if(!(0,Ce.hl)())return!1;try{return yield(0,Ce.eu)()}catch(L){return!1}})).apply(this,arguments)}!function nr(){(0,be._registerComponent)(new Se.wA("remote-config",function L(j,{instanceIdentifier:X}){const me=j.getProvider("app").getImmediate(),$e=j.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw Ee.create("registration-window");if(!(0,Ce.hl)())throw Ee.create("indexed-db-unavailable");const{projectId:Xe,apiKey:Ct,appId:Ot}=me.options;if(!Xe)throw Ee.create("registration-project-id");if(!Ct)throw Ee.create("registration-api-key");if(!Ot)throw Ee.create("registration-app-id");const Nn=new Bi(Ot,me.name,X=X||"firebase"),jn=new ao(Nn),ir=new Ve.Yd(bi);ir.logLevel=Ve.in.ERROR;const _n=new Ir($e,be.SDK_VERSION,X,Xe,Ct,Ot),Jr=new Pe(_n,Nn),zs=new Ss(Jr,Nn,jn,ir),ks=new pt(me,zs,jn,Nn,ir);return function Qn(L){const j=(0,Ce.m9)(L);j._initializePromise||(j._initializePromise=j._storageCache.loadFromStorage().then(()=>{j._isInitializationComplete=!0}))}(ks),ks},"PUBLIC").setMultipleInstances(!0)),(0,be.registerVersion)(bi,"0.3.10"),(0,be.registerVersion)(bi,"0.3.10","esm2017")}();const ji="/firebase-messaging-sw.js",ti="/firebase-cloud-messaging-push-scope",is="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",vs="google.c.a.c_id",ls="google.c.a.c_l",Es="google.c.a.ts",Ao="google.c.a.e";var lo=(()=>{return(L=lo||(lo={})).PUSH_RECEIVED="push-received",L.NOTIFICATION_CLICKED="notification-clicked",lo;var L})();function wi(L){const j=new Uint8Array(L);return btoa(String.fromCharCode(...j)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function co(L){const X=(L+"=".repeat((4-L.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),me=atob(X),$e=new Uint8Array(me.length);for(let Xe=0;Xe<me.length;++Xe)$e[Xe]=me.charCodeAt(Xe);return $e}const oi="fcm_token_details_db",hi="fcm_token_object_Store";function ws(L){return Cn.apply(this,arguments)}function Cn(){return Cn=(0,ie.Z)(function*(L){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Xe=>Xe.name).includes(oi))return null;let j=null;return(yield(0,Me.X3)(oi,5,{upgrade:(me=(0,ie.Z)(function*($e,Xe,Ct,Ot){var Nn;if(Xe<2||!$e.objectStoreNames.contains(hi))return;const jn=Ot.objectStore(hi),ir=yield jn.index("fcmSenderId").get(L);if(yield jn.clear(),ir)if(2===Xe){const _n=ir;if(!_n.auth||!_n.p256dh||!_n.endpoint)return;j={token:_n.fcmToken,createTime:null!==(Nn=_n.createTime)&&void 0!==Nn?Nn:Date.now(),subscriptionOptions:{auth:_n.auth,p256dh:_n.p256dh,endpoint:_n.endpoint,swScope:_n.swScope,vapidKey:"string"==typeof _n.vapidKey?_n.vapidKey:wi(_n.vapidKey)}}}else if(3===Xe){const _n=ir;j={token:_n.fcmToken,createTime:_n.createTime,subscriptionOptions:{auth:wi(_n.auth),p256dh:wi(_n.p256dh),endpoint:_n.endpoint,swScope:_n.swScope,vapidKey:wi(_n.vapidKey)}}}else if(4===Xe){const _n=ir;j={token:_n.fcmToken,createTime:_n.createTime,subscriptionOptions:{auth:wi(_n.auth),p256dh:wi(_n.p256dh),endpoint:_n.endpoint,swScope:_n.swScope,vapidKey:wi(_n.vapidKey)}}}}),function(Xe,Ct,Ot,Nn){return me.apply(this,arguments)})})).close(),yield(0,Me.Lj)(oi),yield(0,Me.Lj)("fcm_vapid_details_db"),yield(0,Me.Lj)("undefined"),xs(j)?j:null;var me}),Cn.apply(this,arguments)}function xs(L){if(!L||!L.subscriptionOptions)return!1;const{subscriptionOptions:j}=L;return"number"==typeof L.createTime&&L.createTime>0&&"string"==typeof L.token&&L.token.length>0&&"string"==typeof j.auth&&j.auth.length>0&&"string"==typeof j.p256dh&&j.p256dh.length>0&&"string"==typeof j.endpoint&&j.endpoint.length>0&&"string"==typeof j.swScope&&j.swScope.length>0&&"string"==typeof j.vapidKey&&j.vapidKey.length>0}const fi="firebase-messaging-store";let Rs=null;function On(){return Rs||(Rs=(0,Me.X3)("firebase-messaging-database",1,{upgrade:(L,j)=>{0===j&&L.createObjectStore(fi)}})),Rs}function B(L){return Q.apply(this,arguments)}function Q(){return(Q=(0,ie.Z)(function*(L){const j=yt(L),me=yield(yield On()).transaction(fi).objectStore(fi).get(j);if(me)return me;{const $e=yield ws(L.appConfig.senderId);if($e)return yield U(L,$e),$e}})).apply(this,arguments)}function U(L,j){return te.apply(this,arguments)}function te(){return(te=(0,ie.Z)(function*(L,j){const X=yt(L),$e=(yield On()).transaction(fi,"readwrite");return yield $e.objectStore(fi).put(j,X),yield $e.done,j})).apply(this,arguments)}function _e(L){return rt.apply(this,arguments)}function rt(){return(rt=(0,ie.Z)(function*(L){const j=yt(L),me=(yield On()).transaction(fi,"readwrite");yield me.objectStore(fi).delete(j),yield me.done})).apply(this,arguments)}function yt({appConfig:L}){return L.appId}const wn=new Ce.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Wn(L,j){return kn.apply(this,arguments)}function kn(){return(kn=(0,ie.Z)(function*(L,j){var X;const me=yield pi(L),$e=Zi(j),Xe={method:"POST",headers:me,body:JSON.stringify($e)};let Ct;try{Ct=yield(yield fetch(zn(L.appConfig),Xe)).json()}catch(Ot){throw wn.create("token-subscribe-failed",{errorInfo:null===(X=Ot)||void 0===X?void 0:X.toString()})}if(Ct.error)throw wn.create("token-subscribe-failed",{errorInfo:Ct.error.message});if(!Ct.token)throw wn.create("token-subscribe-no-token");return Ct.token})).apply(this,arguments)}function Jn(L,j){return qr.apply(this,arguments)}function qr(){return(qr=(0,ie.Z)(function*(L,j){var X;const me=yield pi(L),$e=Zi(j.subscriptionOptions),Xe={method:"PATCH",headers:me,body:JSON.stringify($e)};let Ct;try{Ct=yield(yield fetch(`${zn(L.appConfig)}/${j.token}`,Xe)).json()}catch(Ot){throw wn.create("token-update-failed",{errorInfo:null===(X=Ot)||void 0===X?void 0:X.toString()})}if(Ct.error)throw wn.create("token-update-failed",{errorInfo:Ct.error.message});if(!Ct.token)throw wn.create("token-update-no-token");return Ct.token})).apply(this,arguments)}function Mr(L,j){return $r.apply(this,arguments)}function $r(){return($r=(0,ie.Z)(function*(L,j){var X;const $e={method:"DELETE",headers:yield pi(L)};try{const Ct=yield(yield fetch(`${zn(L.appConfig)}/${j}`,$e)).json();if(Ct.error)throw wn.create("token-unsubscribe-failed",{errorInfo:Ct.error.message})}catch(Xe){throw wn.create("token-unsubscribe-failed",{errorInfo:null===(X=Xe)||void 0===X?void 0:X.toString()})}})).apply(this,arguments)}function zn({projectId:L}){return`https://fcmregistrations.googleapis.com/v1/projects/${L}/registrations`}function pi(L){return fn.apply(this,arguments)}function fn(){return(fn=(0,ie.Z)(function*({appConfig:L,installations:j}){const X=yield j.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":L.apiKey,"x-goog-firebase-installations-auth":`FIS ${X}`})})).apply(this,arguments)}function Zi({p256dh:L,auth:j,endpoint:X,vapidKey:me}){const $e={web:{endpoint:X,auth:j,p256dh:L}};return me!==is&&($e.web.applicationPubKey=me),$e}const ho=6048e5;function ds(L){return Ni.apply(this,arguments)}function Ni(){return(Ni=(0,ie.Z)(function*(L){const j=yield oe(L.swRegistration,L.vapidKey),X={vapidKey:L.vapidKey,swScope:L.swRegistration.scope,endpoint:j.endpoint,auth:wi(j.getKey("auth")),p256dh:wi(j.getKey("p256dh"))},me=yield B(L.firebaseDependencies);if(me){if(Ke(me.subscriptionOptions,X))return Date.now()>=me.createTime+ho?F(L,{token:me.token,createTime:Date.now(),subscriptionOptions:X}):me.token;try{yield Mr(L.firebaseDependencies,me.token)}catch($e){console.warn($e)}return R(L.firebaseDependencies,X)}return R(L.firebaseDependencies,X)})).apply(this,arguments)}function G(L){return k.apply(this,arguments)}function k(){return(k=(0,ie.Z)(function*(L){const j=yield B(L.firebaseDependencies);j&&(yield Mr(L.firebaseDependencies,j.token),yield _e(L.firebaseDependencies));const X=yield L.swRegistration.pushManager.getSubscription();return!X||X.unsubscribe()})).apply(this,arguments)}function F(L,j){return E.apply(this,arguments)}function E(){return(E=(0,ie.Z)(function*(L,j){try{const X=yield Jn(L.firebaseDependencies,j),me=Object.assign(Object.assign({},j),{token:X,createTime:Date.now()});return yield U(L.firebaseDependencies,me),X}catch(X){throw yield G(L),X}})).apply(this,arguments)}function R(L,j){return Y.apply(this,arguments)}function Y(){return(Y=(0,ie.Z)(function*(L,j){const me={token:yield Wn(L,j),createTime:Date.now(),subscriptionOptions:j};return yield U(L,me),me.token})).apply(this,arguments)}function oe(L,j){return Te.apply(this,arguments)}function Te(){return(Te=(0,ie.Z)(function*(L,j){return(yield L.pushManager.getSubscription())||L.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:co(j)})})).apply(this,arguments)}function Ke(L,j){return j.vapidKey===L.vapidKey&&j.endpoint===L.endpoint&&j.auth===L.auth&&j.p256dh===L.p256dh}function mt(L){const j={from:L.from,collapseKey:L.collapse_key,messageId:L.fcmMessageId};return function Gt(L,j){if(!j.notification)return;L.notification={};const X=j.notification.title;X&&(L.notification.title=X);const me=j.notification.body;me&&(L.notification.body=me);const $e=j.notification.image;$e&&(L.notification.image=$e)}(j,L),function Ut(L,j){!j.data||(L.data=j.data)}(j,L),function Bn(L,j){var X,me,$e,Xe,Ct;if(!j.fcmOptions&&!(null===(X=j.notification)||void 0===X?void 0:X.click_action))return;L.fcmOptions={};const Ot=null!==($e=null===(me=j.fcmOptions)||void 0===me?void 0:me.link)&&void 0!==$e?$e:null===(Xe=j.notification)||void 0===Xe?void 0:Xe.click_action;Ot&&(L.fcmOptions.link=Ot);const Nn=null===(Ct=j.fcmOptions)||void 0===Ct?void 0:Ct.analytics_label;Nn&&(L.fcmOptions.analyticsLabel=Nn)}(j,L),j}function cr(L){return"object"==typeof L&&!!L&&vs in L}function Br(L,j){const X=[];for(let me=0;me<L.length;me++)X.push(L.charAt(me)),me<j.length&&X.push(j.charAt(me));return X.join("")}function rr(L){return wn.create("missing-app-config-values",{valueName:L})}Br("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Br("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Dr{constructor(j,X,me){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const $e=function Or(L){if(!L||!L.options)throw rr("App Configuration Object");if(!L.name)throw rr("App Name");const j=["projectId","apiKey","appId","messagingSenderId"],{options:X}=L;for(const me of j)if(!X[me])throw rr(me);return{appName:L.name,projectId:X.projectId,apiKey:X.apiKey,appId:X.appId,senderId:X.messagingSenderId}}(j);this.firebaseDependencies={app:j,appConfig:$e,installations:X,analyticsProvider:me}}_delete(){return Promise.resolve()}}function Ti(L){return Cr.apply(this,arguments)}function Cr(){return(Cr=(0,ie.Z)(function*(L){var j;try{L.swRegistration=yield navigator.serviceWorker.register(ji,{scope:ti}),L.swRegistration.update().catch(()=>{})}catch(X){throw wn.create("failed-service-worker-registration",{browserErrorMessage:null===(j=X)||void 0===j?void 0:j.message})}})).apply(this,arguments)}function gi(L,j){return Ms.apply(this,arguments)}function Ms(){return(Ms=(0,ie.Z)(function*(L,j){if(!j&&!L.swRegistration&&(yield Ti(L)),j||!L.swRegistration){if(!(j instanceof ServiceWorkerRegistration))throw wn.create("invalid-sw-registration");L.swRegistration=j}})).apply(this,arguments)}function Xn(L,j){return Pi.apply(this,arguments)}function Pi(){return(Pi=(0,ie.Z)(function*(L,j){j?L.vapidKey=j:L.vapidKey||(L.vapidKey=is)})).apply(this,arguments)}function _o(){return(_o=(0,ie.Z)(function*(L,j){if(!navigator)throw wn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw wn.create("permission-blocked");return yield Xn(L,null==j?void 0:j.vapidKey),yield gi(L,null==j?void 0:j.serviceWorkerRegistration),ds(L)})).apply(this,arguments)}function la(L,j,X){return xo.apply(this,arguments)}function xo(){return(xo=(0,ie.Z)(function*(L,j,X){const me=Ro(j);(yield L.firebaseDependencies.analyticsProvider.get()).logEvent(me,{message_id:X[vs],message_name:X[ls],message_time:X[Es],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Ro(L){switch(L){case lo.NOTIFICATION_CLICKED:return"notification_open";case lo.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Ea(){return(Ea=(0,ie.Z)(function*(L,j){const X=j.data;if(!X.isFirebaseMessaging)return;L.onMessageHandler&&X.messageType===lo.PUSH_RECEIVED&&("function"==typeof L.onMessageHandler?L.onMessageHandler(mt(X)):L.onMessageHandler.next(mt(X)));const me=X.data;cr(me)&&"1"===me[Ao]&&(yield la(L,X.messageType,me))})).apply(this,arguments)}const zo="@firebase/messaging",Mo=L=>{const j=new Dr(L.getProvider("app").getImmediate(),L.getProvider("installations-internal").getImmediate(),L.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",X=>function ju(L,j){return Ea.apply(this,arguments)}(j,X)),j},ca=L=>{const j=L.getProvider("messaging").getImmediate();return{getToken:me=>function Js(L,j){return _o.apply(this,arguments)}(j,me)}};function Ma(){return No.apply(this,arguments)}function No(){return(No=(0,ie.Z)(function*(){try{yield(0,Ce.eu)()}catch(L){return!1}return"undefined"!=typeof window&&(0,Ce.hl)()&&(0,Ce.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Ga(){(0,be._registerComponent)(new Se.wA("messaging",Mo,"PUBLIC")),(0,be._registerComponent)(new Se.wA("messaging-internal",ca,"PRIVATE")),(0,be.registerVersion)(zo,"0.9.15"),(0,be.registerVersion)(zo,"0.9.15","esm2017")}();const Pa="analytics",vo="firebase_id",Xs="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qo="https://www.googletagmanager.com/gtag/js",mr=new Ve.Yd("@firebase/analytics");function da(L){return Promise.all(L.map(j=>j.catch(X=>X)))}function $s(L,j){const X=document.createElement("script");X.src=`${qo}?l=${L}&id=${j}`,X.async=!0,document.head.appendChild(X)}function Oa(L,j,X,me,$e,Xe){return Oo.apply(this,arguments)}function Oo(){return(Oo=(0,ie.Z)(function*(L,j,X,me,$e,Xe){const Ct=me[$e];try{if(Ct)yield j[Ct];else{const Nn=(yield da(X)).find(jn=>jn.measurementId===$e);Nn&&(yield j[Nn.appId])}}catch(Ot){mr.error(Ot)}L("config",$e,Xe)})).apply(this,arguments)}function ko(L,j,X,me,$e){return ha.apply(this,arguments)}function ha(){return(ha=(0,ie.Z)(function*(L,j,X,me,$e){try{let Xe=[];if($e&&$e.send_to){let Ct=$e.send_to;Array.isArray(Ct)||(Ct=[Ct]);const Ot=yield da(X);for(const Nn of Ct){const jn=Ot.find(_n=>_n.measurementId===Nn),ir=jn&&j[jn.appId];if(!ir){Xe=[];break}Xe.push(ir)}}0===Xe.length&&(Xe=Object.values(j)),yield Promise.all(Xe),L("event",me,$e||{})}catch(Xe){mr.error(Xe)}})).apply(this,arguments)}function Ka(){const L=window.document.getElementsByTagName("script");for(const j of Object.values(L))if(j.src&&j.src.includes(qo))return j;return null}const mi=new Ce.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Yr=new class eo{constructor(j={},X=1e3){this.throttleMetadata=j,this.intervalMillis=X}getThrottleMetadata(j){return this.throttleMetadata[j]}setThrottleMetadata(j,X){this.throttleMetadata[j]=X}deleteThrottleMetadata(j){delete this.throttleMetadata[j]}};function Eo(L){return new Headers({Accept:"application/json","x-goog-api-key":L})}function Hs(L){return ru.apply(this,arguments)}function ru(){return(ru=(0,ie.Z)(function*(L){var j;const{appId:X,apiKey:me}=L,$e={method:"GET",headers:Eo(me)},Xe=Xs.replace("{app-id}",X),Ct=yield fetch(Xe,$e);if(200!==Ct.status&&304!==Ct.status){let Ot="";try{const Nn=yield Ct.json();(null===(j=Nn.error)||void 0===j?void 0:j.message)&&(Ot=Nn.error.message)}catch(Nn){}throw mi.create("config-fetch-failed",{httpStatus:Ct.status,responseMessage:Ot})}return Ct.json()})).apply(this,arguments)}function Qr(L){return ka.apply(this,arguments)}function ka(){return(ka=(0,ie.Z)(function*(L,j=Yr,X){const{appId:me,apiKey:$e,measurementId:Xe}=L.options;if(!me)throw mi.create("no-app-id");if(!$e){if(Xe)return{measurementId:Xe,appId:me};throw mi.create("no-api-key")}const Ct=j.getThrottleMetadata(me)||{backoffCount:0,throttleEndTimeMillis:Date.now()},Ot=new Qo;return setTimeout((0,ie.Z)(function*(){Ot.abort()}),void 0!==X?X:6e4),Gs({appId:me,apiKey:$e,measurementId:Xe},Ct,Ot,j)})).apply(this,arguments)}function Gs(L,j,X){return Yi.apply(this,arguments)}function Yi(){return(Yi=(0,ie.Z)(function*(L,{throttleEndTimeMillis:j,backoffCount:X},me,$e=Yr){var Xe,Ct;const{appId:Ot,measurementId:Nn}=L;try{yield Ps(me,j)}catch(jn){if(Nn)return mr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Nn} provided in the "measurementId" field in the local Firebase config. [${null===(Xe=jn)||void 0===Xe?void 0:Xe.message}]`),{appId:Ot,measurementId:Nn};throw jn}try{const jn=yield Hs(L);return $e.deleteThrottleMetadata(Ot),jn}catch(jn){const ir=jn;if(!Fo(ir)){if($e.deleteThrottleMetadata(Ot),Nn)return mr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Nn} provided in the "measurementId" field in the local Firebase config. [${null==ir?void 0:ir.message}]`),{appId:Ot,measurementId:Nn};throw jn}const _n=503===Number(null===(Ct=null==ir?void 0:ir.customData)||void 0===Ct?void 0:Ct.httpStatus)?(0,Ce.$s)(X,$e.intervalMillis,30):(0,Ce.$s)(X,$e.intervalMillis),Jr={throttleEndTimeMillis:Date.now()+_n,backoffCount:X+1};return $e.setThrottleMetadata(Ot,Jr),mr.debug(`Calling attemptFetch again in ${_n} millis`),Gs(L,Jr,me,$e)}})).apply(this,arguments)}function Ps(L,j){return new Promise((X,me)=>{const $e=Math.max(j-Date.now(),0),Xe=setTimeout(X,$e);L.addEventListener(()=>{clearTimeout(Xe),me(mi.create("fetch-throttle",{throttleEndTimeMillis:j}))})})}function Fo(L){if(!(L instanceof Ce.ZR&&L.customData))return!1;const j=Number(L.customData.httpStatus);return 429===j||500===j||503===j||504===j}class Qo{constructor(){this.listeners=[]}addEventListener(j){this.listeners.push(j)}abort(){this.listeners.forEach(j=>j())}}function Hu(){return xt.apply(this,arguments)}function xt(){return(xt=(0,ie.Z)(function*(){var L;if(!(0,Ce.hl)())return mr.warn(mi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,Ce.eu)()}catch(j){return mr.warn(mi.create("indexeddb-unavailable",{errorInfo:null===(L=j)||void 0===L?void 0:L.toString()}).message),!1}return!0})).apply(this,arguments)}function Jo(){return(Jo=(0,ie.Z)(function*(L,j,X,me,$e,Xe,Ct){var Ot;const Nn=Qr(L);Nn.then(zs=>{X[zs.measurementId]=zs.appId,L.options.measurementId&&zs.measurementId!==L.options.measurementId&&mr.warn(`The measurement ID in the local Firebase config (${L.options.measurementId}) does not match the measurement ID fetched from the server (${zs.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(zs=>mr.error(zs)),j.push(Nn);const jn=Hu().then(zs=>{if(zs)return me.getId()}),[ir,_n]=yield Promise.all([Nn,jn]);Ka()||$s(Xe,ir.measurementId),$e("js",new Date);const Jr=null!==(Ot=null==Ct?void 0:Ct.config)&&void 0!==Ot?Ot:{};return Jr.origin="firebase",Jr.update=!0,null!=_n&&(Jr[vo]=_n),$e("config",ir.measurementId,Jr),ir.measurementId})).apply(this,arguments)}class fa{constructor(j){this.app=j}_delete(){return delete S[this.app.options.appId],Promise.resolve()}}let S={},D=[];const b={};let K,de,N="dataLayer",Ie=!1;function yr(L,j,X){!function Jt(){const L=[];if((0,Ce.ru)()&&L.push("This is a browser extension environment."),(0,Ce.zI)()||L.push("Cookies are not available."),L.length>0){const j=L.map((me,$e)=>`(${$e+1}) ${me}`).join(" "),X=mi.create("invalid-analytics-context",{errorInfo:j});mr.warn(X.message)}}();const me=L.options.appId;if(!me)throw mi.create("no-app-id");if(!L.options.apiKey){if(!L.options.measurementId)throw mi.create("no-api-key");mr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${L.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=S[me])throw mi.create("already-exists",{id:me});if(!Ie){!function Gi(L){let j=[];Array.isArray(window[L])?j=window[L]:window[L]=j}(N);const{wrappedGtag:Xe,gtagCore:Ct}=function Ns(L,j,X,me,$e){let Xe=function(...Ct){window[me].push(arguments)};return window[$e]&&"function"==typeof window[$e]&&(Xe=window[$e]),window[$e]=function za(L,j,X,me){function Xe(){return(Xe=(0,ie.Z)(function*(Ct,Ot,Nn){try{"event"===Ct?yield ko(L,j,X,Ot,Nn):"config"===Ct?yield Oa(L,j,X,me,Ot,Nn):L("set",Ot)}catch(jn){mr.error(jn)}})).apply(this,arguments)}return function $e(Ct,Ot,Nn){return Xe.apply(this,arguments)}}(Xe,L,j,X),{gtagCore:Xe,wrappedGtag:window[$e]}}(S,D,b,N,"gtag");de=Xe,K=Ct,Ie=!0}return S[me]=function ai(L,j,X,me,$e,Xe,Ct){return Jo.apply(this,arguments)}(L,D,b,j,K,N,X),new fa(L)}function Tr(){return(Tr=(0,ie.Z)(function*(L,j,X,me,$e){if($e&&$e.global)L("event",X,me);else{const Xe=yield j;L("event",X,Object.assign(Object.assign({},me),{send_to:Xe}))}})).apply(this,arguments)}function _u(){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,ie.Z)(function*(){if((0,Ce.ru)()||!(0,Ce.zI)()||!(0,Ce.hl)())return!1;try{return yield(0,Ce.eu)()}catch(L){return!1}})).apply(this,arguments)}const La="@firebase/analytics";!function al(){(0,be._registerComponent)(new Se.wA(Pa,(j,{options:X})=>yr(j.getProvider("app").getImmediate(),j.getProvider("installations-internal").getImmediate(),X),"PUBLIC")),(0,be._registerComponent)(new Se.wA("analytics-internal",function L(j){try{const X=j.getProvider(Pa).getImmediate();return{logEvent:(me,$e,Xe)=>function Wu(L,j,X,me){L=(0,Ce.m9)(L),function pn(L,j,X,me,$e){return Tr.apply(this,arguments)}(de,S[L.app.options.appId],j,X,me).catch($e=>mr.error($e))}(X,me,$e,Xe)}}catch(X){throw mi.create("interop-component-reg-failed",{reason:X})}},"PRIVATE")),(0,be.registerVersion)(La,"0.7.11"),(0,be.registerVersion)(La,"0.7.11","esm2017")}();var iu=$(4408),jr=$(7565);const qa=new class zu extends jr.v{}(class xl extends iu.o{constructor(j,X){super(j,X),this.scheduler=j,this.work=X}schedule(j,X=0){return X>0?super.schedule(j,X):(this.delay=X,this.state=j,this.scheduler.flush(this),this)}execute(j,X){return X>0||this.closed?super.execute(j,X):this._execute(j,X)}requestAsyncId(j,X,me=0){return null!=me&&me>0||null==me&&this.delay>0?super.requestAsyncId(j,X,me):j.flush(this)}});var Ia=$(4986),Io=$(8505),Qe=$(5363),Va=$(9468);const no=new _.GfV("7.4.1"),Za="__angularfire_symbol__analyticsIsSupportedValue",pa="__angularfire_symbol__analyticsIsSupported",Co="__angularfire_symbol__remoteConfigIsSupportedValue",Ca="__angularfire_symbol__remoteConfigIsSupported",Vo="__angularfire_symbol__messagingIsSupportedValue",ul="__angularfire_symbol__messagingIsSupported";function Rl(L,j,X){if(j){if(1===j.length)return j[0];const Xe=j.filter(Ct=>Ct.app===X);if(1===Xe.length)return Xe[0]}return X.container.getProvider(L).getImmediate({optional:!0})}globalThis[pa]||(globalThis[pa]=_u().then(L=>globalThis[Za]=L).catch(()=>globalThis[Za]=!1)),globalThis[ul]||(globalThis[ul]=Ma().then(L=>globalThis[Vo]=L).catch(()=>globalThis[Vo]=!1)),globalThis[Ca]||(globalThis[Ca]=_s().then(L=>globalThis[Co]=L).catch(()=>globalThis[Co]=!1));const Ya=(L,j)=>{const X=j?[j]:(0,ne.C6)(),me=[];return X.forEach($e=>{$e.container.getProvider(L).instances.forEach(Ct=>{me.includes(Ct)||me.push(Ct)})}),me};function Ua(){}class Oi{constructor(j,X=qa){this.zone=j,this.delegate=X}now(){return this.delegate.now()}schedule(j,X,me){const $e=this.zone;return this.delegate.schedule(function(Ct){$e.runGuarded(()=>{j.apply(this,[Ct])})},X,me)}}class Uo{constructor(j){this.zone=j,this.task=null}call(j,X){const me=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ua,{},Ua,Ua)),X.pipe((0,Io.b)({next:me,complete:me,error:me})).subscribe(j).add(me)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Os=(()=>{class L{constructor(X){this.ngZone=X,this.outsideAngular=X.runOutsideAngular(()=>new Oi(Zone.current)),this.insideAngular=X.run(()=>new Oi(Zone.current,Ia.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return L.\u0275fac=function(X){return new(X||L)(_.LFG(_.R0b))},L.\u0275prov=_.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function Sr(){const L=globalThis.\u0275AngularFireScheduler;if(!L)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return L}function Wi(L){return L.pipe((0,Qe.Q)(Sr().outsideAngular))}function ki(L){return Sr(),function Ku(L){return function(X){return(X=X.lift(new Uo(L.ngZone))).pipe((0,Va.R)(L.outsideAngular),(0,Qe.Q)(L.insideAngular))}}(Sr())(L)}},2090:(Ft,We,$)=>{$.d(We,{BH:()=>Rt,LL:()=>Ye,ZR:()=>Je,gQ:()=>Ar,zI:()=>ge,hu:()=>ne,g5:()=>ie,US:()=>Se,tV:()=>Be,h$:()=>Ve,L:()=>Me,$s:()=>Li,r3:()=>Tn,Sg:()=>ot,ne:()=>Vn,p$:()=>ce,vZ:()=>fr,ZB:()=>ae,gK:()=>ei,pd:()=>Gn,m9:()=>dn,z$:()=>at,GJ:()=>Kt,jU:()=>ft,ru:()=>De,d:()=>ht,xb:()=>Yt,w1:()=>xe,hl:()=>V,uI:()=>Dt,UG:()=>nt,Yr:()=>wt,b$:()=>kt,G6:()=>It,Mn:()=>Ge,w9:()=>tn,cI:()=>Wt,UI:()=>hr,xO:()=>Pn,zd:()=>Hr,DV:()=>zt,ug:()=>Vt,dS:()=>xr,Pz:()=>qt,Dv:()=>Ci,Wj:()=>Fr,lb:()=>ci,eu:()=>ut});const ne=function(Ne,ye){if(!Ne)throw ie(ye)},ie=function(Ne){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+Ne)},be=function(Ne){const ye=[];let je=0;for(let ke=0;ke<Ne.length;ke++){let fe=Ne.charCodeAt(ke);fe<128?ye[je++]=fe:fe<2048?(ye[je++]=fe>>6|192,ye[je++]=63&fe|128):55296==(64512&fe)&&ke+1<Ne.length&&56320==(64512&Ne.charCodeAt(ke+1))?(fe=65536+((1023&fe)<<10)+(1023&Ne.charCodeAt(++ke)),ye[je++]=fe>>18|240,ye[je++]=fe>>12&63|128,ye[je++]=fe>>6&63|128,ye[je++]=63&fe|128):(ye[je++]=fe>>12|224,ye[je++]=fe>>6&63|128,ye[je++]=63&fe|128)}return ye},Se={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(Ne,ye){if(!Array.isArray(Ne))throw Error("encodeByteArray takes an array as a parameter");this.init_();const je=ye?this.byteToCharMapWebSafe_:this.byteToCharMap_,ke=[];for(let fe=0;fe<Ne.length;fe+=3){const qe=Ne[fe],At=fe+1<Ne.length,$t=At?Ne[fe+1]:0,hn=fe+2<Ne.length,or=hn?Ne[fe+2]:0;let ur=(15&$t)<<2|or>>6,ts=63&or;hn||(ts=64,At||(ur=64)),ke.push(je[qe>>2],je[(3&qe)<<4|$t>>4],je[ur],je[ts])}return ke.join("")},encodeString(Ne,ye){return this.HAS_NATIVE_SUPPORT&&!ye?btoa(Ne):this.encodeByteArray(be(Ne),ye)},decodeString(Ne,ye){return this.HAS_NATIVE_SUPPORT&&!ye?atob(Ne):function(Ne){const ye=[];let je=0,ke=0;for(;je<Ne.length;){const fe=Ne[je++];if(fe<128)ye[ke++]=String.fromCharCode(fe);else if(fe>191&&fe<224){const qe=Ne[je++];ye[ke++]=String.fromCharCode((31&fe)<<6|63&qe)}else if(fe>239&&fe<365){const hn=((7&fe)<<18|(63&Ne[je++])<<12|(63&Ne[je++])<<6|63&Ne[je++])-65536;ye[ke++]=String.fromCharCode(55296+(hn>>10)),ye[ke++]=String.fromCharCode(56320+(1023&hn))}else{const qe=Ne[je++],At=Ne[je++];ye[ke++]=String.fromCharCode((15&fe)<<12|(63&qe)<<6|63&At)}}return ye.join("")}(this.decodeStringToByteArray(Ne,ye))},decodeStringToByteArray(Ne,ye){this.init_();const je=ye?this.charToByteMapWebSafe_:this.charToByteMap_,ke=[];for(let fe=0;fe<Ne.length;){const qe=je[Ne.charAt(fe++)],$t=fe<Ne.length?je[Ne.charAt(fe)]:0;++fe;const or=fe<Ne.length?je[Ne.charAt(fe)]:64;++fe;const an=fe<Ne.length?je[Ne.charAt(fe)]:64;if(++fe,null==qe||null==$t||null==or||null==an)throw Error();ke.push(qe<<2|$t>>4),64!==or&&(ke.push($t<<4&240|or>>2),64!==an&&ke.push(or<<6&192|an))}return ke},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let Ne=0;Ne<this.ENCODED_VALS.length;Ne++)this.byteToCharMap_[Ne]=this.ENCODED_VALS.charAt(Ne),this.charToByteMap_[this.byteToCharMap_[Ne]]=Ne,this.byteToCharMapWebSafe_[Ne]=this.ENCODED_VALS_WEBSAFE.charAt(Ne),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[Ne]]=Ne,Ne>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(Ne)]=Ne,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(Ne)]=Ne)}}},Ve=function(Ne){const ye=be(Ne);return Se.encodeByteArray(ye,!0)},Me=function(Ne){return Ve(Ne).replace(/\./g,"")},Be=function(Ne){try{return Se.decodeString(Ne,!0)}catch(ye){console.error("base64Decode failed: ",ye)}return null};function ce(Ne){return ae(void 0,Ne)}function ae(Ne,ye){if(!(ye instanceof Object))return ye;switch(ye.constructor){case Date:return new Date(ye.getTime());case Object:void 0===Ne&&(Ne={});break;case Array:Ne=[];break;default:return ye}for(const je in ye)!ye.hasOwnProperty(je)||!Re(je)||(Ne[je]=ae(Ne[je],ye[je]));return Ne}function Re(Ne){return"__proto__"!==Ne}class Rt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((ye,je)=>{this.resolve=ye,this.reject=je})}wrapCallback(ye){return(je,ke)=>{je?this.reject(je):this.resolve(ke),"function"==typeof ye&&(this.promise.catch(()=>{}),1===ye.length?ye(je):ye(je,ke))}}}function ot(Ne,ye){if(Ne.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const ke=ye||"demo-project",fe=Ne.iat||0,qe=Ne.sub||Ne.user_id;if(!qe)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const At=Object.assign({iss:`https://securetoken.google.com/${ke}`,aud:ke,iat:fe,exp:fe+3600,auth_time:fe,sub:qe,user_id:qe,firebase:{sign_in_provider:"custom",identities:{}}},Ne);return[Me(JSON.stringify({alg:"none",type:"JWT"})),Me(JSON.stringify(At)),""].join(".")}function at(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Dt(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(at())}function nt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(Ne){return!1}}function ft(){return"object"==typeof self&&self.self===self}function De(){const Ne="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof Ne&&void 0!==Ne.id}function kt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ht(){return at().indexOf("Electron/")>=0}function xe(){const Ne=at();return Ne.indexOf("MSIE ")>=0||Ne.indexOf("Trident/")>=0}function Ge(){return at().indexOf("MSAppHost/")>=0}function wt(){return!1}function It(){return!nt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function V(){return"object"==typeof indexedDB}function ut(){return new Promise((Ne,ye)=>{try{let je=!0;const ke="validate-browser-context-for-indexeddb-analytics-module",fe=self.indexedDB.open(ke);fe.onsuccess=()=>{fe.result.close(),je||self.indexedDB.deleteDatabase(ke),Ne(!0)},fe.onupgradeneeded=()=>{je=!1},fe.onerror=()=>{var qe;ye((null===(qe=fe.error)||void 0===qe?void 0:qe.message)||"")}}catch(je){ye(je)}})}function ge(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class Je extends Error{constructor(ye,je,ke){super(je),this.code=ye,this.customData=ke,this.name="FirebaseError",Object.setPrototypeOf(this,Je.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ye.prototype.create)}}class Ye{constructor(ye,je,ke){this.service=ye,this.serviceName=je,this.errors=ke}create(ye,...je){const ke=je[0]||{},fe=`${this.service}/${ye}`,qe=this.errors[ye],At=qe?function St(Ne,ye){return Ne.replace(Pt,(je,ke)=>{const fe=ye[ke];return null!=fe?String(fe):`<${ke}?>`})}(qe,ke):"Error";return new Je(fe,`${this.serviceName}: ${At} (${fe}).`,ke)}}const Pt=/\{\$([^}]+)}/g;function Wt(Ne){return JSON.parse(Ne)}function qt(Ne){return JSON.stringify(Ne)}const it=function(Ne){let ye={},je={},ke={},fe="";try{const qe=Ne.split(".");ye=Wt(Be(qe[0])||""),je=Wt(Be(qe[1])||""),fe=qe[2],ke=je.d||{},delete je.d}catch(qe){}return{header:ye,claims:je,data:ke,signature:fe}},tn=function(Ne){const je=it(Ne).claims;return!!je&&"object"==typeof je&&je.hasOwnProperty("iat")},Kt=function(Ne){const ye=it(Ne).claims;return"object"==typeof ye&&!0===ye.admin};function Tn(Ne,ye){return Object.prototype.hasOwnProperty.call(Ne,ye)}function zt(Ne,ye){if(Object.prototype.hasOwnProperty.call(Ne,ye))return Ne[ye]}function Yt(Ne){for(const ye in Ne)if(Object.prototype.hasOwnProperty.call(Ne,ye))return!1;return!0}function hr(Ne,ye,je){const ke={};for(const fe in Ne)Object.prototype.hasOwnProperty.call(Ne,fe)&&(ke[fe]=ye.call(je,Ne[fe],fe,Ne));return ke}function fr(Ne,ye){if(Ne===ye)return!0;const je=Object.keys(Ne),ke=Object.keys(ye);for(const fe of je){if(!ke.includes(fe))return!1;const qe=Ne[fe],At=ye[fe];if(sr(qe)&&sr(At)){if(!fr(qe,At))return!1}else if(qe!==At)return!1}for(const fe of ke)if(!je.includes(fe))return!1;return!0}function sr(Ne){return null!==Ne&&"object"==typeof Ne}function Pn(Ne){const ye=[];for(const[je,ke]of Object.entries(Ne))Array.isArray(ke)?ke.forEach(fe=>{ye.push(encodeURIComponent(je)+"="+encodeURIComponent(fe))}):ye.push(encodeURIComponent(je)+"="+encodeURIComponent(ke));return ye.length?"&"+ye.join("&"):""}function Hr(Ne){const ye={};return Ne.replace(/^\?/,"").split("&").forEach(ke=>{if(ke){const[fe,qe]=ke.split("=");ye[decodeURIComponent(fe)]=decodeURIComponent(qe)}}),ye}function Gn(Ne){const ye=Ne.indexOf("?");if(!ye)return"";const je=Ne.indexOf("#",ye);return Ne.substring(ye,je>0?je:void 0)}class Ar{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let ye=1;ye<this.blockSize;++ye)this.pad_[ye]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(ye,je){je||(je=0);const ke=this.W_;if("string"==typeof ye)for(let an=0;an<16;an++)ke[an]=ye.charCodeAt(je)<<24|ye.charCodeAt(je+1)<<16|ye.charCodeAt(je+2)<<8|ye.charCodeAt(je+3),je+=4;else for(let an=0;an<16;an++)ke[an]=ye[je]<<24|ye[je+1]<<16|ye[je+2]<<8|ye[je+3],je+=4;for(let an=16;an<80;an++){const ur=ke[an-3]^ke[an-8]^ke[an-14]^ke[an-16];ke[an]=4294967295&(ur<<1|ur>>>31)}let or,lr,fe=this.chain_[0],qe=this.chain_[1],At=this.chain_[2],$t=this.chain_[3],hn=this.chain_[4];for(let an=0;an<80;an++){an<40?an<20?(or=$t^qe&(At^$t),lr=1518500249):(or=qe^At^$t,lr=1859775393):an<60?(or=qe&At|$t&(qe|At),lr=2400959708):(or=qe^At^$t,lr=3395469782);const ur=(fe<<5|fe>>>27)+or+hn+lr+ke[an]&4294967295;hn=$t,$t=At,At=4294967295&(qe<<30|qe>>>2),qe=fe,fe=ur}this.chain_[0]=this.chain_[0]+fe&4294967295,this.chain_[1]=this.chain_[1]+qe&4294967295,this.chain_[2]=this.chain_[2]+At&4294967295,this.chain_[3]=this.chain_[3]+$t&4294967295,this.chain_[4]=this.chain_[4]+hn&4294967295}update(ye,je){if(null==ye)return;void 0===je&&(je=ye.length);const ke=je-this.blockSize;let fe=0;const qe=this.buf_;let At=this.inbuf_;for(;fe<je;){if(0===At)for(;fe<=ke;)this.compress_(ye,fe),fe+=this.blockSize;if("string"==typeof ye){for(;fe<je;)if(qe[At]=ye.charCodeAt(fe),++At,++fe,At===this.blockSize){this.compress_(qe),At=0;break}}else for(;fe<je;)if(qe[At]=ye[fe],++At,++fe,At===this.blockSize){this.compress_(qe),At=0;break}}this.inbuf_=At,this.total_+=je}digest(){const ye=[];let je=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let fe=this.blockSize-1;fe>=56;fe--)this.buf_[fe]=255&je,je/=256;this.compress_(this.buf_);let ke=0;for(let fe=0;fe<5;fe++)for(let qe=24;qe>=0;qe-=8)ye[ke]=this.chain_[fe]>>qe&255,++ke;return ye}}function Vn(Ne,ye){const je=new Bt(Ne,ye);return je.subscribe.bind(je)}class Bt{constructor(ye,je){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=je,this.task.then(()=>{ye(this)}).catch(ke=>{this.error(ke)})}next(ye){this.forEachObserver(je=>{je.next(ye)})}error(ye){this.forEachObserver(je=>{je.error(ye)}),this.close(ye)}complete(){this.forEachObserver(ye=>{ye.complete()}),this.close()}subscribe(ye,je,ke){let fe;if(void 0===ye&&void 0===je&&void 0===ke)throw new Error("Missing Observer.");fe=function Sn(Ne,ye){if("object"!=typeof Ne||null===Ne)return!1;for(const je of ye)if(je in Ne&&"function"==typeof Ne[je])return!0;return!1}(ye,["next","error","complete"])?ye:{next:ye,error:je,complete:ke},void 0===fe.next&&(fe.next=ln),void 0===fe.error&&(fe.error=ln),void 0===fe.complete&&(fe.complete=ln);const qe=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?fe.error(this.finalError):fe.complete()}catch(At){}}),this.observers.push(fe),qe}unsubscribeOne(ye){void 0===this.observers||void 0===this.observers[ye]||(delete this.observers[ye],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(ye){if(!this.finalized)for(let je=0;je<this.observers.length;je++)this.sendOne(je,ye)}sendOne(ye,je){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[ye])try{je(this.observers[ye])}catch(ke){"undefined"!=typeof console&&console.error&&console.error(ke)}})}close(ye){this.finalized||(this.finalized=!0,void 0!==ye&&(this.finalError=ye),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ln(){}const Ci=function(Ne,ye,je,ke){let fe;if(ke<ye?fe="at least "+ye:ke>je&&(fe=0===je?"none":"no more than "+je),fe)throw new Error(Ne+" failed: Was called with "+ke+(1===ke?" argument.":" arguments.")+" Expects "+fe+".")};function ei(Ne,ye){return`${Ne} failed: ${ye} argument `}function Fr(Ne,ye,je,ke){if((!ke||je)&&"function"!=typeof je)throw new Error(ei(Ne,ye)+"must be a valid function.")}function ci(Ne,ye,je,ke){if((!ke||je)&&("object"!=typeof je||null===je))throw new Error(ei(Ne,ye)+"must be a valid context object.")}const xr=function(Ne){const ye=[];let je=0;for(let ke=0;ke<Ne.length;ke++){let fe=Ne.charCodeAt(ke);if(fe>=55296&&fe<=56319){const qe=fe-55296;ke++,ne(ke<Ne.length,"Surrogate pair missing trail surrogate."),fe=65536+(qe<<10)+(Ne.charCodeAt(ke)-56320)}fe<128?ye[je++]=fe:fe<2048?(ye[je++]=fe>>6|192,ye[je++]=63&fe|128):fe<65536?(ye[je++]=fe>>12|224,ye[je++]=fe>>6&63|128,ye[je++]=63&fe|128):(ye[je++]=fe>>18|240,ye[je++]=fe>>12&63|128,ye[je++]=fe>>6&63|128,ye[je++]=63&fe|128)}return ye},Vt=function(Ne){let ye=0;for(let je=0;je<Ne.length;je++){const ke=Ne.charCodeAt(je);ke<128?ye++:ke<2048?ye+=2:ke>=55296&&ke<=56319?(ye+=4,je++):ye+=3}return ye};function Li(Ne,ye=1e3,je=2){const ke=ye*Math.pow(je,Ne),fe=Math.round(.5*ke*(Math.random()-.5)*2);return Math.min(144e5,ke+fe)}function dn(Ne){return Ne&&Ne._delegate?Ne._delegate:Ne}},5936:(Ft,We,$)=>{$.d(We,{a:()=>Ce});var _=$(4004),ne=$(5e3),ie=$(441),be=$(6209);let Ce=(()=>{class Se{constructor(Me,Be){this.router=Me,this.authService=Be}canActivate(){return this.authService.authState.pipe((0,_.U)(Me=>(Me||this.router.navigate(["/auth/login"]),!!Me)))}}return Se.\u0275fac=function(Me){return new(Me||Se)(ne.LFG(ie.F0),ne.LFG(be.e))},Se.\u0275prov=ne.Yz7({token:Se,factory:Se.\u0275fac}),Se})()},6209:(Ft,We,$)=>{$.d(We,{e:()=>Ve});var _=$(8505),ne=$(5e3),ie=$(7078),be=$(7407),Ce=$(1205),Se=$(441);let Ve=(()=>{class Me{constructor(ce,ae,Re,Rt,ot){this.store=ce,this.afs=ae,this.afAuth=Re,this.router=Rt,this.ngZone=ot,this.auth$=this.afAuth.authState.pipe((0,_.b)(at=>{this.store.set("user",at?{email:null==at?void 0:at.email,uid:null==at?void 0:at.uid,authenticated:!0}:null)}))}login(ce,ae){return this.afAuth.signInWithEmailAndPassword(ce,ae)}SignIn(ce,ae){return this.afAuth.signInWithEmailAndPassword(ce,ae).then(Re=>{this.ngZone.run(()=>{this.router.navigate(["dashboard"])}),this.SetUserData(Re.user)}).catch(Re=>{window.alert(Re.message)})}register(ce,ae){return this.afAuth.createUserWithEmailAndPassword(ce,ae)}SignUp(ce,ae){return this.afAuth.createUserWithEmailAndPassword(ce,ae).then(Re=>{this.SendVerificationMail(),this.SetUserData(Re.user)}).catch(Re=>Re)}SendVerificationMail(){return this.afAuth.currentUser.then(ce=>ce.sendEmailVerification()).then(()=>{this.router.navigate([""])})}ForgotPassword(ce){return this.afAuth.sendPasswordResetEmail(ce).then(()=>{window.alert("Password reset email sent, check your inbox.")}).catch(ae=>{window.alert(ae)})}get isLoggedIn(){const ce=JSON.parse(localStorage.getItem("user"));return null!==ce&&!1!==ce.emailVerified}AuthLogin(ce){return this.afAuth.signInWithPopup(ce).then(ae=>{this.ngZone.run(()=>{this.router.navigate(["dashboard"])}),this.SetUserData(ae.user)}).catch(ae=>{window.alert(ae)})}SetUserData(ce){return this.afs.doc(`users/${ce.uid}`).set({uid:ce.uid,email:ce.email,displayName:ce.displayName,photoURL:ce.photoURL,emailVerified:ce.emailVerified},{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["sign-in"])})}logout(){return this.afAuth.signOut()}get authState(){return this.afAuth.authState}get userId(){return this.afAuth.currentUser.then(ce=>ce.uid)}}return Me.\u0275fac=function(ce){return new(ce||Me)(ne.LFG(ie.y),ne.LFG(be.ST),ne.LFG(Ce.zQ),ne.LFG(Se.F0),ne.LFG(ne.R0b))},Me.\u0275prov=ne.Yz7({token:Me,factory:Me.\u0275fac}),Me})()},8583:(Ft,We,$)=>{$.d(We,{m:()=>Se});var _=$(5936),ne=$(6209),ie=$(9808),be=$(2382),Ce=$(5e3);let Se=(()=>{class Ve{static forRoot(){return{ngModule:Ve,providers:[ne.e,_.a]}}}return Ve.\u0275fac=function(Be){return new(Be||Ve)},Ve.\u0275mod=Ce.oAB({type:Ve}),Ve.\u0275inj=Ce.cJS({imports:[[ie.ez,be.UX]]}),Ve})()},8343:(Ft,We,$)=>{var _=$(9808),ne=$(5e3);class ie extends _.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class be extends ie{static makeCurrent(){(0,_.HT)(new be)}onAndCancel(pe,le,ze){return pe.addEventListener(le,ze,!1),()=>{pe.removeEventListener(le,ze,!1)}}dispatchEvent(pe,le){pe.dispatchEvent(le)}remove(pe){pe.parentNode&&pe.parentNode.removeChild(pe)}createElement(pe,le){return(le=le||this.getDefaultDocument()).createElement(pe)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(pe){return pe.nodeType===Node.ELEMENT_NODE}isShadowRoot(pe){return pe instanceof DocumentFragment}getGlobalEventTarget(pe,le){return"window"===le?window:"document"===le?pe:"body"===le?pe.body:null}getBaseHref(pe){const le=function Se(){return Ce=Ce||document.querySelector("base"),Ce?Ce.getAttribute("href"):null}();return null==le?null:function Me(Ee){Ve=Ve||document.createElement("a"),Ve.setAttribute("href",Ee);const pe=Ve.pathname;return"/"===pe.charAt(0)?pe:`/${pe}`}(le)}resetBaseElement(){Ce=null}getUserAgent(){return window.navigator.userAgent}getCookie(pe){return(0,_.Mx)(document.cookie,pe)}}let Ve,Ce=null;const Be=new ne.OlP("TRANSITION_ID"),ae=[{provide:ne.ip1,useFactory:function ce(Ee,pe,le){return()=>{le.get(ne.CZH).donePromise.then(()=>{const ze=(0,_.q)(),gt=pe.querySelectorAll(`style[ng-transition="${Ee}"]`);for(let Qt=0;Qt<gt.length;Qt++)ze.remove(gt[Qt])})}},deps:[Be,_.K0,ne.zs3],multi:!0}];class Re{static init(){(0,ne.VLi)(new Re)}addToWindow(pe){ne.dqk.getAngularTestability=(ze,gt=!0)=>{const Qt=pe.findTestabilityInTree(ze,gt);if(null==Qt)throw new Error("Could not find testability for element.");return Qt},ne.dqk.getAllAngularTestabilities=()=>pe.getAllTestabilities(),ne.dqk.getAllAngularRootElements=()=>pe.getAllRootElements(),ne.dqk.frameworkStabilizers||(ne.dqk.frameworkStabilizers=[]),ne.dqk.frameworkStabilizers.push(ze=>{const gt=ne.dqk.getAllAngularTestabilities();let Qt=gt.length,gn=!1;const er=function(gr){gn=gn||gr,Qt--,0==Qt&&ze(gn)};gt.forEach(function(gr){gr.whenStable(er)})})}findTestabilityInTree(pe,le,ze){if(null==le)return null;const gt=pe.getTestability(le);return null!=gt?gt:ze?(0,_.q)().isShadowRoot(le)?this.findTestabilityInTree(pe,le.host,!0):this.findTestabilityInTree(pe,le.parentElement,!0):null}}let Rt=(()=>{class Ee{build(){return new XMLHttpRequest}}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const ot=new ne.OlP("EventManagerPlugins");let at=(()=>{class Ee{constructor(le,ze){this._zone=ze,this._eventNameToPlugin=new Map,le.forEach(gt=>gt.manager=this),this._plugins=le.slice().reverse()}addEventListener(le,ze,gt){return this._findPluginFor(ze).addEventListener(le,ze,gt)}addGlobalEventListener(le,ze,gt){return this._findPluginFor(ze).addGlobalEventListener(le,ze,gt)}getZone(){return this._zone}_findPluginFor(le){const ze=this._eventNameToPlugin.get(le);if(ze)return ze;const gt=this._plugins;for(let Qt=0;Qt<gt.length;Qt++){const gn=gt[Qt];if(gn.supports(le))return this._eventNameToPlugin.set(le,gn),gn}throw new Error(`No event manager plugin found for event ${le}`)}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.LFG(ot),ne.LFG(ne.R0b))},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();class Dt{constructor(pe){this._doc=pe}addGlobalEventListener(pe,le,ze){const gt=(0,_.q)().getGlobalEventTarget(this._doc,pe);if(!gt)throw new Error(`Unsupported event target ${gt} for event ${le}`);return this.addEventListener(gt,le,ze)}}let nt=(()=>{class Ee{constructor(){this._stylesSet=new Set}addStyles(le){const ze=new Set;le.forEach(gt=>{this._stylesSet.has(gt)||(this._stylesSet.add(gt),ze.add(gt))}),this.onStylesAdded(ze)}onStylesAdded(le){}getAllStyles(){return Array.from(this._stylesSet)}}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})(),ft=(()=>{class Ee extends nt{constructor(le){super(),this._doc=le,this._hostNodes=new Map,this._hostNodes.set(le.head,[])}_addStylesToHost(le,ze,gt){le.forEach(Qt=>{const gn=this._doc.createElement("style");gn.textContent=Qt,gt.push(ze.appendChild(gn))})}addHost(le){const ze=[];this._addStylesToHost(this._stylesSet,le,ze),this._hostNodes.set(le,ze)}removeHost(le){const ze=this._hostNodes.get(le);ze&&ze.forEach(De),this._hostNodes.delete(le)}onStylesAdded(le){this._hostNodes.forEach((ze,gt)=>{this._addStylesToHost(le,gt,ze)})}ngOnDestroy(){this._hostNodes.forEach(le=>le.forEach(De))}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.LFG(_.K0))},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();function De(Ee){(0,_.q)().remove(Ee)}const kt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ht=/%COMP%/g;function ge(Ee,pe,le){for(let ze=0;ze<pe.length;ze++){let gt=pe[ze];Array.isArray(gt)?ge(Ee,gt,le):(gt=gt.replace(ht,Ee),le.push(gt))}return le}function Oe(Ee){return pe=>{if("__ngUnwrap__"===pe)return Ee;!1===Ee(pe)&&(pe.preventDefault(),pe.returnValue=!1)}}let Je=(()=>{class Ee{constructor(le,ze,gt){this.eventManager=le,this.sharedStylesHost=ze,this.appId=gt,this.rendererByCompId=new Map,this.defaultRenderer=new Ye(le)}createRenderer(le,ze){if(!le||!ze)return this.defaultRenderer;switch(ze.encapsulation){case ne.ifc.Emulated:{let gt=this.rendererByCompId.get(ze.id);return gt||(gt=new Wt(this.eventManager,this.sharedStylesHost,ze,this.appId),this.rendererByCompId.set(ze.id,gt)),gt.applyToHost(le),gt}case 1:case ne.ifc.ShadowDom:return new qt(this.eventManager,this.sharedStylesHost,le,ze);default:if(!this.rendererByCompId.has(ze.id)){const gt=ge(ze.id,ze.styles,[]);this.sharedStylesHost.addStyles(gt),this.rendererByCompId.set(ze.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.LFG(at),ne.LFG(ft),ne.LFG(ne.AFp))},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();class Ye{constructor(pe){this.eventManager=pe,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(pe,le){return le?document.createElementNS(kt[le]||le,pe):document.createElement(pe)}createComment(pe){return document.createComment(pe)}createText(pe){return document.createTextNode(pe)}appendChild(pe,le){pe.appendChild(le)}insertBefore(pe,le,ze){pe&&pe.insertBefore(le,ze)}removeChild(pe,le){pe&&pe.removeChild(le)}selectRootElement(pe,le){let ze="string"==typeof pe?document.querySelector(pe):pe;if(!ze)throw new Error(`The selector "${pe}" did not match any elements`);return le||(ze.textContent=""),ze}parentNode(pe){return pe.parentNode}nextSibling(pe){return pe.nextSibling}setAttribute(pe,le,ze,gt){if(gt){le=gt+":"+le;const Qt=kt[gt];Qt?pe.setAttributeNS(Qt,le,ze):pe.setAttribute(le,ze)}else pe.setAttribute(le,ze)}removeAttribute(pe,le,ze){if(ze){const gt=kt[ze];gt?pe.removeAttributeNS(gt,le):pe.removeAttribute(`${ze}:${le}`)}else pe.removeAttribute(le)}addClass(pe,le){pe.classList.add(le)}removeClass(pe,le){pe.classList.remove(le)}setStyle(pe,le,ze,gt){gt&(ne.JOm.DashCase|ne.JOm.Important)?pe.style.setProperty(le,ze,gt&ne.JOm.Important?"important":""):pe.style[le]=ze}removeStyle(pe,le,ze){ze&ne.JOm.DashCase?pe.style.removeProperty(le):pe.style[le]=""}setProperty(pe,le,ze){pe[le]=ze}setValue(pe,le){pe.nodeValue=le}listen(pe,le,ze){return"string"==typeof pe?this.eventManager.addGlobalEventListener(pe,le,Oe(ze)):this.eventManager.addEventListener(pe,le,Oe(ze))}}class Wt extends Ye{constructor(pe,le,ze,gt){super(pe),this.component=ze;const Qt=ge(gt+"-"+ze.id,ze.styles,[]);le.addStyles(Qt),this.contentAttr=function V(Ee){return"_ngcontent-%COMP%".replace(ht,Ee)}(gt+"-"+ze.id),this.hostAttr=function ut(Ee){return"_nghost-%COMP%".replace(ht,Ee)}(gt+"-"+ze.id)}applyToHost(pe){super.setAttribute(pe,this.hostAttr,"")}createElement(pe,le){const ze=super.createElement(pe,le);return super.setAttribute(ze,this.contentAttr,""),ze}}class qt extends Ye{constructor(pe,le,ze,gt){super(pe),this.sharedStylesHost=le,this.hostEl=ze,this.shadowRoot=ze.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Qt=ge(gt.id,gt.styles,[]);for(let gn=0;gn<Qt.length;gn++){const er=document.createElement("style");er.textContent=Qt[gn],this.shadowRoot.appendChild(er)}}nodeOrShadowRoot(pe){return pe===this.hostEl?this.shadowRoot:pe}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(pe,le){return super.appendChild(this.nodeOrShadowRoot(pe),le)}insertBefore(pe,le,ze){return super.insertBefore(this.nodeOrShadowRoot(pe),le,ze)}removeChild(pe,le){return super.removeChild(this.nodeOrShadowRoot(pe),le)}parentNode(pe){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(pe)))}}let it=(()=>{class Ee extends Dt{constructor(le){super(le)}supports(le){return!0}addEventListener(le,ze,gt){return le.addEventListener(ze,gt,!1),()=>this.removeEventListener(le,ze,gt)}removeEventListener(le,ze,gt){return le.removeEventListener(ze,gt)}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.LFG(_.K0))},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const en=["alt","control","meta","shift"],tn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Kt={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Tn={alt:Ee=>Ee.altKey,control:Ee=>Ee.ctrlKey,meta:Ee=>Ee.metaKey,shift:Ee=>Ee.shiftKey};let zt=(()=>{class Ee extends Dt{constructor(le){super(le)}supports(le){return null!=Ee.parseEventName(le)}addEventListener(le,ze,gt){const Qt=Ee.parseEventName(ze),gn=Ee.eventCallback(Qt.fullKey,gt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,_.q)().onAndCancel(le,Qt.domEventName,gn))}static parseEventName(le){const ze=le.toLowerCase().split("."),gt=ze.shift();if(0===ze.length||"keydown"!==gt&&"keyup"!==gt)return null;const Qt=Ee._normalizeKey(ze.pop());let gn="";if(en.forEach(gr=>{const Yn=ze.indexOf(gr);Yn>-1&&(ze.splice(Yn,1),gn+=gr+".")}),gn+=Qt,0!=ze.length||0===Qt.length)return null;const er={};return er.domEventName=gt,er.fullKey=gn,er}static getEventFullKey(le){let ze="",gt=function Yt(Ee){let pe=Ee.key;if(null==pe){if(pe=Ee.keyIdentifier,null==pe)return"Unidentified";pe.startsWith("U+")&&(pe=String.fromCharCode(parseInt(pe.substring(2),16)),3===Ee.location&&Kt.hasOwnProperty(pe)&&(pe=Kt[pe]))}return tn[pe]||pe}(le);return gt=gt.toLowerCase()," "===gt?gt="space":"."===gt&&(gt="dot"),en.forEach(Qt=>{Qt!=gt&&Tn[Qt](le)&&(ze+=Qt+".")}),ze+=gt,ze}static eventCallback(le,ze,gt){return Qt=>{Ee.getEventFullKey(Qt)===le&&gt.runGuarded(()=>ze(Qt))}}static _normalizeKey(le){return"esc"===le?"escape":le}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.LFG(_.K0))},Ee.\u0275prov=ne.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const Hr=(0,ne.eFA)(ne._c5,"browser",[{provide:ne.Lbi,useValue:_.bD},{provide:ne.g9A,useValue:function hr(){be.makeCurrent(),Re.init()},multi:!0},{provide:_.K0,useFactory:function sr(){return(0,ne.RDi)(document),document},deps:[]}]),Gn=[{provide:ne.zSh,useValue:"root"},{provide:ne.qLn,useFactory:function fr(){return new ne.qLn},deps:[]},{provide:ot,useClass:it,multi:!0,deps:[_.K0,ne.R0b,ne.Lbi]},{provide:ot,useClass:zt,multi:!0,deps:[_.K0]},{provide:Je,useClass:Je,deps:[at,ft,ne.AFp]},{provide:ne.FYo,useExisting:Je},{provide:nt,useExisting:ft},{provide:ft,useClass:ft,deps:[_.K0]},{provide:ne.dDg,useClass:ne.dDg,deps:[ne.R0b]},{provide:at,useClass:at,deps:[ot,ne.R0b]},{provide:_.JF,useClass:Rt,deps:[]}];let Ar=(()=>{class Ee{constructor(le){if(le)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(le){return{ngModule:Ee,providers:[{provide:ne.AFp,useValue:le.appId},{provide:Be,useExisting:ne.AFp},ae]}}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.LFG(Ee,12))},Ee.\u0275mod=ne.oAB({type:Ee}),Ee.\u0275inj=ne.cJS({providers:Gn,imports:[_.ez,ne.hGG]}),Ee})();"undefined"!=typeof window&&window;var Gr=$(8583),_i=$(5936),yn=$(441);const br=[{path:"schedule",canActivate:[_i.a],loadChildren:()=>$.e(539).then($.bind($,1539)).then(Ee=>Ee.ScheduleModule)},{path:"meals",canActivate:[_i.a],loadChildren:()=>$.e(857).then($.bind($,4857)).then(Ee=>Ee.MealsModule)},{path:"workouts",canActivate:[_i.a],loadChildren:()=>$.e(493).then($.bind($,8493)).then(Ee=>Ee.WorkoutsModule)}];let ii=(()=>{class Ee{}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275mod=ne.oAB({type:Ee}),Ee.\u0275inj=ne.cJS({imports:[[_.ez,yn.Bz.forChild(br),Gr.m.forRoot()]]}),Ee})();var Zr=$(7078);const Vr=[{path:"",pathMatch:"full",redirectTo:"schedule"}];let si=(()=>{class Ee{}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275mod=ne.oAB({type:Ee}),Ee.\u0275inj=ne.cJS({imports:[[yn.Bz.forRoot(Vr)],yn.Bz]}),Ee})();var ys=$(5861),Vi=$(6209);function Wr(Ee,pe){if(1&Ee){const le=ne.EpF();ne.TgZ(0,"div",12)(1,"span",13),ne.NdJ("click",function(){return ne.CHM(le),ne.oxw().logoutUser()}),ne._uU(2,"Logout"),ne.qZA()()}}let Er=(()=>{class Ee{constructor(){this.logout=new ne.vpe}ngOnInit(){}logoutUser(){this.logout.emit()}}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275cmp=ne.Xpm({type:Ee,selectors:[["app-nav"]],inputs:{user:"user"},outputs:{logout:"logout"},decls:18,vars:1,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-light","my-0","py-0","mb-3"],[1,"container"],["routerLink","/",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarText","aria-controls","navbarText","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarText",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["routerLink","schedule","routerLinkActive","active",1,"nav-link"],["routerLink","meals","routerLinkActive","active",1,"nav-link"],["routerLink","workouts","routerLinkActive","active",1,"nav-link"],["class","header",4,"ngIf"],[1,"header"],[3,"click"]],template:function(le,ze){1&le&&(ne.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),ne._uU(3,"FITNESS"),ne.qZA(),ne.TgZ(4,"button",3),ne._UZ(5,"span",4),ne.qZA(),ne.TgZ(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),ne._uU(10,"SCHEDULE"),ne.qZA()(),ne.TgZ(11,"li",7)(12,"a",9),ne._uU(13,"MEALS"),ne.qZA()(),ne.TgZ(14,"li",7)(15,"a",10),ne._uU(16,"WORKOUTS"),ne.qZA()()(),ne.YNc(17,Wr,3,0,"div",11),ne.qZA()()()),2&le&&(ne.xp6(17),ne.Q6J("ngIf",null==ze.user?null:ze.user.authenticated))},directives:[yn.yS,yn.Od,_.O5],styles:[""],changeDetection:0}),Ee})();function wr(Ee,pe){if(1&Ee){const le=ne.EpF();ne.TgZ(0,"app-nav",2),ne.NdJ("logout",function(){return ne.CHM(le),ne.oxw().onLogout()}),ne.ALo(1,"async"),ne.qZA()}if(2&Ee){const le=ne.oxw();ne.Q6J("user",ne.lcZ(1,1,le.user$))}}let Ui=(()=>{class Ee{constructor(le,ze,gt){this.store=le,this.authService=ze,this.router=gt}ngOnInit(){this.subscription=this.authService.auth$.subscribe(),this.user$=this.store.select("user")}ngOnDestroy(){this.subscription.unsubscribe()}onLogout(){var le=this;return(0,ys.Z)(function*(){yield le.authService.logout(),le.router.navigate(["/auth/login"])})()}}return Ee.\u0275fac=function(le){return new(le||Ee)(ne.Y36(Zr.y),ne.Y36(Vi.e),ne.Y36(yn.F0))},Ee.\u0275cmp=ne.Xpm({type:Ee,selectors:[["app-root"]],decls:4,vars:3,consts:[[3,"user","logout",4,"ngIf"],[1,"container"],[3,"user","logout"]],template:function(le,ze){if(1&le&&(ne.YNc(0,wr,2,3,"app-nav",0),ne.ALo(1,"async"),ne.TgZ(2,"div",1),ne._UZ(3,"router-outlet"),ne.qZA()),2&le){let gt;ne.Q6J("ngIf",null==(gt=ne.lcZ(1,1,ze.user$))?null:gt.authenticated)}},directives:[_.O5,Er,yn.lC],pipes:[_.Ov],styles:[""]}),Ee})();var ar=$(2011),Tt=$(1205),Ht=$(2084),Hn=$(7407),zr=$(7471);const bi=[{path:"auth",children:[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadChildren:()=>Promise.all([$.e(592),$.e(31)]).then($.bind($,9031)).then(Ee=>Ee.LoginModule)},{path:"register",loadChildren:()=>Promise.all([$.e(592),$.e(128)]).then($.bind($,7128)).then(Ee=>Ee.RegisterModule)}]}],Rr={apiKey:"AIzaSyAg8NwlLXjVcTMW0QqEeYODtdoSckv2bYQ",authDomain:"fitnessapp-a65a1.firebaseapp.com",databaseURL:"https://fitnessapp-a65a1-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"fitnessapp-a65a1",storageBucket:"fitnessapp-a65a1.appspot.com",messagingSenderId:"441862111873",appId:"1:441862111873:web:70acd7dd3732c3b4ce0380",measurementId:"G-1FSQ30KPB9"};let Ki=(()=>{class Ee{}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275mod=ne.oAB({type:Ee}),Ee.\u0275inj=ne.cJS({imports:[[_.ez,yn.Bz.forChild(bi),ar.hO.initializeApp(Rr),Tt.ww,Hn.yb,Ht.TE,zr.JS,Gr.m.forRoot()]]}),Ee})(),pr=(()=>{class Ee{}return Ee.\u0275fac=function(le){return new(le||Ee)},Ee.\u0275mod=ne.oAB({type:Ee,bootstrap:[Ui]}),Ee.\u0275inj=ne.cJS({providers:[Zr.y],imports:[[Ar,si,Ki,ii]]}),Ee})();(0,ne.G48)(),Hr().bootstrapModule(pr).catch(Ee=>console.error(Ee))},7078:(Ft,We,$)=>{$.d(We,{y:()=>Se});var _=$(1135),ne=$(1884),ie=$(4004);const Ce={user:void 0,meals:void 0};class Se{constructor(){this.subject=new _.X(Ce),this.store=this.subject.asObservable().pipe((0,ne.x)())}get value(){return this.subject.value}select(Me){return this.store.pipe(function be(...Ve){const Me=Ve.length;if(0===Me)throw new Error("list of properties cannot be empty.");return(0,ie.U)(Be=>{let ce=Be;for(let ae=0;ae<Me;ae++){const Re=null==ce?void 0:ce[Ve[ae]];if(void 0===Re)return;ce=Re}return ce})}(Me))}set(Me,Be){this.subject.next(Object.assign(Object.assign({},this.value),{[Me]:Be}))}}},5867:(Ft,We,$)=>{$.d(We,{Mq:()=>_.getApp,C6:()=>_.getApps});var _=$(9681);(0,_.registerVersion)("firebase","9.8.4","app")},127:(Ft,We,$)=>{$.d(We,{Z:()=>_.Z});var _=$(3942);_.Z.registerVersion("firebase","9.8.4","app-compat")},3677:(Ft,We,$)=>{$.r(We);var _=$(5861),ne=$(3942),ie=$(2090),be=$(9681),Ce=$(655),Se=$(1877),Ve=$(4859);const at=function Rt(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Dt=function ot(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},nt=new ie.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),De=new Se.Yd("@firebase/auth");function kt(w,...f){De.logLevel<=Se.in.ERROR&&De.error(`Auth (${be.SDK_VERSION}): ${w}`,...f)}function ht(w,...f){throw It(w,...f)}function xe(w,...f){return It(w,...f)}function Ge(w,f,m){const T=Object.assign(Object.assign({},Dt()),{[f]:m});return new ie.LL("auth","Firebase",T).create(f,{appName:w.name})}function wt(w,f,m){if(!(f instanceof m))throw m.name!==f.constructor.name&&ht(w,"argument-error"),Ge(w,"argument-error",`Type of ${f.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function It(w,...f){if("string"!=typeof w){const m=f[0],T=[...f.slice(1)];return T[0]&&(T[0].appName=w.name),w._errorFactory.create(m,...T)}return nt.create(w,...f)}function V(w,f,...m){if(!w)throw It(f,...m)}function ut(w){const f="INTERNAL ASSERTION FAILED: "+w;throw kt(f),new Error(f)}function ge(w,f){w||ut(f)}const Oe=new Map;function Ue(w){ge(w instanceof Function,"Expected a class definition");let f=Oe.get(w);return f?(ge(f instanceof w,"Instance stored in cache mismatched with class"),f):(f=new w,Oe.set(w,f),f)}function St(){var w;return"undefined"!=typeof self&&(null===(w=self.location)||void 0===w?void 0:w.href)||""}function Pt(){return"http:"===Wt()||"https:"===Wt()}function Wt(){var w;return"undefined"!=typeof self&&(null===(w=self.location)||void 0===w?void 0:w.protocol)||null}class en{constructor(f,m){this.shortDelay=f,this.longDelay=m,ge(m>f,"Short delay should be less than long delay!"),this.isMobile=(0,ie.uI)()||(0,ie.b$)()}get(){return function qt(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Pt()||(0,ie.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function on(w,f){ge(w.emulator,"Emulator should always be set here");const{url:m}=w.emulator;return f?`${m}${f.startsWith("/")?f.slice(1):f}`:m}class tn{static initialize(f,m,T){this.fetchImpl=f,m&&(this.headersImpl=m),T&&(this.responseImpl=T)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ut("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ut("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ut("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Kt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Tn=new en(3e4,6e4);function zt(w,f){return w.tenantId&&!f.tenantId?Object.assign(Object.assign({},f),{tenantId:w.tenantId}):f}function Yt(w,f,m,T){return hr.apply(this,arguments)}function hr(){return(hr=(0,_.Z)(function*(w,f,m,T,z={}){return fr(w,z,(0,_.Z)(function*(){let re={},Le={};T&&("GET"===f?Le=T:re={body:JSON.stringify(T)});const ct=(0,ie.xO)(Object.assign({key:w.config.apiKey},Le)).slice(1),Lt=yield w._getAdditionalHeaders();return Lt["Content-Type"]="application/json",w.languageCode&&(Lt["X-Firebase-Locale"]=w.languageCode),tn.fetch()(Gn(w,w.config.apiHost,m,ct),Object.assign({method:f,headers:Lt,referrerPolicy:"no-referrer"},re))}))})).apply(this,arguments)}function fr(w,f,m){return sr.apply(this,arguments)}function sr(){return(sr=(0,_.Z)(function*(w,f,m){w._canInitEmulator=!1;const T=Object.assign(Object.assign({},Kt),f);try{const z=new Ar(w),re=yield Promise.race([m(),z.promise]);z.clearNetworkTimeout();const Le=yield re.json();if("needConfirmation"in Le)throw Vn(w,"account-exists-with-different-credential",Le);if(re.ok&&!("errorMessage"in Le))return Le;{const ct=re.ok?Le.errorMessage:Le.error.message,[Lt,rn]=ct.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Lt)throw Vn(w,"credential-already-in-use",Le);if("EMAIL_EXISTS"===Lt)throw Vn(w,"email-already-in-use",Le);if("USER_DISABLED"===Lt)throw Vn(w,"user-disabled",Le);const $n=T[Lt]||Lt.toLowerCase().replace(/[_\s]+/g,"-");if(rn)throw Ge(w,$n,rn);ht(w,$n)}}catch(z){if(z instanceof ie.ZR)throw z;ht(w,"network-request-failed")}})).apply(this,arguments)}function Pn(w,f,m,T){return Hr.apply(this,arguments)}function Hr(){return(Hr=(0,_.Z)(function*(w,f,m,T,z={}){const re=yield Yt(w,f,m,T,z);return"mfaPendingCredential"in re&&ht(w,"multi-factor-auth-required",{_serverResponse:re}),re})).apply(this,arguments)}function Gn(w,f,m,T){const z=`${f}${m}?${T}`;return w.config.emulator?on(w.config,z):`${w.config.apiScheme}://${z}`}class Ar{constructor(f){this.auth=f,this.timer=null,this.promise=new Promise((m,T)=>{this.timer=setTimeout(()=>T(xe(this.auth,"network-request-failed")),Tn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Vn(w,f,m){const T={appName:w.name};m.email&&(T.email=m.email),m.phoneNumber&&(T.phoneNumber=m.phoneNumber);const z=xe(w,f,T);return z.customData._tokenResponse=m,z}function En(){return(En=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:delete",f)})).apply(this,arguments)}function Sn(w,f){return ln.apply(this,arguments)}function ln(){return(ln=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function Ci(w,f){return ei.apply(this,arguments)}function ei(){return(ei=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:lookup",f)})).apply(this,arguments)}function Zn(w){if(w)try{const f=new Date(Number(w));if(!isNaN(f.getTime()))return f.toUTCString()}catch(f){}}function xr(){return(xr=(0,_.Z)(function*(w,f=!1){const m=(0,ie.m9)(w),T=yield m.getIdToken(f),z=Xt(T);V(z&&z.exp&&z.auth_time&&z.iat,m.auth,"internal-error");const re="object"==typeof z.firebase?z.firebase:void 0,Le=null==re?void 0:re.sign_in_provider;return{claims:z,token:T,authTime:Zn(Vt(z.auth_time)),issuedAtTime:Zn(Vt(z.iat)),expirationTime:Zn(Vt(z.exp)),signInProvider:Le||null,signInSecondFactor:(null==re?void 0:re.sign_in_second_factor)||null}})).apply(this,arguments)}function Vt(w){return 1e3*Number(w)}function Xt(w){var f;const[m,T,z]=w.split(".");if(void 0===m||void 0===T||void 0===z)return kt("JWT malformed, contained fewer than 3 sections"),null;try{const re=(0,ie.tV)(T);return re?JSON.parse(re):(kt("Failed to decode base64 JWT payload"),null)}catch(re){return kt("Caught error parsing JWT payload as JSON",null===(f=re)||void 0===f?void 0:f.toString()),null}}function Pr(w,f){return ri.apply(this,arguments)}function ri(){return(ri=(0,_.Z)(function*(w,f,m=!1){if(m)return f;try{return yield f}catch(T){throw T instanceof ie.ZR&&cn(T)&&w.auth.currentUser===w&&(yield w.auth.signOut()),T}})).apply(this,arguments)}function cn({code:w}){return"auth/user-disabled"===w||"auth/user-token-expired"===w}class Li{constructor(f){this.user=f,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(f){var m;if(f){const T=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),T}{this.errorBackoff=3e4;const z=(null!==(m=this.user.stsTokenManager.expirationTime)&&void 0!==m?m:0)-Date.now()-3e5;return Math.max(0,z)}}schedule(f=!1){var m=this;if(!this.isRunning)return;const T=this.getInterval(f);this.timerId=setTimeout((0,_.Z)(function*(){yield m.iteration()}),T)}iteration(){var f=this;return(0,_.Z)(function*(){var m;try{yield f.user.getIdToken(!0)}catch(T){return void("auth/network-request-failed"===(null===(m=T)||void 0===m?void 0:m.code)&&f.schedule(!0))}f.schedule()})()}}class Lr{constructor(f,m){this.createdAt=f,this.lastLoginAt=m,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zn(this.lastLoginAt),this.creationTime=Zn(this.createdAt)}_copy(f){this.createdAt=f.createdAt,this.lastLoginAt=f.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function vr(w){return dn.apply(this,arguments)}function dn(){return(dn=(0,_.Z)(function*(w){var f;const m=w.auth,T=yield w.getIdToken(),z=yield Pr(w,Ci(m,{idToken:T}));V(null==z?void 0:z.users.length,m,"internal-error");const re=z.users[0];w._notifyReloadListener(re);const Le=(null===(f=re.providerUserInfo)||void 0===f?void 0:f.length)?ke(re.providerUserInfo):[],ct=je(w.providerData,Le),$n=!!w.isAnonymous&&!(w.email&&re.passwordHash||(null==ct?void 0:ct.length)),xn={uid:re.localId,displayName:re.displayName||null,photoURL:re.photoUrl||null,email:re.email||null,emailVerified:re.emailVerified||!1,phoneNumber:re.phoneNumber||null,tenantId:re.tenantId||null,providerData:ct,metadata:new Lr(re.createdAt,re.lastLoginAt),isAnonymous:$n};Object.assign(w,xn)})).apply(this,arguments)}function ye(){return(ye=(0,_.Z)(function*(w){const f=(0,ie.m9)(w);yield vr(f),yield f.auth._persistUserIfCurrent(f),f.auth._notifyListenersIfCurrent(f)})).apply(this,arguments)}function je(w,f){return[...w.filter(T=>!f.some(z=>z.providerId===T.providerId)),...f]}function ke(w){return w.map(f=>{var{providerId:m}=f,T=(0,Ce._T)(f,["providerId"]);return{providerId:m,uid:T.rawId||"",displayName:T.displayName||null,email:T.email||null,phoneNumber:T.phoneNumber||null,photoURL:T.photoUrl||null}})}function qe(){return(qe=(0,_.Z)(function*(w,f){const m=yield fr(w,{},(0,_.Z)(function*(){const T=(0,ie.xO)({grant_type:"refresh_token",refresh_token:f}).slice(1),{tokenApiHost:z,apiKey:re}=w.config,Le=Gn(w,z,"/v1/token",`key=${re}`),ct=yield w._getAdditionalHeaders();return ct["Content-Type"]="application/x-www-form-urlencoded",tn.fetch()(Le,{method:"POST",headers:ct,body:T})}));return{accessToken:m.access_token,expiresIn:m.expires_in,refreshToken:m.refresh_token}})).apply(this,arguments)}class At{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(f){V(f.idToken,"internal-error"),V(void 0!==f.idToken,"internal-error"),V(void 0!==f.refreshToken,"internal-error");const m="expiresIn"in f&&void 0!==f.expiresIn?Number(f.expiresIn):function nn(w){const f=Xt(w);return V(f,"internal-error"),V(void 0!==f.exp,"internal-error"),V(void 0!==f.iat,"internal-error"),Number(f.exp)-Number(f.iat)}(f.idToken);this.updateTokensAndExpiration(f.idToken,f.refreshToken,m)}getToken(f,m=!1){var T=this;return(0,_.Z)(function*(){return V(!T.accessToken||T.refreshToken,f,"user-token-expired"),m||!T.accessToken||T.isExpired?T.refreshToken?(yield T.refresh(f,T.refreshToken),T.accessToken):null:T.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(f,m){var T=this;return(0,_.Z)(function*(){const{accessToken:z,refreshToken:re,expiresIn:Le}=yield function fe(w,f){return qe.apply(this,arguments)}(f,m);T.updateTokensAndExpiration(z,re,Number(Le))})()}updateTokensAndExpiration(f,m,T){this.refreshToken=m||null,this.accessToken=f||null,this.expirationTime=Date.now()+1e3*T}static fromJSON(f,m){const{refreshToken:T,accessToken:z,expirationTime:re}=m,Le=new At;return T&&(V("string"==typeof T,"internal-error",{appName:f}),Le.refreshToken=T),z&&(V("string"==typeof z,"internal-error",{appName:f}),Le.accessToken=z),re&&(V("number"==typeof re,"internal-error",{appName:f}),Le.expirationTime=re),Le}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(f){this.accessToken=f.accessToken,this.refreshToken=f.refreshToken,this.expirationTime=f.expirationTime}_clone(){return Object.assign(new At,this.toJSON())}_performRefresh(){return ut("not implemented")}}function $t(w,f){V("string"==typeof w||void 0===w,"internal-error",{appName:f})}class hn{constructor(f){var{uid:m,auth:T,stsTokenManager:z}=f,re=(0,Ce._T)(f,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Li(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=m,this.auth=T,this.stsTokenManager=z,this.accessToken=z.accessToken,this.displayName=re.displayName||null,this.email=re.email||null,this.emailVerified=re.emailVerified||!1,this.phoneNumber=re.phoneNumber||null,this.photoURL=re.photoURL||null,this.isAnonymous=re.isAnonymous||!1,this.tenantId=re.tenantId||null,this.providerData=re.providerData?[...re.providerData]:[],this.metadata=new Lr(re.createdAt||void 0,re.lastLoginAt||void 0)}getIdToken(f){var m=this;return(0,_.Z)(function*(){const T=yield Pr(m,m.stsTokenManager.getToken(m.auth,f));return V(T,m.auth,"internal-error"),m.accessToken!==T&&(m.accessToken=T,yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)),T})()}getIdTokenResult(f){return function ci(w){return xr.apply(this,arguments)}(this,f)}reload(){return function Ne(w){return ye.apply(this,arguments)}(this)}_assign(f){this!==f&&(V(this.uid===f.uid,this.auth,"internal-error"),this.displayName=f.displayName,this.photoURL=f.photoURL,this.email=f.email,this.emailVerified=f.emailVerified,this.phoneNumber=f.phoneNumber,this.isAnonymous=f.isAnonymous,this.tenantId=f.tenantId,this.providerData=f.providerData.map(m=>Object.assign({},m)),this.metadata._copy(f.metadata),this.stsTokenManager._assign(f.stsTokenManager))}_clone(f){return new hn(Object.assign(Object.assign({},this),{auth:f,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(f){V(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=f,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(f){this.reloadListener?this.reloadListener(f):this.reloadUserInfo=f}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(f,m=!1){var T=this;return(0,_.Z)(function*(){let z=!1;f.idToken&&f.idToken!==T.stsTokenManager.accessToken&&(T.stsTokenManager.updateFromServerResponse(f),z=!0),m&&(yield vr(T)),yield T.auth._persistUserIfCurrent(T),z&&T.auth._notifyListenersIfCurrent(T)})()}delete(){var f=this;return(0,_.Z)(function*(){const m=yield f.getIdToken();return yield Pr(f,function Bt(w,f){return En.apply(this,arguments)}(f.auth,{idToken:m})),f.stsTokenManager.clearRefreshToken(),f.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(f=>Object.assign({},f)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(f,m){var T,z,re,Le,ct,Lt,rn,$n;const xn=null!==(T=m.displayName)&&void 0!==T?T:void 0,fs=null!==(z=m.email)&&void 0!==z?z:void 0,sa=null!==(re=m.phoneNumber)&&void 0!==re?re:void 0,jl=null!==(Le=m.photoURL)&&void 0!==Le?Le:void 0,Nd=null!==(ct=m.tenantId)&&void 0!==ct?ct:void 0,Nu=null!==(Lt=m._redirectEventId)&&void 0!==Lt?Lt:void 0,Ic=null!==(rn=m.createdAt)&&void 0!==rn?rn:void 0,Pu=null!==($n=m.lastLoginAt)&&void 0!==$n?$n:void 0,{uid:Ou,emailVerified:Cc,isAnonymous:Aa,providerData:Xc,stsTokenManager:$l}=m;V(Ou&&$l,f,"internal-error");const To=At.fromJSON(this.name,$l);V("string"==typeof Ou,f,"internal-error"),$t(xn,f.name),$t(fs,f.name),V("boolean"==typeof Cc,f,"internal-error"),V("boolean"==typeof Aa,f,"internal-error"),$t(sa,f.name),$t(jl,f.name),$t(Nd,f.name),$t(Nu,f.name),$t(Ic,f.name),$t(Pu,f.name);const ed=new hn({uid:Ou,auth:f,email:fs,emailVerified:Cc,displayName:xn,isAnonymous:Aa,photoURL:jl,phoneNumber:sa,tenantId:Nd,stsTokenManager:To,createdAt:Ic,lastLoginAt:Pu});return Xc&&Array.isArray(Xc)&&(ed.providerData=Xc.map(td=>Object.assign({},td))),Nu&&(ed._redirectEventId=Nu),ed}static _fromIdTokenResponse(f,m,T=!1){return(0,_.Z)(function*(){const z=new At;z.updateFromServerResponse(m);const re=new hn({uid:m.localId,auth:f,stsTokenManager:z,isAnonymous:T});return yield vr(re),re})()}}const lr=(()=>{class w{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,_.Z)(function*(){return!0})()}_set(m,T){var z=this;return(0,_.Z)(function*(){z.storage[m]=T})()}_get(m){var T=this;return(0,_.Z)(function*(){const z=T.storage[m];return void 0===z?null:z})()}_remove(m){var T=this;return(0,_.Z)(function*(){delete T.storage[m]})()}_addListener(m,T){}_removeListener(m,T){}}return w.type="NONE",w})();function an(w,f,m){return`firebase:${w}:${f}:${m}`}class ur{constructor(f,m,T){this.persistence=f,this.auth=m,this.userKey=T;const{config:z,name:re}=this.auth;this.fullUserKey=an(this.userKey,z.apiKey,re),this.fullPersistenceKey=an("persistence",z.apiKey,re),this.boundEventHandler=m._onStorageEvent.bind(m),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(f){return this.persistence._set(this.fullUserKey,f.toJSON())}getCurrentUser(){var f=this;return(0,_.Z)(function*(){const m=yield f.persistence._get(f.fullUserKey);return m?hn._fromJSON(f.auth,m):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(f){var m=this;return(0,_.Z)(function*(){if(m.persistence===f)return;const T=yield m.getCurrentUser();return yield m.removeCurrentUser(),m.persistence=f,T?m.setCurrentUser(T):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(f,m,T="authUser"){return(0,_.Z)(function*(){if(!m.length)return new ur(Ue(lr),f,T);const z=(yield Promise.all(m.map(function(){var rn=(0,_.Z)(function*($n){if(yield $n._isAvailable())return $n});return function($n){return rn.apply(this,arguments)}}()))).filter(rn=>rn);let re=z[0]||Ue(lr);const Le=an(T,f.config.apiKey,f.name);let ct=null;for(const rn of m)try{const $n=yield rn._get(Le);if($n){const xn=hn._fromJSON(f,$n);rn!==re&&(ct=xn),re=rn;break}}catch($n){}const Lt=z.filter(rn=>rn._shouldAllowMigration);return re._shouldAllowMigration&&Lt.length?(re=Lt[0],ct&&(yield re._set(Le,ct.toJSON())),yield Promise.all(m.map(function(){var rn=(0,_.Z)(function*($n){if($n!==re)try{yield $n._remove(Le)}catch(xn){}});return function($n){return rn.apply(this,arguments)}}())),new ur(re,f,T)):new ur(re,f,T)})()}}function ts(w){const f=w.toLowerCase();if(f.includes("opera/")||f.includes("opr/")||f.includes("opios/"))return"Opera";if(br(f))return"IEMobile";if(f.includes("msie")||f.includes("trident/"))return"IE";if(f.includes("edge/"))return"Edge";if(Gr(f))return"Firefox";if(f.includes("silk/"))return"Silk";if(Zr(f))return"Blackberry";if(Vr(f))return"Webos";if(_i(f))return"Safari";if((f.includes("chrome/")||yn(f))&&!f.includes("edge/"))return"Chrome";if(ii(f))return"Android";{const T=w.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==T?void 0:T.length))return T[1]}return"Other"}function Gr(w=(0,ie.z$)()){return/firefox\//i.test(w)}function _i(w=(0,ie.z$)()){const f=w.toLowerCase();return f.includes("safari/")&&!f.includes("chrome/")&&!f.includes("crios/")&&!f.includes("android")}function yn(w=(0,ie.z$)()){return/crios\//i.test(w)}function br(w=(0,ie.z$)()){return/iemobile/i.test(w)}function ii(w=(0,ie.z$)()){return/android/i.test(w)}function Zr(w=(0,ie.z$)()){return/blackberry/i.test(w)}function Vr(w=(0,ie.z$)()){return/webos/i.test(w)}function si(w=(0,ie.z$)()){return/iphone|ipad|ipod/i.test(w)}function Er(w=(0,ie.z$)()){return si(w)||ii(w)||Vr(w)||Zr(w)||/windows phone/i.test(w)||br(w)}function Ui(w,f=[]){let m;switch(w){case"Browser":m=ts((0,ie.z$)());break;case"Worker":m=`${ts((0,ie.z$)())}-${w}`;break;default:m=w}const T=f.length?f.join(","):"FirebaseCore-web";return`${m}/JsCore/${be.SDK_VERSION}/${T}`}class ar{constructor(f){this.auth=f,this.queue=[]}pushCallback(f,m){const T=re=>new Promise((Le,ct)=>{try{Le(f(re))}catch(Lt){ct(Lt)}});T.onAbort=m,this.queue.push(T);const z=this.queue.length-1;return()=>{this.queue[z]=()=>Promise.resolve()}}runMiddleware(f){var m=this;return(0,_.Z)(function*(){var T;if(m.auth.currentUser===f)return;const z=[];try{for(const re of m.queue)yield re(f),re.onAbort&&z.push(re.onAbort)}catch(re){z.reverse();for(const Le of z)try{Le()}catch(ct){}throw m.auth._errorFactory.create("login-blocked",{originalMessage:null===(T=re)||void 0===T?void 0:T.message})}})()}}class Tt{constructor(f,m,T){this.app=f,this.heartbeatServiceProvider=m,this.config=T,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Hn(this),this.idTokenSubscription=new Hn(this),this.beforeStateQueue=new ar(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nt,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=f.name,this.clientVersion=T.sdkClientVersion}_initializeWithPersistence(f,m){var T=this;return m&&(this._popupRedirectResolver=Ue(m)),this._initializationPromise=this.queue((0,_.Z)(function*(){var z,re;if(!T._deleted&&(T.persistenceManager=yield ur.create(T,f),!T._deleted)){if(null===(z=T._popupRedirectResolver)||void 0===z?void 0:z._shouldInitProactively)try{yield T._popupRedirectResolver._initialize(T)}catch(Le){}yield T.initializeCurrentUser(m),T.lastNotifiedUid=(null===(re=T.currentUser)||void 0===re?void 0:re.uid)||null,!T._deleted&&(T._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var f=this;return(0,_.Z)(function*(){if(f._deleted)return;const m=yield f.assertedPersistence.getCurrentUser();if(f.currentUser||m){if(f.currentUser&&m&&f.currentUser.uid===m.uid)return f._currentUser._assign(m),void(yield f.currentUser.getIdToken());yield f._updateCurrentUser(m,!0)}})()}initializeCurrentUser(f){var m=this;return(0,_.Z)(function*(){var T;const z=yield m.assertedPersistence.getCurrentUser();let re=z,Le=!1;if(f&&m.config.authDomain){yield m.getOrInitRedirectPersistenceManager();const ct=null===(T=m.redirectUser)||void 0===T?void 0:T._redirectEventId,Lt=null==re?void 0:re._redirectEventId,rn=yield m.tryRedirectSignIn(f);(!ct||ct===Lt)&&(null==rn?void 0:rn.user)&&(re=rn.user,Le=!0)}if(!re)return m.directlySetCurrentUser(null);if(!re._redirectEventId){if(Le)try{yield m.beforeStateQueue.runMiddleware(re)}catch(ct){re=z,m._popupRedirectResolver._overrideRedirectResult(m,()=>Promise.reject(ct))}return re?m.reloadAndSetCurrentUserOrClear(re):m.directlySetCurrentUser(null)}return V(m._popupRedirectResolver,m,"argument-error"),yield m.getOrInitRedirectPersistenceManager(),m.redirectUser&&m.redirectUser._redirectEventId===re._redirectEventId?m.directlySetCurrentUser(re):m.reloadAndSetCurrentUserOrClear(re)})()}tryRedirectSignIn(f){var m=this;return(0,_.Z)(function*(){let T=null;try{T=yield m._popupRedirectResolver._completeRedirectFn(m,f,!0)}catch(z){yield m._setRedirectUser(null)}return T})()}reloadAndSetCurrentUserOrClear(f){var m=this;return(0,_.Z)(function*(){var T;try{yield vr(f)}catch(z){if("auth/network-request-failed"!==(null===(T=z)||void 0===T?void 0:T.code))return m.directlySetCurrentUser(null)}return m.directlySetCurrentUser(f)})()}useDeviceLanguage(){this.languageCode=function it(){if("undefined"==typeof navigator)return null;const w=navigator;return w.languages&&w.languages[0]||w.language||null}()}_delete(){var f=this;return(0,_.Z)(function*(){f._deleted=!0})()}updateCurrentUser(f){var m=this;return(0,_.Z)(function*(){const T=f?(0,ie.m9)(f):null;return T&&V(T.auth.config.apiKey===m.config.apiKey,m,"invalid-user-token"),m._updateCurrentUser(T&&T._clone(m))})()}_updateCurrentUser(f,m=!1){var T=this;return(0,_.Z)(function*(){if(!T._deleted)return f&&V(T.tenantId===f.tenantId,T,"tenant-id-mismatch"),m||(yield T.beforeStateQueue.runMiddleware(f)),T.queue((0,_.Z)(function*(){yield T.directlySetCurrentUser(f),T.notifyAuthListeners()}))})()}signOut(){var f=this;return(0,_.Z)(function*(){return yield f.beforeStateQueue.runMiddleware(null),(f.redirectPersistenceManager||f._popupRedirectResolver)&&(yield f._setRedirectUser(null)),f._updateCurrentUser(null,!0)})()}setPersistence(f){var m=this;return this.queue((0,_.Z)(function*(){yield m.assertedPersistence.setPersistence(Ue(f))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(f){this._errorFactory=new ie.LL("auth","Firebase",f())}onAuthStateChanged(f,m,T){return this.registerStateListener(this.authStateSubscription,f,m,T)}beforeAuthStateChanged(f,m){return this.beforeStateQueue.pushCallback(f,m)}onIdTokenChanged(f,m,T){return this.registerStateListener(this.idTokenSubscription,f,m,T)}toJSON(){var f;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(f=this._currentUser)||void 0===f?void 0:f.toJSON()}}_setRedirectUser(f,m){var T=this;return(0,_.Z)(function*(){const z=yield T.getOrInitRedirectPersistenceManager(m);return null===f?z.removeCurrentUser():z.setCurrentUser(f)})()}getOrInitRedirectPersistenceManager(f){var m=this;return(0,_.Z)(function*(){if(!m.redirectPersistenceManager){const T=f&&Ue(f)||m._popupRedirectResolver;V(T,m,"argument-error"),m.redirectPersistenceManager=yield ur.create(m,[Ue(T._redirectPersistence)],"redirectUser"),m.redirectUser=yield m.redirectPersistenceManager.getCurrentUser()}return m.redirectPersistenceManager})()}_redirectUserForId(f){var m=this;return(0,_.Z)(function*(){var T,z;return m._isInitialized&&(yield m.queue((0,_.Z)(function*(){}))),(null===(T=m._currentUser)||void 0===T?void 0:T._redirectEventId)===f?m._currentUser:(null===(z=m.redirectUser)||void 0===z?void 0:z._redirectEventId)===f?m.redirectUser:null})()}_persistUserIfCurrent(f){var m=this;return(0,_.Z)(function*(){if(f===m.currentUser)return m.queue((0,_.Z)(function*(){return m.directlySetCurrentUser(f)}))})()}_notifyListenersIfCurrent(f){f===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var f,m;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const T=null!==(m=null===(f=this.currentUser)||void 0===f?void 0:f.uid)&&void 0!==m?m:null;this.lastNotifiedUid!==T&&(this.lastNotifiedUid=T,this.authStateSubscription.next(this.currentUser))}registerStateListener(f,m,T,z){if(this._deleted)return()=>{};const re="function"==typeof m?m:m.next.bind(m),Le=this._isInitialized?Promise.resolve():this._initializationPromise;return V(Le,this,"internal-error"),Le.then(()=>re(this.currentUser)),"function"==typeof m?f.addObserver(m,T,z):f.addObserver(m)}directlySetCurrentUser(f){var m=this;return(0,_.Z)(function*(){m.currentUser&&m.currentUser!==f&&(m._currentUser._stopProactiveRefresh(),f&&m.isProactiveRefreshEnabled&&f._startProactiveRefresh()),m.currentUser=f,f?yield m.assertedPersistence.setCurrentUser(f):yield m.assertedPersistence.removeCurrentUser()})()}queue(f){return this.operations=this.operations.then(f,f),this.operations}get assertedPersistence(){return V(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(f){!f||this.frameworks.includes(f)||(this.frameworks.push(f),this.frameworks.sort(),this.clientVersion=Ui(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var f=this;return(0,_.Z)(function*(){var m;const T={"X-Client-Version":f.clientVersion};f.app.options.appId&&(T["X-Firebase-gmpid"]=f.app.options.appId);const z=yield null===(m=f.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getHeartbeatsHeader();return z&&(T["X-Firebase-Client"]=z),T})()}}function Ht(w){return(0,ie.m9)(w)}class Hn{constructor(f){this.auth=f,this.observer=null,this.addObserver=(0,ie.ne)(m=>this.observer=m)}get next(){return V(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function bi(w){const f=w.indexOf(":");return f<0?"":w.substr(0,f+1)}function Ki(w){if(!w)return null;const f=Number(w);return isNaN(f)?null:f}class Mi{constructor(f,m){this.providerId=f,this.signInMethod=m}toJSON(){return ut("not implemented")}_getIdTokenResponse(f){return ut("not implemented")}_linkToIdToken(f,m){return ut("not implemented")}_getReauthenticationResolver(f){return ut("not implemented")}}function Ee(w,f){return pe.apply(this,arguments)}function pe(){return(pe=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:resetPassword",zt(w,f))})).apply(this,arguments)}function le(w,f){return ze.apply(this,arguments)}function ze(){return(ze=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function gt(w,f){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:update",zt(w,f))})).apply(this,arguments)}function er(){return(er=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithPassword",zt(w,f))})).apply(this,arguments)}function gr(w,f){return Yn.apply(this,arguments)}function Yn(){return(Yn=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:sendOobCode",zt(w,f))})).apply(this,arguments)}function Qn(w,f){return Ys.apply(this,arguments)}function Ys(){return(Ys=(0,_.Z)(function*(w,f){return gr(w,f)})).apply(this,arguments)}function Kr(w,f){return di.apply(this,arguments)}function di(){return(di=(0,_.Z)(function*(w,f){return gr(w,f)})).apply(this,arguments)}function Di(w,f){return Qs.apply(this,arguments)}function Qs(){return(Qs=(0,_.Z)(function*(w,f){return gr(w,f)})).apply(this,arguments)}function qi(w,f){return vi.apply(this,arguments)}function vi(){return(vi=(0,_.Z)(function*(w,f){return gr(w,f)})).apply(this,arguments)}function oo(){return(oo=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithEmailLink",zt(w,f))})).apply(this,arguments)}function yo(){return(yo=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithEmailLink",zt(w,f))})).apply(this,arguments)}class Ir extends Mi{constructor(f,m,T,z=null){super("password",T),this._email=f,this._password=m,this._tenantId=z}static _fromEmailAndPassword(f,m){return new Ir(f,m,"password")}static _fromEmailAndCode(f,m,T=null){return new Ir(f,m,"emailLink",T)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f;if((null==m?void 0:m.email)&&(null==m?void 0:m.password)){if("password"===m.signInMethod)return this._fromEmailAndPassword(m.email,m.password);if("emailLink"===m.signInMethod)return this._fromEmailAndCode(m.email,m.password,m.tenantId)}return null}_getIdTokenResponse(f){var m=this;return(0,_.Z)(function*(){switch(m.signInMethod){case"password":return function gn(w,f){return er.apply(this,arguments)}(f,{returnSecureToken:!0,email:m._email,password:m._password});case"emailLink":return function ns(w,f){return oo.apply(this,arguments)}(f,{email:m._email,oobCode:m._password});default:ht(f,"internal-error")}})()}_linkToIdToken(f,m){var T=this;return(0,_.Z)(function*(){switch(T.signInMethod){case"password":return le(f,{idToken:m,returnSecureToken:!0,email:T._email,password:T._password});case"emailLink":return function Ss(w,f){return yo.apply(this,arguments)}(f,{idToken:m,email:T._email,oobCode:T._password});default:ht(f,"internal-error")}})()}_getReauthenticationResolver(f){return this._getIdTokenResponse(f)}}function us(w,f){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithIdp",zt(w,f))})).apply(this,arguments)}class He extends Mi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(f){const m=new He(f.providerId,f.signInMethod);return f.idToken||f.accessToken?(f.idToken&&(m.idToken=f.idToken),f.accessToken&&(m.accessToken=f.accessToken),f.nonce&&!f.pendingToken&&(m.nonce=f.nonce),f.pendingToken&&(m.pendingToken=f.pendingToken)):f.oauthToken&&f.oauthTokenSecret?(m.accessToken=f.oauthToken,m.secret=f.oauthTokenSecret):ht("argument-error"),m}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f,{providerId:T,signInMethod:z}=m,re=(0,Ce._T)(m,["providerId","signInMethod"]);if(!T||!z)return null;const Le=new He(T,z);return Le.idToken=re.idToken||void 0,Le.accessToken=re.accessToken||void 0,Le.secret=re.secret,Le.nonce=re.nonce,Le.pendingToken=re.pendingToken||null,Le}_getIdTokenResponse(f){return us(f,this.buildRequest())}_linkToIdToken(f,m){const T=this.buildRequest();return T.idToken=m,us(f,T)}_getReauthenticationResolver(f){const m=this.buildRequest();return m.autoCreate=!1,us(f,m)}buildRequest(){const f={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)f.pendingToken=this.pendingToken;else{const m={};this.idToken&&(m.id_token=this.idToken),this.accessToken&&(m.access_token=this.accessToken),this.secret&&(m.oauth_token_secret=this.secret),m.providerId=this.providerId,this.nonce&&!this.pendingToken&&(m.nonce=this.nonce),f.postBody=(0,ie.xO)(m)}return f}}function tt(w,f){return pt.apply(this,arguments)}function pt(){return(pt=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:sendVerificationCode",zt(w,f))})).apply(this,arguments)}function Un(){return(Un=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithPhoneNumber",zt(w,f))})).apply(this,arguments)}function tr(){return(tr=(0,_.Z)(function*(w,f){const m=yield Pn(w,"POST","/v1/accounts:signInWithPhoneNumber",zt(w,f));if(m.temporaryProof)throw Vn(w,"account-exists-with-different-credential",m);return m})).apply(this,arguments)}const rs={USER_NOT_FOUND:"user-not-found"};function ao(){return(ao=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithPhoneNumber",zt(w,Object.assign(Object.assign({},f),{operation:"REAUTH"})),rs)})).apply(this,arguments)}class nr extends Mi{constructor(f){super("phone","phone"),this.params=f}static _fromVerification(f,m){return new nr({verificationId:f,verificationCode:m})}static _fromTokenResponse(f,m){return new nr({phoneNumber:f,temporaryProof:m})}_getIdTokenResponse(f){return function _t(w,f){return Un.apply(this,arguments)}(f,this._makeVerificationRequest())}_linkToIdToken(f,m){return function Mn(w,f){return tr.apply(this,arguments)}(f,Object.assign({idToken:m},this._makeVerificationRequest()))}_getReauthenticationResolver(f){return function Bi(w,f){return ao.apply(this,arguments)}(f,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:f,phoneNumber:m,verificationId:T,verificationCode:z}=this.params;return f&&m?{temporaryProof:f,phoneNumber:m}:{sessionInfo:T,code:z}}toJSON(){const f={providerId:this.providerId};return this.params.phoneNumber&&(f.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(f.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(f.verificationCode=this.params.verificationCode),this.params.verificationId&&(f.verificationId=this.params.verificationId),f}static fromJSON(f){"string"==typeof f&&(f=JSON.parse(f));const{verificationId:m,verificationCode:T,phoneNumber:z,temporaryProof:re}=f;return T||m||z||re?new nr({verificationId:m,verificationCode:T,phoneNumber:z,temporaryProof:re}):null}}class _s{constructor(f){var m,T,z,re,Le,ct;const Lt=(0,ie.zd)((0,ie.pd)(f)),rn=null!==(m=Lt.apiKey)&&void 0!==m?m:null,$n=null!==(T=Lt.oobCode)&&void 0!==T?T:null,xn=function vn(w){switch(w){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(z=Lt.mode)&&void 0!==z?z:null);V(rn&&$n&&xn,"argument-error"),this.apiKey=rn,this.operation=xn,this.code=$n,this.continueUrl=null!==(re=Lt.continueUrl)&&void 0!==re?re:null,this.languageCode=null!==(Le=Lt.languageCode)&&void 0!==Le?Le:null,this.tenantId=null!==(ct=Lt.tenantId)&&void 0!==ct?ct:null}static parseLink(f){const m=function Ur(w){const f=(0,ie.zd)((0,ie.pd)(w)).link,m=f?(0,ie.zd)((0,ie.pd)(f)).deep_link_id:null,T=(0,ie.zd)((0,ie.pd)(w)).deep_link_id;return(T?(0,ie.zd)((0,ie.pd)(T)).link:null)||T||m||f||w}(f);try{return new _s(m)}catch(T){return null}}}let ji=(()=>{class w{constructor(){this.providerId=w.PROVIDER_ID}static credential(m,T){return Ir._fromEmailAndPassword(m,T)}static credentialWithLink(m,T){const z=_s.parseLink(T);return V(z,"argument-error"),Ir._fromEmailAndCode(m,z.code,z.tenantId)}}return w.PROVIDER_ID="password",w.EMAIL_PASSWORD_SIGN_IN_METHOD="password",w.EMAIL_LINK_SIGN_IN_METHOD="emailLink",w})();class ti{constructor(f){this.providerId=f,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(f){this.defaultLanguageCode=f}setCustomParameters(f){return this.customParameters=f,this}getCustomParameters(){return this.customParameters}}class is extends ti{constructor(){super(...arguments),this.scopes=[]}addScope(f){return this.scopes.includes(f)||this.scopes.push(f),this}getScopes(){return[...this.scopes]}}class ss extends is{static credentialFromJSON(f){const m="string"==typeof f?JSON.parse(f):f;return V("providerId"in m&&"signInMethod"in m,"argument-error"),He._fromParams(m)}credential(f){return this._credential(Object.assign(Object.assign({},f),{nonce:f.rawNonce}))}_credential(f){return V(f.idToken||f.accessToken,"argument-error"),He._fromParams(Object.assign(Object.assign({},f),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(f){return ss.oauthCredentialFromTaggedObject(f)}static credentialFromError(f){return ss.oauthCredentialFromTaggedObject(f.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{oauthIdToken:m,oauthAccessToken:T,oauthTokenSecret:z,pendingToken:re,nonce:Le,providerId:ct}=f;if(!T&&!z&&!m&&!re||!ct)return null;try{return new ss(ct)._credential({idToken:m,accessToken:T,nonce:Le,pendingToken:re})}catch(Lt){return null}}}let vs=(()=>{class w extends is{constructor(){super("facebook.com")}static credential(m){return He._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.FACEBOOK_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return w.credential(m.oauthAccessToken)}catch(T){return null}}}return w.FACEBOOK_SIGN_IN_METHOD="facebook.com",w.PROVIDER_ID="facebook.com",w})(),ls=(()=>{class w extends is{constructor(){super("google.com"),this.addScope("profile")}static credential(m,T){return He._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GOOGLE_SIGN_IN_METHOD,idToken:m,accessToken:T})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:T,oauthAccessToken:z}=m;if(!T&&!z)return null;try{return w.credential(T,z)}catch(re){return null}}}return w.GOOGLE_SIGN_IN_METHOD="google.com",w.PROVIDER_ID="google.com",w})(),Es=(()=>{class w extends is{constructor(){super("github.com")}static credential(m){return He._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GITHUB_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return w.credential(m.oauthAccessToken)}catch(T){return null}}}return w.GITHUB_SIGN_IN_METHOD="github.com",w.PROVIDER_ID="github.com",w})();class Ei extends Mi{constructor(f,m){super(f,f),this.pendingToken=m}_getIdTokenResponse(f){return us(f,this.buildRequest())}_linkToIdToken(f,m){const T=this.buildRequest();return T.idToken=m,us(f,T)}_getReauthenticationResolver(f){const m=this.buildRequest();return m.autoCreate=!1,us(f,m)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f,{providerId:T,signInMethod:z,pendingToken:re}=m;return T&&z&&re&&T===z?new Ei(T,re):null}static _create(f,m){return new Ei(f,m)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class wi extends ti{constructor(f){V(f.startsWith("saml."),"argument-error"),super(f)}static credentialFromResult(f){return wi.samlCredentialFromTaggedObject(f)}static credentialFromError(f){return wi.samlCredentialFromTaggedObject(f.customData||{})}static credentialFromJSON(f){const m=Ei.fromJSON(f);return V(m,"argument-error"),m}static samlCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{pendingToken:m,providerId:T}=f;if(!m||!T)return null;try{return Ei._create(T,m)}catch(z){return null}}}let co=(()=>{class w extends is{constructor(){super("twitter.com")}static credential(m,T){return He._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.TWITTER_SIGN_IN_METHOD,oauthToken:m,oauthTokenSecret:T})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthAccessToken:T,oauthTokenSecret:z}=m;if(!T||!z)return null;try{return w.credential(T,z)}catch(re){return null}}}return w.TWITTER_SIGN_IN_METHOD="twitter.com",w.PROVIDER_ID="twitter.com",w})();function oi(w,f){return As.apply(this,arguments)}function As(){return(As=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signUp",zt(w,f))})).apply(this,arguments)}class hi{constructor(f){this.user=f.user,this.providerId=f.providerId,this._tokenResponse=f._tokenResponse,this.operationType=f.operationType}static _fromIdTokenResponse(f,m,T,z=!1){return(0,_.Z)(function*(){const re=yield hn._fromIdTokenResponse(f,T,z),Le=ws(T);return new hi({user:re,providerId:Le,_tokenResponse:T,operationType:m})})()}static _forOperation(f,m,T){return(0,_.Z)(function*(){yield f._updateTokensIfNecessary(T,!0);const z=ws(T);return new hi({user:f,providerId:z,_tokenResponse:T,operationType:m})})()}}function ws(w){return w.providerId?w.providerId:"phoneNumber"in w?"phone":null}function xs(){return(xs=(0,_.Z)(function*(w){var f;const m=Ht(w);if(yield m._initializationPromise,null===(f=m.currentUser)||void 0===f?void 0:f.isAnonymous)return new hi({user:m.currentUser,providerId:null,operationType:"signIn"});const T=yield oi(m,{returnSecureToken:!0}),z=yield hi._fromIdTokenResponse(m,"signIn",T,!0);return yield m._updateCurrentUser(z.user),z})).apply(this,arguments)}class $i extends ie.ZR{constructor(f,m,T,z){var re;super(m.code,m.message),this.operationType=T,this.user=z,Object.setPrototypeOf(this,$i.prototype),this.customData={appName:f.name,tenantId:null!==(re=f.tenantId)&&void 0!==re?re:void 0,_serverResponse:m.customData._serverResponse,operationType:T}}static _fromErrorAndOperation(f,m,T,z){return new $i(f,m,T,z)}}function cs(w,f,m,T){return("reauthenticate"===f?m._getReauthenticationResolver(w):m._getIdTokenResponse(w)).catch(re=>{throw"auth/multi-factor-auth-required"===re.code?$i._fromErrorAndOperation(w,re,f,T):re})}function fi(w){return new Set(w.map(({providerId:f})=>f).filter(f=>!!f))}function On(){return(On=(0,_.Z)(function*(w,f){const m=(0,ie.m9)(w);yield U(!0,m,f);const{providerUserInfo:T}=yield Sn(m.auth,{idToken:yield m.getIdToken(),deleteProvider:[f]}),z=fi(T||[]);return m.providerData=m.providerData.filter(re=>z.has(re.providerId)),z.has("phone")||(m.phoneNumber=null),yield m.auth._persistUserIfCurrent(m),m})).apply(this,arguments)}function B(w,f){return Q.apply(this,arguments)}function Q(){return(Q=(0,_.Z)(function*(w,f,m=!1){const T=yield Pr(w,f._linkToIdToken(w.auth,yield w.getIdToken()),m);return hi._forOperation(w,"link",T)})).apply(this,arguments)}function U(w,f,m){return te.apply(this,arguments)}function te(){return(te=(0,_.Z)(function*(w,f,m){yield vr(f);const z=!1===w?"provider-already-linked":"no-such-provider";V(fi(f.providerData).has(m)===w,f.auth,z)})).apply(this,arguments)}function _e(w,f){return rt.apply(this,arguments)}function rt(){return(rt=(0,_.Z)(function*(w,f,m=!1){var T;const{auth:z}=w,re="reauthenticate";try{const Le=yield Pr(w,cs(z,re,f,w),m);V(Le.idToken,z,"internal-error");const ct=Xt(Le.idToken);V(ct,z,"internal-error");const{sub:Lt}=ct;return V(w.uid===Lt,z,"user-mismatch"),hi._forOperation(w,re,Le)}catch(Le){throw"auth/user-not-found"===(null===(T=Le)||void 0===T?void 0:T.code)&&ht(z,"user-mismatch"),Le}})).apply(this,arguments)}function yt(w,f){return un.apply(this,arguments)}function un(){return(un=(0,_.Z)(function*(w,f,m=!1){const T="signIn",z=yield cs(w,T,f),re=yield hi._fromIdTokenResponse(w,T,z);return m||(yield w._updateCurrentUser(re.user)),re})).apply(this,arguments)}function wn(w,f){return Wn.apply(this,arguments)}function Wn(){return(Wn=(0,_.Z)(function*(w,f){return yt(Ht(w),f)})).apply(this,arguments)}function kn(w,f){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,_.Z)(function*(w,f){const m=(0,ie.m9)(w);return yield U(!1,m,f.providerId),B(m,f)})).apply(this,arguments)}function qr(w,f){return Mr.apply(this,arguments)}function Mr(){return(Mr=(0,_.Z)(function*(w,f){return _e((0,ie.m9)(w),f)})).apply(this,arguments)}function $r(w,f){return zn.apply(this,arguments)}function zn(){return(zn=(0,_.Z)(function*(w,f){return Pn(w,"POST","/v1/accounts:signInWithCustomToken",zt(w,f))})).apply(this,arguments)}function fn(){return(fn=(0,_.Z)(function*(w,f){const m=Ht(w),T=yield $r(m,{token:f,returnSecureToken:!0}),z=yield hi._fromIdTokenResponse(m,"signIn",T);return yield m._updateCurrentUser(z.user),z})).apply(this,arguments)}class Zi{constructor(f,m){this.factorId=f,this.uid=m.mfaEnrollmentId,this.enrollmentTime=new Date(m.enrolledAt).toUTCString(),this.displayName=m.displayName}static _fromServerResponse(f,m){return"phoneInfo"in m?ho._fromServerResponse(f,m):ht(f,"internal-error")}}class ho extends Zi{constructor(f){super("phone",f),this.phoneNumber=f.phoneInfo}static _fromServerResponse(f,m){return new ho(m)}}function ds(w,f,m){var T;V((null===(T=m.url)||void 0===T?void 0:T.length)>0,w,"invalid-continue-uri"),V(void 0===m.dynamicLinkDomain||m.dynamicLinkDomain.length>0,w,"invalid-dynamic-link-domain"),f.continueUrl=m.url,f.dynamicLinkDomain=m.dynamicLinkDomain,f.canHandleCodeInApp=m.handleCodeInApp,m.iOS&&(V(m.iOS.bundleId.length>0,w,"missing-ios-bundle-id"),f.iOSBundleId=m.iOS.bundleId),m.android&&(V(m.android.packageName.length>0,w,"missing-android-pkg-name"),f.androidInstallApp=m.android.installApp,f.androidMinimumVersionCode=m.android.minimumVersion,f.androidPackageName=m.android.packageName)}function G(){return(G=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w),z={requestType:"PASSWORD_RESET",email:f};m&&ds(T,z,m),yield Kr(T,z)})).apply(this,arguments)}function F(){return(F=(0,_.Z)(function*(w,f,m){yield Ee((0,ie.m9)(w),{oobCode:f,newPassword:m})})).apply(this,arguments)}function R(){return(R=(0,_.Z)(function*(w,f){yield gt((0,ie.m9)(w),{oobCode:f})})).apply(this,arguments)}function Y(w,f){return oe.apply(this,arguments)}function oe(){return(oe=(0,_.Z)(function*(w,f){const m=(0,ie.m9)(w),T=yield Ee(m,{oobCode:f}),z=T.requestType;switch(V(z,m,"internal-error"),z){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":V(T.newEmail,m,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":V(T.mfaInfo,m,"internal-error");default:V(T.email,m,"internal-error")}let re=null;return T.mfaInfo&&(re=Zi._fromServerResponse(Ht(m),T.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===T.requestType?T.newEmail:T.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===T.requestType?T.email:T.newEmail)||null,multiFactorInfo:re},operation:z}})).apply(this,arguments)}function Ke(){return(Ke=(0,_.Z)(function*(w,f){const{data:m}=yield Y((0,ie.m9)(w),f);return m.email})).apply(this,arguments)}function Gt(){return(Gt=(0,_.Z)(function*(w,f,m){const T=Ht(w),z=yield oi(T,{returnSecureToken:!0,email:f,password:m}),re=yield hi._fromIdTokenResponse(T,"signIn",z);return yield T._updateCurrentUser(re.user),re})).apply(this,arguments)}function cr(){return(cr=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w),z={requestType:"EMAIL_SIGNIN",email:f};V(m.handleCodeInApp,T,"argument-error"),m&&ds(T,z,m),yield Di(T,z)})).apply(this,arguments)}function rr(){return(rr=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w),z=ji.credentialWithLink(f,m||St());return V(z._tenantId===(T.tenantId||null),T,"tenant-id-mismatch"),wn(T,z)})).apply(this,arguments)}function Dr(w,f){return Ti.apply(this,arguments)}function Ti(){return(Ti=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:createAuthUri",zt(w,f))})).apply(this,arguments)}function gi(){return(gi=(0,_.Z)(function*(w,f){const T={identifier:f,continueUri:Pt()?St():"http://localhost"},{signinMethods:z}=yield Dr((0,ie.m9)(w),T);return z||[]})).apply(this,arguments)}function Xn(){return(Xn=(0,_.Z)(function*(w,f){const m=(0,ie.m9)(w),z={requestType:"VERIFY_EMAIL",idToken:yield w.getIdToken()};f&&ds(m.auth,z,f);const{email:re}=yield Qn(m.auth,z);re!==w.email&&(yield w.reload())})).apply(this,arguments)}function Js(){return(Js=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w),re={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield w.getIdToken(),newEmail:f};m&&ds(T.auth,re,m);const{email:Le}=yield qi(T.auth,re);Le!==w.email&&(yield w.reload())})).apply(this,arguments)}function _o(w,f){return la.apply(this,arguments)}function la(){return(la=(0,_.Z)(function*(w,f){return Yt(w,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function Ro(){return(Ro=(0,_.Z)(function*(w,{displayName:f,photoURL:m}){if(void 0===f&&void 0===m)return;const T=(0,ie.m9)(w),re={idToken:yield T.getIdToken(),displayName:f,photoUrl:m,returnSecureToken:!0},Le=yield Pr(T,_o(T.auth,re));T.displayName=Le.displayName||null,T.photoURL=Le.photoUrl||null;const ct=T.providerData.find(({providerId:Lt})=>"password"===Lt);ct&&(ct.displayName=T.displayName,ct.photoURL=T.photoURL),yield T._updateTokensIfNecessary(Le)})).apply(this,arguments)}function zo(w,f,m){return Ko.apply(this,arguments)}function Ko(){return(Ko=(0,_.Z)(function*(w,f,m){const{auth:T}=w,re={idToken:yield w.getIdToken(),returnSecureToken:!0};f&&(re.email=f),m&&(re.password=m);const Le=yield Pr(w,le(T,re));yield w._updateTokensIfNecessary(Le,!0)})).apply(this,arguments)}class ca{constructor(f,m,T={}){this.isNewUser=f,this.providerId=m,this.profile=T}}class Ga extends ca{constructor(f,m,T,z){super(f,m,T),this.username=z}}class Ma extends ca{constructor(f,m){super(f,"facebook.com",m)}}class No extends Ga{constructor(f,m){super(f,"github.com",m,"string"==typeof(null==m?void 0:m.login)?null==m?void 0:m.login:null)}}class Na extends ca{constructor(f,m){super(f,"google.com",m)}}class Si extends Ga{constructor(f,m,T){super(f,"twitter.com",m,T)}}function fo(w){const{user:f,_tokenResponse:m}=w;return f.isAnonymous&&!m?{providerId:null,isNewUser:!1,profile:null}:function Mo(w){var f,m;if(!w)return null;const{providerId:T}=w,z=w.rawUserInfo?JSON.parse(w.rawUserInfo):{},re=w.isNewUser||"identitytoolkit#SignupNewUserResponse"===w.kind;if(!T&&(null==w?void 0:w.idToken)){const Le=null===(m=null===(f=Xt(w.idToken))||void 0===f?void 0:f.firebase)||void 0===m?void 0:m.sign_in_provider;if(Le)return new ca(re,"anonymous"!==Le&&"custom"!==Le?Le:null)}if(!T)return null;switch(T){case"facebook.com":return new Ma(re,z);case"github.com":return new No(re,z);case"google.com":return new Na(re,z);case"twitter.com":return new Si(re,z,w.screenName||null);case"custom":case"anonymous":return new ca(re,null);default:return new ca(re,T,z)}}(m)}class Xs{constructor(f,m){this.type=f,this.credential=m}static _fromIdtoken(f){return new Xs("enroll",f)}static _fromMfaPendingCredential(f){return new Xs("signin",f)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(f){var m,T;if(null==f?void 0:f.multiFactorSession){if(null===(m=f.multiFactorSession)||void 0===m?void 0:m.pendingCredential)return Xs._fromMfaPendingCredential(f.multiFactorSession.pendingCredential);if(null===(T=f.multiFactorSession)||void 0===T?void 0:T.idToken)return Xs._fromIdtoken(f.multiFactorSession.idToken)}return null}}class qo{constructor(f,m,T){this.session=f,this.hints=m,this.signInResolver=T}static _fromError(f,m){const T=Ht(f),z=m.customData._serverResponse,re=(z.mfaInfo||[]).map(ct=>Zi._fromServerResponse(T,ct));V(z.mfaPendingCredential,T,"internal-error");const Le=Xs._fromMfaPendingCredential(z.mfaPendingCredential);return new qo(Le,re,function(){var ct=(0,_.Z)(function*(Lt){const rn=yield Lt._process(T,Le);delete z.mfaInfo,delete z.mfaPendingCredential;const $n=Object.assign(Object.assign({},z),{idToken:rn.idToken,refreshToken:rn.refreshToken});switch(m.operationType){case"signIn":const xn=yield hi._fromIdTokenResponse(T,m.operationType,$n);return yield T._updateCurrentUser(xn.user),xn;case"reauthenticate":return V(m.user,T,"internal-error"),hi._forOperation(m.user,m.operationType,$n);default:ht(T,"internal-error")}});return function(Lt){return ct.apply(this,arguments)}}())}resolveSignIn(f){var m=this;return(0,_.Z)(function*(){return m.signInResolver(f)})()}}function da(w,f){return Yt(w,"POST","/v2/accounts/mfaEnrollment:start",zt(w,f))}class Oa{constructor(f){this.user=f,this.enrolledFactors=[],f._onReload(m=>{m.mfaInfo&&(this.enrolledFactors=m.mfaInfo.map(T=>Zi._fromServerResponse(f.auth,T)))})}static _fromUser(f){return new Oa(f)}getSession(){var f=this;return(0,_.Z)(function*(){return Xs._fromIdtoken(yield f.user.getIdToken())})()}enroll(f,m){var T=this;return(0,_.Z)(function*(){const z=f,re=yield T.getSession(),Le=yield Pr(T.user,z._process(T.user.auth,re,m));return yield T.user._updateTokensIfNecessary(Le),T.user.reload()})()}unenroll(f){var m=this;return(0,_.Z)(function*(){var T;const z="string"==typeof f?f:f.uid,re=yield m.user.getIdToken(),Le=yield Pr(m.user,function Gi(w,f){return Yt(w,"POST","/v2/accounts/mfaEnrollment:withdraw",zt(w,f))}(m.user.auth,{idToken:re,mfaEnrollmentId:z}));m.enrolledFactors=m.enrolledFactors.filter(({uid:ct})=>ct!==z),yield m.user._updateTokensIfNecessary(Le);try{yield m.user.reload()}catch(ct){if("auth/user-token-expired"!==(null===(T=ct)||void 0===T?void 0:T.code))throw ct}})()}}const Oo=new WeakMap,ha="__sak";class za{constructor(f,m){this.storageRetriever=f,this.type=m}_isAvailable(){try{return this.storage?(this.storage.setItem(ha,"1"),this.storage.removeItem(ha),Promise.resolve(!0)):Promise.resolve(!1)}catch(f){return Promise.resolve(!1)}}_set(f,m){return this.storage.setItem(f,JSON.stringify(m)),Promise.resolve()}_get(f){const m=this.storage.getItem(f);return Promise.resolve(m?JSON.parse(m):null)}_remove(f){return this.storage.removeItem(f),Promise.resolve()}get storage(){return this.storageRetriever()}}const Zo=(()=>{class w extends za{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(m,T)=>this.onStorageEvent(m,T),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Ns(){const w=(0,ie.z$)();return _i(w)||si(w)}()&&function wr(){try{return!(!window||window===window.top)}catch(w){return!1}}(),this.fallbackToPolling=Er(),this._shouldAllowMigration=!0}forAllChangedKeys(m){for(const T of Object.keys(this.listeners)){const z=this.storage.getItem(T),re=this.localCache[T];z!==re&&m(T,re,z)}}onStorageEvent(m,T=!1){if(!m.key)return void this.forAllChangedKeys((ct,Lt,rn)=>{this.notifyListeners(ct,rn)});const z=m.key;if(T?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const ct=this.storage.getItem(z);if(m.newValue!==ct)null!==m.newValue?this.storage.setItem(z,m.newValue):this.storage.removeItem(z);else if(this.localCache[z]===m.newValue&&!T)return}const re=()=>{const ct=this.storage.getItem(z);!T&&this.localCache[z]===ct||this.notifyListeners(z,ct)},Le=this.storage.getItem(z);!function Wr(){return(0,ie.w1)()&&10===document.documentMode}()||Le===m.newValue||m.newValue===m.oldValue?re():setTimeout(re,10)}notifyListeners(m,T){this.localCache[m]=T;const z=this.listeners[m];if(z)for(const re of Array.from(z))re(T&&JSON.parse(T))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((m,T,z)=>{this.onStorageEvent(new StorageEvent("storage",{key:m,oldValue:T,newValue:z}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(m,T){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[m]||(this.listeners[m]=new Set,this.localCache[m]=this.storage.getItem(m)),this.listeners[m].add(T)}_removeListener(m,T){this.listeners[m]&&(this.listeners[m].delete(T),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(m,T){var z=()=>super._set,re=this;return(0,_.Z)(function*(){yield z().call(re,m,T),re.localCache[m]=JSON.stringify(T)})()}_get(m){var T=()=>super._get,z=this;return(0,_.Z)(function*(){const re=yield T().call(z,m);return z.localCache[m]=JSON.stringify(re),re})()}_remove(m){var T=()=>super._remove,z=this;return(0,_.Z)(function*(){yield T().call(z,m),delete z.localCache[m]})()}}return w.type="LOCAL",w})(),eo=(()=>{class w extends za{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(m,T){}_removeListener(m,T){}}return w.type="SESSION",w})();let Eo=(()=>{class w{constructor(m){this.eventTarget=m,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(m){const T=this.receivers.find(re=>re.isListeningto(m));if(T)return T;const z=new w(m);return this.receivers.push(z),z}isListeningto(m){return this.eventTarget===m}handleEvent(m){var T=this;return(0,_.Z)(function*(){const z=m,{eventId:re,eventType:Le,data:ct}=z.data,Lt=T.handlersMap[Le];if(!(null==Lt?void 0:Lt.size))return;z.ports[0].postMessage({status:"ack",eventId:re,eventType:Le});const rn=Array.from(Lt).map(function(){var xn=(0,_.Z)(function*(fs){return fs(z.origin,ct)});return function(fs){return xn.apply(this,arguments)}}()),$n=yield function Yr(w){return Promise.all(w.map(function(){var f=(0,_.Z)(function*(m){try{return{fulfilled:!0,value:yield m}}catch(T){return{fulfilled:!1,reason:T}}});return function(m){return f.apply(this,arguments)}}()))}(rn);z.ports[0].postMessage({status:"done",eventId:re,eventType:Le,response:$n})})()}_subscribe(m,T){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[m]||(this.handlersMap[m]=new Set),this.handlersMap[m].add(T)}_unsubscribe(m,T){this.handlersMap[m]&&T&&this.handlersMap[m].delete(T),(!T||0===this.handlersMap[m].size)&&delete this.handlersMap[m],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return w.receivers=[],w})();function Hs(w="",f=10){let m="";for(let T=0;T<f;T++)m+=Math.floor(10*Math.random());return w+m}class ru{constructor(f){this.target=f,this.handlers=new Set}removeMessageHandler(f){f.messageChannel&&(f.messageChannel.port1.removeEventListener("message",f.onMessage),f.messageChannel.port1.close()),this.handlers.delete(f)}_send(f,m,T=50){var z=this;return(0,_.Z)(function*(){const re="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!re)throw new Error("connection_unavailable");let Le,ct;return new Promise((Lt,rn)=>{const $n=Hs("",20);re.port1.start();const xn=setTimeout(()=>{rn(new Error("unsupported_event"))},T);ct={messageChannel:re,onMessage(fs){const sa=fs;if(sa.data.eventId===$n)switch(sa.data.status){case"ack":clearTimeout(xn),Le=setTimeout(()=>{rn(new Error("timeout"))},3e3);break;case"done":clearTimeout(Le),Lt(sa.data.response);break;default:clearTimeout(xn),clearTimeout(Le),rn(new Error("invalid_response"))}}},z.handlers.add(ct),re.port1.addEventListener("message",ct.onMessage),z.target.postMessage({eventType:f,eventId:$n,data:m},[re.port2])}).finally(()=>{ct&&z.removeMessageHandler(ct)})})()}}function Qr(){return window}function Gs(){return void 0!==Qr().WorkerGlobalScope&&"function"==typeof Qr().importScripts}function Ps(){return(Ps=(0,_.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(w){return null}})).apply(this,arguments)}const Hu="firebaseLocalStorageDb",ai="firebaseLocalStorage",Jo="fbase_key";class fa{constructor(f){this.request=f}toPromise(){return new Promise((f,m)=>{this.request.addEventListener("success",()=>{f(this.request.result)}),this.request.addEventListener("error",()=>{m(this.request.error)})})}}function S(w,f){return w.transaction([ai],f?"readwrite":"readonly").objectStore(ai)}function b(){const w=indexedDB.open(Hu,1);return new Promise((f,m)=>{w.addEventListener("error",()=>{m(w.error)}),w.addEventListener("upgradeneeded",()=>{const T=w.result;try{T.createObjectStore(ai,{keyPath:Jo})}catch(z){m(z)}}),w.addEventListener("success",(0,_.Z)(function*(){const T=w.result;T.objectStoreNames.contains(ai)?f(T):(T.close(),yield function D(){const w=indexedDB.deleteDatabase(Hu);return new fa(w).toPromise()}(),f(yield b()))}))})}function N(w,f,m){return P.apply(this,arguments)}function P(){return(P=(0,_.Z)(function*(w,f,m){const T=S(w,!0).put({[Jo]:f,value:m});return new fa(T).toPromise()})).apply(this,arguments)}function de(){return(de=(0,_.Z)(function*(w,f){const m=S(w,!1).get(f),T=yield new fa(m).toPromise();return void 0===T?null:T.value})).apply(this,arguments)}function Ie(w,f){const m=S(w,!0).delete(f);return new fa(m).toPromise()}const pn=(()=>{class w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var m=this;return(0,_.Z)(function*(){return m.db||(m.db=yield b()),m.db})()}_withRetries(m){var T=this;return(0,_.Z)(function*(){let z=0;for(;;)try{const re=yield T._openDb();return yield m(re)}catch(re){if(z++>3)throw re;T.db&&(T.db.close(),T.db=void 0)}})()}initializeServiceWorkerMessaging(){var m=this;return(0,_.Z)(function*(){return Gs()?m.initializeReceiver():m.initializeSender()})()}initializeReceiver(){var m=this;return(0,_.Z)(function*(){m.receiver=Eo._getInstance(function Qo(){return Gs()?self:null}()),m.receiver._subscribe("keyChanged",function(){var T=(0,_.Z)(function*(z,re){return{keyProcessed:(yield m._poll()).includes(re.key)}});return function(z,re){return T.apply(this,arguments)}}()),m.receiver._subscribe("ping",function(){var T=(0,_.Z)(function*(z,re){return["keyChanged"]});return function(z,re){return T.apply(this,arguments)}}())})()}initializeSender(){var m=this;return(0,_.Z)(function*(){var T,z;if(m.activeServiceWorker=yield function Yi(){return Ps.apply(this,arguments)}(),!m.activeServiceWorker)return;m.sender=new ru(m.activeServiceWorker);const re=yield m.sender._send("ping",{},800);!re||(null===(T=re[0])||void 0===T?void 0:T.fulfilled)&&(null===(z=re[0])||void 0===z?void 0:z.value.includes("keyChanged"))&&(m.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(m){var T=this;return(0,_.Z)(function*(){if(T.sender&&T.activeServiceWorker&&function Fo(){var w;return(null===(w=null==navigator?void 0:navigator.serviceWorker)||void 0===w?void 0:w.controller)||null}()===T.activeServiceWorker)try{yield T.sender._send("keyChanged",{key:m},T.serviceWorkerReceiverAvailable?800:50)}catch(z){}})()}_isAvailable(){return(0,_.Z)(function*(){try{if(!indexedDB)return!1;const m=yield b();return yield N(m,ha,"1"),yield Ie(m,ha),!0}catch(m){}return!1})()}_withPendingWrite(m){var T=this;return(0,_.Z)(function*(){T.pendingWrites++;try{yield m()}finally{T.pendingWrites--}})()}_set(m,T){var z=this;return(0,_.Z)(function*(){return z._withPendingWrite((0,_.Z)(function*(){return yield z._withRetries(re=>N(re,m,T)),z.localCache[m]=T,z.notifyServiceWorker(m)}))})()}_get(m){var T=this;return(0,_.Z)(function*(){const z=yield T._withRetries(re=>function K(w,f){return de.apply(this,arguments)}(re,m));return T.localCache[m]=z,z})()}_remove(m){var T=this;return(0,_.Z)(function*(){return T._withPendingWrite((0,_.Z)(function*(){return yield T._withRetries(z=>Ie(z,m)),delete T.localCache[m],T.notifyServiceWorker(m)}))})()}_poll(){var m=this;return(0,_.Z)(function*(){const T=yield m._withRetries(Le=>{const ct=S(Le,!1).getAll();return new fa(ct).toPromise()});if(!T)return[];if(0!==m.pendingWrites)return[];const z=[],re=new Set;for(const{fbase_key:Le,value:ct}of T)re.add(Le),JSON.stringify(m.localCache[Le])!==JSON.stringify(ct)&&(m.notifyListeners(Le,ct),z.push(Le));for(const Le of Object.keys(m.localCache))m.localCache[Le]&&!re.has(Le)&&(m.notifyListeners(Le,null),z.push(Le));return z})()}notifyListeners(m,T){this.localCache[m]=T;const z=this.listeners[m];if(z)for(const re of Array.from(z))re(T)}startPolling(){var m=this;this.stopPolling(),this.pollTimer=setInterval((0,_.Z)(function*(){return m._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(m,T){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[m]||(this.listeners[m]=new Set,this._get(m)),this.listeners[m].add(T)}_removeListener(m,T){this.listeners[m]&&(this.listeners[m].delete(T),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return w.type="LOCAL",w})();function Tr(w,f){return Yt(w,"POST","/v2/accounts/mfaSignIn:start",zt(w,f))}function po(){return(po=(0,_.Z)(function*(w){return(yield Yt(w,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Lo(w){return new Promise((f,m)=>{const T=document.createElement("script");T.setAttribute("src",w),T.onload=f,T.onerror=z=>{const re=xe("internal-error");re.customData=z,m(re)},T.type="text/javascript",T.charset="UTF-8",function Fa(){var w,f;return null!==(f=null===(w=document.getElementsByTagName("head"))||void 0===w?void 0:w[0])&&void 0!==f?f:document}().appendChild(T)})}function Dn(w){return`__${w}${Math.floor(1e6*Math.random())}`}const ui=1e12;class An{constructor(f){this.auth=f,this.counter=ui,this._widgets=new Map}render(f,m){const T=this.counter;return this._widgets.set(T,new _u(f,this.auth.name,m||{})),this.counter++,T}reset(f){var m;const T=f||ui;null===(m=this._widgets.get(T))||void 0===m||m.delete(),this._widgets.delete(T)}getResponse(f){var m;return(null===(m=this._widgets.get(f||ui))||void 0===m?void 0:m.getResponse())||""}execute(f){var m=this;return(0,_.Z)(function*(){var T;return null===(T=m._widgets.get(f||ui))||void 0===T||T.execute(),""})()}}class _u{constructor(f,m,T){this.params=T,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const z="string"==typeof f?document.getElementById(f):f;V(z,"argument-error",{appName:m}),this.container=z,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Nr(w){const f=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let T=0;T<w;T++)f.push(m.charAt(Math.floor(Math.random()*m.length)));return f.join("")}(50);const{callback:f,"expired-callback":m}=this.params;if(f)try{f(this.responseToken)}catch(T){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,m)try{m()}catch(T){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Qi=Dn("rcb"),hs=new en(3e4,6e4);class Al{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Qr().grecaptcha}load(f,m=""){return V(function Wu(w){return w.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(w)}(m),f,"argument-error"),this.shouldResolveImmediately(m)?Promise.resolve(Qr().grecaptcha):new Promise((T,z)=>{const re=Qr().setTimeout(()=>{z(xe(f,"network-request-failed"))},hs.get());Qr()[Qi]=()=>{Qr().clearTimeout(re),delete Qr()[Qi];const ct=Qr().grecaptcha;if(!ct)return void z(xe(f,"internal-error"));const Lt=ct.render;ct.render=(rn,$n)=>{const xn=Lt(rn,$n);return this.counter++,xn},this.hostLanguage=m,T(ct)},Lo(`https://www.google.com/recaptcha/api.js??${(0,ie.xO)({onload:Qi,render:"explicit",hl:m})}`).catch(()=>{clearTimeout(re),z(xe(f,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(f){return!!Qr().grecaptcha&&(f===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class La{load(f){return(0,_.Z)(function*(){return new An(f)})()}clearedOneInstance(){}}const vu="recaptcha",al={theme:"light",type:"image"};class iu{constructor(f,m=Object.assign({},al),T){this.parameters=m,this.type=vu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ht(T),this.isInvisible="invisible"===this.parameters.size,V("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const z="string"==typeof f?document.getElementById(f):f;V(z,this.auth,"argument-error"),this.container=z,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new La:new Al,this.validateStartingState()}verify(){var f=this;return(0,_.Z)(function*(){f.assertNotDestroyed();const m=yield f.render(),T=f.getAssertedRecaptcha();return T.getResponse(m)||new Promise(re=>{const Le=ct=>{!ct||(f.tokenChangeListeners.delete(Le),re(ct))};f.tokenChangeListeners.add(Le),f.isInvisible&&T.execute(m)})})()}render(){try{this.assertNotDestroyed()}catch(f){return Promise.reject(f)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(f=>{throw this.renderPromise=null,f})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(f=>{this.container.removeChild(f)})}validateStartingState(){V(!this.parameters.sitekey,this.auth,"argument-error"),V(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),V("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(f){return m=>{if(this.tokenChangeListeners.forEach(T=>T(m)),"function"==typeof f)f(m);else if("string"==typeof f){const T=Qr()[f];"function"==typeof T&&T(m)}}}assertNotDestroyed(){V(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var f=this;return(0,_.Z)(function*(){if(yield f.init(),!f.widgetId){let m=f.container;if(!f.isInvisible){const T=document.createElement("div");m.appendChild(T),m=T}f.widgetId=f.getAssertedRecaptcha().render(m,f.parameters)}return f.widgetId})()}init(){var f=this;return(0,_.Z)(function*(){V(Pt()&&!Gs(),f.auth,"internal-error"),yield function xl(){let w=null;return new Promise(f=>{"complete"!==document.readyState?(w=()=>f(),window.addEventListener("load",w)):f()}).catch(f=>{throw w&&window.removeEventListener("load",w),f})}(),f.recaptcha=yield f._recaptchaLoader.load(f.auth,f.auth.languageCode||void 0);const m=yield function to(w){return po.apply(this,arguments)}(f.auth);V(m,f.auth,"internal-error"),f.parameters.sitekey=m})()}getAssertedRecaptcha(){return V(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class jr{constructor(f,m){this.verificationId=f,this.onConfirmation=m}confirm(f){const m=nr._fromVerification(this.verificationId,f);return this.onConfirmation(m)}}function qa(){return(qa=(0,_.Z)(function*(w,f,m){const T=Ht(w),z=yield Va(T,f,(0,ie.m9)(m));return new jr(z,re=>wn(T,re))})).apply(this,arguments)}function Ia(){return(Ia=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w);yield U(!1,T,"phone");const z=yield Va(T.auth,f,(0,ie.m9)(m));return new jr(z,re=>kn(T,re))})).apply(this,arguments)}function Qe(){return(Qe=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w),z=yield Va(T.auth,f,(0,ie.m9)(m));return new jr(z,re=>qr(T,re))})).apply(this,arguments)}function Va(w,f,m){return no.apply(this,arguments)}function no(){return(no=(0,_.Z)(function*(w,f,m){var T;const z=yield m.verify();try{let re;if(V("string"==typeof z,w,"argument-error"),V(m.type===vu,w,"argument-error"),re="string"==typeof f?{phoneNumber:f}:f,"session"in re){const Le=re.session;if("phoneNumber"in re)return V("enroll"===Le.type,w,"internal-error"),(yield da(w,{idToken:Le.credential,phoneEnrollmentInfo:{phoneNumber:re.phoneNumber,recaptchaToken:z}})).phoneSessionInfo.sessionInfo;{V("signin"===Le.type,w,"internal-error");const ct=(null===(T=re.multiFactorHint)||void 0===T?void 0:T.uid)||re.multiFactorUid;return V(ct,w,"missing-multi-factor-info"),(yield Tr(w,{mfaPendingCredential:Le.credential,mfaEnrollmentId:ct,phoneSignInInfo:{recaptchaToken:z}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Le}=yield tt(w,{phoneNumber:re.phoneNumber,recaptchaToken:z});return Le}}finally{m._reset()}})).apply(this,arguments)}function pa(){return(pa=(0,_.Z)(function*(w,f){yield B((0,ie.m9)(w),f)})).apply(this,arguments)}let Co=(()=>{class w{constructor(m){this.providerId=w.PROVIDER_ID,this.auth=Ht(m)}verifyPhoneNumber(m,T){return Va(this.auth,m,(0,ie.m9)(T))}static credential(m,T){return nr._fromVerification(m,T)}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{phoneNumber:T,temporaryProof:z}=m;return T&&z?nr._fromTokenResponse(T,z):null}}return w.PROVIDER_ID="phone",w.PHONE_SIGN_IN_METHOD="phone",w})();function Ca(w,f){return f?Ue(f):(V(w._popupRedirectResolver,w,"argument-error"),w._popupRedirectResolver)}class Vo extends Mi{constructor(f){super("custom","custom"),this.params=f}_getIdTokenResponse(f){return us(f,this._buildIdpRequest())}_linkToIdToken(f,m){return us(f,this._buildIdpRequest(m))}_getReauthenticationResolver(f){return us(f,this._buildIdpRequest())}_buildIdpRequest(f){const m={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return f&&(m.idToken=f),m}}function ul(w){return yt(w.auth,new Vo(w),w.bypassAuthState)}function Eu(w){const{auth:f,user:m}=w;return V(m,f,"internal-error"),_e(m,new Vo(w),w.bypassAuthState)}function Xo(w){return ll.apply(this,arguments)}function ll(){return(ll=(0,_.Z)(function*(w){const{auth:f,user:m}=w;return V(m,f,"internal-error"),B(m,new Vo(w),w.bypassAuthState)})).apply(this,arguments)}class os{constructor(f,m,T,z,re=!1){this.auth=f,this.resolver=T,this.user=z,this.bypassAuthState=re,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(m)?m:[m]}execute(){var f=this;return new Promise(function(){var m=(0,_.Z)(function*(T,z){f.pendingPromise={resolve:T,reject:z};try{f.eventManager=yield f.resolver._initialize(f.auth),yield f.onExecution(),f.eventManager.registerConsumer(f)}catch(re){f.reject(re)}});return function(T,z){return m.apply(this,arguments)}}())}onAuthEvent(f){var m=this;return(0,_.Z)(function*(){const{urlResponse:T,sessionId:z,postBody:re,tenantId:Le,error:ct,type:Lt}=f;if(ct)return void m.reject(ct);const rn={auth:m.auth,requestUri:T,sessionId:z,tenantId:Le||void 0,postBody:re||void 0,user:m.user,bypassAuthState:m.bypassAuthState};try{m.resolve(yield m.getIdpTask(Lt)(rn))}catch($n){m.reject($n)}})()}onError(f){this.reject(f)}getIdpTask(f){switch(f){case"signInViaPopup":case"signInViaRedirect":return ul;case"linkViaPopup":case"linkViaRedirect":return Xo;case"reauthViaPopup":case"reauthViaRedirect":return Eu;default:ht(this.auth,"internal-error")}}resolve(f){ge(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(f),this.unregisterAndCleanUp()}reject(f){ge(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(f),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Rl=new en(2e3,1e4);function Ua(){return(Ua=(0,_.Z)(function*(w,f,m){const T=Ht(w);wt(w,f,ti);const z=Ca(T,m);return new ea(T,"signInViaPopup",f,z).executeNotNull()})).apply(this,arguments)}function Uo(){return(Uo=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w);wt(T.auth,f,ti);const z=Ca(T.auth,m);return new ea(T.auth,"reauthViaPopup",f,z,T).executeNotNull()})).apply(this,arguments)}function Sr(){return(Sr=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w);wt(T.auth,f,ti);const z=Ca(T.auth,m);return new ea(T.auth,"linkViaPopup",f,z,T).executeNotNull()})).apply(this,arguments)}let ea=(()=>{class w extends os{constructor(m,T,z,re,Le){super(m,T,re,Le),this.provider=z,this.authWindow=null,this.pollId=null,w.currentPopupAction&&w.currentPopupAction.cancel(),w.currentPopupAction=this}executeNotNull(){var m=this;return(0,_.Z)(function*(){const T=yield m.execute();return V(T,m.auth,"internal-error"),T})()}onExecution(){var m=this;return(0,_.Z)(function*(){ge(1===m.filter.length,"Popup operations only handle one event");const T=Hs();m.authWindow=yield m.resolver._openPopup(m.auth,m.provider,m.filter[0],T),m.authWindow.associatedEvent=T,m.resolver._originValidation(m.auth).catch(z=>{m.reject(z)}),m.resolver._isIframeWebStorageSupported(m.auth,z=>{z||m.reject(xe(m.auth,"web-storage-unsupported"))}),m.pollUserCancellation()})()}get eventId(){var m;return(null===(m=this.authWindow)||void 0===m?void 0:m.associatedEvent)||null}cancel(){this.reject(xe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,w.currentPopupAction=null}pollUserCancellation(){const m=()=>{var T,z;this.pollId=(null===(z=null===(T=this.authWindow)||void 0===T?void 0:T.window)||void 0===z?void 0:z.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(xe(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(m,Rl.get())};m()}}return w.currentPopupAction=null,w})();const Wi=new Map;class dh extends os{constructor(f,m,T=!1){super(f,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],m,void 0,T),this.eventId=null}execute(){var f=()=>super.execute,m=this;return(0,_.Z)(function*(){let T=Wi.get(m.auth._key());if(!T){try{const re=(yield function ki(w,f){return Ku.apply(this,arguments)}(m.resolver,m.auth))?yield f().call(m):null;T=()=>Promise.resolve(re)}catch(z){T=()=>Promise.reject(z)}Wi.set(m.auth._key(),T)}return m.bypassAuthState||Wi.set(m.auth._key(),()=>Promise.resolve(null)),T()})()}onAuthEvent(f){var m=()=>super.onAuthEvent,T=this;return(0,_.Z)(function*(){if("signInViaRedirect"===f.type)return m().call(T,f);if("unknown"!==f.type){if(f.eventId){const z=yield T.auth._redirectUserForId(f.eventId);if(z)return T.user=z,m().call(T,f);T.resolve(null)}}else T.resolve(null)})()}onExecution(){return(0,_.Z)(function*(){})()}cleanUp(){}}function Ku(){return(Ku=(0,_.Z)(function*(w,f){const m=me(f),T=X(w);if(!(yield T._isAvailable()))return!1;const z="true"===(yield T._get(m));return yield T._remove(m),z})).apply(this,arguments)}function bo(w,f){return Ai.apply(this,arguments)}function Ai(){return(Ai=(0,_.Z)(function*(w,f){return X(w)._set(me(f),"true")})).apply(this,arguments)}function j(w,f){Wi.set(w._key(),f)}function X(w){return Ue(w._redirectPersistence)}function me(w){return an("pendingRedirect",w.config.apiKey,w.name)}function Ct(){return(Ct=(0,_.Z)(function*(w,f,m){const T=Ht(w);wt(w,f,ti);const z=Ca(T,m);return yield bo(z,T),z._openRedirect(T,f,"signInViaRedirect")})).apply(this,arguments)}function jn(){return(jn=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w);wt(T.auth,f,ti);const z=Ca(T.auth,m);yield bo(z,T.auth);const re=yield wu(T);return z._openRedirect(T.auth,f,"reauthViaRedirect",re)})).apply(this,arguments)}function Jr(){return(Jr=(0,_.Z)(function*(w,f,m){const T=(0,ie.m9)(w);wt(T.auth,f,ti);const z=Ca(T.auth,m);yield U(!1,T,f.providerId),yield bo(z,T.auth);const re=yield wu(T);return z._openRedirect(T.auth,f,"linkViaRedirect",re)})).apply(this,arguments)}function ks(){return(ks=(0,_.Z)(function*(w,f){return yield Ht(w)._initializationPromise,Bo(w,f,!1)})).apply(this,arguments)}function Bo(w,f){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,_.Z)(function*(w,f,m=!1){const T=Ht(w),z=Ca(T,f),Le=yield new dh(T,z,m).execute();return Le&&!m&&(delete Le.user._redirectEventId,yield T._persistUserIfCurrent(Le.user),yield T._setRedirectUser(null,f)),Le})).apply(this,arguments)}function wu(w){return Is.apply(this,arguments)}function Is(){return(Is=(0,_.Z)(function*(w){const f=Hs(`${w.uid}:::`);return w._redirectEventId=f,yield w.auth._setRedirectUser(w),yield w.auth._persistUserIfCurrent(w),f})).apply(this,arguments)}class go{constructor(f){this.auth=f,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(f){this.consumers.add(f),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,f)&&(this.sendToConsumer(this.queuedRedirectEvent,f),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(f){this.consumers.delete(f)}onEvent(f){if(this.hasEventBeenHandled(f))return!1;let m=!1;return this.consumers.forEach(T=>{this.isEventForConsumer(f,T)&&(m=!0,this.sendToConsumer(f,T),this.saveEventToCache(f))}),this.hasHandledPotentialRedirect||!function Ml(w){switch(w.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ba(w);default:return!1}}(f)||(this.hasHandledPotentialRedirect=!0,m||(this.queuedRedirectEvent=f,m=!0)),m}sendToConsumer(f,m){var T;if(f.error&&!Ba(f)){const z=(null===(T=f.error.code)||void 0===T?void 0:T.split("auth/")[1])||"internal-error";m.onError(xe(this.auth,z))}else m.onAuthEvent(f)}isEventForConsumer(f,m){const T=null===m.eventId||!!f.eventId&&f.eventId===m.eventId;return m.filter.includes(f.type)&&T}hasEventBeenHandled(f){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ta(f))}saveEventToCache(f){this.cachedEventUids.add(ta(f)),this.lastProcessedEventTime=Date.now()}}function ta(w){return[w.type,w.eventId,w.sessionId,w.tenantId].filter(f=>f).join("-")}function Ba({type:w,error:f}){return"unknown"===w&&"auth/no-auth-event"===(null==f?void 0:f.code)}function Qa(w){return nc.apply(this,arguments)}function nc(){return(nc=(0,_.Z)(function*(w,f={}){return Yt(w,"GET","/v1/projects",f)})).apply(this,arguments)}const cl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Nl=/^https?/;function Pl(){return(Pl=(0,_.Z)(function*(w){if(w.config.emulator)return;const{authorizedDomains:f}=yield Qa(w);for(const m of f)try{if(ro(m))return}catch(T){}ht(w,"unauthorized-domain")})).apply(this,arguments)}function ro(w){const f=St(),{protocol:m,hostname:T}=new URL(f);if(w.startsWith("chrome-extension://")){const Le=new URL(w);return""===Le.hostname&&""===T?"chrome-extension:"===m&&w.replace("chrome-extension://","")===f.replace("chrome-extension://",""):"chrome-extension:"===m&&Le.hostname===T}if(!Nl.test(m))return!1;if(cl.test(w))return T===w;const z=w.replace(/\./g,"\\.");return new RegExp("^(.+\\."+z+"|"+z+")$","i").test(T)}const Hc=new en(3e4,6e4);function Fi(){const w=Qr().___jsl;if(null==w?void 0:w.H)for(const f of Object.keys(w.H))if(w.H[f].r=w.H[f].r||[],w.H[f].L=w.H[f].L||[],w.H[f].r=[...w.H[f].L],w.CP)for(let m=0;m<w.CP.length;m++)w.CP[m]=null}let dl=null;function su(w){return dl=dl||function hh(w){return new Promise((f,m)=>{var T,z,re;function Le(){Fi(),gapi.load("gapi.iframes",{callback:()=>{f(gapi.iframes.getContext())},ontimeout:()=>{Fi(),m(xe(w,"network-request-failed"))},timeout:Hc.get()})}if(null===(z=null===(T=Qr().gapi)||void 0===T?void 0:T.iframes)||void 0===z?void 0:z.Iframe)f(gapi.iframes.getContext());else{if(!(null===(re=Qr().gapi)||void 0===re?void 0:re.load)){const ct=Dn("iframefcb");return Qr()[ct]=()=>{gapi.load?Le():m(xe(w,"network-request-failed"))},Lo(`https://apis.google.com/js/api.js?onload=${ct}`).catch(Lt=>m(Lt))}Le()}}).catch(f=>{throw dl=null,f})}(w),dl}const hl=new en(5e3,15e3),Ja={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ic=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dd(w){const f=w.config;V(f.authDomain,w,"auth-domain-config-required");const m=f.emulator?on(f,"emulator/auth/iframe"):`https://${w.config.authDomain}/__/auth/iframe`,T={apiKey:f.apiKey,appName:w.name,v:be.SDK_VERSION},z=ic.get(w.config.apiHost);z&&(T.eid=z);const re=w._getFrameworks();return re.length&&(T.fw=re.join(",")),`${m}?${(0,ie.xO)(T).slice(1)}`}function Iu(){return Iu=(0,_.Z)(function*(w){const f=yield su(w),m=Qr().gapi;return V(m,w,"internal-error"),f.open({where:document.body,url:Dd(w),messageHandlersFilter:m.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ja,dontclear:!0},T=>new Promise(function(){var z=(0,_.Z)(function*(re,Le){yield T.restyle({setHideOnLeave:!1});const ct=xe(w,"network-request-failed"),Lt=Qr().setTimeout(()=>{Le(ct)},hl.get());function rn(){Qr().clearTimeout(Lt),re(T)}T.ping(rn).then(rn,()=>{Le(ct)})});return function(re,Le){return z.apply(this,arguments)}}()))}),Iu.apply(this,arguments)}const Gc={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Sd{constructor(f){this.window=f,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(f){}}}function Cu(w,f,m,T,z,re){V(w.config.authDomain,w,"auth-domain-config-required"),V(w.config.apiKey,w,"invalid-api-key");const Le={apiKey:w.config.apiKey,appName:w.name,authType:m,redirectUrl:T,v:be.SDK_VERSION,eventId:z};if(f instanceof ti){f.setDefaultLanguage(w.languageCode),Le.providerId=f.providerId||"",(0,ie.xb)(f.getCustomParameters())||(Le.customParameters=JSON.stringify(f.getCustomParameters()));for(const[Lt,rn]of Object.entries(re||{}))Le[Lt]=rn}if(f instanceof is){const Lt=f.getScopes().filter(rn=>""!==rn);Lt.length>0&&(Le.scopes=Lt.join(","))}w.tenantId&&(Le.tid=w.tenantId);const ct=Le;for(const Lt of Object.keys(ct))void 0===ct[Lt]&&delete ct[Lt];return`${function fl({config:w}){return w.emulator?on(w,"emulator/auth/handler"):`https://${w.authDomain}/__/auth/handler`}(w)}?${(0,ie.xO)(ct).slice(1)}`}const Ks="webStorageSupport";class gl extends class gh{constructor(f){this.factorId=f}_process(f,m,T){switch(m.type){case"enroll":return this._finalizeEnroll(f,m.credential,T);case"signin":return this._finalizeSignIn(f,m.credential);default:return ut("unexpected MultiFactorSessionType")}}}{constructor(f){super("phone"),this.credential=f}static _fromCredential(f){return new gl(f)}_finalizeEnroll(f,m,T){return function $s(w,f){return Yt(w,"POST","/v2/accounts/mfaEnrollment:finalize",zt(w,f))}(f,{idToken:m,displayName:T,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(f,m){return function _r(w,f){return Yt(w,"POST","/v2/accounts/mfaSignIn:finalize",zt(w,f))}(f,{mfaPendingCredential:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let bu=(()=>{class w{constructor(){}static assertion(m){return gl._fromCredential(m)}}return w.FACTOR_ID="phone",w})();var Du="@firebase/auth";class as{constructor(f){this.auth=f,this.internalListeners=new Map}getUid(){var f;return this.assertAuthConfigured(),(null===(f=this.auth.currentUser)||void 0===f?void 0:f.uid)||null}getToken(f){var m=this;return(0,_.Z)(function*(){return m.assertAuthConfigured(),yield m.auth._initializationPromise,m.auth.currentUser?{accessToken:yield m.auth.currentUser.getIdToken(f)}:null})()}addAuthTokenListener(f){if(this.assertAuthConfigured(),this.internalListeners.has(f))return;const m=this.auth.onIdTokenChanged(T=>{var z;f((null===(z=T)||void 0===z?void 0:z.stsTokenManager.accessToken)||null)});this.internalListeners.set(f,m),this.updateProactiveRefresh()}removeAuthTokenListener(f){this.assertAuthConfigured();const m=this.internalListeners.get(f);!m||(this.internalListeners.delete(f),m(),this.updateProactiveRefresh())}assertAuthConfigured(){V(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function ga(){return window}function Tu(){return(Tu=(0,_.Z)(function*(w,f,m){var T;const{BuildInfo:z}=ga();ge(f.sessionId,"AuthEvent did not contain a session ID");const re=yield lc(f.sessionId),Le={};return si()?Le.ibi=z.packageName:ii()?Le.apn=z.packageName:ht(w,"operation-not-supported-in-this-environment"),z.displayName&&(Le.appDisplayName=z.displayName),Le.sessionId=re,Cu(w,m,f.type,void 0,null!==(T=f.eventId)&&void 0!==T?T:void 0,Le)})).apply(this,arguments)}function kl(){return(kl=(0,_.Z)(function*(w){const{BuildInfo:f}=ga(),m={};si()?m.iosBundleId=f.packageName:ii()?m.androidPackageName=f.packageName:ht(w,"operation-not-supported-in-this-environment"),yield Qa(w,m)})).apply(this,arguments)}function ml(){return(ml=(0,_.Z)(function*(w,f,m){const{cordova:T}=ga();let z=()=>{};try{yield new Promise((re,Le)=>{let ct=null;function Lt(){var xn;re();const fs=null===(xn=T.plugins.browsertab)||void 0===xn?void 0:xn.close;"function"==typeof fs&&fs(),"function"==typeof(null==m?void 0:m.close)&&m.close()}function rn(){ct||(ct=window.setTimeout(()=>{Le(xe(w,"redirect-cancelled-by-user"))},2e3))}function $n(){"visible"===(null==document?void 0:document.visibilityState)&&rn()}f.addPassiveListener(Lt),document.addEventListener("resume",rn,!1),ii()&&document.addEventListener("visibilitychange",$n,!1),z=()=>{f.removePassiveListener(Lt),document.removeEventListener("resume",rn,!1),document.removeEventListener("visibilitychange",$n,!1),ct&&window.clearTimeout(ct)}})}finally{z()}})).apply(this,arguments)}function lc(w){return Yu.apply(this,arguments)}function Yu(){return(Yu=(0,_.Z)(function*(w){const f=Su(w),m=yield crypto.subtle.digest("SHA-256",f);return Array.from(new Uint8Array(m)).map(z=>z.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Su(w){if(ge(/[0-9a-zA-Z]+/.test(w),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(w);const f=new ArrayBuffer(w.length),m=new Uint8Array(f);for(let T=0;T<w.length;T++)m[T]=w.charCodeAt(T);return m}!function oc(w){(0,be._registerComponent)(new Ve.wA("auth",(f,{options:m})=>{const T=f.getProvider("app").getImmediate(),z=f.getProvider("heartbeat"),{apiKey:re,authDomain:Le}=T.options;return((ct,Lt)=>{V(re&&!re.includes(":"),"invalid-api-key",{appName:ct.name}),V(!(null==Le?void 0:Le.includes(":")),"argument-error",{appName:ct.name});const rn={apiKey:re,authDomain:Le,clientPlatform:w,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ui(w)},$n=new Tt(ct,Lt,rn);return function Ye(w,f){const m=(null==f?void 0:f.persistence)||[],T=(Array.isArray(m)?m:[m]).map(Ue);(null==f?void 0:f.errorMap)&&w._updateErrorMap(f.errorMap),w._initializeWithPersistence(T,null==f?void 0:f.popupRedirectResolver)}($n,m),$n})(T,z)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((f,m,T)=>{f.getProvider("auth-internal").initialize()})),(0,be._registerComponent)(new Ve.wA("auth-internal",f=>{const m=Ht(f.getProvider("auth").getImmediate());return new as(m)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,be.registerVersion)(Du,"0.20.4",function Wc(w){switch(w){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(w)),(0,be.registerVersion)(Du,"0.20.4","esm2017")}("Browser");class cc extends go{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(f=>{this.resolveInialized=f})}addPassiveListener(f){this.passiveListeners.add(f)}removePassiveListener(f){this.passiveListeners.delete(f)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(f){return this.resolveInialized(),this.passiveListeners.forEach(m=>m(f)),super.onEvent(f)}initialized(){var f=this;return(0,_.Z)(function*(){yield f.initPromise})()}}function Qu(w){return hc.apply(this,arguments)}function hc(){return(hc=(0,_.Z)(function*(w){const f=yield yl()._get(qc(w));return f&&(yield yl()._remove(qc(w))),f})).apply(this,arguments)}function Ju(){const w=[],f="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let m=0;m<20;m++){const T=Math.floor(Math.random()*f.length);w.push(f.charAt(T))}return w.join("")}function yl(){return Ue(Zo)}function qc(w){return an("authEvent",w.config.apiKey,w.name)}function xi(w){if(!(null==w?void 0:w.includes("?")))return{};const[f,...m]=w.split("?");return(0,ie.zd)(m.join("?"))}function Zc(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:xe("no-auth-event")}}function vl(){var w;return(null===(w=null==self?void 0:self.location)||void 0===w?void 0:w.protocol)||null}function tl(w=(0,ie.z$)()){return!("file:"!==vl()&&"ionic:"!==vl()&&"capacitor:"!==vl()||!w.toLowerCase().match(/iphone|ipad|ipod|android/))}function pc(){try{const w=self.localStorage,f=Hs();if(w)return w.setItem(f,"1"),w.removeItem(f),!function kr(w=(0,ie.z$)()){return function io(){return(0,ie.w1)()&&11===(null==document?void 0:document.documentMode)}()||function Ji(w=(0,ie.z$)()){return/Edge\/\d+/.test(w)}(w)}()||(0,ie.hl)()}catch(w){return qs()&&(0,ie.hl)()}return!1}function qs(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Do(){return(function Rd(){return"http:"===vl()||"https:"===vl()}()||(0,ie.ru)()||tl())&&!function Ru(){return(0,ie.b$)()||(0,ie.UG)()}()&&pc()&&!qs()}function gc(){return tl()&&"undefined"!=typeof document}function Fl(){return(Fl=(0,_.Z)(function*(){return!!gc()&&new Promise(w=>{const f=setTimeout(()=>{w(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(f),w(!0)})})})).apply(this,arguments)}const Ho={LOCAL:"local",NONE:"none",SESSION:"session"},Ii=V,El="persistence";function wl(w){return ra.apply(this,arguments)}function ra(){return(ra=(0,_.Z)(function*(w){yield w._initializationPromise;const f=Yc(),m=an(El,w.config.apiKey,w.name);f&&f.setItem(m,w._getPersistence())})).apply(this,arguments)}function Yc(){var w;try{return(null===(w=function nl(){return"undefined"!=typeof window?window:null}())||void 0===w?void 0:w.sessionStorage)||null}catch(f){return null}}const Ll=V;class Vs{constructor(){this.browserResolver=Ue(class Ol{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eo,this._completeRedirectFn=Bo,this._overrideRedirectResult=j}_openPopup(f,m,T,z){var re=this;return(0,_.Z)(function*(){var Le;ge(null===(Le=re.eventManagers[f._key()])||void 0===Le?void 0:Le.manager,"_initialize() not called before _openPopup()");const ct=Cu(f,m,T,St(),z);return function ph(w,f,m,T=500,z=600){const re=Math.max((window.screen.availHeight-z)/2,0).toString(),Le=Math.max((window.screen.availWidth-T)/2,0).toString();let ct="";const Lt=Object.assign(Object.assign({},Gc),{width:T.toString(),height:z.toString(),top:re,left:Le}),rn=(0,ie.z$)().toLowerCase();m&&(ct=yn(rn)?"_blank":m),Gr(rn)&&(f=f||"http://localhost",Lt.scrollbars="yes");const $n=Object.entries(Lt).reduce((fs,[sa,jl])=>`${fs}${sa}=${jl},`,"");if(function Vi(w=(0,ie.z$)()){var f;return si(w)&&!!(null===(f=window.navigator)||void 0===f?void 0:f.standalone)}(rn)&&"_self"!==ct)return function Xa(w,f){const m=document.createElement("a");m.href=w,m.target=f;const T=document.createEvent("MouseEvent");T.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),m.dispatchEvent(T)}(f||"",ct),new Sd(null);const xn=window.open(f||"",ct,$n);V(xn,w,"popup-blocked");try{xn.focus()}catch(fs){}return new Sd(xn)}(f,ct,Hs())})()}_openRedirect(f,m,T,z){var re=this;return(0,_.Z)(function*(){return yield re._originValidation(f),function ka(w){Qr().location.href=w}(Cu(f,m,T,St(),z)),new Promise(()=>{})})()}_initialize(f){const m=f._key();if(this.eventManagers[m]){const{manager:z,promise:re}=this.eventManagers[m];return z?Promise.resolve(z):(ge(re,"If manager is not set, promise should be"),re)}const T=this.initAndGetManager(f);return this.eventManagers[m]={promise:T},T.catch(()=>{delete this.eventManagers[m]}),T}initAndGetManager(f){var m=this;return(0,_.Z)(function*(){const T=yield function Ls(w){return Iu.apply(this,arguments)}(f),z=new go(f);return T.register("authEvent",re=>(V(null==re?void 0:re.authEvent,f,"invalid-auth-event"),{status:z.onEvent(re.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),m.eventManagers[f._key()]={manager:z},m.iframes[f._key()]=T,z})()}_isIframeWebStorageSupported(f,m){this.iframes[f._key()].send(Ks,{type:Ks},z=>{var re;const Le=null===(re=null==z?void 0:z[0])||void 0===re?void 0:re[Ks];void 0!==Le&&m(!!Le),ht(f,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(f){const m=f._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function rc(w){return Pl.apply(this,arguments)}(f)),this.originValidationPromises[m]}get _shouldInitProactively(){return Er()||_i()||si()}}),this.cordovaResolver=Ue(class Xu{constructor(){this._redirectPersistence=eo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Bo,this._overrideRedirectResult=j}_initialize(f){var m=this;return(0,_.Z)(function*(){const T=f._key();let z=m.eventManagers.get(T);return z||(z=new cc(f),m.eventManagers.set(T,z),m.attachCallbackListeners(f,z)),z})()}_openPopup(f){ht(f,"operation-not-supported-in-this-environment")}_openRedirect(f,m,T,z){var re=this;return(0,_.Z)(function*(){!function uc(w){var f,m,T,z,re,Le,ct,Lt,rn,$n;const xn=ga();V("function"==typeof(null===(f=null==xn?void 0:xn.universalLinks)||void 0===f?void 0:f.subscribe),w,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),V(void 0!==(null===(m=null==xn?void 0:xn.BuildInfo)||void 0===m?void 0:m.packageName),w,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),V("function"==typeof(null===(re=null===(z=null===(T=null==xn?void 0:xn.cordova)||void 0===T?void 0:T.plugins)||void 0===z?void 0:z.browsertab)||void 0===re?void 0:re.openUrl),w,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V("function"==typeof(null===(Lt=null===(ct=null===(Le=null==xn?void 0:xn.cordova)||void 0===Le?void 0:Le.plugins)||void 0===ct?void 0:ct.browsertab)||void 0===Lt?void 0:Lt.isAvailable),w,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V("function"==typeof(null===($n=null===(rn=null==xn?void 0:xn.cordova)||void 0===rn?void 0:rn.InAppBrowser)||void 0===$n?void 0:$n.open),w,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(f);const Le=yield re._initialize(f);yield Le.initialized(),Le.resetRedirect(),function L(){Wi.clear()}(),yield re._originValidation(f);const ct=function xu(w,f,m=null){return{type:f,eventId:m,urlResponse:null,sessionId:Ju(),postBody:null,tenantId:w.tenantId,error:xe(w,"no-auth-event")}}(f,T,z);yield function dc(w,f){return yl()._set(qc(w),f)}(f,ct);const Lt=yield function Ta(w,f,m){return Tu.apply(this,arguments)}(f,ct,m),rn=yield function Kc(w){const{cordova:f}=ga();return new Promise(m=>{f.plugins.browsertab.isAvailable(T=>{let z=null;T?f.plugins.browsertab.openUrl(w):z=f.InAppBrowser.open(w,function ys(w=(0,ie.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(w)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(w)}()?"_blank":"_system","location=yes"),m(z)})})}(Lt);return function mh(w,f,m){return ml.apply(this,arguments)}(f,Le,rn)})()}_isIframeWebStorageSupported(f,m){throw new Error("Method not implemented.")}_originValidation(f){const m=f._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function zc(w){return kl.apply(this,arguments)}(f)),this.originValidationPromises[m]}attachCallbackListeners(f,m){const{universalLinks:T,handleOpenURL:z,BuildInfo:re}=ga(),Le=setTimeout((0,_.Z)(function*(){yield Qu(f),m.onEvent(Zc())}),500),ct=function(){var $n=(0,_.Z)(function*(xn){clearTimeout(Le);const fs=yield Qu(f);let sa=null;fs&&(null==xn?void 0:xn.url)&&(sa=function Ad(w,f){var m,T;const z=function _l(w){const f=xi(w),m=f.link?decodeURIComponent(f.link):void 0,T=xi(m).link,z=f.deep_link_id?decodeURIComponent(f.deep_link_id):void 0;return xi(z).link||z||T||m||w}(f);if(z.includes("/__/auth/callback")){const re=xi(z),Le=re.firebaseError?function zi(w){try{return JSON.parse(w)}catch(f){return null}}(decodeURIComponent(re.firebaseError)):null,ct=null===(T=null===(m=null==Le?void 0:Le.code)||void 0===m?void 0:m.split("auth/"))||void 0===T?void 0:T[1],Lt=ct?xe(ct):null;return Lt?{type:w.type,eventId:w.eventId,tenantId:w.tenantId,error:Lt,urlResponse:null,sessionId:null,postBody:null}:{type:w.type,eventId:w.eventId,tenantId:w.tenantId,sessionId:w.sessionId,urlResponse:z,postBody:null}}return null}(fs,xn.url)),m.onEvent(sa||Zc())});return function(fs){return $n.apply(this,arguments)}}();void 0!==T&&"function"==typeof T.subscribe&&T.subscribe(null,ct);const Lt=z,rn=`${re.packageName.toLowerCase()}://`;ga().handleOpenURL=function(){var $n=(0,_.Z)(function*(xn){if(xn.toLowerCase().startsWith(rn)&&ct({url:xn}),"function"==typeof Lt)try{Lt(xn)}catch(fs){console.error(fs)}});return function(xn){return $n.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=eo,this._completeRedirectFn=Bo,this._overrideRedirectResult=j}_initialize(f){var m=this;return(0,_.Z)(function*(){return yield m.selectUnderlyingResolver(),m.assertedUnderlyingResolver._initialize(f)})()}_openPopup(f,m,T,z){var re=this;return(0,_.Z)(function*(){return yield re.selectUnderlyingResolver(),re.assertedUnderlyingResolver._openPopup(f,m,T,z)})()}_openRedirect(f,m,T,z){var re=this;return(0,_.Z)(function*(){return yield re.selectUnderlyingResolver(),re.assertedUnderlyingResolver._openRedirect(f,m,T,z)})()}_isIframeWebStorageSupported(f,m){this.assertedUnderlyingResolver._isIframeWebStorageSupported(f,m)}_originValidation(f){return this.assertedUnderlyingResolver._originValidation(f)}get _shouldInitProactively(){return gc()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Ll(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var f=this;return(0,_.Z)(function*(){if(f.underlyingResolver)return;const m=yield function $o(){return Fl.apply(this,arguments)}();f.underlyingResolver=m?f.cordovaResolver:f.browserResolver})()}}function Vl(w){return w.unwrap()}function Ul(w){return Qc(w)}function Qc(w){const{_tokenResponse:f}=w instanceof ie.ZR?w.customData:w;if(!f)return null;if(!(w instanceof ie.ZR)&&"temporaryProof"in f&&"phoneNumber"in f)return Co.credentialFromResult(w);const m=f.providerId;if(!m||"password"===m)return null;let T;switch(m){case"google.com":T=ls;break;case"facebook.com":T=vs;break;case"github.com":T=Es;break;case"twitter.com":T=co;break;default:const{oauthIdToken:z,oauthAccessToken:re,oauthTokenSecret:Le,pendingToken:ct,nonce:Lt}=f;return re||Le||z||ct?ct?m.startsWith("saml.")?Ei._create(m,ct):He._fromParams({providerId:m,signInMethod:m,pendingToken:ct,idToken:z,accessToken:re}):new ss(m).credential({idToken:z,accessToken:re,rawNonce:Lt}):null}return w instanceof ie.ZR?T.credentialFromError(w):T.credentialFromResult(w)}function ia(w,f){return f.catch(m=>{throw m instanceof ie.ZR&&function yc(w,f){var m,T;const z=null===(m=f.customData)||void 0===m?void 0:m._tokenResponse;if("auth/multi-factor-auth-required"===(null===(T=f)||void 0===T?void 0:T.code))f.resolver=new Bl(w,function mr(w,f){var m;const T=(0,ie.m9)(w),z=f;return V(f.customData.operationType,T,"argument-error"),V(null===(m=z.customData._serverResponse)||void 0===m?void 0:m.mfaPendingCredential,T,"argument-error"),qo._fromError(T,z)}(w,f));else if(z){const re=Qc(f),Le=f;re&&(Le.credential=re,Le.tenantId=z.tenantId||void 0,Le.email=z.email||void 0,Le.phoneNumber=z.phoneNumber||void 0)}}(w,m),m}).then(m=>{const z=m.user;return{operationType:m.operationType,credential:Ul(m),additionalUserInfo:fo(m),user:Sa.getOrCreate(z)}})}function _c(w,f){return vc.apply(this,arguments)}function vc(){return(vc=(0,_.Z)(function*(w,f){const m=yield f;return{verificationId:m.verificationId,confirm:T=>ia(w,m.confirm(T))}})).apply(this,arguments)}class Bl{constructor(f,m){this.resolver=m,this.auth=function mc(w){return w.wrapped()}(f)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(f){return ia(Vl(this.auth),this.resolver.resolveSignIn(f))}}class Sa{constructor(f){this._delegate=f,this.multiFactor=function ko(w){const f=(0,ie.m9)(w);return Oo.has(f)||Oo.set(f,Oa._fromUser(f)),Oo.get(f)}(f)}static getOrCreate(f){return Sa.USER_MAP.has(f)||Sa.USER_MAP.set(f,new Sa(f)),Sa.USER_MAP.get(f)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(f){return this._delegate.getIdTokenResult(f)}getIdToken(f){return this._delegate.getIdToken(f)}linkAndRetrieveDataWithCredential(f){return this.linkWithCredential(f)}linkWithCredential(f){var m=this;return(0,_.Z)(function*(){return ia(m.auth,kn(m._delegate,f))})()}linkWithPhoneNumber(f,m){var T=this;return(0,_.Z)(function*(){return _c(T.auth,function bd(w,f,m){return Ia.apply(this,arguments)}(T._delegate,f,m))})()}linkWithPopup(f){var m=this;return(0,_.Z)(function*(){return ia(m.auth,function Os(w,f,m){return Sr.apply(this,arguments)}(m._delegate,f,Vs))})()}linkWithRedirect(f){var m=this;return(0,_.Z)(function*(){return yield wl(Ht(m.auth)),function ir(w,f,m){return function _n(w,f,m){return Jr.apply(this,arguments)}(w,f,m)}(m._delegate,f,Vs)})()}reauthenticateAndRetrieveDataWithCredential(f){return this.reauthenticateWithCredential(f)}reauthenticateWithCredential(f){var m=this;return(0,_.Z)(function*(){return ia(m.auth,qr(m._delegate,f))})()}reauthenticateWithPhoneNumber(f,m){return _c(this.auth,function Io(w,f,m){return Qe.apply(this,arguments)}(this._delegate,f,m))}reauthenticateWithPopup(f){return ia(this.auth,function Oi(w,f,m){return Uo.apply(this,arguments)}(this._delegate,f,Vs))}reauthenticateWithRedirect(f){var m=this;return(0,_.Z)(function*(){return yield wl(Ht(m.auth)),function Ot(w,f,m){return function Nn(w,f,m){return jn.apply(this,arguments)}(w,f,m)}(m._delegate,f,Vs)})()}sendEmailVerification(f){return function Ms(w,f){return Xn.apply(this,arguments)}(this._delegate,f)}unlink(f){var m=this;return(0,_.Z)(function*(){return yield function Rs(w,f){return On.apply(this,arguments)}(m._delegate,f),m})()}updateEmail(f){return function ju(w,f){return zo((0,ie.m9)(w),f,null)}(this._delegate,f)}updatePassword(f){return function Ea(w,f){return zo((0,ie.m9)(w),null,f)}(this._delegate,f)}updatePhoneNumber(f){return function Za(w,f){return pa.apply(this,arguments)}(this._delegate,f)}updateProfile(f){return function xo(w,f){return Ro.apply(this,arguments)}(this._delegate,f)}verifyBeforeUpdateEmail(f,m){return function Pi(w,f,m){return Js.apply(this,arguments)}(this._delegate,f,m)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Sa.USER_MAP=new WeakMap;const du=V;let Mu=(()=>{class w{constructor(m,T){if(this.app=m,T.isInitialized())return this._delegate=T.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:z}=m.options;du(z,"invalid-api-key",{appName:m.name}),du(z,"invalid-api-key",{appName:m.name});const re="undefined"!=typeof window?Vs:void 0;this._delegate=T.initialize({options:{persistence:Md(z,m.name),popupRedirectResolver:re}}),this._delegate._updateErrorMap(at),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Sa.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(m){this._delegate.languageCode=m}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(m){this._delegate.tenantId=m}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(m,T){!function zr(w,f,m){const T=Ht(w);V(T._canInitEmulator,T,"emulator-config-failed"),V(/^https?:\/\//.test(f),T,"invalid-emulator-scheme");const z=!!(null==m?void 0:m.disableWarnings),re=bi(f),{host:Le,port:ct}=function Rr(w){const f=bi(w),m=/(\/\/)?([^?#/]+)/.exec(w.substr(f.length));if(!m)return{host:"",port:null};const T=m[2].split("@").pop()||"",z=/^(\[[^\]]+\])(:|$)/.exec(T);if(z){const re=z[1];return{host:re,port:Ki(T.substr(re.length+1))}}{const[re,Le]=T.split(":");return{host:re,port:Ki(Le)}}}(f);T.config.emulator={url:`${re}//${Le}${null===ct?"":`:${ct}`}/`},T.settings.appVerificationDisabledForTesting=!0,T.emulatorConfig=Object.freeze({host:Le,port:ct,protocol:re.replace(":",""),options:Object.freeze({disableWarnings:z})}),z||function pr(){function w(){const f=document.createElement("p"),m=f.style;f.innerText="Running in emulator mode. Do not use with production credentials.",m.position="fixed",m.width="100%",m.backgroundColor="#ffffff",m.border=".1em solid #000000",m.color="#b50000",m.bottom="0px",m.left="0px",m.margin="0px",m.zIndex="10000",m.textAlign="center",f.classList.add("firebase-emulator-warning"),document.body.appendChild(f)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",w):w())}()}(this._delegate,m,T)}applyActionCode(m){return function E(w,f){return R.apply(this,arguments)}(this._delegate,m)}checkActionCode(m){return Y(this._delegate,m)}confirmPasswordReset(m,T){return function k(w,f,m){return F.apply(this,arguments)}(this._delegate,m,T)}createUserWithEmailAndPassword(m,T){var z=this;return(0,_.Z)(function*(){return ia(z._delegate,function mt(w,f,m){return Gt.apply(this,arguments)}(z._delegate,m,T))})()}fetchProvidersForEmail(m){return this.fetchSignInMethodsForEmail(m)}fetchSignInMethodsForEmail(m){return function Cr(w,f){return gi.apply(this,arguments)}(this._delegate,m)}isSignInWithEmailLink(m){return function Br(w,f){const m=_s.parseLink(f);return"EMAIL_SIGNIN"===(null==m?void 0:m.operation)}(0,m)}getRedirectResult(){var m=this;return(0,_.Z)(function*(){du(Do(),m._delegate,"operation-not-supported-in-this-environment");const T=yield function zs(w,f){return ks.apply(this,arguments)}(m._delegate,Vs);return T?ia(m._delegate,Promise.resolve(T)):{credential:null,user:null}})()}addFrameworkForLogging(m){!function fc(w,f){Ht(w)._logFramework(f)}(this._delegate,m)}onAuthStateChanged(m,T,z){const{next:re,error:Le,complete:ct}=Ec(m,T,z);return this._delegate.onAuthStateChanged(re,Le,ct)}onIdTokenChanged(m,T,z){const{next:re,error:Le,complete:ct}=Ec(m,T,z);return this._delegate.onIdTokenChanged(re,Le,ct)}sendSignInLinkToEmail(m,T){return function Bn(w,f,m){return cr.apply(this,arguments)}(this._delegate,m,T)}sendPasswordResetEmail(m,T){return function Ni(w,f,m){return G.apply(this,arguments)}(this._delegate,m,T||void 0)}setPersistence(m){var T=this;return(0,_.Z)(function*(){let z;switch(function ma(w,f){Ii(Object.values(Ho).includes(f),w,"invalid-persistence-type"),(0,ie.b$)()?Ii(f!==Ho.SESSION,w,"unsupported-persistence-type"):(0,ie.UG)()?Ii(f===Ho.NONE,w,"unsupported-persistence-type"):qs()?Ii(f===Ho.NONE||f===Ho.LOCAL&&(0,ie.hl)(),w,"unsupported-persistence-type"):Ii(f===Ho.NONE||pc(),w,"unsupported-persistence-type")}(T._delegate,m),m){case Ho.SESSION:z=eo;break;case Ho.LOCAL:z=(yield Ue(pn)._isAvailable())?pn:Zo;break;case Ho.NONE:z=lr;break;default:return ht("argument-error",{appName:T._delegate.name})}return T._delegate.setPersistence(z)})()}signInAndRetrieveDataWithCredential(m){return this.signInWithCredential(m)}signInAnonymously(){return ia(this._delegate,function Cn(w){return xs.apply(this,arguments)}(this._delegate))}signInWithCredential(m){return ia(this._delegate,wn(this._delegate,m))}signInWithCustomToken(m){return ia(this._delegate,function pi(w,f){return fn.apply(this,arguments)}(this._delegate,m))}signInWithEmailAndPassword(m,T){return ia(this._delegate,function Ut(w,f,m){return wn((0,ie.m9)(w),ji.credential(f,m))}(this._delegate,m,T))}signInWithEmailLink(m,T){return ia(this._delegate,function Or(w,f,m){return rr.apply(this,arguments)}(this._delegate,m,T))}signInWithPhoneNumber(m,T){return _c(this._delegate,function zu(w,f,m){return qa.apply(this,arguments)}(this._delegate,m,T))}signInWithPopup(m){var T=this;return(0,_.Z)(function*(){return du(Do(),T._delegate,"operation-not-supported-in-this-environment"),ia(T._delegate,function Ya(w,f,m){return Ua.apply(this,arguments)}(T._delegate,m,Vs))})()}signInWithRedirect(m){var T=this;return(0,_.Z)(function*(){return du(Do(),T._delegate,"operation-not-supported-in-this-environment"),yield wl(T._delegate),function $e(w,f,m){return function Xe(w,f,m){return Ct.apply(this,arguments)}(w,f,m)}(T._delegate,m,Vs)})()}updateCurrentUser(m){return this._delegate.updateCurrentUser(m)}verifyPasswordResetCode(m){return function Te(w,f){return Ke.apply(this,arguments)}(this._delegate,m)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return w.Persistence=Ho,w})();function Ec(w,f,m){let T=w;"function"!=typeof w&&({next:T,error:f,complete:m}=w);const z=T;return{next:Le=>z(Le&&Sa.getOrCreate(Le)),error:f,complete:m}}function Md(w,f){const m=function Kn(w,f){const m=Yc();if(!m)return[];const T=an(El,w,f);switch(m.getItem(T)){case Ho.NONE:return[lr];case Ho.LOCAL:return[pn,eo];case Ho.SESSION:return[eo];default:return[]}}(w,f);if("undefined"!=typeof self&&!m.includes(pn)&&m.push(pn),"undefined"!=typeof window)for(const T of[Zo,eo])m.includes(T)||m.push(T);return m.includes(lr)||m.push(lr),m}class Cs{constructor(){this.providerId="phone",this._delegate=new Co(Vl(ne.Z.auth()))}static credential(f,m){return Co.credential(f,m)}verifyPhoneNumber(f,m){return this._delegate.verifyPhoneNumber(f,m)}unwrap(){return this._delegate}}Cs.PHONE_SIGN_IN_METHOD=Co.PHONE_SIGN_IN_METHOD,Cs.PROVIDER_ID=Co.PROVIDER_ID;const wc=V;class Jc{constructor(f,m,T=ne.Z.app()){var z;wc(null===(z=T.options)||void 0===z?void 0:z.apiKey,"invalid-api-key",{appName:T.name}),this._delegate=new iu(f,m,T.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Bs(w){w.INTERNAL.registerComponent(new Ve.wA("auth-compat",f=>{const m=f.getProvider("app-compat").getImmediate(),T=f.getProvider("auth");return new Mu(m,T)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:ji,FacebookAuthProvider:vs,GithubAuthProvider:Es,GoogleAuthProvider:ls,OAuthProvider:ss,SAMLAuthProvider:wi,PhoneAuthProvider:Cs,PhoneMultiFactorGenerator:bu,RecaptchaVerifier:Jc,TwitterAuthProvider:co,Auth:Mu,AuthCredential:Mi,Error:ie.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),w.registerVersion("@firebase/auth-compat","0.2.17")}(ne.Z)},1135:(Ft,We,$)=>{$.d(We,{X:()=>ne});var _=$(7579);class ne extends _.x{constructor(be){super(),this._value=be}get value(){return this.getValue()}_subscribe(be){const Ce=super._subscribe(be);return!Ce.closed&&be.next(this._value),Ce}getValue(){const{hasError:be,thrownError:Ce,_value:Se}=this;if(be)throw Ce;return this._throwIfClosed(),Se}next(be){super.next(this._value=be)}}},8306:(Ft,We,$)=>{$.d(We,{y:()=>ce});var _=$(930),ne=$(727),ie=$(8822),be=$(4671);var Ve=$(2416),Me=$(576),Be=$(2806);let ce=(()=>{class ot{constructor(Dt){Dt&&(this._subscribe=Dt)}lift(Dt){const nt=new ot;return nt.source=this,nt.operator=Dt,nt}subscribe(Dt,nt,ft){const De=function Rt(ot){return ot&&ot instanceof _.Lv||function Re(ot){return ot&&(0,Me.m)(ot.next)&&(0,Me.m)(ot.error)&&(0,Me.m)(ot.complete)}(ot)&&(0,ne.Nn)(ot)}(Dt)?Dt:new _.Hp(Dt,nt,ft);return(0,Be.x)(()=>{const{operator:kt,source:ht}=this;De.add(kt?kt.call(De,ht):ht?this._subscribe(De):this._trySubscribe(De))}),De}_trySubscribe(Dt){try{return this._subscribe(Dt)}catch(nt){Dt.error(nt)}}forEach(Dt,nt){return new(nt=ae(nt))((ft,De)=>{const kt=new _.Hp({next:ht=>{try{Dt(ht)}catch(xe){De(xe),kt.unsubscribe()}},error:De,complete:ft});this.subscribe(kt)})}_subscribe(Dt){var nt;return null===(nt=this.source)||void 0===nt?void 0:nt.subscribe(Dt)}[ie.L](){return this}pipe(...Dt){return function Se(ot){return 0===ot.length?be.y:1===ot.length?ot[0]:function(Dt){return ot.reduce((nt,ft)=>ft(nt),Dt)}}(Dt)(this)}toPromise(Dt){return new(Dt=ae(Dt))((nt,ft)=>{let De;this.subscribe(kt=>De=kt,kt=>ft(kt),()=>nt(De))})}}return ot.create=at=>new ot(at),ot})();function ae(ot){var at;return null!==(at=null!=ot?ot:Ve.v.Promise)&&void 0!==at?at:Promise}},7579:(Ft,We,$)=>{$.d(We,{x:()=>Ve});var _=$(8306),ne=$(727);const be=(0,$(3888).d)(Be=>function(){Be(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ce=$(8737),Se=$(2806);let Ve=(()=>{class Be extends _.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ae){const Re=new Me(this,this);return Re.operator=ae,Re}_throwIfClosed(){if(this.closed)throw new be}next(ae){(0,Se.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Re of this.currentObservers)Re.next(ae)}})}error(ae){(0,Se.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ae;const{observers:Re}=this;for(;Re.length;)Re.shift().error(ae)}})}complete(){(0,Se.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ae}=this;for(;ae.length;)ae.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ae;return(null===(ae=this.observers)||void 0===ae?void 0:ae.length)>0}_trySubscribe(ae){return this._throwIfClosed(),super._trySubscribe(ae)}_subscribe(ae){return this._throwIfClosed(),this._checkFinalizedStatuses(ae),this._innerSubscribe(ae)}_innerSubscribe(ae){const{hasError:Re,isStopped:Rt,observers:ot}=this;return Re||Rt?ne.Lc:(this.currentObservers=null,ot.push(ae),new ne.w0(()=>{this.currentObservers=null,(0,Ce.P)(ot,ae)}))}_checkFinalizedStatuses(ae){const{hasError:Re,thrownError:Rt,isStopped:ot}=this;Re?ae.error(Rt):ot&&ae.complete()}asObservable(){const ae=new _.y;return ae.source=this,ae}}return Be.create=(ce,ae)=>new Me(ce,ae),Be})();class Me extends Ve{constructor(ce,ae){super(),this.destination=ce,this.source=ae}next(ce){var ae,Re;null===(Re=null===(ae=this.destination)||void 0===ae?void 0:ae.next)||void 0===Re||Re.call(ae,ce)}error(ce){var ae,Re;null===(Re=null===(ae=this.destination)||void 0===ae?void 0:ae.error)||void 0===Re||Re.call(ae,ce)}complete(){var ce,ae;null===(ae=null===(ce=this.destination)||void 0===ce?void 0:ce.complete)||void 0===ae||ae.call(ce)}_subscribe(ce){var ae,Re;return null!==(Re=null===(ae=this.source)||void 0===ae?void 0:ae.subscribe(ce))&&void 0!==Re?Re:ne.Lc}}},930:(Ft,We,$)=>{$.d(We,{Hp:()=>Dt,Lv:()=>Re});var _=$(576),ne=$(727),ie=$(2416),be=$(7849),Ce=$(5032);const Se=Be("C",void 0,void 0);function Be(ht,xe,Ge){return{kind:ht,value:xe,error:Ge}}var ce=$(3410),ae=$(2806);class Re extends ne.w0{constructor(xe){super(),this.isStopped=!1,xe?(this.destination=xe,(0,ne.Nn)(xe)&&xe.add(this)):this.destination=kt}static create(xe,Ge,wt){return new Dt(xe,Ge,wt)}next(xe){this.isStopped?De(function Me(ht){return Be("N",ht,void 0)}(xe),this):this._next(xe)}error(xe){this.isStopped?De(function Ve(ht){return Be("E",void 0,ht)}(xe),this):(this.isStopped=!0,this._error(xe))}complete(){this.isStopped?De(Se,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(xe){this.destination.next(xe)}_error(xe){try{this.destination.error(xe)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Rt=Function.prototype.bind;function ot(ht,xe){return Rt.call(ht,xe)}class at{constructor(xe){this.partialObserver=xe}next(xe){const{partialObserver:Ge}=this;if(Ge.next)try{Ge.next(xe)}catch(wt){nt(wt)}}error(xe){const{partialObserver:Ge}=this;if(Ge.error)try{Ge.error(xe)}catch(wt){nt(wt)}else nt(xe)}complete(){const{partialObserver:xe}=this;if(xe.complete)try{xe.complete()}catch(Ge){nt(Ge)}}}class Dt extends Re{constructor(xe,Ge,wt){let It;if(super(),(0,_.m)(xe)||!xe)It={next:null!=xe?xe:void 0,error:null!=Ge?Ge:void 0,complete:null!=wt?wt:void 0};else{let V;this&&ie.v.useDeprecatedNextContext?(V=Object.create(xe),V.unsubscribe=()=>this.unsubscribe(),It={next:xe.next&&ot(xe.next,V),error:xe.error&&ot(xe.error,V),complete:xe.complete&&ot(xe.complete,V)}):It=xe}this.destination=new at(It)}}function nt(ht){ie.v.useDeprecatedSynchronousErrorHandling?(0,ae.O)(ht):(0,be.h)(ht)}function De(ht,xe){const{onStoppedNotification:Ge}=ie.v;Ge&&ce.z.setTimeout(()=>Ge(ht,xe))}const kt={closed:!0,next:Ce.Z,error:function ft(ht){throw ht},complete:Ce.Z}},727:(Ft,We,$)=>{$.d(We,{Lc:()=>Se,w0:()=>Ce,Nn:()=>Ve});var _=$(576);const ie=(0,$(3888).d)(Be=>function(ae){Be(this),this.message=ae?`${ae.length} errors occurred during unsubscription:\n${ae.map((Re,Rt)=>`${Rt+1}) ${Re.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ae});var be=$(8737);class Ce{constructor(ce){this.initialTeardown=ce,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ce;if(!this.closed){this.closed=!0;const{_parentage:ae}=this;if(ae)if(this._parentage=null,Array.isArray(ae))for(const ot of ae)ot.remove(this);else ae.remove(this);const{initialTeardown:Re}=this;if((0,_.m)(Re))try{Re()}catch(ot){ce=ot instanceof ie?ot.errors:[ot]}const{_finalizers:Rt}=this;if(Rt){this._finalizers=null;for(const ot of Rt)try{Me(ot)}catch(at){ce=null!=ce?ce:[],at instanceof ie?ce=[...ce,...at.errors]:ce.push(at)}}if(ce)throw new ie(ce)}}add(ce){var ae;if(ce&&ce!==this)if(this.closed)Me(ce);else{if(ce instanceof Ce){if(ce.closed||ce._hasParent(this))return;ce._addParent(this)}(this._finalizers=null!==(ae=this._finalizers)&&void 0!==ae?ae:[]).push(ce)}}_hasParent(ce){const{_parentage:ae}=this;return ae===ce||Array.isArray(ae)&&ae.includes(ce)}_addParent(ce){const{_parentage:ae}=this;this._parentage=Array.isArray(ae)?(ae.push(ce),ae):ae?[ae,ce]:ce}_removeParent(ce){const{_parentage:ae}=this;ae===ce?this._parentage=null:Array.isArray(ae)&&(0,be.P)(ae,ce)}remove(ce){const{_finalizers:ae}=this;ae&&(0,be.P)(ae,ce),ce instanceof Ce&&ce._removeParent(this)}}Ce.EMPTY=(()=>{const Be=new Ce;return Be.closed=!0,Be})();const Se=Ce.EMPTY;function Ve(Be){return Be instanceof Ce||Be&&"closed"in Be&&(0,_.m)(Be.remove)&&(0,_.m)(Be.add)&&(0,_.m)(Be.unsubscribe)}function Me(Be){(0,_.m)(Be)?Be():Be.unsubscribe()}},2416:(Ft,We,$)=>{$.d(We,{v:()=>_});const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7272:(Ft,We,$)=>{$.d(We,{z:()=>Ce});var _=$(8189),ie=$(7669),be=$(8996);function Ce(...Se){return function ne(){return(0,_.J)(1)}()((0,be.D)(Se,(0,ie.yG)(Se)))}},515:(Ft,We,$)=>{$.d(We,{E:()=>ne});const ne=new($(8306).y)(Ce=>Ce.complete())},8996:(Ft,We,$)=>{$.d(We,{D:()=>xe});var _=$(8421),ne=$(5363),ie=$(9468),Se=$(8306),Me=$(2202),Be=$(576),ce=$(9672);function Re(Ge,wt){if(!Ge)throw new Error("Iterable cannot be null");return new Se.y(It=>{(0,ce.f)(It,wt,()=>{const V=Ge[Symbol.asyncIterator]();(0,ce.f)(It,wt,()=>{V.next().then(ut=>{ut.done?It.complete():It.next(ut.value)})},0,!0)})})}var Rt=$(3670),ot=$(8239),at=$(1144),Dt=$(6495),nt=$(2206),ft=$(4532),De=$(3260);function xe(Ge,wt){return wt?function ht(Ge,wt){if(null!=Ge){if((0,Rt.c)(Ge))return function be(Ge,wt){return(0,_.Xf)(Ge).pipe((0,ie.R)(wt),(0,ne.Q)(wt))}(Ge,wt);if((0,at.z)(Ge))return function Ve(Ge,wt){return new Se.y(It=>{let V=0;return wt.schedule(function(){V===Ge.length?It.complete():(It.next(Ge[V++]),It.closed||this.schedule())})})}(Ge,wt);if((0,ot.t)(Ge))return function Ce(Ge,wt){return(0,_.Xf)(Ge).pipe((0,ie.R)(wt),(0,ne.Q)(wt))}(Ge,wt);if((0,nt.D)(Ge))return Re(Ge,wt);if((0,Dt.T)(Ge))return function ae(Ge,wt){return new Se.y(It=>{let V;return(0,ce.f)(It,wt,()=>{V=Ge[Me.h](),(0,ce.f)(It,wt,()=>{let ut,ge;try{({value:ut,done:ge}=V.next())}catch(Oe){return void It.error(Oe)}ge?It.complete():It.next(ut)},0,!0)}),()=>(0,Be.m)(null==V?void 0:V.return)&&V.return()})}(Ge,wt);if((0,De.L)(Ge))return function kt(Ge,wt){return Re((0,De.Q)(Ge),wt)}(Ge,wt)}throw(0,ft.z)(Ge)}(Ge,wt):(0,_.Xf)(Ge)}},8421:(Ft,We,$)=>{$.d(We,{Xf:()=>Rt});var _=$(655),ne=$(1144),ie=$(8239),be=$(8306),Ce=$(3670),Se=$(2206),Ve=$(4532),Me=$(6495),Be=$(3260),ce=$(576),ae=$(7849),Re=$(8822);function Rt(ht){if(ht instanceof be.y)return ht;if(null!=ht){if((0,Ce.c)(ht))return function ot(ht){return new be.y(xe=>{const Ge=ht[Re.L]();if((0,ce.m)(Ge.subscribe))return Ge.subscribe(xe);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(ht);if((0,ne.z)(ht))return function at(ht){return new be.y(xe=>{for(let Ge=0;Ge<ht.length&&!xe.closed;Ge++)xe.next(ht[Ge]);xe.complete()})}(ht);if((0,ie.t)(ht))return function Dt(ht){return new be.y(xe=>{ht.then(Ge=>{xe.closed||(xe.next(Ge),xe.complete())},Ge=>xe.error(Ge)).then(null,ae.h)})}(ht);if((0,Se.D)(ht))return ft(ht);if((0,Me.T)(ht))return function nt(ht){return new be.y(xe=>{for(const Ge of ht)if(xe.next(Ge),xe.closed)return;xe.complete()})}(ht);if((0,Be.L)(ht))return function De(ht){return ft((0,Be.Q)(ht))}(ht)}throw(0,Ve.z)(ht)}function ft(ht){return new be.y(xe=>{(function kt(ht,xe){var Ge,wt,It,V;return(0,_.mG)(this,void 0,void 0,function*(){try{for(Ge=(0,_.KL)(ht);!(wt=yield Ge.next()).done;)if(xe.next(wt.value),xe.closed)return}catch(ut){It={error:ut}}finally{try{wt&&!wt.done&&(V=Ge.return)&&(yield V.call(Ge))}finally{if(It)throw It.error}}xe.complete()})})(ht,xe).catch(Ge=>xe.error(Ge))})}},6451:(Ft,We,$)=>{$.d(We,{T:()=>Se});var _=$(8189),ne=$(8421),ie=$(515),be=$(7669),Ce=$(8996);function Se(...Ve){const Me=(0,be.yG)(Ve),Be=(0,be._6)(Ve,1/0),ce=Ve;return ce.length?1===ce.length?(0,ne.Xf)(ce[0]):(0,_.J)(Be)((0,Ce.D)(ce,Me)):ie.E}},9646:(Ft,We,$)=>{$.d(We,{of:()=>ie});var _=$(7669),ne=$(8996);function ie(...be){const Ce=(0,_.yG)(be);return(0,ne.D)(be,Ce)}},5403:(Ft,We,$)=>{$.d(We,{x:()=>ne});var _=$(930);function ne(be,Ce,Se,Ve,Me){return new ie(be,Ce,Se,Ve,Me)}class ie extends _.Lv{constructor(Ce,Se,Ve,Me,Be,ce){super(Ce),this.onFinalize=Be,this.shouldUnsubscribe=ce,this._next=Se?function(ae){try{Se(ae)}catch(Re){Ce.error(Re)}}:super._next,this._error=Me?function(ae){try{Me(ae)}catch(Re){Ce.error(Re)}finally{this.unsubscribe()}}:super._error,this._complete=Ve?function(){try{Ve()}catch(ae){Ce.error(ae)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ce;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Se}=this;super.unsubscribe(),!Se&&(null===(Ce=this.onFinalize)||void 0===Ce||Ce.call(this))}}}},6590:(Ft,We,$)=>{$.d(We,{d:()=>ie});var _=$(4482),ne=$(5403);function ie(be){return(0,_.e)((Ce,Se)=>{let Ve=!1;Ce.subscribe((0,ne.x)(Se,Me=>{Ve=!0,Se.next(Me)},()=>{Ve||Se.next(be),Se.complete()}))})}},1884:(Ft,We,$)=>{$.d(We,{x:()=>be});var _=$(4671),ne=$(4482),ie=$(5403);function be(Se,Ve=_.y){return Se=null!=Se?Se:Ce,(0,ne.e)((Me,Be)=>{let ce,ae=!0;Me.subscribe((0,ie.x)(Be,Re=>{const Rt=Ve(Re);(ae||!Se(ce,Rt))&&(ae=!1,ce=Rt,Be.next(Re))}))})}function Ce(Se,Ve){return Se===Ve}},9300:(Ft,We,$)=>{$.d(We,{h:()=>ie});var _=$(4482),ne=$(5403);function ie(be,Ce){return(0,_.e)((Se,Ve)=>{let Me=0;Se.subscribe((0,ne.x)(Ve,Be=>be.call(Ce,Be,Me++)&&Ve.next(Be)))})}},590:(Ft,We,$)=>{$.d(We,{P:()=>Ve});var _=$(6805),ne=$(9300),ie=$(5698),be=$(6590),Ce=$(8068),Se=$(4671);function Ve(Me,Be){const ce=arguments.length>=2;return ae=>ae.pipe(Me?(0,ne.h)((Re,Rt)=>Me(Re,Rt,ae)):Se.y,(0,ie.q)(1),ce?(0,be.d)(Be):(0,Ce.T)(()=>new _.K))}},4004:(Ft,We,$)=>{$.d(We,{U:()=>ie});var _=$(4482),ne=$(5403);function ie(be,Ce){return(0,_.e)((Se,Ve)=>{let Me=0;Se.subscribe((0,ne.x)(Ve,Be=>{Ve.next(be.call(Ce,Be,Me++))}))})}},8189:(Ft,We,$)=>{$.d(We,{J:()=>ie});var _=$(5577),ne=$(4671);function ie(be=1/0){return(0,_.z)(ne.y,be)}},5577:(Ft,We,$)=>{$.d(We,{z:()=>Me});var _=$(4004),ne=$(8421),ie=$(4482),be=$(9672),Ce=$(5403),Ve=$(576);function Me(Be,ce,ae=1/0){return(0,Ve.m)(ce)?Me((Re,Rt)=>(0,_.U)((ot,at)=>ce(Re,ot,Rt,at))((0,ne.Xf)(Be(Re,Rt))),ae):("number"==typeof ce&&(ae=ce),(0,ie.e)((Re,Rt)=>function Se(Be,ce,ae,Re,Rt,ot,at,Dt){const nt=[];let ft=0,De=0,kt=!1;const ht=()=>{kt&&!nt.length&&!ft&&ce.complete()},xe=wt=>ft<Re?Ge(wt):nt.push(wt),Ge=wt=>{ot&&ce.next(wt),ft++;let It=!1;(0,ne.Xf)(ae(wt,De++)).subscribe((0,Ce.x)(ce,V=>{null==Rt||Rt(V),ot?xe(V):ce.next(V)},()=>{It=!0},void 0,()=>{if(It)try{for(ft--;nt.length&&ft<Re;){const V=nt.shift();at?(0,be.f)(ce,at,()=>Ge(V)):Ge(V)}ht()}catch(V){ce.error(V)}}))};return Be.subscribe((0,Ce.x)(ce,xe,()=>{kt=!0,ht()})),()=>{null==Dt||Dt()}}(Re,Rt,Be,ae)))}},5363:(Ft,We,$)=>{$.d(We,{Q:()=>be});var _=$(9672),ne=$(4482),ie=$(5403);function be(Ce,Se=0){return(0,ne.e)((Ve,Me)=>{Ve.subscribe((0,ie.x)(Me,Be=>(0,_.f)(Me,Ce,()=>Me.next(Be),Se),()=>(0,_.f)(Me,Ce,()=>Me.complete(),Se),Be=>(0,_.f)(Me,Ce,()=>Me.error(Be),Se)))})}},5026:(Ft,We,$)=>{$.d(We,{R:()=>be});var _=$(4482),ne=$(5403);function ie(Ce,Se,Ve,Me,Be){return(ce,ae)=>{let Re=Ve,Rt=Se,ot=0;ce.subscribe((0,ne.x)(ae,at=>{const Dt=ot++;Rt=Re?Ce(Rt,at,Dt):(Re=!0,at),Me&&ae.next(Rt)},Be&&(()=>{Re&&ae.next(Rt),ae.complete()})))}}function be(Ce,Se){return(0,_.e)(ie(Ce,Se,arguments.length>=2,!0))}},3099:(Ft,We,$)=>{$.d(We,{B:()=>Se});var _=$(8996),ne=$(5698),ie=$(7579),be=$(930),Ce=$(4482);function Se(Me={}){const{connector:Be=(()=>new ie.x),resetOnError:ce=!0,resetOnComplete:ae=!0,resetOnRefCountZero:Re=!0}=Me;return Rt=>{let ot=null,at=null,Dt=null,nt=0,ft=!1,De=!1;const kt=()=>{null==at||at.unsubscribe(),at=null},ht=()=>{kt(),ot=Dt=null,ft=De=!1},xe=()=>{const Ge=ot;ht(),null==Ge||Ge.unsubscribe()};return(0,Ce.e)((Ge,wt)=>{nt++,!De&&!ft&&kt();const It=Dt=null!=Dt?Dt:Be();wt.add(()=>{nt--,0===nt&&!De&&!ft&&(at=Ve(xe,Re))}),It.subscribe(wt),ot||(ot=new be.Hp({next:V=>It.next(V),error:V=>{De=!0,kt(),at=Ve(ht,ce,V),It.error(V)},complete:()=>{ft=!0,kt(),at=Ve(ht,ae),It.complete()}}),(0,_.D)(Ge).subscribe(ot))})(Rt)}}function Ve(Me,Be,...ce){return!0===Be?(Me(),null):!1===Be?null:Be(...ce).pipe((0,ne.q)(1)).subscribe(()=>Me())}},8675:(Ft,We,$)=>{$.d(We,{O:()=>be});var _=$(7272),ne=$(7669),ie=$(4482);function be(...Ce){const Se=(0,ne.yG)(Ce);return(0,ie.e)((Ve,Me)=>{(Se?(0,_.z)(Ce,Ve,Se):(0,_.z)(Ce,Ve)).subscribe(Me)})}},9468:(Ft,We,$)=>{$.d(We,{R:()=>ne});var _=$(4482);function ne(ie,be=0){return(0,_.e)((Ce,Se)=>{Se.add(ie.schedule(()=>Ce.subscribe(Se),be))})}},3900:(Ft,We,$)=>{$.d(We,{w:()=>be});var _=$(8421),ne=$(4482),ie=$(5403);function be(Ce,Se){return(0,ne.e)((Ve,Me)=>{let Be=null,ce=0,ae=!1;const Re=()=>ae&&!Be&&Me.complete();Ve.subscribe((0,ie.x)(Me,Rt=>{null==Be||Be.unsubscribe();let ot=0;const at=ce++;(0,_.Xf)(Ce(Rt,at)).subscribe(Be=(0,ie.x)(Me,Dt=>Me.next(Se?Se(Rt,Dt,at,ot++):Dt),()=>{Be=null,Re()}))},()=>{ae=!0,Re()}))})}},5698:(Ft,We,$)=>{$.d(We,{q:()=>be});var _=$(515),ne=$(4482),ie=$(5403);function be(Ce){return Ce<=0?()=>_.E:(0,ne.e)((Se,Ve)=>{let Me=0;Se.subscribe((0,ie.x)(Ve,Be=>{++Me<=Ce&&(Ve.next(Be),Ce<=Me&&Ve.complete())}))})}},8505:(Ft,We,$)=>{$.d(We,{b:()=>Ce});var _=$(576),ne=$(4482),ie=$(5403),be=$(4671);function Ce(Se,Ve,Me){const Be=(0,_.m)(Se)||Ve||Me?{next:Se,error:Ve,complete:Me}:Se;return Be?(0,ne.e)((ce,ae)=>{var Re;null===(Re=Be.subscribe)||void 0===Re||Re.call(Be);let Rt=!0;ce.subscribe((0,ie.x)(ae,ot=>{var at;null===(at=Be.next)||void 0===at||at.call(Be,ot),ae.next(ot)},()=>{var ot;Rt=!1,null===(ot=Be.complete)||void 0===ot||ot.call(Be),ae.complete()},ot=>{var at;Rt=!1,null===(at=Be.error)||void 0===at||at.call(Be,ot),ae.error(ot)},()=>{var ot,at;Rt&&(null===(ot=Be.unsubscribe)||void 0===ot||ot.call(Be)),null===(at=Be.finalize)||void 0===at||at.call(Be)}))}):be.y}},8068:(Ft,We,$)=>{$.d(We,{T:()=>be});var _=$(6805),ne=$(4482),ie=$(5403);function be(Se=Ce){return(0,ne.e)((Ve,Me)=>{let Be=!1;Ve.subscribe((0,ie.x)(Me,ce=>{Be=!0,Me.next(ce)},()=>Be?Me.complete():Me.error(Se())))})}function Ce(){return new _.K}},4408:(Ft,We,$)=>{$.d(We,{o:()=>Ce});var _=$(727);class ne extends _.w0{constructor(Ve,Me){super()}schedule(Ve,Me=0){return this}}const ie={setInterval(Se,Ve,...Me){const{delegate:Be}=ie;return(null==Be?void 0:Be.setInterval)?Be.setInterval(Se,Ve,...Me):setInterval(Se,Ve,...Me)},clearInterval(Se){const{delegate:Ve}=ie;return((null==Ve?void 0:Ve.clearInterval)||clearInterval)(Se)},delegate:void 0};var be=$(8737);class Ce extends ne{constructor(Ve,Me){super(Ve,Me),this.scheduler=Ve,this.work=Me,this.pending=!1}schedule(Ve,Me=0){if(this.closed)return this;this.state=Ve;const Be=this.id,ce=this.scheduler;return null!=Be&&(this.id=this.recycleAsyncId(ce,Be,Me)),this.pending=!0,this.delay=Me,this.id=this.id||this.requestAsyncId(ce,this.id,Me),this}requestAsyncId(Ve,Me,Be=0){return ie.setInterval(Ve.flush.bind(Ve,this),Be)}recycleAsyncId(Ve,Me,Be=0){if(null!=Be&&this.delay===Be&&!1===this.pending)return Me;ie.clearInterval(Me)}execute(Ve,Me){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Be=this._execute(Ve,Me);if(Be)return Be;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Ve,Me){let ce,Be=!1;try{this.work(Ve)}catch(ae){Be=!0,ce=ae||new Error("Scheduled action threw falsy error")}if(Be)return this.unsubscribe(),ce}unsubscribe(){if(!this.closed){const{id:Ve,scheduler:Me}=this,{actions:Be}=Me;this.work=this.state=this.scheduler=null,this.pending=!1,(0,be.P)(Be,this),null!=Ve&&(this.id=this.recycleAsyncId(Me,Ve,null)),this.delay=null,super.unsubscribe()}}}},7565:(Ft,We,$)=>{$.d(We,{v:()=>ie});var _=$(6063);class ne{constructor(Ce,Se=ne.now){this.schedulerActionCtor=Ce,this.now=Se}schedule(Ce,Se=0,Ve){return new this.schedulerActionCtor(this,Ce).schedule(Ve,Se)}}ne.now=_.l.now;class ie extends ne{constructor(Ce,Se=ne.now){super(Ce,Se),this.actions=[],this._active=!1,this._scheduled=void 0}flush(Ce){const{actions:Se}=this;if(this._active)return void Se.push(Ce);let Ve;this._active=!0;do{if(Ve=Ce.execute(Ce.state,Ce.delay))break}while(Ce=Se.shift());if(this._active=!1,Ve){for(;Ce=Se.shift();)Ce.unsubscribe();throw Ve}}}},4986:(Ft,We,$)=>{$.d(We,{z:()=>ie});var _=$(4408);const ie=new($(7565).v)(_.o)},6063:(Ft,We,$)=>{$.d(We,{l:()=>_});const _={now:()=>(_.delegate||Date).now(),delegate:void 0}},3410:(Ft,We,$)=>{$.d(We,{z:()=>_});const _={setTimeout(ne,ie,...be){const{delegate:Ce}=_;return(null==Ce?void 0:Ce.setTimeout)?Ce.setTimeout(ne,ie,...be):setTimeout(ne,ie,...be)},clearTimeout(ne){const{delegate:ie}=_;return((null==ie?void 0:ie.clearTimeout)||clearTimeout)(ne)},delegate:void 0}},2202:(Ft,We,$)=>{$.d(We,{h:()=>ne});const ne=function _(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Ft,We,$)=>{$.d(We,{L:()=>_});const _="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(Ft,We,$)=>{$.d(We,{K:()=>ne});const ne=(0,$(3888).d)(ie=>function(){ie(this),this.name="EmptyError",this.message="no elements in sequence"})},7669:(Ft,We,$)=>{$.d(We,{_6:()=>Se,jO:()=>be,yG:()=>Ce});var _=$(576);function ie(Ve){return Ve[Ve.length-1]}function be(Ve){return(0,_.m)(ie(Ve))?Ve.pop():void 0}function Ce(Ve){return function ne(Ve){return Ve&&(0,_.m)(Ve.schedule)}(ie(Ve))?Ve.pop():void 0}function Se(Ve,Me){return"number"==typeof ie(Ve)?Ve.pop():Me}},4742:(Ft,We,$)=>{$.d(We,{D:()=>Ce});const{isArray:_}=Array,{getPrototypeOf:ne,prototype:ie,keys:be}=Object;function Ce(Ve){if(1===Ve.length){const Me=Ve[0];if(_(Me))return{args:Me,keys:null};if(function Se(Ve){return Ve&&"object"==typeof Ve&&ne(Ve)===ie}(Me)){const Be=be(Me);return{args:Be.map(ce=>Me[ce]),keys:Be}}}return{args:Ve,keys:null}}},8737:(Ft,We,$)=>{function _(ne,ie){if(ne){const be=ne.indexOf(ie);0<=be&&ne.splice(be,1)}}$.d(We,{P:()=>_})},3888:(Ft,We,$)=>{function _(ne){const be=ne(Ce=>{Error.call(Ce),Ce.stack=(new Error).stack});return be.prototype=Object.create(Error.prototype),be.prototype.constructor=be,be}$.d(We,{d:()=>_})},1810:(Ft,We,$)=>{function _(ne,ie){return ne.reduce((be,Ce,Se)=>(be[Ce]=ie[Se],be),{})}$.d(We,{n:()=>_})},2806:(Ft,We,$)=>{$.d(We,{x:()=>ie,O:()=>be});var _=$(2416);let ne=null;function ie(Ce){if(_.v.useDeprecatedSynchronousErrorHandling){const Se=!ne;if(Se&&(ne={errorThrown:!1,error:null}),Ce(),Se){const{errorThrown:Ve,error:Me}=ne;if(ne=null,Ve)throw Me}}else Ce()}function be(Ce){_.v.useDeprecatedSynchronousErrorHandling&&ne&&(ne.errorThrown=!0,ne.error=Ce)}},9672:(Ft,We,$)=>{function _(ne,ie,be,Ce=0,Se=!1){const Ve=ie.schedule(function(){be(),Se?ne.add(this.schedule(null,Ce)):this.unsubscribe()},Ce);if(ne.add(Ve),!Se)return Ve}$.d(We,{f:()=>_})},4671:(Ft,We,$)=>{function _(ne){return ne}$.d(We,{y:()=>_})},1144:(Ft,We,$)=>{$.d(We,{z:()=>_});const _=ne=>ne&&"number"==typeof ne.length&&"function"!=typeof ne},2206:(Ft,We,$)=>{$.d(We,{D:()=>ne});var _=$(576);function ne(ie){return Symbol.asyncIterator&&(0,_.m)(null==ie?void 0:ie[Symbol.asyncIterator])}},576:(Ft,We,$)=>{function _(ne){return"function"==typeof ne}$.d(We,{m:()=>_})},3670:(Ft,We,$)=>{$.d(We,{c:()=>ie});var _=$(8822),ne=$(576);function ie(be){return(0,ne.m)(be[_.L])}},6495:(Ft,We,$)=>{$.d(We,{T:()=>ie});var _=$(2202),ne=$(576);function ie(be){return(0,ne.m)(null==be?void 0:be[_.h])}},8239:(Ft,We,$)=>{$.d(We,{t:()=>ne});var _=$(576);function ne(ie){return(0,_.m)(null==ie?void 0:ie.then)}},3260:(Ft,We,$)=>{$.d(We,{Q:()=>ie,L:()=>be});var _=$(655),ne=$(576);function ie(Ce){return(0,_.FC)(this,arguments,function*(){const Ve=Ce.getReader();try{for(;;){const{value:Me,done:Be}=yield(0,_.qq)(Ve.read());if(Be)return yield(0,_.qq)(void 0);yield yield(0,_.qq)(Me)}}finally{Ve.releaseLock()}})}function be(Ce){return(0,ne.m)(null==Ce?void 0:Ce.getReader)}},4482:(Ft,We,$)=>{$.d(We,{A:()=>ne,e:()=>ie});var _=$(576);function ne(be){return(0,_.m)(null==be?void 0:be.lift)}function ie(be){return Ce=>{if(ne(Ce))return Ce.lift(function(Se){try{return be(Se,this)}catch(Ve){this.error(Ve)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Ft,We,$)=>{$.d(We,{Z:()=>be});var _=$(4004);const{isArray:ne}=Array;function be(Ce){return(0,_.U)(Se=>function ie(Ce,Se){return ne(Se)?Ce(...Se):Ce(Se)}(Ce,Se))}},5032:(Ft,We,$)=>{function _(){}$.d(We,{Z:()=>_})},7849:(Ft,We,$)=>{$.d(We,{h:()=>ie});var _=$(2416),ne=$(3410);function ie(be){ne.z.setTimeout(()=>{const{onUnhandledError:Ce}=_.v;if(!Ce)throw be;Ce(be)})}},4532:(Ft,We,$)=>{function _(ne){return new TypeError(`You provided ${null!==ne&&"object"==typeof ne?"an invalid object":`'${ne}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}$.d(We,{z:()=>_})},655:(Ft,We,$)=>{function be(ge,Oe){var Ue={};for(var Je in ge)Object.prototype.hasOwnProperty.call(ge,Je)&&Oe.indexOf(Je)<0&&(Ue[Je]=ge[Je]);if(null!=ge&&"function"==typeof Object.getOwnPropertySymbols){var Ye=0;for(Je=Object.getOwnPropertySymbols(ge);Ye<Je.length;Ye++)Oe.indexOf(Je[Ye])<0&&Object.prototype.propertyIsEnumerable.call(ge,Je[Ye])&&(Ue[Je[Ye]]=ge[Je[Ye]])}return Ue}function Me(ge,Oe,Ue,Je){return new(Ue||(Ue=Promise))(function(St,Pt){function Wt(en){try{it(Je.next(en))}catch(on){Pt(on)}}function qt(en){try{it(Je.throw(en))}catch(on){Pt(on)}}function it(en){en.done?St(en.value):function Ye(St){return St instanceof Ue?St:new Ue(function(Pt){Pt(St)})}(en.value).then(Wt,qt)}it((Je=Je.apply(ge,Oe||[])).next())})}function nt(ge){return this instanceof nt?(this.v=ge,this):new nt(ge)}function ft(ge,Oe,Ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ye,Je=Ue.apply(ge,Oe||[]),St=[];return Ye={},Pt("next"),Pt("throw"),Pt("return"),Ye[Symbol.asyncIterator]=function(){return this},Ye;function Pt(tn){Je[tn]&&(Ye[tn]=function(Kt){return new Promise(function(Tn,zt){St.push([tn,Kt,Tn,zt])>1||Wt(tn,Kt)})})}function Wt(tn,Kt){try{!function qt(tn){tn.value instanceof nt?Promise.resolve(tn.value.v).then(it,en):on(St[0][2],tn)}(Je[tn](Kt))}catch(Tn){on(St[0][3],Tn)}}function it(tn){Wt("next",tn)}function en(tn){Wt("throw",tn)}function on(tn,Kt){tn(Kt),St.shift(),St.length&&Wt(St[0][0],St[0][1])}}function kt(ge){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ue,Oe=ge[Symbol.asyncIterator];return Oe?Oe.call(ge):(ge=function Re(ge){var Oe="function"==typeof Symbol&&Symbol.iterator,Ue=Oe&&ge[Oe],Je=0;if(Ue)return Ue.call(ge);if(ge&&"number"==typeof ge.length)return{next:function(){return ge&&Je>=ge.length&&(ge=void 0),{value:ge&&ge[Je++],done:!ge}}};throw new TypeError(Oe?"Object is not iterable.":"Symbol.iterator is not defined.")}(ge),Ue={},Je("next"),Je("throw"),Je("return"),Ue[Symbol.asyncIterator]=function(){return this},Ue);function Je(St){Ue[St]=ge[St]&&function(Pt){return new Promise(function(Wt,qt){!function Ye(St,Pt,Wt,qt){Promise.resolve(qt).then(function(it){St({value:it,done:Wt})},Pt)}(Wt,qt,(Pt=ge[St](Pt)).done,Pt.value)})}}}$.d(We,{_T:()=>be,mG:()=>Me,qq:()=>nt,FC:()=>ft,KL:()=>kt})},9808:(Ft,We,$)=>{$.d(We,{mr:()=>De,Ov:()=>tt,ez:()=>Ao,K0:()=>Ve,Do:()=>ht,Ts:()=>vn,V_:()=>ce,Ye:()=>xe,S$:()=>nt,sg:()=>gn,O5:()=>Yn,b0:()=>kt,lw:()=>Me,EM:()=>xs,JF:()=>On,PM:()=>As,w_:()=>Se,bD:()=>Ei,q:()=>ie,Mx:()=>le,HT:()=>Ce});var _=$(5e3);let ne=null;function ie(){return ne}function Ce(B){ne||(ne=B)}class Se{}const Ve=new _.OlP("DocumentToken");let Me=(()=>{class B{historyGo(U){throw new Error("Not implemented")}}return B.\u0275fac=function(U){return new(U||B)},B.\u0275prov=_.Yz7({token:B,factory:function(){return function Be(){return(0,_.LFG)(ae)}()},providedIn:"platform"}),B})();const ce=new _.OlP("Location Initialized");let ae=(()=>{class B extends Me{constructor(U){super(),this._doc=U,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ie().getBaseHref(this._doc)}onPopState(U){const te=ie().getGlobalEventTarget(this._doc,"window");return te.addEventListener("popstate",U,!1),()=>te.removeEventListener("popstate",U)}onHashChange(U){const te=ie().getGlobalEventTarget(this._doc,"window");return te.addEventListener("hashchange",U,!1),()=>te.removeEventListener("hashchange",U)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(U){this.location.pathname=U}pushState(U,te,_e){Re()?this._history.pushState(U,te,_e):this.location.hash=_e}replaceState(U,te,_e){Re()?this._history.replaceState(U,te,_e):this.location.hash=_e}forward(){this._history.forward()}back(){this._history.back()}historyGo(U=0){this._history.go(U)}getState(){return this._history.state}}return B.\u0275fac=function(U){return new(U||B)(_.LFG(Ve))},B.\u0275prov=_.Yz7({token:B,factory:function(){return function Rt(){return new ae((0,_.LFG)(Ve))}()},providedIn:"platform"}),B})();function Re(){return!!window.history.pushState}function ot(B,Q){if(0==B.length)return Q;if(0==Q.length)return B;let U=0;return B.endsWith("/")&&U++,Q.startsWith("/")&&U++,2==U?B+Q.substring(1):1==U?B+Q:B+"/"+Q}function at(B){const Q=B.match(/#|\?|$/),U=Q&&Q.index||B.length;return B.slice(0,U-("/"===B[U-1]?1:0))+B.slice(U)}function Dt(B){return B&&"?"!==B[0]?"?"+B:B}let nt=(()=>{class B{historyGo(U){throw new Error("Not implemented")}}return B.\u0275fac=function(U){return new(U||B)},B.\u0275prov=_.Yz7({token:B,factory:function(){return function ft(B){const Q=(0,_.LFG)(Ve).location;return new kt((0,_.LFG)(Me),Q&&Q.origin||"")}()},providedIn:"root"}),B})();const De=new _.OlP("appBaseHref");let kt=(()=>{class B extends nt{constructor(U,te){if(super(),this._platformLocation=U,this._removeListenerFns=[],null==te&&(te=this._platformLocation.getBaseHrefFromDOM()),null==te)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=te}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(U){this._removeListenerFns.push(this._platformLocation.onPopState(U),this._platformLocation.onHashChange(U))}getBaseHref(){return this._baseHref}prepareExternalUrl(U){return ot(this._baseHref,U)}path(U=!1){const te=this._platformLocation.pathname+Dt(this._platformLocation.search),_e=this._platformLocation.hash;return _e&&U?`${te}${_e}`:te}pushState(U,te,_e,rt){const yt=this.prepareExternalUrl(_e+Dt(rt));this._platformLocation.pushState(U,te,yt)}replaceState(U,te,_e,rt){const yt=this.prepareExternalUrl(_e+Dt(rt));this._platformLocation.replaceState(U,te,yt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(U=0){var te,_e;null===(_e=(te=this._platformLocation).historyGo)||void 0===_e||_e.call(te,U)}}return B.\u0275fac=function(U){return new(U||B)(_.LFG(Me),_.LFG(De,8))},B.\u0275prov=_.Yz7({token:B,factory:B.\u0275fac}),B})(),ht=(()=>{class B extends nt{constructor(U,te){super(),this._platformLocation=U,this._baseHref="",this._removeListenerFns=[],null!=te&&(this._baseHref=te)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(U){this._removeListenerFns.push(this._platformLocation.onPopState(U),this._platformLocation.onHashChange(U))}getBaseHref(){return this._baseHref}path(U=!1){let te=this._platformLocation.hash;return null==te&&(te="#"),te.length>0?te.substring(1):te}prepareExternalUrl(U){const te=ot(this._baseHref,U);return te.length>0?"#"+te:te}pushState(U,te,_e,rt){let yt=this.prepareExternalUrl(_e+Dt(rt));0==yt.length&&(yt=this._platformLocation.pathname),this._platformLocation.pushState(U,te,yt)}replaceState(U,te,_e,rt){let yt=this.prepareExternalUrl(_e+Dt(rt));0==yt.length&&(yt=this._platformLocation.pathname),this._platformLocation.replaceState(U,te,yt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(U=0){var te,_e;null===(_e=(te=this._platformLocation).historyGo)||void 0===_e||_e.call(te,U)}}return B.\u0275fac=function(U){return new(U||B)(_.LFG(Me),_.LFG(De,8))},B.\u0275prov=_.Yz7({token:B,factory:B.\u0275fac}),B})(),xe=(()=>{class B{constructor(U,te){this._subject=new _.vpe,this._urlChangeListeners=[],this._platformStrategy=U;const _e=this._platformStrategy.getBaseHref();this._platformLocation=te,this._baseHref=at(It(_e)),this._platformStrategy.onPopState(rt=>{this._subject.emit({url:this.path(!0),pop:!0,state:rt.state,type:rt.type})})}path(U=!1){return this.normalize(this._platformStrategy.path(U))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(U,te=""){return this.path()==this.normalize(U+Dt(te))}normalize(U){return B.stripTrailingSlash(function wt(B,Q){return B&&Q.startsWith(B)?Q.substring(B.length):Q}(this._baseHref,It(U)))}prepareExternalUrl(U){return U&&"/"!==U[0]&&(U="/"+U),this._platformStrategy.prepareExternalUrl(U)}go(U,te="",_e=null){this._platformStrategy.pushState(_e,"",U,te),this._notifyUrlChangeListeners(this.prepareExternalUrl(U+Dt(te)),_e)}replaceState(U,te="",_e=null){this._platformStrategy.replaceState(_e,"",U,te),this._notifyUrlChangeListeners(this.prepareExternalUrl(U+Dt(te)),_e)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(U=0){var te,_e;null===(_e=(te=this._platformStrategy).historyGo)||void 0===_e||_e.call(te,U)}onUrlChange(U){this._urlChangeListeners.push(U),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(te=>{this._notifyUrlChangeListeners(te.url,te.state)}))}_notifyUrlChangeListeners(U="",te){this._urlChangeListeners.forEach(_e=>_e(U,te))}subscribe(U,te,_e){return this._subject.subscribe({next:U,error:te,complete:_e})}}return B.normalizeQueryParams=Dt,B.joinWithSlash=ot,B.stripTrailingSlash=at,B.\u0275fac=function(U){return new(U||B)(_.LFG(nt),_.LFG(Me))},B.\u0275prov=_.Yz7({token:B,factory:function(){return function Ge(){return new xe((0,_.LFG)(nt),(0,_.LFG)(Me))}()},providedIn:"root"}),B})();function It(B){return B.replace(/\/index.html$/,"")}function le(B,Q){Q=encodeURIComponent(Q);for(const U of B.split(";")){const te=U.indexOf("="),[_e,rt]=-1==te?[U,""]:[U.slice(0,te),U.slice(te+1)];if(_e.trim()===Q)return decodeURIComponent(rt)}return null}class Qt{constructor(Q,U,te,_e){this.$implicit=Q,this.ngForOf=U,this.index=te,this.count=_e}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let gn=(()=>{class B{constructor(U,te,_e){this._viewContainer=U,this._template=te,this._differs=_e,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(U){this._ngForOf=U,this._ngForOfDirty=!0}set ngForTrackBy(U){this._trackByFn=U}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(U){U&&(this._template=U)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const U=this._ngForOf;!this._differ&&U&&(this._differ=this._differs.find(U).create(this.ngForTrackBy))}if(this._differ){const U=this._differ.diff(this._ngForOf);U&&this._applyChanges(U)}}_applyChanges(U){const te=this._viewContainer;U.forEachOperation((_e,rt,yt)=>{if(null==_e.previousIndex)te.createEmbeddedView(this._template,new Qt(_e.item,this._ngForOf,-1,-1),null===yt?void 0:yt);else if(null==yt)te.remove(null===rt?void 0:rt);else if(null!==rt){const un=te.get(rt);te.move(un,yt),er(un,_e)}});for(let _e=0,rt=te.length;_e<rt;_e++){const un=te.get(_e).context;un.index=_e,un.count=rt,un.ngForOf=this._ngForOf}U.forEachIdentityChange(_e=>{er(te.get(_e.currentIndex),_e)})}static ngTemplateContextGuard(U,te){return!0}}return B.\u0275fac=function(U){return new(U||B)(_.Y36(_.s_b),_.Y36(_.Rgc),_.Y36(_.ZZ4))},B.\u0275dir=_.lG2({type:B,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),B})();function er(B,Q){B.context.$implicit=Q.item}let Yn=(()=>{class B{constructor(U,te){this._viewContainer=U,this._context=new Qn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=te}set ngIf(U){this._context.$implicit=this._context.ngIf=U,this._updateView()}set ngIfThen(U){Ys("ngIfThen",U),this._thenTemplateRef=U,this._thenViewRef=null,this._updateView()}set ngIfElse(U){Ys("ngIfElse",U),this._elseTemplateRef=U,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(U,te){return!0}}return B.\u0275fac=function(U){return new(U||B)(_.Y36(_.s_b),_.Y36(_.Rgc))},B.\u0275dir=_.lG2({type:B,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),B})();class Qn{constructor(){this.$implicit=null,this.ngIf=null}}function Ys(B,Q){if(Q&&!Q.createEmbeddedView)throw new Error(`${B} must be a TemplateRef, but received '${(0,_.AaK)(Q)}'.`)}class us{createSubscription(Q,U){return Q.subscribe({next:U,error:te=>{throw te}})}dispose(Q){Q.unsubscribe()}onDestroy(Q){Q.unsubscribe()}}class Fe{createSubscription(Q,U){return Q.then(U,te=>{throw te})}dispose(Q){}onDestroy(Q){}}const Pe=new Fe,He=new us;let tt=(()=>{class B{constructor(U){this._ref=U,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(U){return this._obj?U!==this._obj?(this._dispose(),this.transform(U)):this._latestValue:(U&&this._subscribe(U),this._latestValue)}_subscribe(U){this._obj=U,this._strategy=this._selectStrategy(U),this._subscription=this._strategy.createSubscription(U,te=>this._updateLatestValue(U,te))}_selectStrategy(U){if((0,_.QGY)(U))return Pe;if((0,_.F4k)(U))return He;throw function Ir(B,Q){return new _.vHH(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(U,te){U===this._obj&&(this._latestValue=te,this._ref.markForCheck())}}return B.\u0275fac=function(U){return new(U||B)(_.Y36(_.sBO,16))},B.\u0275pipe=_.Yjl({name:"async",type:B,pure:!1}),B})(),vn=(()=>{class B{transform(U){return JSON.stringify(U,null,2)}}return B.\u0275fac=function(U){return new(U||B)},B.\u0275pipe=_.Yjl({name:"json",type:B,pure:!1}),B})(),Ao=(()=>{class B{}return B.\u0275fac=function(U){return new(U||B)},B.\u0275mod=_.oAB({type:B}),B.\u0275inj=_.cJS({}),B})();const Ei="browser";function As(B){return"server"===B}let xs=(()=>{class B{}return B.\u0275prov=(0,_.Yz7)({token:B,providedIn:"root",factory:()=>new $i((0,_.LFG)(Ve),window)}),B})();class $i{constructor(Q,U){this.document=Q,this.window=U,this.offset=()=>[0,0]}setOffset(Q){this.offset=Array.isArray(Q)?()=>Q:Q}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(Q){this.supportsScrolling()&&this.window.scrollTo(Q[0],Q[1])}scrollToAnchor(Q){if(!this.supportsScrolling())return;const U=function fi(B,Q){const U=B.getElementById(Q)||B.getElementsByName(Q)[0];if(U)return U;if("function"==typeof B.createTreeWalker&&B.body&&(B.body.createShadowRoot||B.body.attachShadow)){const te=B.createTreeWalker(B.body,NodeFilter.SHOW_ELEMENT);let _e=te.currentNode;for(;_e;){const rt=_e.shadowRoot;if(rt){const yt=rt.getElementById(Q)||rt.querySelector(`[name="${Q}"]`);if(yt)return yt}_e=te.nextNode()}}return null}(this.document,Q);U&&(this.scrollToElement(U),U.focus())}setHistoryScrollRestoration(Q){if(this.supportScrollRestoration()){const U=this.window.history;U&&U.scrollRestoration&&(U.scrollRestoration=Q)}}scrollToElement(Q){const U=Q.getBoundingClientRect(),te=U.left+this.window.pageXOffset,_e=U.top+this.window.pageYOffset,rt=this.offset();this.window.scrollTo(te-rt[0],_e-rt[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const Q=cs(this.window.history)||cs(Object.getPrototypeOf(this.window.history));return!(!Q||!Q.writable&&!Q.set)}catch(Q){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(Q){return!1}}}function cs(B){return Object.getOwnPropertyDescriptor(B,"scrollRestoration")}class On{}},5e3:(Ft,We,$)=>{$.d(We,{deG:()=>hs,tb:()=>vE,AFp:()=>gE,ip1:()=>pE,CZH:()=>Nv,hGG:()=>aC,z2F:()=>Uv,sBO:()=>WI,Sil:()=>DI,_Vd:()=>jy,EJc:()=>CI,SBq:()=>Yg,qLn:()=>Ul,vpe:()=>$c,tBr:()=>Bo,XFs:()=>Bt,OlP:()=>Qi,zs3:()=>xa,ZZ4:()=>Wv,aQg:()=>zv,soG:()=>Ov,YKP:()=>A0,h0i:()=>yp,PXZ:()=>LI,R0b:()=>Jl,FiY:()=>Fs,Lbi:()=>_E,g9A:()=>yE,Qsj:()=>vw,FYo:()=>C0,JOm:()=>z,tp0:()=>Is,Rgc:()=>em,dDg:()=>CE,q4F:()=>D0,GfV:()=>b0,s_b:()=>Gy,ifc:()=>Vt,eFA:()=>TE,G48:()=>GI,Gpc:()=>ae,X6Q:()=>HI,_c5:()=>oC,VLi:()=>OI,c2e:()=>EE,zSh:()=>Wp,wAp:()=>Ln,vHH:()=>at,cg1:()=>pp,kL8:()=>Ay,dqk:()=>cn,sIi:()=>Jd,CqO:()=>Xm,QGY:()=>sp,F4k:()=>Jm,RDi:()=>cs,AaK:()=>Me,qOj:()=>qf,TTD:()=>ss,_Bn:()=>E0,xp6:()=>Th,uIk:()=>jh,ekj:()=>Mg,Suo:()=>z0,Xpm:()=>$t,lG2:()=>_i,Yz7:()=>Kt,cJS:()=>zt,oAB:()=>ur,Yjl:()=>yn,Y36:()=>tu,_UZ:()=>Wh,qZA:()=>ip,TgZ:()=>Gh,EpF:()=>mo,n5z:()=>to,LFG:()=>Ot,$8M:()=>Fa,$Z:()=>Eg,NdJ:()=>op,CRH:()=>K0,oxw:()=>iy,ALo:()=>V0,lcZ:()=>U0,Hsn:()=>Tl,F$t:()=>Ig,Q6J:()=>wg,DdM:()=>N0,iGM:()=>W0,MAs:()=>ug,CHM:()=>Y,LSH:()=>na,YNc:()=>Bm,W1O:()=>Q0,_uU:()=>my,Oqu:()=>dp,hij:()=>Jh});var _=$(7579),ne=$(727),ie=$(8306),be=$(6451),Ce=$(3099);function Se(n){for(let r in n)if(n[r]===Se)return r;throw Error("Could not find renamed property on target object.")}function Ve(n,r){for(const o in r)r.hasOwnProperty(o)&&!n.hasOwnProperty(o)&&(n[o]=r[o])}function Me(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Me).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function Be(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const ce=Se({__forward_ref__:Se});function ae(n){return n.__forward_ref__=ae,n.toString=function(){return Me(this())},n}function Re(n){return Rt(n)?n():n}function Rt(n){return"function"==typeof n&&n.hasOwnProperty(ce)&&n.__forward_ref__===ae}class at extends Error{constructor(r,o){super(function Dt(n,r){return`NG0${Math.abs(n)}${r?": "+r:""}`}(r,o)),this.code=r}}function nt(n){return"string"==typeof n?n:null==n?"":String(n)}function ft(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():nt(n)}function xe(n,r){const o=r?` in ${r}`:"";throw new at(-201,`No provider for ${ft(n)} found${o}`)}function qt(n,r){null==n&&function it(n,r,o,a){throw new Error(`ASSERTION ERROR: ${n}`+(null==a?"":` [Expected=> ${o} ${a} ${r} <=Actual]`))}(r,n,null,"!=")}function Kt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function zt(n){return{providers:n.providers||[],imports:n.imports||[]}}function Yt(n){return hr(n,Hr)||hr(n,Ar)}function hr(n,r){return n.hasOwnProperty(r)?n[r]:null}function Pn(n){return n&&(n.hasOwnProperty(Gn)||n.hasOwnProperty(Vn))?n[Gn]:null}const Hr=Se({\u0275prov:Se}),Gn=Se({\u0275inj:Se}),Ar=Se({ngInjectableDef:Se}),Vn=Se({ngInjectorDef:Se});var Bt=(()=>((Bt=Bt||{})[Bt.Default=0]="Default",Bt[Bt.Host=1]="Host",Bt[Bt.Self=2]="Self",Bt[Bt.SkipSelf=4]="SkipSelf",Bt[Bt.Optional=8]="Optional",Bt))();let En;function ln(n){const r=En;return En=n,r}function Ci(n,r,o){const a=Yt(n);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:o&Bt.Optional?null:void 0!==r?r:void xe(Me(n),"Injector")}function Zn(n){return{toString:n}.toString()}var Fr=(()=>((Fr=Fr||{})[Fr.OnPush=0]="OnPush",Fr[Fr.Default=1]="Default",Fr))(),Vt=(()=>{return(n=Vt||(Vt={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Vt;var n})();const Xt="undefined"!=typeof globalThis&&globalThis,nn="undefined"!=typeof window&&window,Pr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,cn=Xt||"undefined"!=typeof global&&global||nn||Pr,vr={},dn=[],Ne=Se({\u0275cmp:Se}),ye=Se({\u0275dir:Se}),je=Se({\u0275pipe:Se}),ke=Se({\u0275mod:Se}),fe=Se({\u0275fac:Se}),qe=Se({__NG_ELEMENT_ID__:Se});let At=0;function $t(n){return Zn(()=>{const o={},a={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Fr.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||dn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Vt.Emulated,id:"c",styles:n.styles||dn,_:null,setInput:null,schemas:n.schemas||null,tView:null},h=n.directives,y=n.features,C=n.pipes;return a.id+=At++,a.inputs=Gr(n.inputs,o),a.outputs=Gr(n.outputs),y&&y.forEach(A=>A(a)),a.directiveDefs=h?()=>("function"==typeof h?h():h).map(or):null,a.pipeDefs=C?()=>("function"==typeof C?C():C).map(lr):null,a})}function or(n){return br(n)||function ii(n){return n[ye]||null}(n)}function lr(n){return function Zr(n){return n[je]||null}(n)}const an={};function ur(n){return Zn(()=>{const r={type:n.type,bootstrap:n.bootstrap||dn,declarations:n.declarations||dn,imports:n.imports||dn,exports:n.exports||dn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(an[n.id]=n.type),r})}function Gr(n,r){if(null==n)return vr;const o={};for(const a in n)if(n.hasOwnProperty(a)){let h=n[a],y=h;Array.isArray(h)&&(y=h[1],h=h[0]),o[h]=a,r&&(r[h]=y)}return o}const _i=$t;function yn(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function br(n){return n[Ne]||null}function Vr(n,r){const o=n[ke]||null;if(!o&&!0===r)throw new Error(`Type ${Me(n)} does not have '\u0275mod' property.`);return o}function di(n){return Array.isArray(n)&&"object"==typeof n[1]}function Di(n){return Array.isArray(n)&&!0===n[1]}function Qs(n){return 0!=(8&n.flags)}function qi(n){return 2==(2&n.flags)}function vi(n){return 1==(1&n.flags)}function ns(n){return null!==n.template}function oo(n){return 0!=(512&n[2])}function ti(n,r){return n.hasOwnProperty(fe)?n[fe]:null}class is{constructor(r,o,a){this.previousValue=r,this.currentValue=o,this.firstChange=a}isFirstChange(){return this.firstChange}}function ss(){return vs}function vs(n){return n.type.prototype.ngOnChanges&&(n.setInput=Es),ls}function ls(){const n=Ei(this),r=null==n?void 0:n.current;if(r){const o=n.previous;if(o===vr)n.previous=r;else for(let a in r)o[a]=r[a];n.current=null,this.ngOnChanges(r)}}function Es(n,r,o,a){const h=Ei(n)||function lo(n,r){return n[Ao]=r}(n,{previous:vr,current:null}),y=h.current||(h.current={}),C=h.previous,A=this.declaredInputs[o],O=C[A];y[A]=new is(O&&O.currentValue,r,C===vr),n[a]=r}ss.ngInherit=!0;const Ao="__ngSimpleChanges__";function Ei(n){return n[Ao]||null}let $i;function cs(n){$i=n}function On(n){return!!n.listen}const B={createRenderer:(n,r)=>function fi(){return void 0!==$i?$i:"undefined"!=typeof document?document:void 0}()};function U(n){for(;Array.isArray(n);)n=n[0];return n}function rt(n,r){return U(r[n])}function yt(n,r){return U(r[n.index])}function wn(n,r){return n.data[r]}function Wn(n,r){return n[r]}function kn(n,r){const o=r[n];return di(o)?o:o[0]}function Jn(n){return 4==(4&n[2])}function qr(n){return 128==(128&n[2])}function $r(n,r){return null==r?null:n[r]}function zn(n){n[18]=0}function pi(n,r){n[5]+=r;let o=n,a=n[3];for(;null!==a&&(1===r&&1===o[5]||-1===r&&0===o[5]);)a[5]+=r,o=a,a=a[3]}const fn={lFrame:Mo(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function G(){return fn.bindingsEnabled}function E(){return fn.lFrame.lView}function R(){return fn.lFrame.tView}function Y(n){return fn.lFrame.contextLView=n,n[8]}function oe(){let n=Te();for(;null!==n&&64===n.type;)n=n.parent;return n}function Te(){return fn.lFrame.currentTNode}function mt(n,r){const o=fn.lFrame;o.currentTNode=n,o.isParent=r}function Gt(){return fn.lFrame.isParent}function Ut(){fn.lFrame.isParent=!1}function Br(){return fn.isInCheckNoChangesMode}function Or(n){fn.isInCheckNoChangesMode=n}function rr(){const n=fn.lFrame;let r=n.bindingRootIndex;return-1===r&&(r=n.bindingRootIndex=n.tView.bindingStartIndex),r}function Cr(){return fn.lFrame.bindingIndex++}function Pi(n,r){const o=fn.lFrame;o.bindingIndex=o.bindingRootIndex=n,_o(r)}function _o(n){fn.lFrame.currentDirectiveIndex=n}function xo(){return fn.lFrame.currentQueryIndex}function Ro(n){fn.lFrame.currentQueryIndex=n}function ju(n){const r=n[1];return 2===r.type?r.declTNode:1===r.type?n[6]:null}function Ea(n,r,o){if(o&Bt.SkipSelf){let h=r,y=n;for(;!(h=h.parent,null!==h||o&Bt.Host||(h=ju(y),null===h||(y=y[15],10&h.type))););if(null===h)return!1;r=h,n=y}const a=fn.lFrame=Ko();return a.currentTNode=r,a.lView=n,!0}function zo(n){const r=Ko(),o=n[1];fn.lFrame=r,r.currentTNode=o.firstChild,r.lView=n,r.tView=o,r.contextLView=n,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function Ko(){const n=fn.lFrame,r=null===n?null:n.child;return null===r?Mo(n):r}function Mo(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function ca(){const n=fn.lFrame;return fn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Ga=ca;function Ma(){const n=ca();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Si(){return fn.lFrame.selectedIndex}function fo(n){fn.lFrame.selectedIndex=n}function Hi(){const n=fn.lFrame;return wn(n.tView,n.selectedIndex)}function Wa(n,r){for(let o=r.directiveStart,a=r.directiveEnd;o<a;o++){const y=n.data[o].type.prototype,{ngAfterContentInit:C,ngAfterContentChecked:A,ngAfterViewInit:O,ngAfterViewChecked:q,ngOnDestroy:J}=y;C&&(n.contentHooks||(n.contentHooks=[])).push(-o,C),A&&((n.contentHooks||(n.contentHooks=[])).push(o,A),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(o,A)),O&&(n.viewHooks||(n.viewHooks=[])).push(-o,O),q&&((n.viewHooks||(n.viewHooks=[])).push(o,q),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(o,q)),null!=J&&(n.destroyHooks||(n.destroyHooks=[])).push(o,J)}}function Po(n,r,o){mr(n,r,3,o)}function Xs(n,r,o,a){(3&n[2])===o&&mr(n,r,o,a)}function qo(n,r){let o=n[2];(3&o)===r&&(o&=2047,o+=1,n[2]=o)}function mr(n,r,o,a){const y=null!=a?a:-1,C=r.length-1;let A=0;for(let O=void 0!==a?65535&n[18]:0;O<C;O++)if("number"==typeof r[O+1]){if(A=r[O],null!=a&&A>=a)break}else r[O]<0&&(n[18]+=65536),(A<y||-1==y)&&(da(n,o,r,O),n[18]=(4294901760&n[18])+O+2),O++}function da(n,r,o,a){const h=o[a]<0,y=o[a+1],A=n[h?-o[a]:o[a]];if(h){if(n[2]>>11<n[18]>>16&&(3&n[2])===r){n[2]+=2048;try{y.call(A)}finally{}}}else try{y.call(A)}finally{}}class Gi{constructor(r,o,a){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=a}}function mi(n,r,o){const a=On(n);let h=0;for(;h<o.length;){const y=o[h];if("number"==typeof y){if(0!==y)break;h++;const C=o[h++],A=o[h++],O=o[h++];a?n.setAttribute(r,A,O,C):r.setAttributeNS(C,A,O)}else{const C=y,A=o[++h];Yo(C)?a&&n.setProperty(r,C,A):a?n.setAttribute(r,C,A):r.setAttribute(C,A),h++}}return h}function Zo(n){return 3===n||4===n||6===n}function Yo(n){return 64===n.charCodeAt(0)}function eo(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let o=-1;for(let a=0;a<r.length;a++){const h=r[a];"number"==typeof h?o=h:0===o||Yr(n,o,h,null,-1===o||2===o?r[++a]:null)}}return n}function Yr(n,r,o,a,h){let y=0,C=n.length;if(-1===r)C=-1;else for(;y<n.length;){const A=n[y++];if("number"==typeof A){if(A===r){C=-1;break}if(A>r){C=y-1;break}}}for(;y<n.length;){const A=n[y];if("number"==typeof A)break;if(A===o){if(null===a)return void(null!==h&&(n[y+1]=h));if(a===n[y+1])return void(n[y+2]=h)}y++,null!==a&&y++,null!==h&&y++}-1!==C&&(n.splice(C,0,r),y=C+1),n.splice(y++,0,o),null!==a&&n.splice(y++,0,a),null!==h&&n.splice(y++,0,h)}function Eo(n){return-1!==n}function Hs(n){return 32767&n}function Qr(n,r){let o=function ru(n){return n>>16}(n),a=r;for(;o>0;)a=a[15],o--;return a}let ka=!0;function Gs(n){const r=ka;return ka=n,r}let Qo=0;function xt(n,r){const o=Jo(n,r);if(-1!==o)return o;const a=r[1];a.firstCreatePass&&(n.injectorIndex=r.length,ai(a.data,n),ai(r,null),ai(a.blueprint,null));const h=fa(n,r),y=n.injectorIndex;if(Eo(h)){const C=Hs(h),A=Qr(h,r),O=A[1].data;for(let q=0;q<8;q++)r[y+q]=A[C+q]|O[C+q]}return r[y+8]=h,y}function ai(n,r){n.push(0,0,0,0,0,0,0,0,r)}function Jo(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function fa(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let o=0,a=null,h=r;for(;null!==h;){const y=h[1],C=y.type;if(a=2===C?y.declTNode:1===C?h[6]:null,null===a)return-1;if(o++,h=h[15],-1!==a.injectorIndex)return a.injectorIndex|o<<16}return-1}function S(n,r,o){!function Hu(n,r,o){let a;"string"==typeof o?a=o.charCodeAt(0)||0:o.hasOwnProperty(qe)&&(a=o[qe]),null==a&&(a=o[qe]=Qo++);const h=255&a;r.data[n+(h>>5)]|=1<<h}(n,r,o)}function b(n,r,o){if(o&Bt.Optional)return n;xe(r,"NodeInjector")}function N(n,r,o,a){if(o&Bt.Optional&&void 0===a&&(a=null),0==(o&(Bt.Self|Bt.Host))){const h=n[9],y=ln(void 0);try{return h?h.get(r,a,o&Bt.Optional):Ci(r,a,o&Bt.Optional)}finally{ln(y)}}return b(a,r,o)}function P(n,r,o,a=Bt.Default,h){if(null!==n){const y=function yr(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(qe)?n[qe]:void 0;return"number"==typeof r?r>=0?255&r:de:r}(o);if("function"==typeof y){if(!Ea(r,n,a))return a&Bt.Host?b(h,o,a):N(r,o,a,h);try{const C=y(a);if(null!=C||a&Bt.Optional)return C;xe(o)}finally{Ga()}}else if("number"==typeof y){let C=null,A=Jo(n,r),O=-1,q=a&Bt.Host?r[16][6]:null;for((-1===A||a&Bt.SkipSelf)&&(O=-1===A?fa(n,r):r[A+8],-1!==O&&Tr(a,!1)?(C=r[1],A=Hs(O),r=Qr(O,r)):A=-1);-1!==A;){const J=r[1];if(pn(y,A,J.data)){const he=Ie(A,r,o,C,a,q);if(he!==K)return he}O=r[A+8],-1!==O&&Tr(a,r[1].data[A+8]===q)&&pn(y,A,r)?(C=J,A=Hs(O),r=Qr(O,r)):A=-1}}}return N(r,o,a,h)}const K={};function de(){return new _r(oe(),E())}function Ie(n,r,o,a,h,y){const C=r[1],A=C.data[n+8],J=dt(A,C,o,null==a?qi(A)&&ka:a!=C&&0!=(3&A.type),h&Bt.Host&&y===A);return null!==J?Jt(r,C,J,A):K}function dt(n,r,o,a,h){const y=n.providerIndexes,C=r.data,A=1048575&y,O=n.directiveStart,J=y>>20,Ae=h?A+J:n.directiveEnd;for(let Ze=a?A:A+J;Ze<Ae;Ze++){const vt=C[Ze];if(Ze<O&&o===vt||Ze>=O&&vt.type===o)return Ze}if(h){const Ze=C[O];if(Ze&&ns(Ze)&&Ze.type===o)return O}return null}function Jt(n,r,o,a){let h=n[o];const y=r.data;if(function Oa(n){return n instanceof Gi}(h)){const C=h;C.resolving&&function De(n,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new at(-200,`Circular dependency in DI detected for ${n}${o}`)}(ft(y[o]));const A=Gs(C.canSeeViewProviders);C.resolving=!0;const O=C.injectImpl?ln(C.injectImpl):null;Ea(n,a,Bt.Default);try{h=n[o]=C.factory(void 0,y,n,a),r.firstCreatePass&&o>=a.directiveStart&&function vo(n,r,o){const{ngOnChanges:a,ngOnInit:h,ngDoCheck:y}=r.type.prototype;if(a){const C=vs(r);(o.preOrderHooks||(o.preOrderHooks=[])).push(n,C),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(n,C)}h&&(o.preOrderHooks||(o.preOrderHooks=[])).push(0-n,h),y&&((o.preOrderHooks||(o.preOrderHooks=[])).push(n,y),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(n,y))}(o,y[o],r)}finally{null!==O&&ln(O),Gs(A),C.resolving=!1,Ga()}}return h}function pn(n,r,o){return!!(o[r+(n>>5)]&1<<n)}function Tr(n,r){return!(n&Bt.Self||n&Bt.Host&&r)}class _r{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,a){return P(this._tNode,this._lView,r,a,o)}}function to(n){return Zn(()=>{const r=n.prototype.constructor,o=r[fe]||po(r),a=Object.prototype;let h=Object.getPrototypeOf(n.prototype).constructor;for(;h&&h!==a;){const y=h[fe]||po(h);if(y&&y!==o)return y;h=Object.getPrototypeOf(h)}return y=>new y})}function po(n){return Rt(n)?()=>{const r=po(Re(n));return r&&r()}:ti(n)}function Fa(n){return function D(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const o=n.attrs;if(o){const a=o.length;let h=0;for(;h<a;){const y=o[h];if(Zo(y))break;if(0===y)h+=2;else if("number"==typeof y)for(h++;h<a&&"string"==typeof o[h];)h++;else{if(y===r)return o[h+1];h+=2}}}return null}(oe(),n)}const Dn="__parameters__";function An(n,r,o){return Zn(()=>{const a=function ui(n){return function(...o){if(n){const a=n(...o);for(const h in a)this[h]=a[h]}}}(r);function h(...y){if(this instanceof h)return a.apply(this,y),this;const C=new h(...y);return A.annotation=C,A;function A(O,q,J){const he=O.hasOwnProperty(Dn)?O[Dn]:Object.defineProperty(O,Dn,{value:[]})[Dn];for(;he.length<=J;)he.push(null);return(he[J]=he[J]||[]).push(C),O}}return o&&(h.prototype=Object.create(o.prototype)),h.prototype.ngMetadataName=n,h.annotationCls=h,h})}class Qi{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=Kt({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}toString(){return`InjectionToken ${this._desc}`}}const hs=new Qi("AnalyzeForEntryComponents");function Io(n,r){void 0===r&&(r=n);for(let o=0;o<n.length;o++){let a=n[o];Array.isArray(a)?(r===n&&(r=n.slice(0,o)),Io(a,r)):r!==n&&r.push(a)}return r}function Qe(n,r){n.forEach(o=>Array.isArray(o)?Qe(o,r):r(o))}function Va(n,r,o){r>=n.length?n.push(o):n.splice(r,0,o)}function no(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function Za(n,r){const o=[];for(let a=0;a<n;a++)o.push(r);return o}function Xo(n,r,o){let a=os(n,r);return a>=0?n[1|a]=o:(a=~a,function Ca(n,r,o,a){let h=n.length;if(h==r)n.push(o,a);else if(1===h)n.push(a,n[0]),n[0]=o;else{for(h--,n.push(n[h-1],n[h]);h>r;)n[h]=n[h-2],h--;n[r]=o,n[r+1]=a}}(n,a,r,o)),a}function ll(n,r){const o=os(n,r);if(o>=0)return n[1|o]}function os(n,r){return function Ya(n,r,o){let a=0,h=n.length>>o;for(;h!==a;){const y=a+(h-a>>1),C=n[y<<o];if(r===C)return y<<o;C>r?h=y:a=y+1}return~(h<<o)}(n,r,1)}const ki={},Ku="__NG_DI_FLAG__",bo="ngTempTokenPath",L=/\n/gm,X="__source",me=Se({provide:String,useValue:Se});let $e;function Xe(n){const r=$e;return $e=n,r}function Ct(n,r=Bt.Default){if(void 0===$e)throw new at(203,"");return null===$e?Ci(n,void 0,r):$e.get(n,r&Bt.Optional?null:void 0,r)}function Ot(n,r=Bt.Default){return(function Sn(){return En}()||Ct)(Re(n),r)}const jn=Ot;function ir(n){const r=[];for(let o=0;o<n.length;o++){const a=Re(n[o]);if(Array.isArray(a)){if(0===a.length)throw new at(900,"");let h,y=Bt.Default;for(let C=0;C<a.length;C++){const A=a[C],O=Jr(A);"number"==typeof O?-1===O?h=A.token:y|=O:h=A}r.push(Ot(h,y))}else r.push(Ot(a))}return r}function _n(n,r){return n[Ku]=r,n.prototype[Ku]=r,n}function Jr(n){return n[Ku]}const Bo=_n(An("Inject",n=>({token:n})),-1),Fs=_n(An("Optional"),8),Is=_n(An("SkipSelf"),4);class sc{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function uu(n){return n instanceof sc?n.changingThisBreaksApplicationSecurity:n}const Wc=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,ac=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var xi=(()=>((xi=xi||{})[xi.NONE=0]="NONE",xi[xi.HTML=1]="HTML",xi[xi.STYLE=2]="STYLE",xi[xi.SCRIPT=3]="SCRIPT",xi[xi.URL=4]="URL",xi[xi.RESOURCE_URL=5]="RESOURCE_URL",xi))();function na(n){const r=function Ru(){const n=E();return n&&n[12]}();return r?r.sanitize(xi.URL,n)||"":function Cu(n,r){const o=function fl(n){return n instanceof sc&&n.getTypeName()||null}(n);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see https://g.co/ng/security#xss)`)}return o===r}(n,"URL")?uu(n):function ga(n){return(n=String(n)).match(Wc)||n.match(ac)?n:"unsafe:"+n}(nt(n))}const pc="__ngContext__";function qs(n,r){n[pc]=r}function gc(n){const r=function Do(n){return n[pc]||null}(n);return r?Array.isArray(r)?r:r.lView:null}function Vs(n){return n.ngOriginalError}function mc(n,...r){n.error(...r)}class Ul{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r),a=function Vl(n){return n&&n.ngErrorLogger||mc}(r);a(this._console,"ERROR",r),o&&a(this._console,"ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&Vs(r);for(;o&&Vs(o);)o=Vs(o);return o||null}}const Md=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(cn))();function Bs(n){return n instanceof Function?n():n}var z=(()=>((z=z||{})[z.Important=1]="Important",z[z.DashCase=2]="DashCase",z))();function Le(n,r){return undefined(n,r)}function rn(n){const r=n[3];return Di(r)?r[3]:r}function fs(n){return jl(n[13])}function sa(n){return jl(n[4])}function jl(n){for(;null!==n&&!Di(n);)n=n[4];return n}function Nu(n,r,o,a,h){if(null!=a){let y,C=!1;Di(a)?y=a:di(a)&&(C=!0,a=a[0]);const A=U(a);0===n&&null!==o?null==h?df(r,o,A):Hl(r,o,A,h||null,!0):1===n&&null!==o?Hl(r,o,A,h||null,!0):2===n?function vh(n,r,o){const a=kd(n,r);a&&function Ip(n,r,o,a){On(n)?n.removeChild(r,o,a):r.removeChild(o)}(n,a,r,o)}(r,A,C):3===n&&r.destroyNode(A),null!=y&&function ku(n,r,o,a,h){const y=o[7];y!==U(o)&&Nu(r,n,a,y,h);for(let A=10;A<o.length;A++){const O=o[A];js(O[1],O,n,r,a,y)}}(r,n,y,o,h)}}function Cc(n,r,o){if(On(n))return n.createElement(r,o);{const a=null!==o?function xs(n){const r=n.toLowerCase();return"svg"===r?"http://www.w3.org/2000/svg":"math"===r?"http://www.w3.org/1998/MathML/":null}(o):null;return null===a?n.createElement(r):n.createElementNS(a,r)}}function hu(n,r){const o=n[9],a=o.indexOf(r),h=r[3];1024&r[2]&&(r[2]&=-1025,pi(h,-1)),o.splice(a,1)}function Pd(n,r){if(n.length<=10)return;const o=10+r,a=n[o];if(a){const h=a[17];null!==h&&h!==n&&hu(h,a),r>0&&(n[o-1][4]=a[4]);const y=no(n,10+r);!function Aa(n,r){js(n,r,r[11],2,null,null),r[0]=null,r[6]=null}(a[1],a);const C=y[19];null!==C&&C.detachView(y[1]),a[3]=null,a[4]=null,a[2]&=-129}return a}function nd(n,r){if(!(256&r[2])){const o=r[11];On(o)&&o.destroyNode&&js(n,r,o,3,null,null),function To(n){let r=n[13];if(!r)return Od(n[1],n);for(;r;){let o=null;if(di(r))o=r[13];else{const a=r[10];a&&(o=a)}if(!o){for(;r&&!r[4]&&r!==n;)di(r)&&Od(r[1],r),r=r[3];null===r&&(r=n),di(r)&&Od(r[1],r),o=r&&r[4]}r=o}}(r)}}function Od(n,r){if(!(256&r[2])){r[2]&=-129,r[2]|=256,function Ep(n,r){let o;if(null!=n&&null!=(o=n.destroyHooks))for(let a=0;a<o.length;a+=2){const h=r[o[a]];if(!(h instanceof Gi)){const y=o[a+1];if(Array.isArray(y))for(let C=0;C<y.length;C+=2){const A=h[y[C]],O=y[C+1];try{O.call(A)}finally{}}else try{y.call(h)}finally{}}}}(n,r),function lf(n,r){const o=n.cleanup,a=r[7];let h=-1;if(null!==o)for(let y=0;y<o.length-1;y+=2)if("string"==typeof o[y]){const C=o[y+1],A="function"==typeof C?C(r):U(r[C]),O=a[h=o[y+2]],q=o[y+3];"boolean"==typeof q?A.removeEventListener(o[y],O,q):q>=0?a[h=q]():a[h=-q].unsubscribe(),y+=2}else{const C=a[h=o[y+1]];o[y].call(C)}if(null!==a){for(let y=h+1;y<a.length;y++)a[y]();r[7]=null}}(n,r),1===r[1].type&&On(r[11])&&r[11].destroy();const o=r[17];if(null!==o&&Di(r[3])){o!==r[3]&&hu(o,r);const a=r[19];null!==a&&a.detachView(n)}}}function cf(n,r,o){return function wp(n,r,o){let a=r;for(;null!==a&&40&a.type;)a=(r=a).parent;if(null===a)return o[0];if(2&a.flags){const h=n.data[a.directiveStart].encapsulation;if(h===Vt.None||h===Vt.Emulated)return null}return yt(a,o)}(n,r.parent,o)}function Hl(n,r,o,a,h){On(n)?n.insertBefore(r,o,a,h):r.insertBefore(o,a,h)}function df(n,r,o){On(n)?n.appendChild(r,o):r.appendChild(o)}function hf(n,r,o,a,h){null!==a?Hl(n,r,o,a,h):df(n,r,o)}function kd(n,r){return On(n)?n.parentNode(r):r.parentNode}function ff(n,r,o){return gf(n,r,o)}let gf=function pf(n,r,o){return 40&n.type?yt(n,o):null};function Fd(n,r,o,a){const h=cf(n,a,r),y=r[11],A=ff(a.parent||r[6],a,r);if(null!=h)if(Array.isArray(o))for(let O=0;O<o.length;O++)hf(y,h,o[O],A,!1);else hf(y,h,o,A,!1)}function Ld(n,r){if(null!==r){const o=r.type;if(3&o)return yt(r,n);if(4&o)return Vd(-1,n[r.index]);if(8&o){const a=r.child;if(null!==a)return Ld(n,a);{const h=n[r.index];return Di(h)?Vd(-1,h):U(h)}}if(32&o)return Le(r,n)()||U(n[r.index]);{const a=_h(n,r);return null!==a?Array.isArray(a)?a[0]:Ld(rn(n[16]),a):Ld(n,r.next)}}return null}function _h(n,r){return null!==r?n[16][6].projection[r.projection]:null}function Vd(n,r){const o=10+n+1;if(o<r.length){const a=r[o],h=a[1].firstChild;if(null!==h)return Ld(a,h)}return r[7]}function rd(n,r,o,a,h,y,C){for(;null!=o;){const A=a[o.index],O=o.type;if(C&&0===r&&(A&&qs(U(A),a),o.flags|=4),64!=(64&o.flags))if(8&O)rd(n,r,o.child,a,h,y,!1),Nu(r,n,h,A,y);else if(32&O){const q=Le(o,a);let J;for(;J=q();)Nu(r,n,h,J,y);Nu(r,n,h,A,y)}else 16&O?Ud(n,r,a,o,h,y):Nu(r,n,h,A,y);o=C?o.projectionNext:o.next}}function js(n,r,o,a,h,y){rd(o,a,n.firstChild,r,h,y,!1)}function Ud(n,r,o,a,h,y){const C=o[16],O=C[6].projection[a.projection];if(Array.isArray(O))for(let q=0;q<O.length;q++)Nu(r,n,h,O[q],y);else rd(n,r,O,C[3],h,y,!0)}function ya(n,r,o){On(n)?n.setAttribute(r,"style",o):r.style.cssText=o}function Gl(n,r,o){On(n)?""===o?n.removeAttribute(r,"class"):n.setAttribute(r,"class",o):r.className=o}function wh(n,r,o){let a=n.length;for(;;){const h=n.indexOf(r,o);if(-1===h)return h;if(0===h||n.charCodeAt(h-1)<=32){const y=r.length;if(h+y===a||n.charCodeAt(h+y)<=32)return h}o=h+1}}const Il="ng-template";function Wl(n,r,o){let a=0;for(;a<n.length;){let h=n[a++];if(o&&"class"===h){if(h=n[a],-1!==wh(h.toLowerCase(),r,0))return!0}else if(1===h){for(;a<n.length&&"string"==typeof(h=n[a++]);)if(h.toLowerCase()===r)return!0;return!1}}return!1}function _a(n){return 4===n.type&&n.value!==Il}function id(n,r,o){return r===(4!==n.type||o?n.value:Il)}function mf(n,r,o){let a=4;const h=n.attrs||[],y=function yf(n){for(let r=0;r<n.length;r++)if(Zo(n[r]))return r;return n.length}(h);let C=!1;for(let A=0;A<r.length;A++){const O=r[A];if("number"!=typeof O){if(!C)if(4&a){if(a=2|1&a,""!==O&&!id(n,O,o)||""===O&&1===r.length){if(ja(a))return!1;C=!0}}else{const q=8&a?O:r[++A];if(8&a&&null!==n.attrs){if(!Wl(n.attrs,q,o)){if(ja(a))return!1;C=!0}continue}const he=Ch(8&a?"class":O,h,_a(n),o);if(-1===he){if(ja(a))return!1;C=!0;continue}if(""!==q){let Ae;Ae=he>y?"":h[he+1].toLowerCase();const Ze=8&a?Ae:null;if(Ze&&-1!==wh(Ze,q,0)||2&a&&q!==Ae){if(ja(a))return!1;C=!0}}}}else{if(!C&&!ja(a)&&!ja(O))return!1;if(C&&ja(O))continue;C=!1,a=O|1&a}}return ja(a)||C}function ja(n){return 0==(1&n)}function Ch(n,r,o,a){if(null===r)return-1;let h=0;if(a||!o){let y=!1;for(;h<r.length;){const C=r[h];if(C===n)return h;if(3===C||6===C)y=!0;else{if(1===C||2===C){let A=r[++h];for(;"string"==typeof A;)A=r[++h];continue}if(4===C)break;if(0===C){h+=4;continue}}h+=y?1:2}return-1}return function Dh(n,r){let o=n.indexOf(4);if(o>-1)for(o++;o<n.length;){const a=n[o];if("number"==typeof a)return-1;if(a===r)return o;o++}return-1}(r,n)}function Bd(n,r,o=!1){for(let a=0;a<r.length;a++)if(mf(n,r[a],o))return!0;return!1}function bc(n,r){e:for(let o=0;o<r.length;o++){const a=r[o];if(n.length===a.length){for(let h=0;h<n.length;h++)if(n[h]!==a[h])continue e;return!0}}return!1}function sd(n,r){return n?":not("+r.trim()+")":r}function Dc(n){let r=n[0],o=1,a=2,h="",y=!1;for(;o<n.length;){let C=n[o];if("string"==typeof C)if(2&a){const A=n[++o];h+="["+C+(A.length>0?'="'+A+'"':"")+"]"}else 8&a?h+="."+C:4&a&&(h+=" "+C);else""!==h&&!ja(C)&&(r+=sd(y,h),h=""),a=C,y=y||!ja(a);o++}return""!==h&&(r+=sd(y,h)),r}const dr={};function Th(n){Sh(R(),E(),Si()+n,Br())}function Sh(n,r,o,a){if(!a)if(3==(3&r[2])){const y=n.preOrderCheckHooks;null!==y&&Po(r,y,o)}else{const y=n.preOrderHooks;null!==y&&Xs(r,y,0,o)}fo(o)}function Cl(n,r){return n<<17|r<<2}function Go(n){return n>>17&32767}function Ah(n){return 2|n}function Fu(n){return(131068&n)>>2}function od(n,r){return-131069&n|r<<2}function xh(n){return 1|n}function Rp(n,r){const o=n.contentQueries;if(null!==o)for(let a=0;a<o.length;a+=2){const h=o[a],y=o[a+1];if(-1!==y){const C=n.data[y];Ro(h),C.contentQueries(2,r[y],y)}}}function Rh(n,r,o,a,h,y,C,A,O,q){const J=r.blueprint.slice();return J[0]=h,J[2]=140|a,zn(J),J[3]=J[15]=n,J[8]=o,J[10]=C||n&&n[10],J[11]=A||n&&n[11],J[12]=O||n&&n[12]||null,J[9]=q||n&&n[9]||null,J[6]=y,J[16]=2==r.type?n[16]:J,J}function ld(n,r,o,a,h){let y=n.data[r];if(null===y)y=function Mh(n,r,o,a,h){const y=Te(),C=Gt(),O=n.data[r]=function Hd(n,r,o,a,h,y){return{type:o,index:a,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:y,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,C?y:y&&y.parent,o,r,a,h);return null===n.firstChild&&(n.firstChild=O),null!==y&&(C?null==y.child&&null!==O.parent&&(y.child=O):null===y.next&&(y.next=O)),O}(n,r,o,a,h),function Ms(){return fn.lFrame.inI18n}()&&(y.flags|=64);else if(64&y.type){y.type=o,y.value=a,y.attrs=h;const C=function Ke(){const n=fn.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();y.injectorIndex=null===C?-1:C.injectorIndex}return mt(y,!0),y}function Sc(n,r,o,a){if(0===o)return-1;const h=r.length;for(let y=0;y<o;y++)r.push(a),n.blueprint.push(a),n.data.push(null);return h}function Kl(n,r,o){zo(r);try{const a=n.viewQuery;null!==a&&kh(1,a,o);const h=n.template;null!==h&&bf(n,r,h,1,o),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Rp(n,r),n.staticViewQueries&&kh(2,n.viewQuery,o);const y=n.components;null!==y&&function Cf(n,r){for(let o=0;o<r.length;o++)u_(n,r[o])}(r,y)}catch(a){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),a}finally{r[2]&=-5,Ma()}}function ql(n,r,o,a){const h=r[2];if(256==(256&h))return;zo(r);const y=Br();try{zn(r),function Ti(n){return fn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==o&&bf(n,r,o,2,a);const C=3==(3&h);if(!y)if(C){const q=n.preOrderCheckHooks;null!==q&&Po(r,q,null)}else{const q=n.preOrderHooks;null!==q&&Xs(r,q,0,null),qo(r,0)}if(function o_(n){for(let r=fs(n);null!==r;r=sa(r)){if(!r[2])continue;const o=r[9];for(let a=0;a<o.length;a++){const h=o[a],y=h[3];0==(1024&h[2])&&pi(y,1),h[2]|=1024}}}(r),function s_(n){for(let r=fs(n);null!==r;r=sa(r))for(let o=10;o<r.length;o++){const a=r[o],h=a[1];qr(a)&&ql(h,a,h.template,a[8])}}(r),null!==n.contentQueries&&Rp(n,r),!y)if(C){const q=n.contentCheckHooks;null!==q&&Po(r,q)}else{const q=n.contentHooks;null!==q&&Xs(r,q,1),qo(r,1)}!function e_(n,r){const o=n.hostBindingOpCodes;if(null!==o)try{for(let a=0;a<o.length;a++){const h=o[a];if(h<0)fo(~h);else{const y=h,C=o[++a],A=o[++a];Pi(C,y),A(2,r[y])}}}finally{fo(-1)}}(n,r);const A=n.components;null!==A&&function t_(n,r){for(let o=0;o<r.length;o++)a_(n,r[o])}(r,A);const O=n.viewQuery;if(null!==O&&kh(2,O,a),!y)if(C){const q=n.viewCheckHooks;null!==q&&Po(r,q)}else{const q=n.viewHooks;null!==q&&Xs(r,q,2),qo(r,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),y||(r[2]&=-73),1024&r[2]&&(r[2]&=-1025,pi(r[3],-1))}finally{Ma()}}function Mp(n,r,o,a){const h=r[10],y=!Br(),C=Jn(r);try{y&&!C&&h.begin&&h.begin(),C&&Kl(n,r,a),ql(n,r,o,a)}finally{y&&!C&&h.end&&h.end()}}function bf(n,r,o,a,h){const y=Si(),C=2&a;try{fo(-1),C&&r.length>20&&Sh(n,r,20,Br()),o(a,h)}finally{fo(y)}}function Pp(n,r,o){!G()||(function Nh(n,r,o,a){const h=o.directiveStart,y=o.directiveEnd;n.firstCreatePass||xt(o,r),qs(a,r);const C=o.initialInputs;for(let A=h;A<y;A++){const O=n.data[A],q=ns(O);q&&i_(r,o,O);const J=Jt(r,n,A,o);qs(J,r),null!==C&&Of(0,A-h,J,O,0,C),q&&(kn(o.index,r)[8]=J)}}(n,r,o,yt(o,r)),128==(128&o.flags)&&function Rf(n,r,o){const a=o.directiveStart,h=o.directiveEnd,C=o.index,A=function Js(){return fn.lFrame.currentDirectiveIndex}();try{fo(C);for(let O=a;O<h;O++){const q=n.data[O],J=r[O];_o(O),(null!==q.hostBindings||0!==q.hostVars||null!==q.hostAttrs)&&Mf(q,J)}}finally{fo(-1),_o(A)}}(n,r,o))}function Df(n,r,o=yt){const a=r.localNames;if(null!==a){let h=r.index+1;for(let y=0;y<a.length;y+=2){const C=a[y+1],A=-1===C?o(r,n):n[C];n[h++]=A}}}function Op(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=$d(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):r}function $d(n,r,o,a,h,y,C,A,O,q){const J=20+a,he=J+h,Ae=function n_(n,r){const o=[];for(let a=0;a<r;a++)o.push(a<n?null:dr);return o}(J,he),Ze="function"==typeof q?q():q;return Ae[1]={type:n,blueprint:Ae,template:o,queries:null,viewQuery:A,declTNode:r,data:Ae.slice().fill(null,J),bindingStartIndex:J,expandoStartIndex:he,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof y?y():y,pipeRegistry:"function"==typeof C?C():C,firstChild:null,schemas:O,consts:Ze,incompleteFirstPass:!1}}function am(n,r,o,a){const h=vm(r);null===o?h.push(a):(h.push(o),n.firstCreatePass&&Ff(n).push(a,h.length-1))}function cd(n,r,o){for(let a in n)if(n.hasOwnProperty(a)){const h=n[a];(o=null===o?{}:o).hasOwnProperty(a)?o[a].push(r,h):o[a]=[r,h]}return o}function Sf(n,r,o,a){let h=!1;if(G()){const y=function Vp(n,r,o){const a=n.directiveRegistry;let h=null;if(a)for(let y=0;y<a.length;y++){const C=a[y];Bd(o,C.selectors,!1)&&(h||(h=[]),S(xt(o,r),n,C.type),ns(C)?(Nf(n,o),h.unshift(C)):h.push(C))}return h}(n,r,o),C=null===a?null:{"":-1};if(null!==y){h=!0,Up(o,n.data.length,y.length);for(let J=0;J<y.length;J++){const he=y[J];he.providersResolver&&he.providersResolver(he)}let A=!1,O=!1,q=Sc(n,r,y.length,null);for(let J=0;J<y.length;J++){const he=y[J];o.mergedAttrs=eo(o.mergedAttrs,he.hostAttrs),gm(n,o,r,q,he),r_(q,he,C),null!==he.contentQueries&&(o.flags|=8),(null!==he.hostBindings||null!==he.hostAttrs||0!==he.hostVars)&&(o.flags|=128);const Ae=he.type.prototype;!A&&(Ae.ngOnChanges||Ae.ngOnInit||Ae.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(o.index),A=!0),!O&&(Ae.ngOnChanges||Ae.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(o.index),O=!0),q++}!function Lp(n,r){const a=r.directiveEnd,h=n.data,y=r.attrs,C=[];let A=null,O=null;for(let q=r.directiveStart;q<a;q++){const J=h[q],he=J.inputs,Ae=null===y||_a(r)?null:Ph(he,y);C.push(Ae),A=cd(he,q,A),O=cd(J.outputs,q,O)}null!==A&&(A.hasOwnProperty("class")&&(r.flags|=16),A.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=C,r.inputs=A,r.outputs=O}(n,o)}C&&function pm(n,r,o){if(r){const a=n.localNames=[];for(let h=0;h<r.length;h+=2){const y=o[r[h+1]];if(null==y)throw new at(-301,!1);a.push(r[h],y)}}}(o,a,C)}return o.mergedAttrs=eo(o.mergedAttrs,o.attrs),h}function Af(n,r,o,a,h,y){const C=y.hostBindings;if(C){let A=n.hostBindingOpCodes;null===A&&(A=n.hostBindingOpCodes=[]);const O=~r.index;(function xf(n){let r=n.length;for(;r>0;){const o=n[--r];if("number"==typeof o&&o<0)return o}return 0})(A)!=O&&A.push(O),A.push(a,h,C)}}function Mf(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function Nf(n,r){r.flags|=2,(n.components||(n.components=[])).push(r.index)}function r_(n,r,o){if(o){if(r.exportAs)for(let a=0;a<r.exportAs.length;a++)o[r.exportAs[a]]=n;ns(r)&&(o[""]=n)}}function Up(n,r,o){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+o,n.providerIndexes=r}function gm(n,r,o,a,h){n.data[a]=h;const y=h.factory||(h.factory=ti(h.type)),C=new Gi(y,ns(h),null);n.blueprint[a]=C,o[a]=C,Af(n,r,0,a,Sc(n,o,h.hostVars,dr),h)}function i_(n,r,o){const a=yt(r,n),h=Op(o),y=n[10],C=Gd(n,Rh(n,h,null,o.onPush?64:16,a,r,y,y.createRenderer(a,o),null,null));n[r.index]=C}function Dl(n,r,o,a,h,y){const C=yt(n,r);!function Pf(n,r,o,a,h,y,C){if(null==y)On(n)?n.removeAttribute(r,h,o):r.removeAttribute(h);else{const A=null==C?nt(y):C(y,a||"",h);On(n)?n.setAttribute(r,h,A,o):o?r.setAttributeNS(o,h,A):r.setAttribute(h,A)}}(r[11],C,y,n.value,o,a,h)}function Of(n,r,o,a,h,y){const C=y[r];if(null!==C){const A=a.setInput;for(let O=0;O<C.length;){const q=C[O++],J=C[O++],he=C[O++];null!==A?a.setInput(o,he,q,J):o[J]=he}}}function Ph(n,r){let o=null,a=0;for(;a<r.length;){const h=r[a];if(0!==h)if(5!==h){if("number"==typeof h)break;n.hasOwnProperty(h)&&(null===o&&(o=[]),o.push(h,n[h],r[a+1])),a+=2}else a+=2;else a+=4}return o}function Bp(n,r,o,a){return new Array(n,!0,!1,r,null,0,a,o,null,null)}function a_(n,r){const o=kn(r,n);if(qr(o)){const a=o[1];80&o[2]?ql(a,o,a.template,o[8]):o[5]>0&&jp(o)}}function jp(n){for(let a=fs(n);null!==a;a=sa(a))for(let h=10;h<a.length;h++){const y=a[h];if(1024&y[2]){const C=y[1];ql(C,y,C.template,y[8])}else y[5]>0&&jp(y)}const o=n[1].components;if(null!==o)for(let a=0;a<o.length;a++){const h=kn(o[a],n);qr(h)&&h[5]>0&&jp(h)}}function u_(n,r){const o=kn(r,n),a=o[1];(function Oh(n,r){for(let o=r.length;o<n.blueprint.length;o++)r.push(n.blueprint[o])})(a,o),Kl(a,o,o[8])}function Gd(n,r){return n[13]?n[14][4]=r:n[13]=r,n[14]=r,r}function Ac(n){for(;n;){n[2]|=64;const r=rn(n);if(oo(n)&&!r)return n;n=r}return null}function dd(n,r,o){const a=r[10];a.begin&&a.begin();try{ql(n,r,n.template,o)}catch(h){throw Lf(r,h),h}finally{a.end&&a.end()}}function kf(n){!function Wd(n){for(let r=0;r<n.components.length;r++){const o=n.components[r],a=gc(o),h=a[1];Mp(h,a,h.template,o)}}(n[8])}function kh(n,r,o){Ro(0),r(n,o)}const _m=(()=>Promise.resolve(null))();function vm(n){return n[7]||(n[7]=[])}function Ff(n){return n.cleanup||(n.cleanup=[])}function Lf(n,r){const o=n[9],a=o?o.get(Ul,null):null;a&&a.handleError(r)}function wm(n,r,o,a,h){for(let y=0;y<o.length;){const C=o[y++],A=o[y++],O=r[C],q=n.data[C];null!==q.setInput?q.setInput(O,h,a,A):O[A]=h}}function il(n,r,o){const a=rt(r,n);!function Pu(n,r,o){On(n)?n.setValue(r,o):r.textContent=o}(n[11],a,o)}function fd(n,r,o){let a=o?n.styles:null,h=o?n.classes:null,y=0;if(null!==r)for(let C=0;C<r.length;C++){const A=r[C];"number"==typeof A?y=A:1==y?h=Be(h,A):2==y&&(a=Be(a,A+": "+r[++C]+";"))}o?n.styles=a:n.stylesWithoutHost=a,o?n.classes=h:n.classesWithoutHost=h}const Lh=new Qi("INJECTOR",-1);class Cm{get(r,o=ki){if(o===ki){const a=new Error(`NullInjectorError: No provider for ${Me(r)}!`);throw a.name="NullInjectorError",a}return o}}const Wp=new Qi("Set Injector scope."),zd={},bm={};let zp;function Vf(){return void 0===zp&&(zp=new Cm),zp}function Dm(n,r=null,o=null,a){const h=Uf(n,r,o,a);return h._resolveInjectorDefTypes(),h}function Uf(n,r=null,o=null,a){return new l_(n,o,r||Vf(),a)}class l_{constructor(r,o,a,h=null){this.parent=a,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const y=[];o&&Qe(o,A=>this.processProvider(A,r,o)),Qe([r],A=>this.processInjectorType(A,[],y)),this.records.set(Lh,xc(void 0,this));const C=this.records.get(Wp);this.scope=null!=C?C.value:null,this.source=h||("object"==typeof r?null:Me(r))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(r=>r.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(r,o=ki,a=Bt.Default){this.assertNotDestroyed();const h=Xe(this),y=ln(void 0);try{if(!(a&Bt.SkipSelf)){let A=this.records.get(r);if(void 0===A){const O=function Tm(n){return"function"==typeof n||"object"==typeof n&&n instanceof Qi}(r)&&Yt(r);A=O&&this.injectableDefInScope(O)?xc(Vh(r),zd):null,this.records.set(r,A)}if(null!=A)return this.hydrate(r,A)}return(a&Bt.Self?Vf():this.parent).get(r,o=a&Bt.Optional&&o===ki?null:o)}catch(C){if("NullInjectorError"===C.name){if((C[bo]=C[bo]||[]).unshift(Me(r)),h)throw C;return function zs(n,r,o,a){const h=n[bo];throw r[X]&&h.unshift(r[X]),n.message=function ks(n,r,o,a=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let h=Me(r);if(Array.isArray(r))h=r.map(Me).join(" -> ");else if("object"==typeof r){let y=[];for(let C in r)if(r.hasOwnProperty(C)){let A=r[C];y.push(C+":"+("string"==typeof A?JSON.stringify(A):Me(A)))}h=`{${y.join(", ")}}`}return`${o}${a?"("+a+")":""}[${h}]: ${n.replace(L,"\n  ")}`}("\n"+n.message,h,o,a),n.ngTokenPath=h,n[bo]=null,n}(C,r,"R3InjectorError",this.source)}throw C}finally{ln(y),Xe(h)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(r=>this.get(r))}toString(){const r=[];return this.records.forEach((a,h)=>r.push(Me(h))),`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new at(205,!1)}processInjectorType(r,o,a){if(!(r=Re(r)))return!1;let h=Pn(r);const y=null==h&&r.ngModule||void 0,C=void 0===y?r:y,A=-1!==a.indexOf(C);if(void 0!==y&&(h=Pn(y)),null==h)return!1;if(null!=h.imports&&!A){let J;a.push(C);try{Qe(h.imports,he=>{this.processInjectorType(he,o,a)&&(void 0===J&&(J=[]),J.push(he))})}finally{}if(void 0!==J)for(let he=0;he<J.length;he++){const{ngModule:Ae,providers:Ze}=J[he];Qe(Ze,vt=>this.processProvider(vt,Ae,Ze||dn))}}this.injectorDefTypes.add(C);const O=ti(C)||(()=>new C);this.records.set(C,xc(O,zd));const q=h.providers;if(null!=q&&!A){const J=r;Qe(q,he=>this.processProvider(he,J,q))}return void 0!==y&&void 0!==r.providers}processProvider(r,o,a){let h=pu(r=Re(r))?r:Re(r&&r.provide);const y=function Kp(n,r,o){return Bf(n)?xc(void 0,n.useValue):xc(qp(n),zd)}(r);if(pu(r)||!0!==r.multi)this.records.get(h);else{let C=this.records.get(h);C||(C=xc(void 0,zd,!0),C.factory=()=>ir(C.multi),this.records.set(h,C)),h=r,C.multi.push(r)}this.records.set(h,y)}hydrate(r,o){return o.value===zd&&(o.value=bm,o.value=o.factory()),"object"==typeof o.value&&o.value&&function Zd(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(o.value)&&this.onDestroy.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=Re(r.providedIn);return"string"==typeof o?"any"===o||o===this.scope:this.injectorDefTypes.has(o)}}function Vh(n){const r=Yt(n),o=null!==r?r.factory:ti(n);if(null!==o)return o;if(n instanceof Qi)throw new at(204,!1);if(n instanceof Function)return function c_(n){const r=n.length;if(r>0)throw Za(r,"?"),new at(204,!1);const o=function fr(n){const r=n&&(n[Hr]||n[Ar]);if(r){const o=function sr(n){if(n.hasOwnProperty("name"))return n.name;const r=(""+n).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${o}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${o}" class.`),r}return null}(n);return null!==o?()=>o.factory(n):()=>new n}(n);throw new at(204,!1)}function qp(n,r,o){let a;if(pu(n)){const h=Re(n);return ti(h)||Vh(h)}if(Bf(n))a=()=>Re(n.useValue);else if(function Kd(n){return!(!n||!n.useFactory)}(n))a=()=>n.useFactory(...ir(n.deps||[]));else if(function Zp(n){return!(!n||!n.useExisting)}(n))a=()=>Ot(Re(n.useExisting));else{const h=Re(n&&(n.useClass||n.provide));if(!function qd(n){return!!n.deps}(n))return ti(h)||Vh(h);a=()=>new h(...ir(n.deps))}return a}function xc(n,r,o=!1){return{factory:n,value:r,multi:o?[]:void 0}}function Bf(n){return null!==n&&"object"==typeof n&&me in n}function pu(n){return"function"==typeof n}let xa=(()=>{class n{static create(o,a){var h;if(Array.isArray(o))return Dm({name:""},a,o,"");{const y=null!==(h=o.name)&&void 0!==h?h:"";return Dm({name:y},o.parent,o.providers,y)}}}return n.THROW_IF_NOT_FOUND=ki,n.NULL=new Cm,n.\u0275prov=Kt({token:n,providedIn:"any",factory:()=>Ot(Lh)}),n.__NG_ELEMENT_ID__=-1,n})();function tg(n,r){Wa(gc(n)[1],oe())}function qf(n){let r=function Kf(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),o=!0;const a=[n];for(;r;){let h;if(ns(n))h=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new at(903,"");h=r.\u0275dir}if(h){if(o){a.push(h);const C=n;C.inputs=Uh(n.inputs),C.declaredInputs=Uh(n.declaredInputs),C.outputs=Uh(n.outputs);const A=h.hostBindings;A&&E_(n,A);const O=h.viewQuery,q=h.contentQueries;if(O&&v_(n,O),q&&ng(n,q),Ve(n.inputs,h.inputs),Ve(n.declaredInputs,h.declaredInputs),Ve(n.outputs,h.outputs),ns(h)&&h.data.animation){const J=n.data;J.animation=(J.animation||[]).concat(h.data.animation)}}const y=h.features;if(y)for(let C=0;C<y.length;C++){const A=y[C];A&&A.ngInherit&&A(n),A===qf&&(o=!1)}}r=Object.getPrototypeOf(r)}!function __(n){let r=0,o=null;for(let a=n.length-1;a>=0;a--){const h=n[a];h.hostVars=r+=h.hostVars,h.hostAttrs=eo(h.hostAttrs,o=eo(o,h.hostAttrs))}}(a)}function Uh(n){return n===vr?{}:n===dn?[]:n}function v_(n,r){const o=n.viewQuery;n.viewQuery=o?(a,h)=>{r(a,h),o(a,h)}:r}function ng(n,r){const o=n.contentQueries;n.contentQueries=o?(a,h,y)=>{r(a,h,y),o(a,h,y)}:r}function E_(n,r){const o=n.hostBindings;n.hostBindings=o?(a,h)=>{r(a,h),o(a,h)}:r}let Yd=null;function Rc(){if(!Yd){const n=cn.Symbol;if(n&&n.iterator)Yd=n.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let o=0;o<r.length;++o){const a=r[o];"entries"!==a&&"size"!==a&&Map.prototype[a]===Map.prototype.entries&&(Yd=a)}}}return Yd}function Jd(n){return!!Bh(n)&&(Array.isArray(n)||!(n instanceof Map)&&Rc()in n)}function Bh(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function oa(n,r,o){return n[r]=o}function Ra(n,r,o){return!Object.is(n[r],o)&&(n[r]=o,!0)}function jh(n,r,o,a){const h=E();return Ra(h,Cr(),r)&&(R(),Dl(Hi(),h,n,r,o,a)),jh}function Bm(n,r,o,a,h,y,C,A){const O=E(),q=R(),J=n+20,he=q.firstCreatePass?function Um(n,r,o,a,h,y,C,A,O){const q=r.consts,J=ld(r,n,4,C||null,$r(q,A));Sf(r,o,J,$r(q,O)),Wa(r,J);const he=J.tViews=$d(2,J,a,h,y,r.directiveRegistry,r.pipeRegistry,null,r.schemas,q);return null!==r.queries&&(r.queries.template(r,J),he.queries=r.queries.embeddedTView(J)),J}(J,q,O,r,o,a,h,y,C):q.data[J];mt(he,!1);const Ae=O[11].createComment("");Fd(q,O,Ae,he),qs(Ae,O),Gd(O,O[J]=Bp(Ae,O,Ae,he)),vi(he)&&Pp(q,O,he),null!=C&&Df(O,he,A)}function ug(n){return Wn(function cr(){return fn.lFrame.contextLView}(),20+n)}function tu(n,r=Bt.Default){const o=E();return null===o?Ot(n,r):P(oe(),o,Re(n),r)}function Eg(){throw new Error("invalid")}function wg(n,r,o){const a=E();return Ra(a,Cr(),r)&&function eu(n,r,o,a,h,y,C,A){const O=yt(r,o);let J,q=r.inputs;!A&&null!=q&&(J=q[a])?(wm(n,o,J,a,h),qi(r)&&function um(n,r){const o=kn(r,n);16&o[2]||(o[2]|=64)}(o,r.index)):3&r.type&&(a=function Tf(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(a),h=null!=C?C(h,r.value||"",a):h,On(y)?y.setProperty(O,a,h):Yo(a)||(O.setProperty?O.setProperty(a,h):O[a]=h))}(R(),Hi(),a,n,r,a[11],o,!1),wg}function ih(n,r,o,a,h){const C=h?"class":"style";wm(n,o,r.inputs[C],C,a)}function Gh(n,r,o,a){const h=E(),y=R(),C=20+n,A=h[11],O=h[C]=Cc(A,r,function Pa(){return fn.lFrame.currentNamespace}()),q=y.firstCreatePass?function Ym(n,r,o,a,h,y,C){const A=r.consts,q=ld(r,n,2,h,$r(A,y));return Sf(r,o,q,$r(A,C)),null!==q.attrs&&fd(q,q.attrs,!1),null!==q.mergedAttrs&&fd(q,q.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,q),q}(C,y,h,0,r,o,a):y.data[C];mt(q,!0);const J=q.mergedAttrs;null!==J&&mi(A,O,J);const he=q.classes;null!==he&&Gl(A,O,he);const Ae=q.styles;return null!==Ae&&ya(A,O,Ae),64!=(64&q.flags)&&Fd(y,h,O,q),0===function ho(){return fn.lFrame.elementDepthCount}()&&qs(O,h),function ds(){fn.lFrame.elementDepthCount++}(),vi(q)&&(Pp(y,h,q),function Np(n,r,o){if(Qs(r)){const h=r.directiveEnd;for(let y=r.directiveStart;y<h;y++){const C=n.data[y];C.contentQueries&&C.contentQueries(1,o[y],y)}}}(y,q,h)),null!==a&&Df(h,q),Gh}function ip(){let n=oe();Gt()?Ut():(n=n.parent,mt(n,!1));const r=n;!function Ni(){fn.lFrame.elementDepthCount--}();const o=R();return o.firstCreatePass&&(Wa(o,n),Qs(n)&&o.queries.elementEnd(n)),null!=r.classesWithoutHost&&function za(n){return 0!=(16&n.flags)}(r)&&ih(o,r,E(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function Ns(n){return 0!=(32&n.flags)}(r)&&ih(o,r,E(),r.stylesWithoutHost,!1),ip}function Wh(n,r,o,a){return Gh(n,r,o,a),ip(),Wh}function mo(){return E()}function sp(n){return!!n&&"function"==typeof n.then}function Jm(n){return!!n&&"function"==typeof n.subscribe}const Xm=Jm;function op(n,r,o,a){const h=E(),y=R(),C=oe();return function ty(n,r,o,a,h,y,C,A){const O=vi(a),J=n.firstCreatePass&&Ff(n),he=r[8],Ae=vm(r);let Ze=!0;if(3&a.type||A){const sn=yt(a,r),bn=A?A(sn):sn,Mt=Ae.length,qn=A?ni=>A(U(ni[a.index])):a.index;if(On(o)){let ni=null;if(!A&&O&&(ni=function k_(n,r,o,a){const h=n.cleanup;if(null!=h)for(let y=0;y<h.length-1;y+=2){const C=h[y];if(C===o&&h[y+1]===a){const A=r[7],O=h[y+2];return A.length>O?A[O]:null}"string"==typeof C&&(y+=2)}return null}(n,r,h,a.index)),null!==ni)(ni.__ngLastListenerFn__||ni).__ngNextListenerFn__=y,ni.__ngLastListenerFn__=y,Ze=!1;else{y=ry(a,r,he,y,!1);const es=o.listen(bn,h,y);Ae.push(y,es),J&&J.push(h,qn,Mt,Mt+1)}}else y=ry(a,r,he,y,!0),bn.addEventListener(h,y,C),Ae.push(y),J&&J.push(h,qn,Mt,C)}else y=ry(a,r,he,y,!1);const vt=a.outputs;let jt;if(Ze&&null!==vt&&(jt=vt[h])){const sn=jt.length;if(sn)for(let bn=0;bn<sn;bn+=2){const ol=r[jt[bn]][jt[bn+1]].subscribe(y),uf=Ae.length;Ae.push(y,ol),J&&J.push(h,a.index,uf,-(uf+1))}}}(y,h,h[11],C,n,r,!!o,a),op}function ny(n,r,o,a){try{return!1!==o(a)}catch(h){return Lf(n,h),!1}}function ry(n,r,o,a,h){return function y(C){if(C===Function)return a;const A=2&n.flags?kn(n.index,r):r;0==(32&r[2])&&Ac(A);let O=ny(r,0,a,C),q=y.__ngNextListenerFn__;for(;q;)O=ny(r,0,q,C)&&O,q=q.__ngNextListenerFn__;return h&&!1===O&&(C.preventDefault(),C.returnValue=!1),O}}function iy(n=1){return function No(n){return(fn.lFrame.contextLView=function Na(n,r){for(;n>0;)r=r[15],n--;return r}(n,fn.lFrame.contextLView))[8]}(n)}function F_(n,r){let o=null;const a=function bh(n){const r=n.attrs;if(null!=r){const o=r.indexOf(5);if(0==(1&o))return r[o+1]}return null}(n);for(let h=0;h<r.length;h++){const y=r[h];if("*"!==y){if(null===a?Bd(n,y,!0):bc(a,y))return h}else o=h}return o}function Ig(n){const r=E()[16][6];if(!r.projection){const a=r.projection=Za(n?n.length:1,null),h=a.slice();let y=r.child;for(;null!==y;){const C=n?F_(y,n):0;null!==C&&(h[C]?h[C].projectionNext=y:a[C]=y,h[C]=y),y=y.next}}}function Tl(n,r=0,o){const a=E(),h=R(),y=ld(h,20+n,16,null,o||null);null===y.projection&&(y.projection=r),Ut(),64!=(64&y.flags)&&function Eh(n,r,o){Ud(r[11],0,r,o,cf(n,o,r),ff(o.parent||r[6],o,r))}(h,a,y)}function Dg(n,r,o,a,h){const y=n[o+1],C=null===r;let A=a?Go(y):Fu(y),O=!1;for(;0!==A&&(!1===O||C);){const J=n[A+1];Tg(n[A],r)&&(O=!0,n[A+1]=a?xh(J):Ah(J)),A=a?Go(J):Fu(J)}O&&(n[o+1]=a?Ah(y):xh(y))}function Tg(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&os(n,r)>=0}function Mg(n,r){return function aa(n,r,o,a){const h=E(),y=R(),C=function gi(n){const r=fn.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,o}(2);y.firstUpdatePass&&function Pg(n,r,o,a){const h=n.data;if(null===h[o+1]){const y=h[Si()],C=function Ng(n,r){return r>=n.expandoStartIndex}(n,o);(function gy(n,r){return 0!=(n.flags&(r?16:32))})(y,a)&&null===r&&!C&&(r=!1),r=function Yh(n,r,o,a){const h=function la(n){const r=fn.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let y=a?r.residualClasses:r.residualStyles;if(null===h)0===(a?r.classBindings:r.styleBindings)&&(o=Qh(o=Og(null,n,r,o,a),r.attrs,a),y=null);else{const C=r.directiveStylingLast;if(-1===C||n[C]!==h)if(o=Og(h,n,r,o,a),null===y){let O=function Lc(n,r,o){const a=o?r.classBindings:r.styleBindings;if(0!==Fu(a))return n[Go(a)]}(n,r,a);void 0!==O&&Array.isArray(O)&&(O=Og(null,n,r,O[1],a),O=Qh(O,r.attrs,a),function B_(n,r,o,a){n[Go(o?r.classBindings:r.styleBindings)]=a}(n,r,a,O))}else y=function j_(n,r,o){let a;const h=r.directiveEnd;for(let y=1+r.directiveStylingLast;y<h;y++)a=Qh(a,n[y].hostAttrs,o);return Qh(a,r.attrs,o)}(n,r,a)}return void 0!==y&&(a?r.residualClasses=y:r.residualStyles=y),o}(h,y,r,a),function ap(n,r,o,a,h,y){let C=y?r.classBindings:r.styleBindings,A=Go(C),O=Fu(C);n[a]=o;let J,q=!1;if(Array.isArray(o)){const he=o;J=he[1],(null===J||os(he,J)>0)&&(q=!0)}else J=o;if(h)if(0!==O){const Ae=Go(n[A+1]);n[a+1]=Cl(Ae,A),0!==Ae&&(n[Ae+1]=od(n[Ae+1],a)),n[A+1]=function vf(n,r){return 131071&n|r<<17}(n[A+1],a)}else n[a+1]=Cl(A,0),0!==A&&(n[A+1]=od(n[A+1],a)),A=a;else n[a+1]=Cl(O,0),0===A?A=a:n[O+1]=od(n[O+1],a),O=a;q&&(n[a+1]=Ah(n[a+1])),Dg(n,J,a,!0),Dg(n,J,a,!1),function qh(n,r,o,a,h){const y=h?n.residualClasses:n.residualStyles;null!=y&&"string"==typeof r&&os(y,r)>=0&&(o[a+1]=xh(o[a+1]))}(r,J,n,a,y),C=Cl(A,O),y?r.classBindings=C:r.styleBindings=C}(h,y,r,o,C,a)}}(y,n,C,a),r!==dr&&Ra(h,C,r)&&function kg(n,r,o,a,h,y,C,A){if(!(3&r.type))return;const O=n.data,q=O[A+1];cp(function ad(n){return 1==(1&n)}(q)?fy(O,r,o,h,Fu(q),C):void 0)||(cp(y)||function rl(n){return 2==(2&n)}(q)&&(y=fy(O,null,o,h,A,C)),function ps(n,r,o,a,h){const y=On(n);if(r)h?y?n.addClass(o,a):o.classList.add(a):y?n.removeClass(o,a):o.classList.remove(a);else{let C=-1===a.indexOf("-")?void 0:z.DashCase;if(null==h)y?n.removeStyle(o,a,C):o.style.removeProperty(a);else{const A="string"==typeof h&&h.endsWith("!important");A&&(h=h.slice(0,-10),C|=z.Important),y?n.setStyle(o,a,h,C):o.style.setProperty(a,h,A?"important":"")}}}(a,C,rt(Si(),o),h,y))}(y,y.data[Si()],h,h[11],n,h[C+1]=function py(n,r){return null==n||("string"==typeof r?n+=r:"object"==typeof n&&(n=Me(uu(n)))),n}(r,o),a,C)}(n,r,null,!0),Mg}function Og(n,r,o,a,h){let y=null;const C=o.directiveEnd;let A=o.directiveStylingLast;for(-1===A?A=o.directiveStart:A++;A<C&&(y=r[A],a=Qh(a,y.hostAttrs,h),y!==n);)A++;return null!==n&&(o.directiveStylingLast=A),a}function Qh(n,r,o){const a=o?1:2;let h=-1;if(null!==r)for(let y=0;y<r.length;y++){const C=r[y];"number"==typeof C?h=C:h===a&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Xo(n,C,!!o||r[++y]))}return void 0===n?null:n}function fy(n,r,o,a,h,y){const C=null===r;let A;for(;h>0;){const O=n[h],q=Array.isArray(O),J=q?O[1]:O,he=null===J;let Ae=o[h+1];Ae===dr&&(Ae=he?dn:void 0);let Ze=he?ll(Ae,a):J===a?Ae:void 0;if(q&&!cp(Ze)&&(Ze=ll(O,a)),cp(Ze)&&(A=Ze,C))return A;const vt=n[h+1];h=C?Go(vt):Fu(vt)}if(null!==r){let O=y?r.residualClasses:r.residualStyles;null!=O&&(A=ll(O,a))}return A}function cp(n){return void 0!==n}function my(n,r=""){const o=E(),a=R(),h=n+20,y=a.firstCreatePass?ld(a,h,1,r,null):a.data[h],C=o[h]=function Ic(n,r){return On(n)?n.createText(r):n.createTextNode(r)}(o[11],r);Fd(a,o,C,y),mt(y,!1)}function dp(n){return Jh("",n,""),dp}function Jh(n,r,o){const a=E(),h=function Mc(n,r,o,a){return Ra(n,Cr(),o)?r+nt(o)+a:dr}(a,n,r,o);return h!==dr&&il(a,Si(),h),Jh}const Vc=void 0;var $g=["en",[["a","p"],["AM","PM"],Vc],[["AM","PM"],Vc,Vc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Vc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Vc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Vc,"{1} 'at' {0}",Vc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ef(n){const o=Math.floor(Math.abs(n)),a=n.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===a?1:5}];let uh={};function pp(n){const r=function Bu(n){return n.toLowerCase().replace(/_/g,"-")}(n);let o=Gg(r);if(o)return o;const a=r.split("-")[0];if(o=Gg(a),o)return o;if("en"===a)return $g;throw new Error(`Missing locale data for the locale "${n}".`)}function Ay(n){return pp(n)[Ln.PluralCase]}function Gg(n){return n in uh||(uh[n]=cn.ng&&cn.ng.common&&cn.ng.common.locales&&cn.ng.common.locales[n]),uh[n]}var Ln=(()=>((Ln=Ln||{})[Ln.LocaleId=0]="LocaleId",Ln[Ln.DayPeriodsFormat=1]="DayPeriodsFormat",Ln[Ln.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ln[Ln.DaysFormat=3]="DaysFormat",Ln[Ln.DaysStandalone=4]="DaysStandalone",Ln[Ln.MonthsFormat=5]="MonthsFormat",Ln[Ln.MonthsStandalone=6]="MonthsStandalone",Ln[Ln.Eras=7]="Eras",Ln[Ln.FirstDayOfWeek=8]="FirstDayOfWeek",Ln[Ln.WeekendRange=9]="WeekendRange",Ln[Ln.DateFormat=10]="DateFormat",Ln[Ln.TimeFormat=11]="TimeFormat",Ln[Ln.DateTimeFormat=12]="DateTimeFormat",Ln[Ln.NumberSymbols=13]="NumberSymbols",Ln[Ln.NumberFormats=14]="NumberFormats",Ln[Ln.CurrencyCode=15]="CurrencyCode",Ln[Ln.CurrencySymbol=16]="CurrencySymbol",Ln[Ln.CurrencyName=17]="CurrencyName",Ln[Ln.Currencies=18]="Currencies",Ln[Ln.Directionality=19]="Directionality",Ln[Ln.PluralCase=20]="PluralCase",Ln[Ln.ExtraData=21]="ExtraData",Ln))();const tf="en-US";let wd=tf;function hv(n,r,o,a,h){if(n=Re(n),Array.isArray(n))for(let y=0;y<n.length;y++)hv(n[y],r,o,a,h);else{const y=R(),C=E();let A=pu(n)?n:Re(n.provide),O=qp(n);const q=oe(),J=1048575&q.providerIndexes,he=q.directiveStart,Ae=q.providerIndexes>>20;if(pu(n)||!n.multi){const Ze=new Gi(O,h,tu),vt=pv(A,r,h?J:J+Ae,he);-1===vt?(S(xt(q,C),y,A),fv(y,n,r.length),r.push(A),q.directiveStart++,q.directiveEnd++,h&&(q.providerIndexes+=1048576),o.push(Ze),C.push(Ze)):(o[vt]=Ze,C[vt]=Ze)}else{const Ze=pv(A,r,J+Ae,he),vt=pv(A,r,J,J+Ae),jt=Ze>=0&&o[Ze],sn=vt>=0&&o[vt];if(h&&!sn||!h&&!jt){S(xt(q,C),y,A);const bn=function fw(n,r,o,a,h){const y=new Gi(n,o,tu);return y.multi=[],y.index=r,y.componentProviders=0,v0(y,h,a&&!o),y}(h?hw:dw,o.length,h,a,O);!h&&sn&&(o[vt].providerFactory=bn),fv(y,n,r.length,0),r.push(A),q.directiveStart++,q.directiveEnd++,h&&(q.providerIndexes+=1048576),o.push(bn),C.push(bn)}else fv(y,n,Ze>-1?Ze:vt,v0(o[h?vt:Ze],O,!h&&a));!h&&a&&sn&&o[vt].componentProviders++}}}function fv(n,r,o,a){const h=pu(r),y=function Yp(n){return!!n.useClass}(r);if(h||y){const O=(y?Re(r.useClass):r).prototype.ngOnDestroy;if(O){const q=n.destroyHooks||(n.destroyHooks=[]);if(!h&&r.multi){const J=q.indexOf(o);-1===J?q.push(o,[a,O]):q[J+1].push(a,O)}else q.push(o,O)}}}function v0(n,r,o){return o&&n.componentProviders++,n.multi.push(r)-1}function pv(n,r,o,a){for(let h=o;h<a;h++)if(r[h]===n)return h;return-1}function dw(n,r,o,a){return gv(this.multi,[])}function hw(n,r,o,a){const h=this.multi;let y;if(this.providerFactory){const C=this.providerFactory.componentProviders,A=Jt(o,o[1],this.providerFactory.index,a);y=A.slice(0,C),gv(h,y);for(let O=C;O<A.length;O++)y.push(A[O])}else y=[],gv(h,y);return y}function gv(n,r){for(let o=0;o<n.length;o++)r.push((0,n[o])());return r}function E0(n,r=[]){return o=>{o.providersResolver=(a,h)=>function cw(n,r,o){const a=R();if(a.firstCreatePass){const h=ns(n);hv(o,a.data,a.blueprint,h,!0),hv(r,a.data,a.blueprint,h,!1)}}(a,h?h(n):n,r)}}class w0{}class mw{resolveComponentFactory(r){throw function gw(n){const r=Error(`No component factory found for ${Me(n)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=n,r}(r)}}let jy=(()=>{class n{}return n.NULL=new mw,n})();function yw(){return mp(oe(),E())}function mp(n,r){return new Yg(yt(n,r))}let Yg=(()=>{class n{constructor(o){this.nativeElement=o}}return n.__NG_ELEMENT_ID__=yw,n})();function _w(n){return n instanceof Yg?n.nativeElement:n}class C0{}let vw=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function ww(){const n=E(),o=kn(oe().index,n);return function Ew(n){return n[11]}(di(o)?o:n)}(),n})(),Iw=(()=>{class n{}return n.\u0275prov=Kt({token:n,providedIn:"root",factory:()=>null}),n})();class b0{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const D0=new b0("13.2.7"),mv={};function $y(n,r,o,a,h=!1){for(;null!==o;){const y=r[o.index];if(null!==y&&a.push(U(y)),Di(y))for(let A=10;A<y.length;A++){const O=y[A],q=O[1].firstChild;null!==q&&$y(O[1],O,q,a)}const C=o.type;if(8&C)$y(n,r,o.child,a);else if(32&C){const A=Le(o,r);let O;for(;O=A();)a.push(O)}else if(16&C){const A=_h(r,o);if(Array.isArray(A))a.push(...A);else{const O=rn(r[16]);$y(O[1],O,A,a,!0)}}o=h?o.projectionNext:o.next}return a}class Qg{constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,o=r[1];return $y(o,r,o.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(Di(r)){const o=r[8],a=o?o.indexOf(this):-1;a>-1&&(Pd(r,a),no(o,a))}this._attachedToViewContainer=!1}nd(this._lView[1],this._lView)}onDestroy(r){am(this._lView[1],this._lView,null,r)}markForCheck(){Ac(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){dd(this._lView[1],this._lView,this.context)}checkNoChanges(){!function ym(n,r,o){Or(!0);try{dd(n,r,o)}finally{Or(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new at(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function $l(n,r){js(n,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new at(902,"");this._appRef=r}}class Cw extends Qg{constructor(r){super(r),this._view=r}detectChanges(){kf(this._view)}checkNoChanges(){!function Hp(n){Or(!0);try{kf(n)}finally{Or(!1)}}(this._view)}get context(){return null}}class T0 extends jy{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=br(r);return new yv(o,this.ngModule)}}function S0(n){const r=[];for(let o in n)n.hasOwnProperty(o)&&r.push({propName:n[o],templateName:o});return r}class yv extends w0{constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function zl(n){return n.map(Dc).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}get inputs(){return S0(this.componentDef.inputs)}get outputs(){return S0(this.componentDef.outputs)}create(r,o,a,h){const y=(h=h||this.ngModule)?function Dw(n,r){return{get:(o,a,h)=>{const y=n.get(o,mv,h);return y!==mv||a===mv?y:r.get(o,a,h)}}}(r,h.injector):r,C=y.get(C0,B),A=y.get(Iw,null),O=C.createRenderer(null,this.componentDef),q=this.componentDef.selectors[0][0]||"div",J=a?function Fp(n,r,o){if(On(n))return n.selectRootElement(r,o===Vt.ShadowDom);let a="string"==typeof r?n.querySelector(r):r;return a.textContent="",a}(O,a,this.componentDef.encapsulation):Cc(C.createRenderer(null,this.componentDef),q,function bw(n){const r=n.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(q)),he=this.componentDef.onPush?576:528,Ae=function Om(n,r){return{components:[],scheduler:n||Md,clean:_m,playerHandler:r||null,flags:0}}(),Ze=$d(0,null,null,1,0,null,null,null,null,null),vt=Rh(null,Ze,Ae,he,null,null,C,O,A,y);let jt,sn;zo(vt);try{const bn=function Pm(n,r,o,a,h,y){const C=o[1];o[20]=n;const O=ld(C,20,2,"#host",null),q=O.mergedAttrs=r.hostAttrs;null!==q&&(fd(O,q,!0),null!==n&&(mi(h,n,q),null!==O.classes&&Gl(h,n,O.classes),null!==O.styles&&ya(h,n,O.styles)));const J=a.createRenderer(n,r),he=Rh(o,Op(r),null,r.onPush?64:16,o[20],O,a,J,y||null,null);return C.firstCreatePass&&(S(xt(O,o),C,r.type),Nf(C,O),Up(O,o.length,1)),Gd(o,he),o[20]=he}(J,this.componentDef,vt,C,O);if(J)if(a)mi(O,J,["ng-version",D0.full]);else{const{attrs:Mt,classes:qn}=function Dp(n){const r=[],o=[];let a=1,h=2;for(;a<n.length;){let y=n[a];if("string"==typeof y)2===h?""!==y&&r.push(y,n[++a]):8===h&&o.push(y);else{if(!ja(h))break;h=y}a++}return{attrs:r,classes:o}}(this.componentDef.selectors[0]);Mt&&mi(O,J,Mt),qn&&qn.length>0&&Gl(O,J,qn.join(" "))}if(sn=wn(Ze,20),void 0!==o){const Mt=sn.projection=[];for(let qn=0;qn<this.ngContentSelectors.length;qn++){const ni=o[qn];Mt.push(null!=ni?Array.from(ni):null)}}jt=function zf(n,r,o,a,h){const y=o[1],C=function fm(n,r,o){const a=oe();n.firstCreatePass&&(o.providersResolver&&o.providersResolver(o),gm(n,a,r,Sc(n,r,1,null),o));const h=Jt(r,n,a.directiveStart,a);qs(h,r);const y=yt(a,r);return y&&qs(y,r),h}(y,o,r);if(a.components.push(C),n[8]=C,h&&h.forEach(O=>O(C,r)),r.contentQueries){const O=oe();r.contentQueries(1,C,O.directiveStart)}const A=oe();return!y.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||(fo(A.index),Af(o[1],A,0,A.directiveStart,A.directiveEnd,r),Mf(r,C)),C}(bn,this.componentDef,vt,Ae,[tg]),Kl(Ze,vt,null)}finally{Ma()}return new Sw(this.componentType,jt,mp(sn,vt),vt,sn)}}class Sw extends class pw{}{constructor(r,o,a,h,y){super(),this.location=a,this._rootLView=h,this._tNode=y,this.instance=o,this.hostView=this.changeDetectorRef=new Cw(h),this.componentType=r}get injector(){return new _r(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}class yp{}class A0{}const _p=new Map;class M0 extends yp{constructor(r,o){super(),this._parent=o,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new T0(this);const a=Vr(r);this._bootstrapComponents=Bs(a.bootstrap),this._r3Injector=Uf(r,o,[{provide:yp,useValue:this},{provide:jy,useValue:this.componentFactoryResolver}],Me(r)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(r)}get(r,o=xa.THROW_IF_NOT_FOUND,a=Bt.Default){return r===xa||r===yp||r===Lh?this:this._r3Injector.get(r,o,a)}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class _v extends A0{constructor(r){super(),this.moduleType=r,null!==Vr(r)&&function xw(n){const r=new Set;!function o(a){const h=Vr(a,!0),y=h.id;null!==y&&(function x0(n,r,o){if(r&&r!==o)throw new Error(`Duplicate module registered for ${n} - ${Me(r)} vs ${Me(r.name)}`)}(y,_p.get(y),a),_p.set(y,a));const C=Bs(h.imports);for(const A of C)r.has(A)||(r.add(A),o(A))}(n)}(r)}create(r){return new M0(this.moduleType,r)}}function N0(n,r,o){const a=rr()+n,h=E();return h[a]===dr?oa(h,a,o?r.call(o):r()):function pd(n,r){return n[r]}(h,a)}function P0(n,r,o,a,h,y){const C=r+o;return Ra(n,C,h)?oa(n,C+1,y?a.call(y,h):a(h)):function Jg(n,r){const o=n[r];return o===dr?void 0:o}(n,C+1)}function V0(n,r){const o=R();let a;const h=n+20;o.firstCreatePass?(a=function Uw(n,r){if(r)for(let o=r.length-1;o>=0;o--){const a=r[o];if(n===a.name)return a}}(r,o.pipeRegistry),o.data[h]=a,a.onDestroy&&(o.destroyHooks||(o.destroyHooks=[])).push(h,a.onDestroy)):a=o.data[h];const y=a.factory||(a.factory=ti(a.type)),C=ln(tu);try{const A=Gs(!1),O=y();return Gs(A),function ag(n,r,o,a){o>=n.data.length&&(n.data[o]=null,n.blueprint[o]=null),r[o]=a}(o,E(),h,O),O}finally{ln(C)}}function U0(n,r,o){const a=n+20,h=E(),y=Wn(h,a);return function Xg(n,r){return n[1].data[r].pure}(h,a)?P0(h,rr(),r,y.transform,o,y):y.transform(o)}function vv(n){return r=>{setTimeout(n,void 0,r)}}const $c=class Gw extends _.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,a){var h,y,C;let A=r,O=o||(()=>null),q=a;if(r&&"object"==typeof r){const he=r;A=null===(h=he.next)||void 0===h?void 0:h.bind(he),O=null===(y=he.error)||void 0===y?void 0:y.bind(he),q=null===(C=he.complete)||void 0===C?void 0:C.bind(he)}this.__isAsync&&(O=vv(O),A&&(A=vv(A)),q&&(q=vv(q)));const J=super.subscribe({next:A,error:O,complete:q});return r instanceof ne.w0&&r.add(J),J}};function Ww(){return this._results[Rc()]()}class Ev{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=Rc(),a=Ev.prototype;a[o]||(a[o]=Ww)}get changes(){return this._changes||(this._changes=new $c)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const a=this;a.dirty=!1;const h=Io(r);(this._changesDetected=!function Ia(n,r,o){if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++){let h=n[a],y=r[a];if(o&&(h=o(h),y=o(y)),y!==h)return!1}return!0}(a._results,h,o))&&(a._results=h,a.length=h.length,a.last=h[this.length-1],a.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let em=(()=>{class n{}return n.__NG_ELEMENT_ID__=qw,n})();const zw=em,Kw=class extends zw{constructor(r,o,a){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=a}createEmbeddedView(r){const o=this._declarationTContainer.tViews,a=Rh(this._declarationLView,o,r,16,null,o.declTNode,null,null,null,null);a[17]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[19];return null!==y&&(a[19]=y.createEmbeddedView(o)),Kl(o,a,r),new Qg(a)}};function qw(){return Hy(oe(),E())}function Hy(n,r){return 4&n.type?new Kw(r,n,mp(n,r)):null}let Gy=(()=>{class n{}return n.__NG_ELEMENT_ID__=Zw,n})();function Zw(){return $0(oe(),E())}const Yw=Gy,B0=class extends Yw{constructor(r,o,a){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=a}get element(){return mp(this._hostTNode,this._hostLView)}get injector(){return new _r(this._hostTNode,this._hostLView)}get parentInjector(){const r=fa(this._hostTNode,this._hostLView);if(Eo(r)){const o=Qr(r,this._hostLView),a=Hs(r);return new _r(o[1].data[a+8],o)}return new _r(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=j0(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,o,a){const h=r.createEmbeddedView(o||{});return this.insert(h,a),h}createComponent(r,o,a,h,y){const C=r&&!function qa(n){return"function"==typeof n}(r);let A;if(C)A=o;else{const he=o||{};A=he.index,a=he.injector,h=he.projectableNodes,y=he.ngModuleRef}const O=C?r:new yv(br(r)),q=a||this.parentInjector;if(!y&&null==O.ngModule){const Ae=(C?q:this.parentInjector).get(yp,null);Ae&&(y=Ae)}const J=O.create(q,h,void 0,y);return this.insert(J.hostView,A),J}insert(r,o){const a=r._lView,h=a[1];if(function Mr(n){return Di(n[3])}(a)){const J=this.indexOf(r);if(-1!==J)this.detach(J);else{const he=a[3],Ae=new B0(he,he[6],he[3]);Ae.detach(Ae.indexOf(r))}}const y=this._adjustIndex(o),C=this._lContainer;!function ed(n,r,o,a){const h=10+a,y=o.length;a>0&&(o[h-1][4]=r),a<y-10?(r[4]=o[h],Va(o,10+a,r)):(o.push(r),r[4]=null),r[3]=o;const C=r[17];null!==C&&o!==C&&function td(n,r){const o=n[9];r[16]!==r[3][3][16]&&(n[2]=!0),null===o?n[9]=[r]:o.push(r)}(C,r);const A=r[19];null!==A&&A.insertView(n),r[2]|=128}(h,a,C,y);const A=Vd(y,C),O=a[11],q=kd(O,C[7]);return null!==q&&function Xc(n,r,o,a,h,y){a[0]=h,a[6]=r,js(n,a,o,1,h,y)}(h,C[6],O,a,q,A),r.attachToViewContainerRef(),Va(wv(C),y,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=j0(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),a=Pd(this._lContainer,o);a&&(no(wv(this._lContainer),o),nd(a[1],a))}detach(r){const o=this._adjustIndex(r,-1),a=Pd(this._lContainer,o);return a&&null!=no(wv(this._lContainer),o)?new Qg(a):null}_adjustIndex(r,o=0){return null==r?this.length+o:r}};function j0(n){return n[8]}function wv(n){return n[8]||(n[8]=[])}function $0(n,r){let o;const a=r[n.index];if(Di(a))o=a;else{let h;if(8&n.type)h=U(a);else{const y=r[11];h=y.createComment("");const C=yt(n,r);Hl(y,kd(y,C),h,function Cp(n,r){return On(n)?n.nextSibling(r):r.nextSibling}(y,C),!1)}r[n.index]=o=Bp(a,r,h,n),Gd(r,o)}return new B0(o,n,r)}class Iv{constructor(r){this.queryList=r,this.matches=null}clone(){return new Iv(this.queryList)}setDirty(){this.queryList.setDirty()}}class Cv{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const a=null!==r.contentQueries?r.contentQueries[0]:o.length,h=[];for(let y=0;y<a;y++){const C=o.getByIndex(y);h.push(this.queries[C.indexInDeclarationView].clone())}return new Cv(h)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==Y0(r,o).matches&&this.queries[o].setDirty()}}class H0{constructor(r,o,a=null){this.predicate=r,this.flags=o,this.read=a}}class bv{constructor(r=[]){this.queries=r}elementStart(r,o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let a=0;a<this.length;a++){const h=null!==o?o.length:0,y=this.getByIndex(a).embeddedTView(r,h);y&&(y.indexInDeclarationView=a,null!==o?o.push(y):o=[y])}return null!==o?new bv(o):null}template(r,o){for(let a=0;a<this.queries.length;a++)this.queries[a].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class Dv{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new Dv(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let a=r.parent;for(;null!==a&&8&a.type&&a.index!==o;)a=a.parent;return o===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const a=this.metadata.predicate;if(Array.isArray(a))for(let h=0;h<a.length;h++){const y=a[h];this.matchTNodeWithReadOption(r,o,Xw(o,y)),this.matchTNodeWithReadOption(r,o,dt(o,r,y,!1,!1))}else a===em?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,dt(o,r,a,!1,!1))}matchTNodeWithReadOption(r,o,a){if(null!==a){const h=this.metadata.read;if(null!==h)if(h===Yg||h===Gy||h===em&&4&o.type)this.addMatch(o.index,-2);else{const y=dt(o,r,h,!1,!1);null!==y&&this.addMatch(o.index,y)}else this.addMatch(o.index,a)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function Xw(n,r){const o=n.localNames;if(null!==o)for(let a=0;a<o.length;a+=2)if(o[a]===r)return o[a+1];return null}function tI(n,r,o,a){return-1===o?function eI(n,r){return 11&n.type?mp(n,r):4&n.type?Hy(n,r):null}(r,n):-2===o?function nI(n,r,o){return o===Yg?mp(r,n):o===em?Hy(r,n):o===Gy?$0(r,n):void 0}(n,r,a):Jt(n,n[1],o,r)}function G0(n,r,o,a){const h=r[19].queries[a];if(null===h.matches){const y=n.data,C=o.matches,A=[];for(let O=0;O<C.length;O+=2){const q=C[O];A.push(q<0?null:tI(r,y[q],C[O+1],o.metadata.read))}h.matches=A}return h.matches}function Tv(n,r,o,a){const h=n.queries.getByIndex(o),y=h.matches;if(null!==y){const C=G0(n,r,h,o);for(let A=0;A<y.length;A+=2){const O=y[A];if(O>0)a.push(C[A/2]);else{const q=y[A+1],J=r[-O];for(let he=10;he<J.length;he++){const Ae=J[he];Ae[17]===Ae[3]&&Tv(Ae[1],Ae,q,a)}if(null!==J[9]){const he=J[9];for(let Ae=0;Ae<he.length;Ae++){const Ze=he[Ae];Tv(Ze[1],Ze,q,a)}}}}}return a}function W0(n){const r=E(),o=R(),a=xo();Ro(a+1);const h=Y0(o,a);if(n.dirty&&Jn(r)===(2==(2&h.metadata.flags))){if(null===h.matches)n.reset([]);else{const y=h.crossesNgTemplate?Tv(o,r,a,[]):G0(o,r,h,a);n.reset(y,_w),n.notifyOnChanges()}return!0}return!1}function z0(n,r,o,a){const h=R();if(h.firstCreatePass){const y=oe();(function Z0(n,r,o){null===n.queries&&(n.queries=new bv),n.queries.track(new Dv(r,o))})(h,new H0(r,o,a),y.index),function sI(n,r){const o=n.contentQueries||(n.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(n.queries.length-1,r)}(h,n),2==(2&o)&&(h.staticContentQueries=!0)}!function q0(n,r,o){const a=new Ev(4==(4&o));am(n,r,a,a.destroy),null===r[19]&&(r[19]=new Cv),r[19].queries.push(new Iv(a))}(h,E(),o)}function K0(){return function iI(n,r){return n[19].queries[r].queryList}(E(),xo())}function Y0(n,r){return n.queries.getByIndex(r)}function Q0(n,r){return Hy(n,r)}function Ky(...n){}const pE=new Qi("Application Initializer");let Nv=(()=>{class n{constructor(o){this.appInits=o,this.resolve=Ky,this.reject=Ky,this.initialized=!1,this.done=!1,this.donePromise=new Promise((a,h)=>{this.resolve=a,this.reject=h})}runInitializers(){if(this.initialized)return;const o=[],a=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const y=this.appInits[h]();if(sp(y))o.push(y);else if(Xm(y)){const C=new Promise((A,O)=>{y.subscribe({complete:A,error:O})});o.push(C)}}Promise.all(o).then(()=>{a()}).catch(h=>{this.reject(h)}),0===o.length&&a(),this.initialized=!0}}return n.\u0275fac=function(o){return new(o||n)(Ot(pE,8))},n.\u0275prov=Kt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const gE=new Qi("AppId",{providedIn:"root",factory:function mE(){return`${Pv()}${Pv()}${Pv()}`}});function Pv(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const yE=new Qi("Platform Initializer"),_E=new Qi("Platform ID"),vE=new Qi("appBootstrapListener");let EE=(()=>{class n{log(o){console.log(o)}warn(o){console.warn(o)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Kt({token:n,factory:n.\u0275fac}),n})();const Ov=new Qi("LocaleId",{providedIn:"root",factory:()=>jn(Ov,Bt.Optional|Bt.SkipSelf)||function II(){return"undefined"!=typeof $localize&&$localize.locale||tf}()}),CI=new Qi("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class bI{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let DI=(()=>{class n{compileModuleSync(o){return new _v(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const a=this.compileModuleSync(o),y=Bs(Vr(o).declarations).reduce((C,A)=>{const O=br(A);return O&&C.push(new yv(O)),C},[]);return new bI(a,y)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Kt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const SI=(()=>Promise.resolve(0))();function kv(n){"undefined"==typeof Zone?SI.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Jl{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $c(!1),this.onMicrotaskEmpty=new $c(!1),this.onStable=new $c(!1),this.onError=new $c(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!a&&o,h.shouldCoalesceRunChangeDetection=a,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function AI(){let n=cn.requestAnimationFrame,r=cn.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&r){const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o);const a=r[Zone.__symbol__("OriginalDelegate")];a&&(r=a)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function MI(n){const r=()=>{!function RI(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(cn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Lv(n),n.isCheckStableRunning=!0,Fv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Lv(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,a,h,y,C,A)=>{try{return wE(n),o.invokeTask(h,y,C,A)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===y.type||n.shouldCoalesceRunChangeDetection)&&r(),IE(n)}},onInvoke:(o,a,h,y,C,A,O)=>{try{return wE(n),o.invoke(h,y,C,A,O)}finally{n.shouldCoalesceRunChangeDetection&&r(),IE(n)}},onHasTask:(o,a,h,y)=>{o.hasTask(h,y),a===h&&("microTask"==y.change?(n._hasPendingMicrotasks=y.microTask,Lv(n),Fv(n)):"macroTask"==y.change&&(n.hasPendingMacrotasks=y.macroTask))},onHandleError:(o,a,h,y)=>(o.handleError(h,y),n.runOutsideAngular(()=>n.onError.emit(y)),!1)})}(h)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Jl.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Jl.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(r,o,a){return this._inner.run(r,o,a)}runTask(r,o,a,h){const y=this._inner,C=y.scheduleEventTask("NgZoneEvent: "+h,r,xI,Ky,Ky);try{return y.runTask(C,o,a)}finally{y.cancelTask(C)}}runGuarded(r,o,a){return this._inner.runGuarded(r,o,a)}runOutsideAngular(r){return this._outer.run(r)}}const xI={};function Fv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Lv(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function wE(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function IE(n){n._nesting--,Fv(n)}class NI{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new $c,this.onMicrotaskEmpty=new $c,this.onStable=new $c,this.onError=new $c}run(r,o,a){return r.apply(o,a)}runGuarded(r,o,a){return r.apply(o,a)}runOutsideAngular(r){return r()}runTask(r,o,a,h){return r.apply(o,a)}}let CE=(()=>{class n{constructor(o){this._ngZone=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Jl.assertNotInAngularZone(),kv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())kv(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(o)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,a,h){let y=-1;a&&a>0&&(y=setTimeout(()=>{this._callbacks=this._callbacks.filter(C=>C.timeoutId!==y),o(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:o,timeoutId:y,updateCb:h})}whenStable(o,a,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,a,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(o,a,h){return[]}}return n.\u0275fac=function(o){return new(o||n)(Ot(Jl))},n.\u0275prov=Kt({token:n,factory:n.\u0275fac}),n})(),bE=(()=>{class n{constructor(){this._applications=new Map,Vv.addToWindow(this)}registerApplication(o,a){this._applications.set(o,a)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,a=!0){return Vv.findTestabilityInTree(this,o,a)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Kt({token:n,factory:n.\u0275fac}),n})();class PI{addToWindow(r){}findTestabilityInTree(r,o,a){return null}}function OI(n){Vv=n}let Xl,Vv=new PI;const DE=new Qi("AllowMultipleToken");class LI{constructor(r,o){this.name=r,this.token=o}}function TE(n,r,o=[]){const a=`Platform: ${r}`,h=new Qi(a);return(y=[])=>{let C=SE();if(!C||C.injector.get(DE,!1))if(n)n(o.concat(y).concat({provide:h,useValue:!0}));else{const A=o.concat(y).concat({provide:h,useValue:!0},{provide:Wp,useValue:"platform"});!function VI(n){if(Xl&&!Xl.destroyed&&!Xl.injector.get(DE,!1))throw new at(400,"");Xl=n.get(AE);const r=n.get(yE,null);r&&r.forEach(o=>o())}(xa.create({providers:A,name:a}))}return function UI(n){const r=SE();if(!r)throw new at(401,"");return r}()}}function SE(){return Xl&&!Xl.destroyed?Xl:null}let AE=(()=>{class n{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,a){const A=function BI(n,r){let o;return o="noop"===n?new NI:("zone.js"===n?void 0:n)||new Jl({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==r?void 0:r.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==r?void 0:r.ngZoneRunCoalescing)}),o}(a?a.ngZone:void 0,{ngZoneEventCoalescing:a&&a.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:a&&a.ngZoneRunCoalescing||!1}),O=[{provide:Jl,useValue:A}];return A.run(()=>{const q=xa.create({providers:O,parent:this.injector,name:o.moduleType.name}),J=o.create(q),he=J.injector.get(Ul,null);if(!he)throw new at(402,"");return A.runOutsideAngular(()=>{const Ae=A.onError.subscribe({next:Ze=>{he.handleError(Ze)}});J.onDestroy(()=>{Bv(this._modules,J),Ae.unsubscribe()})}),function jI(n,r,o){try{const a=o();return sp(a)?a.catch(h=>{throw r.runOutsideAngular(()=>n.handleError(h)),h}):a}catch(a){throw r.runOutsideAngular(()=>n.handleError(a)),a}}(he,A,()=>{const Ae=J.injector.get(Nv);return Ae.runInitializers(),Ae.donePromise.then(()=>(function Id(n){qt(n,"Expected localeId to be defined"),"string"==typeof n&&(wd=n.toLowerCase().replace(/_/g,"-"))}(J.injector.get(Ov,tf)||tf),this._moduleDoBootstrap(J),J))})})}bootstrapModule(o,a=[]){const h=xE({},a);return function kI(n,r,o){const a=new _v(o);return Promise.resolve(a)}(0,0,o).then(y=>this.bootstrapModuleFactory(y,h))}_moduleDoBootstrap(o){const a=o.injector.get(Uv);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(h=>a.bootstrap(h));else{if(!o.instance.ngDoBootstrap)throw new at(403,"");o.instance.ngDoBootstrap(a)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new at(404,"");this._modules.slice().forEach(o=>o.destroy()),this._destroyListeners.forEach(o=>o()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(o){return new(o||n)(Ot(xa))},n.\u0275prov=Kt({token:n,factory:n.\u0275fac}),n})();function xE(n,r){return Array.isArray(r)?r.reduce(xE,n):Object.assign(Object.assign({},n),r)}let Uv=(()=>{class n{constructor(o,a,h,y,C){this._zone=o,this._injector=a,this._exceptionHandler=h,this._componentFactoryResolver=y,this._initStatus=C,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const A=new ie.y(q=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{q.next(this._stable),q.complete()})}),O=new ie.y(q=>{let J;this._zone.runOutsideAngular(()=>{J=this._zone.onStable.subscribe(()=>{Jl.assertNotInAngularZone(),kv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,q.next(!0))})})});const he=this._zone.onUnstable.subscribe(()=>{Jl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{q.next(!1)}))});return()=>{J.unsubscribe(),he.unsubscribe()}});this.isStable=(0,be.T)(A,O.pipe((0,Ce.B)()))}bootstrap(o,a){if(!this._initStatus.done)throw new at(405,"");let h;h=o instanceof w0?o:this._componentFactoryResolver.resolveComponentFactory(o),this.componentTypes.push(h.componentType);const y=function FI(n){return n.isBoundToModule}(h)?void 0:this._injector.get(yp),A=h.create(xa.NULL,[],a||h.selector,y),O=A.location.nativeElement,q=A.injector.get(CE,null),J=q&&A.injector.get(bE);return q&&J&&J.registerApplication(O,q),A.onDestroy(()=>{this.detachView(A.hostView),Bv(this.components,A),J&&J.unregisterApplication(O)}),this._loadComponent(A),A}tick(){if(this._runningTick)throw new at(101,"");try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const a=o;this._views.push(a),a.attachToAppRef(this)}detachView(o){const a=o;Bv(this._views,a),a.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o),this._injector.get(vE,[]).concat(this._bootstrapListeners).forEach(h=>h(o))}ngOnDestroy(){this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(o){return new(o||n)(Ot(Jl),Ot(xa),Ot(Ul),Ot(jy),Ot(Nv))},n.\u0275prov=Kt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Bv(n,r){const o=n.indexOf(r);o>-1&&n.splice(o,1)}let ME=!0,NE=!1;function HI(){return NE=!0,ME}function GI(){if(NE)throw new Error("Cannot enable prod mode after platform setup.");ME=!1}let WI=(()=>{class n{}return n.__NG_ELEMENT_ID__=zI,n})();function zI(n){return function KI(n,r,o){if(qi(n)&&!o){const a=kn(n.index,r);return new Qg(a,a)}return 47&n.type?new Qg(r[16],r):null}(oe(),E(),16==(16&n))}class FE{constructor(){}supports(r){return Jd(r)}create(r){return new XI(r)}}const JI=(n,r)=>r;class XI{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||JI}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,a=this._removalsHead,h=0,y=null;for(;o||a;){const C=!a||o&&o.currentIndex<VE(a,h,y)?o:a,A=VE(C,h,y),O=C.currentIndex;if(C===a)h--,a=a._nextRemoved;else if(o=o._next,null==C.previousIndex)h++;else{y||(y=[]);const q=A-h,J=O-h;if(q!=J){for(let Ae=0;Ae<q;Ae++){const Ze=Ae<y.length?y[Ae]:y[Ae]=0,vt=Ze+Ae;J<=vt&&vt<q&&(y[Ae]=Ze+1)}y[C.previousIndex]=J-q}}A!==O&&r(C,A,O)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!Jd(r))throw new at(900,"");return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let h,y,C,o=this._itHead,a=!1;if(Array.isArray(r)){this.length=r.length;for(let A=0;A<this.length;A++)y=r[A],C=this._trackByFn(A,y),null!==o&&Object.is(o.trackById,C)?(a&&(o=this._verifyReinsertion(o,y,C,A)),Object.is(o.item,y)||this._addIdentityChange(o,y)):(o=this._mismatch(o,y,C,A),a=!0),o=o._next}else h=0,function I_(n,r){if(Array.isArray(n))for(let o=0;o<n.length;o++)r(n[o]);else{const o=n[Rc()]();let a;for(;!(a=o.next()).done;)r(a.value)}}(r,A=>{C=this._trackByFn(h,A),null!==o&&Object.is(o.trackById,C)?(a&&(o=this._verifyReinsertion(o,A,C,h)),Object.is(o.item,A)||this._addIdentityChange(o,A)):(o=this._mismatch(o,A,C,h),a=!0),o=o._next,h++}),this.length=h;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,a,h){let y;return null===r?y=this._itTail:(y=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,y,h)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(a,h))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,y,h)):r=this._addAfter(new eC(o,a),y,h),r}_verifyReinsertion(r,o,a,h){let y=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==y?r=this._reinsertAfter(y,r._prev,h):r.currentIndex!=h&&(r.currentIndex=h,this._addToMoves(r,h)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const h=r._prevRemoved,y=r._nextRemoved;return null===h?this._removalsHead=y:h._nextRemoved=y,null===y?this._removalsTail=h:y._prevRemoved=h,this._insertAfter(r,o,a),this._addToMoves(r,a),r}_moveAfter(r,o,a){return this._unlink(r),this._insertAfter(r,o,a),this._addToMoves(r,a),r}_addAfter(r,o,a){return this._insertAfter(r,o,a),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,a){const h=null===o?this._itHead:o._next;return r._next=h,r._prev=o,null===h?this._itTail=r:h._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new LE),this._linkedRecords.put(r),r.currentIndex=a,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,a=r._next;return null===o?this._itHead=a:o._next=a,null===a?this._itTail=o:a._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new LE),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class eC{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class tC{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===o||o<=a.currentIndex)&&Object.is(a.trackById,r))return a;return null}remove(r){const o=r._prevDup,a=r._nextDup;return null===o?this._head=a:o._nextDup=a,null===a?this._tail=o:a._prevDup=o,null===this._head}}class LE{constructor(){this.map=new Map}put(r){const o=r.trackById;let a=this.map.get(o);a||(a=new tC,this.map.set(o,a)),a.add(r)}get(r,o){const h=this.map.get(r);return h?h.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function VE(n,r,o){const a=n.previousIndex;if(null===a)return a;let h=0;return o&&a<o.length&&(h=o[a]),a+r+h}class UE{constructor(){}supports(r){return r instanceof Map||Bh(r)}create(){return new nC}}class nC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||Bh(r)))throw new at(900,"")}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(a,h)=>{if(o&&o.key===h)this._maybeAddToChanges(o,a),this._appendAfter=o,o=o._next;else{const y=this._getOrCreateRecordForKey(h,a);o=this._insertBeforeOrAppend(o,y)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let a=o;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const a=r._prev;return o._next=r,o._prev=a,r._prev=o,a&&(a._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const h=this._records.get(r);this._maybeAddToChanges(h,o);const y=h._prev,C=h._next;return y&&(y._next=C),C&&(C._prev=y),h._next=null,h._prev=null,h}const a=new rC(r);return this._records.set(r,a),a.currentValue=o,this._addToAdditions(a),a}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(a=>o(r[a],a))}}class rC{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function BE(){return new Wv([new FE])}let Wv=(()=>{class n{constructor(o){this.factories=o}static create(o,a){if(null!=a){const h=a.factories.slice();o=o.concat(h)}return new n(o)}static extend(o){return{provide:n,useFactory:a=>n.create(o,a||BE()),deps:[[n,new Is,new Fs]]}}find(o){const a=this.factories.find(h=>h.supports(o));if(null!=a)return a;throw new at(901,"")}}return n.\u0275prov=Kt({token:n,providedIn:"root",factory:BE}),n})();function jE(){return new zv([new UE])}let zv=(()=>{class n{constructor(o){this.factories=o}static create(o,a){if(a){const h=a.factories.slice();o=o.concat(h)}return new n(o)}static extend(o){return{provide:n,useFactory:a=>n.create(o,a||jE()),deps:[[n,new Is,new Fs]]}}find(o){const a=this.factories.find(y=>y.supports(o));if(a)return a;throw new at(901,"")}}return n.\u0275prov=Kt({token:n,providedIn:"root",factory:jE}),n})();const oC=TE(null,"core",[{provide:_E,useValue:"unknown"},{provide:AE,deps:[xa]},{provide:bE,deps:[]},{provide:EE,deps:[]}]);let aC=(()=>{class n{constructor(o){}}return n.\u0275fac=function(o){return new(o||n)(Ot(Uv))},n.\u0275mod=ur({type:n}),n.\u0275inj=zt({}),n})()},2382:(Ft,We,$)=>{$.d(We,{Fj:()=>ht,CE:()=>ti,qu:()=>ds,NI:()=>gr,u:()=>vs,sg:()=>Ur,JJ:()=>Fr,JL:()=>ci,UX:()=>Zi,kI:()=>ut,_Y:()=>Fe});var _=$(5e3),ne=$(9808),ie=$(8306),be=$(4742),Ce=$(8421),Se=$(7669),Ve=$(5403),Me=$(3268),Be=$(1810),ae=$(8996),Re=$(4004);let Rt=(()=>{class G{constructor(F,E){this._renderer=F,this._elementRef=E,this.onChange=R=>{},this.onTouched=()=>{}}setProperty(F,E){this._renderer.setProperty(this._elementRef.nativeElement,F,E)}registerOnTouched(F){this.onTouched=F}registerOnChange(F){this.onChange=F}setDisabledState(F){this.setProperty("disabled",F)}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(_.Qsj),_.Y36(_.SBq))},G.\u0275dir=_.lG2({type:G}),G})(),ot=(()=>{class G extends Rt{}return G.\u0275fac=function(){let k;return function(E){return(k||(k=_.n5z(G)))(E||G)}}(),G.\u0275dir=_.lG2({type:G,features:[_.qOj]}),G})();const at=new _.OlP("NgValueAccessor"),ft={provide:at,useExisting:(0,_.Gpc)(()=>ht),multi:!0},kt=new _.OlP("CompositionEventMode");let ht=(()=>{class G extends Rt{constructor(F,E,R){super(F,E),this._compositionMode=R,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function De(){const G=(0,ne.q)()?(0,ne.q)().getUserAgent():"";return/android (\d+)/.test(G.toLowerCase())}())}writeValue(F){this.setProperty("value",null==F?"":F)}_handleInput(F){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(F)}_compositionStart(){this._composing=!0}_compositionEnd(F){this._composing=!1,this._compositionMode&&this.onChange(F)}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(_.Qsj),_.Y36(_.SBq),_.Y36(kt,8))},G.\u0275dir=_.lG2({type:G,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(F,E){1&F&&_.NdJ("input",function(Y){return E._handleInput(Y.target.value)})("blur",function(){return E.onTouched()})("compositionstart",function(){return E._compositionStart()})("compositionend",function(Y){return E._compositionEnd(Y.target.value)})},features:[_._Bn([ft]),_.qOj]}),G})();function xe(G){return null==G||0===G.length}function Ge(G){return null!=G&&"number"==typeof G.length}const wt=new _.OlP("NgValidators"),It=new _.OlP("NgAsyncValidators"),V=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ut{static min(k){return function ge(G){return k=>{if(xe(k.value)||xe(G))return null;const F=parseFloat(k.value);return!isNaN(F)&&F<G?{min:{min:G,actual:k.value}}:null}}(k)}static max(k){return function Oe(G){return k=>{if(xe(k.value)||xe(G))return null;const F=parseFloat(k.value);return!isNaN(F)&&F>G?{max:{max:G,actual:k.value}}:null}}(k)}static required(k){return function Ue(G){return xe(G.value)?{required:!0}:null}(k)}static requiredTrue(k){return function Je(G){return!0===G.value?null:{required:!0}}(k)}static email(k){return function Ye(G){return xe(G.value)||V.test(G.value)?null:{email:!0}}(k)}static minLength(k){return function St(G){return k=>xe(k.value)||!Ge(k.value)?null:k.value.length<G?{minlength:{requiredLength:G,actualLength:k.value.length}}:null}(k)}static maxLength(k){return function Pt(G){return k=>Ge(k.value)&&k.value.length>G?{maxlength:{requiredLength:G,actualLength:k.value.length}}:null}(k)}static pattern(k){return function Wt(G){if(!G)return qt;let k,F;return"string"==typeof G?(F="","^"!==G.charAt(0)&&(F+="^"),F+=G,"$"!==G.charAt(G.length-1)&&(F+="$"),k=new RegExp(F)):(F=G.toString(),k=G),E=>{if(xe(E.value))return null;const R=E.value;return k.test(R)?null:{pattern:{requiredPattern:F,actualValue:R}}}}(k)}static nullValidator(k){return null}static compose(k){return zt(k)}static composeAsync(k){return hr(k)}}function qt(G){return null}function it(G){return null!=G}function en(G){const k=(0,_.QGY)(G)?(0,ae.D)(G):G;return(0,_.CqO)(k),k}function on(G){let k={};return G.forEach(F=>{k=null!=F?Object.assign(Object.assign({},k),F):k}),0===Object.keys(k).length?null:k}function tn(G,k){return k.map(F=>F(G))}function Tn(G){return G.map(k=>function Kt(G){return!G.validate}(k)?k:F=>k.validate(F))}function zt(G){if(!G)return null;const k=G.filter(it);return 0==k.length?null:function(F){return on(tn(F,k))}}function Yt(G){return null!=G?zt(Tn(G)):null}function hr(G){if(!G)return null;const k=G.filter(it);return 0==k.length?null:function(F){return function ce(...G){const k=(0,Se.jO)(G),{args:F,keys:E}=(0,be.D)(G),R=new ie.y(Y=>{const{length:oe}=F;if(!oe)return void Y.complete();const Te=new Array(oe);let Ke=oe,mt=oe;for(let Gt=0;Gt<oe;Gt++){let Ut=!1;(0,Ce.Xf)(F[Gt]).subscribe((0,Ve.x)(Y,Bn=>{Ut||(Ut=!0,mt--),Te[Gt]=Bn},()=>Ke--,void 0,()=>{(!Ke||!Ut)&&(mt||Y.next(E?(0,Be.n)(E,Te):Te),Y.complete())}))}});return k?R.pipe((0,Me.Z)(k)):R}(tn(F,k).map(en)).pipe((0,Re.U)(on))}}function fr(G){return null!=G?hr(Tn(G)):null}function sr(G,k){return null===G?[k]:Array.isArray(G)?[...G,k]:[G,k]}function Pn(G){return G._rawValidators}function Hr(G){return G._rawAsyncValidators}function Gn(G){return G?Array.isArray(G)?G:[G]:[]}function Ar(G,k){return Array.isArray(G)?G.includes(k):G===k}function Vn(G,k){const F=Gn(k);return Gn(G).forEach(R=>{Ar(F,R)||F.push(R)}),F}function Bt(G,k){return Gn(k).filter(F=>!Ar(G,F))}class En{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(k){this._rawValidators=k||[],this._composedValidatorFn=Yt(this._rawValidators)}_setAsyncValidators(k){this._rawAsyncValidators=k||[],this._composedAsyncValidatorFn=fr(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(k){this._onDestroyCallbacks.push(k)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(k=>k()),this._onDestroyCallbacks=[]}reset(k){this.control&&this.control.reset(k)}hasError(k,F){return!!this.control&&this.control.hasError(k,F)}getError(k,F){return this.control?this.control.getError(k,F):null}}class Sn extends En{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ln extends En{get formDirective(){return null}get path(){return null}}class Ci{constructor(k){this._cd=k}is(k){var F,E,R;return"submitted"===k?!!(null===(F=this._cd)||void 0===F?void 0:F.submitted):!!(null===(R=null===(E=this._cd)||void 0===E?void 0:E.control)||void 0===R?void 0:R[k])}}let Fr=(()=>{class G extends Ci{constructor(F){super(F)}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(Sn,2))},G.\u0275dir=_.lG2({type:G,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(F,E){2&F&&_.ekj("ng-untouched",E.is("untouched"))("ng-touched",E.is("touched"))("ng-pristine",E.is("pristine"))("ng-dirty",E.is("dirty"))("ng-valid",E.is("valid"))("ng-invalid",E.is("invalid"))("ng-pending",E.is("pending"))},features:[_.qOj]}),G})(),ci=(()=>{class G extends Ci{constructor(F){super(F)}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(ln,10))},G.\u0275dir=_.lG2({type:G,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(F,E){2&F&&_.ekj("ng-untouched",E.is("untouched"))("ng-touched",E.is("touched"))("ng-pristine",E.is("pristine"))("ng-dirty",E.is("dirty"))("ng-valid",E.is("valid"))("ng-invalid",E.is("invalid"))("ng-pending",E.is("pending"))("ng-submitted",E.is("submitted"))},features:[_.qOj]}),G})();function qe(G,k){return[...k.path,G]}function At(G,k){lr(G,k),k.valueAccessor.writeValue(G.value),function ur(G,k){k.valueAccessor.registerOnChange(F=>{G._pendingValue=F,G._pendingChange=!0,G._pendingDirty=!0,"change"===G.updateOn&&Gr(G,k)})}(G,k),function _i(G,k){const F=(E,R)=>{k.valueAccessor.writeValue(E),R&&k.viewToModelUpdate(E)};G.registerOnChange(F),k._registerOnDestroy(()=>{G._unregisterOnChange(F)})}(G,k),function ts(G,k){k.valueAccessor.registerOnTouched(()=>{G._pendingTouched=!0,"blur"===G.updateOn&&G._pendingChange&&Gr(G,k),"submit"!==G.updateOn&&G.markAsTouched()})}(G,k),function or(G,k){if(k.valueAccessor.setDisabledState){const F=E=>{k.valueAccessor.setDisabledState(E)};G.registerOnDisabledChange(F),k._registerOnDestroy(()=>{G._unregisterOnDisabledChange(F)})}}(G,k)}function $t(G,k,F=!0){const E=()=>{};k.valueAccessor&&(k.valueAccessor.registerOnChange(E),k.valueAccessor.registerOnTouched(E)),an(G,k),G&&(k._invokeOnDestroyCallbacks(),G._registerOnCollectionChange(()=>{}))}function hn(G,k){G.forEach(F=>{F.registerOnValidatorChange&&F.registerOnValidatorChange(k)})}function lr(G,k){const F=Pn(G);null!==k.validator?G.setValidators(sr(F,k.validator)):"function"==typeof F&&G.setValidators([F]);const E=Hr(G);null!==k.asyncValidator?G.setAsyncValidators(sr(E,k.asyncValidator)):"function"==typeof E&&G.setAsyncValidators([E]);const R=()=>G.updateValueAndValidity();hn(k._rawValidators,R),hn(k._rawAsyncValidators,R)}function an(G,k){let F=!1;if(null!==G){if(null!==k.validator){const R=Pn(G);if(Array.isArray(R)&&R.length>0){const Y=R.filter(oe=>oe!==k.validator);Y.length!==R.length&&(F=!0,G.setValidators(Y))}}if(null!==k.asyncValidator){const R=Hr(G);if(Array.isArray(R)&&R.length>0){const Y=R.filter(oe=>oe!==k.asyncValidator);Y.length!==R.length&&(F=!0,G.setAsyncValidators(Y))}}}const E=()=>{};return hn(k._rawValidators,E),hn(k._rawAsyncValidators,E),F}function Gr(G,k){G._pendingDirty&&G.markAsDirty(),G.setValue(G._pendingValue,{emitModelToViewChange:!1}),k.viewToModelUpdate(G._pendingValue),G._pendingChange=!1}function wr(G,k){const F=G.indexOf(k);F>-1&&G.splice(F,1)}const Tt="VALID",Ht="INVALID",Hn="PENDING",zr="DISABLED";function Rr(G){return(Ee(G)?G.validators:G)||null}function Ki(G){return Array.isArray(G)?Yt(G):G||null}function pr(G,k){return(Ee(k)?k.asyncValidators:G)||null}function Mi(G){return Array.isArray(G)?fr(G):G||null}function Ee(G){return null!=G&&!Array.isArray(G)&&"object"==typeof G}const pe=G=>G instanceof gr,le=G=>G instanceof Yn,ze=G=>G instanceof Qn;function gt(G){return pe(G)?G.value:G.getRawValue()}function Qt(G,k){const F=le(G),E=G.controls;if(!(F?Object.keys(E):E).length)throw new _.vHH(1e3,"");if(!E[k])throw new _.vHH(1001,"")}function gn(G,k){le(G),G._forEachChild((E,R)=>{if(void 0===k[R])throw new _.vHH(1002,"")})}class er{constructor(k,F){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=k,this._rawAsyncValidators=F,this._composedValidatorFn=Ki(this._rawValidators),this._composedAsyncValidatorFn=Mi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(k){this._rawValidators=this._composedValidatorFn=k}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(k){this._rawAsyncValidators=this._composedAsyncValidatorFn=k}get parent(){return this._parent}get valid(){return this.status===Tt}get invalid(){return this.status===Ht}get pending(){return this.status==Hn}get disabled(){return this.status===zr}get enabled(){return this.status!==zr}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(k){this._rawValidators=k,this._composedValidatorFn=Ki(k)}setAsyncValidators(k){this._rawAsyncValidators=k,this._composedAsyncValidatorFn=Mi(k)}addValidators(k){this.setValidators(Vn(k,this._rawValidators))}addAsyncValidators(k){this.setAsyncValidators(Vn(k,this._rawAsyncValidators))}removeValidators(k){this.setValidators(Bt(k,this._rawValidators))}removeAsyncValidators(k){this.setAsyncValidators(Bt(k,this._rawAsyncValidators))}hasValidator(k){return Ar(this._rawValidators,k)}hasAsyncValidator(k){return Ar(this._rawAsyncValidators,k)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(k={}){this.touched=!0,this._parent&&!k.onlySelf&&this._parent.markAsTouched(k)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(k=>k.markAllAsTouched())}markAsUntouched(k={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(F=>{F.markAsUntouched({onlySelf:!0})}),this._parent&&!k.onlySelf&&this._parent._updateTouched(k)}markAsDirty(k={}){this.pristine=!1,this._parent&&!k.onlySelf&&this._parent.markAsDirty(k)}markAsPristine(k={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(F=>{F.markAsPristine({onlySelf:!0})}),this._parent&&!k.onlySelf&&this._parent._updatePristine(k)}markAsPending(k={}){this.status=Hn,!1!==k.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!k.onlySelf&&this._parent.markAsPending(k)}disable(k={}){const F=this._parentMarkedDirty(k.onlySelf);this.status=zr,this.errors=null,this._forEachChild(E=>{E.disable(Object.assign(Object.assign({},k),{onlySelf:!0}))}),this._updateValue(),!1!==k.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},k),{skipPristineCheck:F})),this._onDisabledChange.forEach(E=>E(!0))}enable(k={}){const F=this._parentMarkedDirty(k.onlySelf);this.status=Tt,this._forEachChild(E=>{E.enable(Object.assign(Object.assign({},k),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:k.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},k),{skipPristineCheck:F})),this._onDisabledChange.forEach(E=>E(!1))}_updateAncestors(k){this._parent&&!k.onlySelf&&(this._parent.updateValueAndValidity(k),k.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(k){this._parent=k}updateValueAndValidity(k={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Tt||this.status===Hn)&&this._runAsyncValidator(k.emitEvent)),!1!==k.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!k.onlySelf&&this._parent.updateValueAndValidity(k)}_updateTreeValidity(k={emitEvent:!0}){this._forEachChild(F=>F._updateTreeValidity(k)),this.updateValueAndValidity({onlySelf:!0,emitEvent:k.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?zr:Tt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(k){if(this.asyncValidator){this.status=Hn,this._hasOwnPendingAsyncValidator=!0;const F=en(this.asyncValidator(this));this._asyncValidationSubscription=F.subscribe(E=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(E,{emitEvent:k})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(k,F={}){this.errors=k,this._updateControlsErrors(!1!==F.emitEvent)}get(k){return function bi(G,k,F){if(null==k||(Array.isArray(k)||(k=k.split(F)),Array.isArray(k)&&0===k.length))return null;let E=G;return k.forEach(R=>{E=le(E)?E.controls.hasOwnProperty(R)?E.controls[R]:null:ze(E)&&E.at(R)||null}),E}(this,k,".")}getError(k,F){const E=F?this.get(F):this;return E&&E.errors?E.errors[k]:null}hasError(k,F){return!!this.getError(k,F)}get root(){let k=this;for(;k._parent;)k=k._parent;return k}_updateControlsErrors(k){this.status=this._calculateStatus(),k&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(k)}_initObservables(){this.valueChanges=new _.vpe,this.statusChanges=new _.vpe}_calculateStatus(){return this._allControlsDisabled()?zr:this.errors?Ht:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Hn)?Hn:this._anyControlsHaveStatus(Ht)?Ht:Tt}_anyControlsHaveStatus(k){return this._anyControls(F=>F.status===k)}_anyControlsDirty(){return this._anyControls(k=>k.dirty)}_anyControlsTouched(){return this._anyControls(k=>k.touched)}_updatePristine(k={}){this.pristine=!this._anyControlsDirty(),this._parent&&!k.onlySelf&&this._parent._updatePristine(k)}_updateTouched(k={}){this.touched=this._anyControlsTouched(),this._parent&&!k.onlySelf&&this._parent._updateTouched(k)}_isBoxedValue(k){return"object"==typeof k&&null!==k&&2===Object.keys(k).length&&"value"in k&&"disabled"in k}_registerOnCollectionChange(k){this._onCollectionChange=k}_setUpdateStrategy(k){Ee(k)&&null!=k.updateOn&&(this._updateOn=k.updateOn)}_parentMarkedDirty(k){return!k&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class gr extends er{constructor(k=null,F,E){super(Rr(F),pr(E,F)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(k),this._setUpdateStrategy(F),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ee(F)&&F.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(k)?k.value:k)}setValue(k,F={}){this.value=this._pendingValue=k,this._onChange.length&&!1!==F.emitModelToViewChange&&this._onChange.forEach(E=>E(this.value,!1!==F.emitViewToModelChange)),this.updateValueAndValidity(F)}patchValue(k,F={}){this.setValue(k,F)}reset(k=this.defaultValue,F={}){this._applyFormState(k),this.markAsPristine(F),this.markAsUntouched(F),this.setValue(this.value,F),this._pendingChange=!1}_updateValue(){}_anyControls(k){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(k){this._onChange.push(k)}_unregisterOnChange(k){wr(this._onChange,k)}registerOnDisabledChange(k){this._onDisabledChange.push(k)}_unregisterOnDisabledChange(k){wr(this._onDisabledChange,k)}_forEachChild(k){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(k){this._isBoxedValue(k)?(this.value=this._pendingValue=k.value,k.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=k}}class Yn extends er{constructor(k,F,E){super(Rr(F),pr(E,F)),this.controls=k,this._initObservables(),this._setUpdateStrategy(F),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(k,F){return this.controls[k]?this.controls[k]:(this.controls[k]=F,F.setParent(this),F._registerOnCollectionChange(this._onCollectionChange),F)}addControl(k,F,E={}){this.registerControl(k,F),this.updateValueAndValidity({emitEvent:E.emitEvent}),this._onCollectionChange()}removeControl(k,F={}){this.controls[k]&&this.controls[k]._registerOnCollectionChange(()=>{}),delete this.controls[k],this.updateValueAndValidity({emitEvent:F.emitEvent}),this._onCollectionChange()}setControl(k,F,E={}){this.controls[k]&&this.controls[k]._registerOnCollectionChange(()=>{}),delete this.controls[k],F&&this.registerControl(k,F),this.updateValueAndValidity({emitEvent:E.emitEvent}),this._onCollectionChange()}contains(k){return this.controls.hasOwnProperty(k)&&this.controls[k].enabled}setValue(k,F={}){gn(this,k),Object.keys(k).forEach(E=>{Qt(this,E),this.controls[E].setValue(k[E],{onlySelf:!0,emitEvent:F.emitEvent})}),this.updateValueAndValidity(F)}patchValue(k,F={}){null!=k&&(Object.keys(k).forEach(E=>{this.controls[E]&&this.controls[E].patchValue(k[E],{onlySelf:!0,emitEvent:F.emitEvent})}),this.updateValueAndValidity(F))}reset(k={},F={}){this._forEachChild((E,R)=>{E.reset(k[R],{onlySelf:!0,emitEvent:F.emitEvent})}),this._updatePristine(F),this._updateTouched(F),this.updateValueAndValidity(F)}getRawValue(){return this._reduceChildren({},(k,F,E)=>(k[E]=gt(F),k))}_syncPendingControls(){let k=this._reduceChildren(!1,(F,E)=>!!E._syncPendingControls()||F);return k&&this.updateValueAndValidity({onlySelf:!0}),k}_forEachChild(k){Object.keys(this.controls).forEach(F=>{const E=this.controls[F];E&&k(E,F)})}_setUpControls(){this._forEachChild(k=>{k.setParent(this),k._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(k){for(const F of Object.keys(this.controls)){const E=this.controls[F];if(this.contains(F)&&k(E))return!0}return!1}_reduceValue(){return this._reduceChildren({},(k,F,E)=>((F.enabled||this.disabled)&&(k[E]=F.value),k))}_reduceChildren(k,F){let E=k;return this._forEachChild((R,Y)=>{E=F(E,R,Y)}),E}_allControlsDisabled(){for(const k of Object.keys(this.controls))if(this.controls[k].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class Qn extends er{constructor(k,F,E){super(Rr(F),pr(E,F)),this.controls=k,this._initObservables(),this._setUpdateStrategy(F),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(k){return this.controls[k]}push(k,F={}){this.controls.push(k),this._registerControl(k),this.updateValueAndValidity({emitEvent:F.emitEvent}),this._onCollectionChange()}insert(k,F,E={}){this.controls.splice(k,0,F),this._registerControl(F),this.updateValueAndValidity({emitEvent:E.emitEvent})}removeAt(k,F={}){this.controls[k]&&this.controls[k]._registerOnCollectionChange(()=>{}),this.controls.splice(k,1),this.updateValueAndValidity({emitEvent:F.emitEvent})}setControl(k,F,E={}){this.controls[k]&&this.controls[k]._registerOnCollectionChange(()=>{}),this.controls.splice(k,1),F&&(this.controls.splice(k,0,F),this._registerControl(F)),this.updateValueAndValidity({emitEvent:E.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(k,F={}){gn(this,k),k.forEach((E,R)=>{Qt(this,R),this.at(R).setValue(E,{onlySelf:!0,emitEvent:F.emitEvent})}),this.updateValueAndValidity(F)}patchValue(k,F={}){null!=k&&(k.forEach((E,R)=>{this.at(R)&&this.at(R).patchValue(E,{onlySelf:!0,emitEvent:F.emitEvent})}),this.updateValueAndValidity(F))}reset(k=[],F={}){this._forEachChild((E,R)=>{E.reset(k[R],{onlySelf:!0,emitEvent:F.emitEvent})}),this._updatePristine(F),this._updateTouched(F),this.updateValueAndValidity(F)}getRawValue(){return this.controls.map(k=>gt(k))}clear(k={}){this.controls.length<1||(this._forEachChild(F=>F._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:k.emitEvent}))}_syncPendingControls(){let k=this.controls.reduce((F,E)=>!!E._syncPendingControls()||F,!1);return k&&this.updateValueAndValidity({onlySelf:!0}),k}_forEachChild(k){this.controls.forEach((F,E)=>{k(F,E)})}_updateValue(){this.value=this.controls.filter(k=>k.enabled||this.disabled).map(k=>k.value)}_anyControls(k){return this.controls.some(F=>F.enabled&&k(F))}_setUpControls(){this._forEachChild(k=>this._registerControl(k))}_allControlsDisabled(){for(const k of this.controls)if(k.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(k){k.setParent(this),k._registerOnCollectionChange(this._onCollectionChange)}}let Di=(()=>{class G extends ln{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return qe(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}}return G.\u0275fac=function(){let k;return function(E){return(k||(k=_.n5z(G)))(E||G)}}(),G.\u0275dir=_.lG2({type:G,features:[_.qOj]}),G})(),Fe=(()=>{class G{}return G.\u0275fac=function(F){return new(F||G)},G.\u0275dir=_.lG2({type:G,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),G})(),_t=(()=>{class G{}return G.\u0275fac=function(F){return new(F||G)},G.\u0275mod=_.oAB({type:G}),G.\u0275inj=_.cJS({}),G})();const Bi=new _.OlP("NgModelWithFormControlWarning"),vn={provide:ln,useExisting:(0,_.Gpc)(()=>Ur)};let Ur=(()=>{class G extends ln{constructor(F,E){super(),this.validators=F,this.asyncValidators=E,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new _.vpe,this._setValidators(F),this._setAsyncValidators(E)}ngOnChanges(F){this._checkFormPresent(),F.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(an(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(F){const E=this.form.get(F.path);return At(E,F),E.updateValueAndValidity({emitEvent:!1}),this.directives.push(F),E}getControl(F){return this.form.get(F.path)}removeControl(F){$t(F.control||null,F,!1),wr(this.directives,F)}addFormGroup(F){this._setUpFormContainer(F)}removeFormGroup(F){this._cleanUpFormContainer(F)}getFormGroup(F){return this.form.get(F.path)}addFormArray(F){this._setUpFormContainer(F)}removeFormArray(F){this._cleanUpFormContainer(F)}getFormArray(F){return this.form.get(F.path)}updateModel(F,E){this.form.get(F.path).setValue(E)}onSubmit(F){return this.submitted=!0,function Wr(G,k){G._syncPendingControls(),k.forEach(F=>{const E=F.control;"submit"===E.updateOn&&E._pendingChange&&(F.viewToModelUpdate(E._pendingValue),E._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(F),!1}onReset(){this.resetForm()}resetForm(F){this.form.reset(F),this.submitted=!1}_updateDomValue(){this.directives.forEach(F=>{const E=F.control,R=this.form.get(F.path);E!==R&&($t(E||null,F),pe(R)&&(At(R,F),F.control=R))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(F){const E=this.form.get(F.path);(function yn(G,k){lr(G,k)})(E,F),E.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(F){if(this.form){const E=this.form.get(F.path);E&&function br(G,k){return an(G,k)}(E,F)&&E.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){lr(this.form,this),this._oldForm&&an(this._oldForm,this)}_checkFormPresent(){}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(wt,10),_.Y36(It,10))},G.\u0275dir=_.lG2({type:G,selectors:[["","formGroup",""]],hostBindings:function(F,E){1&F&&_.NdJ("submit",function(Y){return E.onSubmit(Y)})("reset",function(){return E.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_._Bn([vn]),_.qOj,_.TTD]}),G})();const _s={provide:ln,useExisting:(0,_.Gpc)(()=>uo)};let uo=(()=>{class G extends Di{constructor(F,E,R){super(),this._parent=F,this._setValidators(E),this._setAsyncValidators(R)}_checkParentType(){is(this._parent)}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(ln,13),_.Y36(wt,10),_.Y36(It,10))},G.\u0275dir=_.lG2({type:G,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[_._Bn([_s]),_.qOj]}),G})();const ji={provide:ln,useExisting:(0,_.Gpc)(()=>ti)};let ti=(()=>{class G extends ln{constructor(F,E,R){super(),this._parent=F,this._setValidators(E),this._setAsyncValidators(R)}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return qe(null==this.name?this.name:this.name.toString(),this._parent)}_checkParentType(){is(this._parent)}}return G.\u0275fac=function(F){return new(F||G)(_.Y36(ln,13),_.Y36(wt,10),_.Y36(It,10))},G.\u0275dir=_.lG2({type:G,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[_._Bn([ji]),_.qOj]}),G})();function is(G){return!(G instanceof uo||G instanceof Ur||G instanceof ti)}const ss={provide:Sn,useExisting:(0,_.Gpc)(()=>vs)};let vs=(()=>{class G extends Sn{constructor(F,E,R,Y,oe){super(),this._ngModelWarningConfig=oe,this._added=!1,this.update=new _.vpe,this._ngModelWarningSent=!1,this._parent=F,this._setValidators(E),this._setAsyncValidators(R),this.valueAccessor=function Er(G,k){if(!k)return null;let F,E,R;return Array.isArray(k),k.forEach(Y=>{Y.constructor===ht?F=Y:function Vi(G){return Object.getPrototypeOf(G.constructor)===ot}(Y)?E=Y:R=Y}),R||E||F||null}(0,Y)}set isDisabled(F){}ngOnChanges(F){this._added||this._setUpControl(),function ys(G,k){if(!G.hasOwnProperty("model"))return!1;const F=G.model;return!!F.isFirstChange()||!Object.is(k,F.currentValue)}(F,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(F){this.viewModel=F,this.update.emit(F)}get path(){return qe(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return G._ngModelWarningSentOnce=!1,G.\u0275fac=function(F){return new(F||G)(_.Y36(ln,13),_.Y36(wt,10),_.Y36(It,10),_.Y36(at,10),_.Y36(Bi,8))},G.\u0275dir=_.lG2({type:G,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[_._Bn([ss]),_.qOj,_.TTD]}),G})(),pi=(()=>{class G{}return G.\u0275fac=function(F){return new(F||G)},G.\u0275mod=_.oAB({type:G}),G.\u0275inj=_.cJS({imports:[[_t]]}),G})(),Zi=(()=>{class G{static withConfig(F){return{ngModule:G,providers:[{provide:Bi,useValue:F.warnOnNgModelWithFormControl}]}}}return G.\u0275fac=function(F){return new(F||G)},G.\u0275mod=_.oAB({type:G}),G.\u0275inj=_.cJS({imports:[pi]}),G})(),ds=(()=>{class G{group(F,E=null){const R=this._reduceControls(F);let Te,Y=null,oe=null;return null!=E&&(function ho(G){return void 0!==G.asyncValidators||void 0!==G.validators||void 0!==G.updateOn}(E)?(Y=null!=E.validators?E.validators:null,oe=null!=E.asyncValidators?E.asyncValidators:null,Te=null!=E.updateOn?E.updateOn:void 0):(Y=null!=E.validator?E.validator:null,oe=null!=E.asyncValidator?E.asyncValidator:null)),new Yn(R,{asyncValidators:oe,updateOn:Te,validators:Y})}control(F,E,R){return new gr(F,E,R)}array(F,E,R){const Y=F.map(oe=>this._createControl(oe));return new Qn(Y,E,R)}_reduceControls(F){const E={};return Object.keys(F).forEach(R=>{E[R]=this._createControl(F[R])}),E}_createControl(F){return pe(F)||le(F)||ze(F)?F:Array.isArray(F)?this.control(F[0],F.length>1?F[1]:null,F.length>2?F[2]:null):this.control(F)}}return G.\u0275fac=function(F){return new(F||G)},G.\u0275prov=_.Yz7({token:G,factory:G.\u0275fac,providedIn:Zi}),G})()},441:(Ft,We,$)=>{$.d(We,{F0:()=>mr,rH:()=>Gi,Od:()=>ko,yS:()=>Oa,Bz:()=>Hs,lC:()=>xs});var _=$(5e3),ne=$(8306),ie=$(4742),be=$(8996),Ce=$(4671),Se=$(3268),Ve=$(7669),Me=$(1810),Be=$(5403),ce=$(9672);function Rt(S,D,b){S?(0,ce.f)(b,S,D):D()}var ot=$(576);function at(S,D){const b=(0,ot.m)(S)?S:()=>S,N=P=>P.error(b());return new ne.y(D?P=>D.schedule(N,0,P):N)}var Dt=$(8421);function nt(S){return new ne.y(D=>{(0,Dt.Xf)(S()).subscribe(D)})}var ft=$(727),De=$(4482);function kt(){return(0,De.e)((S,D)=>{let b=null;S._refCount++;const N=(0,Be.x)(D,void 0,void 0,void 0,()=>{if(!S||S._refCount<=0||0<--S._refCount)return void(b=null);const P=S._connection,K=b;b=null,P&&(!K||P===K)&&P.unsubscribe(),D.unsubscribe()});S.subscribe(N),N.closed||(b=S.connect())})}class ht extends ne.y{constructor(D,b){super(),this.source=D,this.subjectFactory=b,this._subject=null,this._refCount=0,this._connection=null,(0,De.A)(D)&&(this.lift=D.lift)}_subscribe(D){return this.getSubject().subscribe(D)}getSubject(){const D=this._subject;return(!D||D.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:D}=this;this._subject=this._connection=null,null==D||D.unsubscribe()}connect(){let D=this._connection;if(!D){D=this._connection=new ft.w0;const b=this.getSubject();D.add(this.source.subscribe((0,Be.x)(b,void 0,()=>{this._teardown(),b.complete()},N=>{this._teardown(),b.error(N)},()=>this._teardown()))),D.closed&&(this._connection=null,D=ft.w0.EMPTY)}return D}refCount(){return kt()(this)}}var xe=$(9646),Ge=$(1135),wt=$(6805),It=$(7272),V=$(515),ut=$(7579);function ge(S){return(0,De.e)((D,b)=>{let K,N=null,P=!1;N=D.subscribe((0,Be.x)(b,void 0,void 0,de=>{K=(0,Dt.Xf)(S(de,ge(S)(D))),N?(N.unsubscribe(),N=null,K.subscribe(b)):P=!0})),P&&(N.unsubscribe(),N=null,K.subscribe(b))})}var Oe=$(5577);function Ue(S,D){return(0,ot.m)(D)?(0,Oe.z)(S,D,1):(0,Oe.z)(S,1)}var Je=$(9300);function Ye(S){return S<=0?()=>V.E:(0,De.e)((D,b)=>{let N=[];D.subscribe((0,Be.x)(b,P=>{N.push(P),S<N.length&&N.shift()},()=>{for(const P of N)b.next(P);b.complete()},void 0,()=>{N=null}))})}var St=$(8068),Pt=$(6590),it=$(4004),en=$(3900),on=$(5698),tn=$(8675),Kt=$(5026),Tn=$(590),zt=$(8505),Yt=$(8189),hr=$(9808);class fr{constructor(D,b){this.id=D,this.url=b}}class sr extends fr{constructor(D,b,N="imperative",P=null){super(D,b),this.navigationTrigger=N,this.restoredState=P}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Pn extends fr{constructor(D,b,N){super(D,b),this.urlAfterRedirects=N}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Hr extends fr{constructor(D,b,N){super(D,b),this.reason=N}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Gn extends fr{constructor(D,b,N){super(D,b),this.error=N}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Ar extends fr{constructor(D,b,N,P){super(D,b),this.urlAfterRedirects=N,this.state=P}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vn extends fr{constructor(D,b,N,P){super(D,b),this.urlAfterRedirects=N,this.state=P}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Bt extends fr{constructor(D,b,N,P,K){super(D,b),this.urlAfterRedirects=N,this.state=P,this.shouldActivate=K}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class En extends fr{constructor(D,b,N,P){super(D,b),this.urlAfterRedirects=N,this.state=P}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Sn extends fr{constructor(D,b,N,P){super(D,b),this.urlAfterRedirects=N,this.state=P}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ln{constructor(D){this.route=D}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ci{constructor(D){this.route=D}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ei{constructor(D){this.snapshot=D}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zn{constructor(D){this.snapshot=D}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fr{constructor(D){this.snapshot=D}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ci{constructor(D){this.snapshot=D}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xr{constructor(D,b,N){this.routerEvent=D,this.position=b,this.anchor=N}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Vt="primary";class Xt{constructor(D){this.params=D||{}}has(D){return Object.prototype.hasOwnProperty.call(this.params,D)}get(D){if(this.has(D)){const b=this.params[D];return Array.isArray(b)?b[0]:b}return null}getAll(D){if(this.has(D)){const b=this.params[D];return Array.isArray(b)?b:[b]}return[]}get keys(){return Object.keys(this.params)}}function nn(S){return new Xt(S)}const Pr="ngNavigationCancelingError";function ri(S){const D=Error("NavigationCancelingError: "+S);return D[Pr]=!0,D}function Li(S,D,b){const N=b.path.split("/");if(N.length>S.length||"full"===b.pathMatch&&(D.hasChildren()||N.length<S.length))return null;const P={};for(let K=0;K<N.length;K++){const de=N[K],Ie=S[K];if(de.startsWith(":"))P[de.substring(1)]=Ie;else if(de!==Ie.path)return null}return{consumed:S.slice(0,N.length),posParams:P}}function vr(S,D){const b=S?Object.keys(S):void 0,N=D?Object.keys(D):void 0;if(!b||!N||b.length!=N.length)return!1;let P;for(let K=0;K<b.length;K++)if(P=b[K],!dn(S[P],D[P]))return!1;return!0}function dn(S,D){if(Array.isArray(S)&&Array.isArray(D)){if(S.length!==D.length)return!1;const b=[...S].sort(),N=[...D].sort();return b.every((P,K)=>N[K]===P)}return S===D}function Ne(S){return Array.prototype.concat.apply([],S)}function ye(S){return S.length>0?S[S.length-1]:null}function ke(S,D){for(const b in S)S.hasOwnProperty(b)&&D(S[b],b)}function fe(S){return(0,_.CqO)(S)?S:(0,_.QGY)(S)?(0,be.D)(Promise.resolve(S)):(0,xe.of)(S)}const At={exact:function lr(S,D,b){if(!Zr(S.segments,D.segments)||!Gr(S.segments,D.segments,b)||S.numberOfChildren!==D.numberOfChildren)return!1;for(const N in D.children)if(!S.children[N]||!lr(S.children[N],D.children[N],b))return!1;return!0},subset:ur},$t={exact:function or(S,D){return vr(S,D)},subset:function an(S,D){return Object.keys(D).length<=Object.keys(S).length&&Object.keys(D).every(b=>dn(S[b],D[b]))},ignored:()=>!0};function hn(S,D,b){return At[b.paths](S.root,D.root,b.matrixParams)&&$t[b.queryParams](S.queryParams,D.queryParams)&&!("exact"===b.fragment&&S.fragment!==D.fragment)}function ur(S,D,b){return ts(S,D,D.segments,b)}function ts(S,D,b,N){if(S.segments.length>b.length){const P=S.segments.slice(0,b.length);return!(!Zr(P,b)||D.hasChildren()||!Gr(P,b,N))}if(S.segments.length===b.length){if(!Zr(S.segments,b)||!Gr(S.segments,b,N))return!1;for(const P in D.children)if(!S.children[P]||!ur(S.children[P],D.children[P],N))return!1;return!0}{const P=b.slice(0,S.segments.length),K=b.slice(S.segments.length);return!!(Zr(S.segments,P)&&Gr(S.segments,P,N)&&S.children[Vt])&&ts(S.children[Vt],D,K,N)}}function Gr(S,D,b){return D.every((N,P)=>$t[b](S[P].parameters,N.parameters))}class _i{constructor(D,b,N){this.root=D,this.queryParams=b,this.fragment=N}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=nn(this.queryParams)),this._queryParamMap}toString(){return Vi.serialize(this)}}class yn{constructor(D,b){this.segments=D,this.children=b,this.parent=null,ke(b,(N,P)=>N.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wr(this)}}class br{constructor(D,b){this.path=D,this.parameters=b}get parameterMap(){return this._parameterMap||(this._parameterMap=nn(this.parameters)),this._parameterMap}toString(){return zr(this)}}function Zr(S,D){return S.length===D.length&&S.every((b,N)=>b.path===D[N].path)}class si{}class ys{parse(D){const b=new ze(D);return new _i(b.parseRootSegment(),b.parseQueryParams(),b.parseFragment())}serialize(D){const b=`/${Er(D.root,!0)}`,N=function Rr(S){const D=Object.keys(S).map(b=>{const N=S[b];return Array.isArray(N)?N.map(P=>`${Ui(b)}=${Ui(P)}`).join("&"):`${Ui(b)}=${Ui(N)}`}).filter(b=>!!b);return D.length?`?${D.join("&")}`:""}(D.queryParams);return`${b}${N}${"string"==typeof D.fragment?`#${function ar(S){return encodeURI(S)}(D.fragment)}`:""}`}}const Vi=new ys;function Wr(S){return S.segments.map(D=>zr(D)).join("/")}function Er(S,D){if(!S.hasChildren())return Wr(S);if(D){const b=S.children[Vt]?Er(S.children[Vt],!1):"",N=[];return ke(S.children,(P,K)=>{K!==Vt&&N.push(`${K}:${Er(P,!1)}`)}),N.length>0?`${b}(${N.join("//")})`:b}{const b=function Vr(S,D){let b=[];return ke(S.children,(N,P)=>{P===Vt&&(b=b.concat(D(N,P)))}),ke(S.children,(N,P)=>{P!==Vt&&(b=b.concat(D(N,P)))}),b}(S,(N,P)=>P===Vt?[Er(S.children[Vt],!1)]:[`${P}:${Er(N,!1)}`]);return 1===Object.keys(S.children).length&&null!=S.children[Vt]?`${Wr(S)}/${b[0]}`:`${Wr(S)}/(${b.join("//")})`}}function wr(S){return encodeURIComponent(S).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ui(S){return wr(S).replace(/%3B/gi,";")}function Tt(S){return wr(S).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ht(S){return decodeURIComponent(S)}function Hn(S){return Ht(S.replace(/\+/g,"%20"))}function zr(S){return`${Tt(S.path)}${function bi(S){return Object.keys(S).map(D=>`;${Tt(D)}=${Tt(S[D])}`).join("")}(S.parameters)}`}const Ki=/^[^\/()?;=#]+/;function pr(S){const D=S.match(Ki);return D?D[0]:""}const Mi=/^[^=?&#]+/,pe=/^[^&#]+/;class ze{constructor(D){this.url=D,this.remaining=D}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new yn([],{}):new yn([],this.parseChildren())}parseQueryParams(){const D={};if(this.consumeOptional("?"))do{this.parseQueryParam(D)}while(this.consumeOptional("&"));return D}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const D=[];for(this.peekStartsWith("(")||D.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),D.push(this.parseSegment());let b={};this.peekStartsWith("/(")&&(this.capture("/"),b=this.parseParens(!0));let N={};return this.peekStartsWith("(")&&(N=this.parseParens(!1)),(D.length>0||Object.keys(b).length>0)&&(N[Vt]=new yn(D,b)),N}parseSegment(){const D=pr(this.remaining);if(""===D&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(D),new br(Ht(D),this.parseMatrixParams())}parseMatrixParams(){const D={};for(;this.consumeOptional(";");)this.parseParam(D);return D}parseParam(D){const b=pr(this.remaining);if(!b)return;this.capture(b);let N="";if(this.consumeOptional("=")){const P=pr(this.remaining);P&&(N=P,this.capture(N))}D[Ht(b)]=Ht(N)}parseQueryParam(D){const b=function Ee(S){const D=S.match(Mi);return D?D[0]:""}(this.remaining);if(!b)return;this.capture(b);let N="";if(this.consumeOptional("=")){const de=function le(S){const D=S.match(pe);return D?D[0]:""}(this.remaining);de&&(N=de,this.capture(N))}const P=Hn(b),K=Hn(N);if(D.hasOwnProperty(P)){let de=D[P];Array.isArray(de)||(de=[de],D[P]=de),de.push(K)}else D[P]=K}parseParens(D){const b={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const N=pr(this.remaining),P=this.remaining[N.length];if("/"!==P&&")"!==P&&";"!==P)throw new Error(`Cannot parse url '${this.url}'`);let K;N.indexOf(":")>-1?(K=N.substr(0,N.indexOf(":")),this.capture(K),this.capture(":")):D&&(K=Vt);const de=this.parseChildren();b[K]=1===Object.keys(de).length?de[Vt]:new yn([],de),this.consumeOptional("//")}return b}peekStartsWith(D){return this.remaining.startsWith(D)}consumeOptional(D){return!!this.peekStartsWith(D)&&(this.remaining=this.remaining.substring(D.length),!0)}capture(D){if(!this.consumeOptional(D))throw new Error(`Expected "${D}".`)}}class gt{constructor(D){this._root=D}get root(){return this._root.value}parent(D){const b=this.pathFromRoot(D);return b.length>1?b[b.length-2]:null}children(D){const b=Qt(D,this._root);return b?b.children.map(N=>N.value):[]}firstChild(D){const b=Qt(D,this._root);return b&&b.children.length>0?b.children[0].value:null}siblings(D){const b=gn(D,this._root);return b.length<2?[]:b[b.length-2].children.map(P=>P.value).filter(P=>P!==D)}pathFromRoot(D){return gn(D,this._root).map(b=>b.value)}}function Qt(S,D){if(S===D.value)return D;for(const b of D.children){const N=Qt(S,b);if(N)return N}return null}function gn(S,D){if(S===D.value)return[D];for(const b of D.children){const N=gn(S,b);if(N.length)return N.unshift(D),N}return[]}class er{constructor(D,b){this.value=D,this.children=b}toString(){return`TreeNode(${this.value})`}}function gr(S){const D={};return S&&S.children.forEach(b=>D[b.value.outlet]=b),D}class Yn extends gt{constructor(D,b){super(D),this.snapshot=b,vi(this,D)}toString(){return this.snapshot.toString()}}function Qn(S,D){const b=function Ys(S,D){const de=new Qs([],{},{},"",{},Vt,D,null,S.root,-1,{});return new qi("",new er(de,[]))}(S,D),N=new Ge.X([new br("",{})]),P=new Ge.X({}),K=new Ge.X({}),de=new Ge.X({}),Ie=new Ge.X(""),dt=new Kr(N,P,de,Ie,K,Vt,D,b.root);return dt.snapshot=b.root,new Yn(new er(dt,[]),b)}class Kr{constructor(D,b,N,P,K,de,Ie,dt){this.url=D,this.params=b,this.queryParams=N,this.fragment=P,this.data=K,this.outlet=de,this.component=Ie,this._futureSnapshot=dt}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,it.U)(D=>nn(D)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,it.U)(D=>nn(D)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function di(S,D="emptyOnly"){const b=S.pathFromRoot;let N=0;if("always"!==D)for(N=b.length-1;N>=1;){const P=b[N],K=b[N-1];if(P.routeConfig&&""===P.routeConfig.path)N--;else{if(K.component)break;N--}}return function Di(S){return S.reduce((D,b)=>({params:Object.assign(Object.assign({},D.params),b.params),data:Object.assign(Object.assign({},D.data),b.data),resolve:Object.assign(Object.assign({},D.resolve),b._resolvedData)}),{params:{},data:{},resolve:{}})}(b.slice(N))}class Qs{constructor(D,b,N,P,K,de,Ie,dt,Jt,yr,pn){this.url=D,this.params=b,this.queryParams=N,this.fragment=P,this.data=K,this.outlet=de,this.component=Ie,this.routeConfig=dt,this._urlSegment=Jt,this._lastPathIndex=yr,this._resolve=pn}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=nn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=nn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(N=>N.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class qi extends gt{constructor(D,b){super(b),this.url=D,vi(this,b)}toString(){return ns(this._root)}}function vi(S,D){D.value._routerState=S,D.children.forEach(b=>vi(S,b))}function ns(S){const D=S.children.length>0?` { ${S.children.map(ns).join(", ")} } `:"";return`${S.value}${D}`}function oo(S){if(S.snapshot){const D=S.snapshot,b=S._futureSnapshot;S.snapshot=b,vr(D.queryParams,b.queryParams)||S.queryParams.next(b.queryParams),D.fragment!==b.fragment&&S.fragment.next(b.fragment),vr(D.params,b.params)||S.params.next(b.params),function Lr(S,D){if(S.length!==D.length)return!1;for(let b=0;b<S.length;++b)if(!vr(S[b],D[b]))return!1;return!0}(D.url,b.url)||S.url.next(b.url),vr(D.data,b.data)||S.data.next(b.data)}else S.snapshot=S._futureSnapshot,S.data.next(S._futureSnapshot.data)}function Ss(S,D){const b=vr(S.params,D.params)&&function ii(S,D){return Zr(S,D)&&S.every((b,N)=>vr(b.parameters,D[N].parameters))}(S.url,D.url);return b&&!(!S.parent!=!D.parent)&&(!S.parent||Ss(S.parent,D.parent))}function Ir(S,D,b){if(b&&S.shouldReuseRoute(D.value,b.value.snapshot)){const N=b.value;N._futureSnapshot=D.value;const P=function us(S,D,b){return D.children.map(N=>{for(const P of b.children)if(S.shouldReuseRoute(N.value,P.value.snapshot))return Ir(S,N,P);return Ir(S,N)})}(S,D,b);return new er(N,P)}{if(S.shouldAttach(D.value)){const K=S.retrieve(D.value);if(null!==K){const de=K.route;return de.value._futureSnapshot=D.value,de.children=D.children.map(Ie=>Ir(S,Ie)),de}}const N=function Fe(S){return new Kr(new Ge.X(S.url),new Ge.X(S.params),new Ge.X(S.queryParams),new Ge.X(S.fragment),new Ge.X(S.data),S.outlet,S.component,S)}(D.value),P=D.children.map(K=>Ir(S,K));return new er(N,P)}}function He(S){return"object"==typeof S&&null!=S&&!S.outlets&&!S.segmentPath}function tt(S){return"object"==typeof S&&null!=S&&S.outlets}function pt(S,D,b,N,P){let K={};if(N&&ke(N,(Ie,dt)=>{K[dt]=Array.isArray(Ie)?Ie.map(Jt=>`${Jt}`):`${Ie}`}),S===D)return new _i(b,K,P);const de=_t(S,D,b);return new _i(de,K,P)}function _t(S,D,b){const N={};return ke(S.children,(P,K)=>{N[K]=P===D?b:_t(P,D,b)}),new yn(S.segments,N)}class Un{constructor(D,b,N){if(this.isAbsolute=D,this.numberOfDoubleDots=b,this.commands=N,D&&N.length>0&&He(N[0]))throw new Error("Root segment cannot have matrix parameters");const P=N.find(tt);if(P&&P!==ye(N))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class tr{constructor(D,b,N){this.segmentGroup=D,this.processChildren=b,this.index=N}}function nr(S,D,b){if(S||(S=new yn([],{})),0===S.segments.length&&S.hasChildren())return vn(S,D,b);const N=function Ur(S,D,b){let N=0,P=D;const K={match:!1,pathIndex:0,commandIndex:0};for(;P<S.segments.length;){if(N>=b.length)return K;const de=S.segments[P],Ie=b[N];if(tt(Ie))break;const dt=`${Ie}`,Jt=N<b.length-1?b[N+1]:null;if(P>0&&void 0===dt)break;if(dt&&Jt&&"object"==typeof Jt&&void 0===Jt.outlets){if(!ti(dt,Jt,de))return K;N+=2}else{if(!ti(dt,{},de))return K;N++}P++}return{match:!0,pathIndex:P,commandIndex:N}}(S,D,b),P=b.slice(N.commandIndex);if(N.match&&N.pathIndex<S.segments.length){const K=new yn(S.segments.slice(0,N.pathIndex),{});return K.children[Vt]=new yn(S.segments.slice(N.pathIndex),S.children),vn(K,0,P)}return N.match&&0===P.length?new yn(S.segments,{}):N.match&&!S.hasChildren()?_s(S,D,b):N.match?vn(S,0,P):_s(S,D,b)}function vn(S,D,b){if(0===b.length)return new yn(S.segments,{});{const N=function ao(S){return tt(S[0])?S[0].outlets:{[Vt]:S}}(b),P={};return ke(N,(K,de)=>{"string"==typeof K&&(K=[K]),null!==K&&(P[de]=nr(S.children[de],D,K))}),ke(S.children,(K,de)=>{void 0===N[de]&&(P[de]=K)}),new yn(S.segments,P)}}function _s(S,D,b){const N=S.segments.slice(0,D);let P=0;for(;P<b.length;){const K=b[P];if(tt(K)){const dt=uo(K.outlets);return new yn(N,dt)}if(0===P&&He(b[0])){N.push(new br(S.segments[D].path,ji(b[0]))),P++;continue}const de=tt(K)?K.outlets[Vt]:`${K}`,Ie=P<b.length-1?b[P+1]:null;de&&Ie&&He(Ie)?(N.push(new br(de,ji(Ie))),P+=2):(N.push(new br(de,{})),P++)}return new yn(N,{})}function uo(S){const D={};return ke(S,(b,N)=>{"string"==typeof b&&(b=[b]),null!==b&&(D[N]=_s(new yn([],{}),0,b))}),D}function ji(S){const D={};return ke(S,(b,N)=>D[N]=`${b}`),D}function ti(S,D,b){return S==b.path&&vr(D,b.parameters)}class ss{constructor(D,b,N,P){this.routeReuseStrategy=D,this.futureState=b,this.currState=N,this.forwardEvent=P}activate(D){const b=this.futureState._root,N=this.currState?this.currState._root:null;this.deactivateChildRoutes(b,N,D),oo(this.futureState.root),this.activateChildRoutes(b,N,D)}deactivateChildRoutes(D,b,N){const P=gr(b);D.children.forEach(K=>{const de=K.value.outlet;this.deactivateRoutes(K,P[de],N),delete P[de]}),ke(P,(K,de)=>{this.deactivateRouteAndItsChildren(K,N)})}deactivateRoutes(D,b,N){const P=D.value,K=b?b.value:null;if(P===K)if(P.component){const de=N.getContext(P.outlet);de&&this.deactivateChildRoutes(D,b,de.children)}else this.deactivateChildRoutes(D,b,N);else K&&this.deactivateRouteAndItsChildren(b,N)}deactivateRouteAndItsChildren(D,b){D.value.component&&this.routeReuseStrategy.shouldDetach(D.value.snapshot)?this.detachAndStoreRouteSubtree(D,b):this.deactivateRouteAndOutlet(D,b)}detachAndStoreRouteSubtree(D,b){const N=b.getContext(D.value.outlet),P=N&&D.value.component?N.children:b,K=gr(D);for(const de of Object.keys(K))this.deactivateRouteAndItsChildren(K[de],P);if(N&&N.outlet){const de=N.outlet.detach(),Ie=N.children.onOutletDeactivated();this.routeReuseStrategy.store(D.value.snapshot,{componentRef:de,route:D,contexts:Ie})}}deactivateRouteAndOutlet(D,b){const N=b.getContext(D.value.outlet),P=N&&D.value.component?N.children:b,K=gr(D);for(const de of Object.keys(K))this.deactivateRouteAndItsChildren(K[de],P);N&&N.outlet&&(N.outlet.deactivate(),N.children.onOutletDeactivated(),N.attachRef=null,N.resolver=null,N.route=null)}activateChildRoutes(D,b,N){const P=gr(b);D.children.forEach(K=>{this.activateRoutes(K,P[K.value.outlet],N),this.forwardEvent(new ci(K.value.snapshot))}),D.children.length&&this.forwardEvent(new Zn(D.value.snapshot))}activateRoutes(D,b,N){const P=D.value,K=b?b.value:null;if(oo(P),P===K)if(P.component){const de=N.getOrCreateContext(P.outlet);this.activateChildRoutes(D,b,de.children)}else this.activateChildRoutes(D,b,N);else if(P.component){const de=N.getOrCreateContext(P.outlet);if(this.routeReuseStrategy.shouldAttach(P.snapshot)){const Ie=this.routeReuseStrategy.retrieve(P.snapshot);this.routeReuseStrategy.store(P.snapshot,null),de.children.onOutletReAttached(Ie.contexts),de.attachRef=Ie.componentRef,de.route=Ie.route.value,de.outlet&&de.outlet.attach(Ie.componentRef,Ie.route.value),oo(Ie.route.value),this.activateChildRoutes(D,null,de.children)}else{const Ie=function vs(S){for(let D=S.parent;D;D=D.parent){const b=D.routeConfig;if(b&&b._loadedConfig)return b._loadedConfig;if(b&&b.component)return null}return null}(P.snapshot),dt=Ie?Ie.module.componentFactoryResolver:null;de.attachRef=null,de.route=P,de.resolver=dt,de.outlet&&de.outlet.activateWith(P,dt),this.activateChildRoutes(D,null,de.children)}}else this.activateChildRoutes(D,null,N)}}class ls{constructor(D,b){this.routes=D,this.module=b}}function Es(S){return"function"==typeof S}function Ei(S){return S instanceof _i}const As=Symbol("INITIAL_VALUE");function hi(){return(0,en.w)(S=>function ae(...S){const D=(0,Ve.yG)(S),b=(0,Ve.jO)(S),{args:N,keys:P}=(0,ie.D)(S);if(0===N.length)return(0,be.D)([],D);const K=new ne.y(function Re(S,D,b=Ce.y){return N=>{Rt(D,()=>{const{length:P}=S,K=new Array(P);let de=P,Ie=P;for(let dt=0;dt<P;dt++)Rt(D,()=>{const Jt=(0,be.D)(S[dt],D);let yr=!1;Jt.subscribe((0,Be.x)(N,pn=>{K[dt]=pn,yr||(yr=!0,Ie--),Ie||N.next(b(K.slice()))},()=>{--de||N.complete()}))},N)},N)}}(N,D,P?de=>(0,Me.n)(P,de):Ce.y));return b?K.pipe((0,Se.Z)(b)):K}(S.map(D=>D.pipe((0,on.q)(1),(0,tn.O)(As)))).pipe((0,Kt.R)((D,b)=>{let N=!1;return b.reduce((P,K,de)=>P!==As?P:(K===As&&(N=!0),N||!1!==K&&de!==b.length-1&&!Ei(K)?P:K),D)},As),(0,Je.h)(D=>D!==As),(0,it.U)(D=>Ei(D)?D:!0===D),(0,on.q)(1)))}class ws{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Cn,this.attachRef=null}}class Cn{constructor(){this.contexts=new Map}onChildOutletCreated(D,b){const N=this.getOrCreateContext(D);N.outlet=b,this.contexts.set(D,N)}onChildOutletDestroyed(D){const b=this.getContext(D);b&&(b.outlet=null,b.attachRef=null)}onOutletDeactivated(){const D=this.contexts;return this.contexts=new Map,D}onOutletReAttached(D){this.contexts=D}getOrCreateContext(D){let b=this.getContext(D);return b||(b=new ws,this.contexts.set(D,b)),b}getContext(D){return this.contexts.get(D)||null}}let xs=(()=>{class S{constructor(b,N,P,K,de){this.parentContexts=b,this.location=N,this.resolver=P,this.changeDetector=de,this.activated=null,this._activatedRoute=null,this.activateEvents=new _.vpe,this.deactivateEvents=new _.vpe,this.attachEvents=new _.vpe,this.detachEvents=new _.vpe,this.name=K||Vt,b.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const b=this.parentContexts.getContext(this.name);b&&b.route&&(b.attachRef?this.attach(b.attachRef,b.route):this.activateWith(b.route,b.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const b=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(b.instance),b}attach(b,N){this.activated=b,this._activatedRoute=N,this.location.insert(b.hostView),this.attachEvents.emit(b.instance)}deactivate(){if(this.activated){const b=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(b)}}activateWith(b,N){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=b;const de=(N=N||this.resolver).resolveComponentFactory(b._futureSnapshot.routeConfig.component),Ie=this.parentContexts.getOrCreateContext(this.name).children,dt=new $i(b,Ie,this.location.injector);this.activated=this.location.createComponent(de,this.location.length,dt),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return S.\u0275fac=function(b){return new(b||S)(_.Y36(Cn),_.Y36(_.s_b),_.Y36(_._Vd),_.$8M("name"),_.Y36(_.sBO))},S.\u0275dir=_.lG2({type:S,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),S})();class $i{constructor(D,b,N){this.route=D,this.childContexts=b,this.parent=N}get(D,b){return D===Kr?this.route:D===Cn?this.childContexts:this.parent.get(D,b)}}let cs=(()=>{class S{}return S.\u0275fac=function(b){return new(b||S)},S.\u0275cmp=_.Xpm({type:S,selectors:[["ng-component"]],decls:1,vars:0,template:function(b,N){1&b&&_._UZ(0,"router-outlet")},directives:[xs],encapsulation:2}),S})();function fi(S,D=""){for(let b=0;b<S.length;b++){const N=S[b];Rs(N,On(D,N))}}function Rs(S,D){S.children&&fi(S.children,D)}function On(S,D){return D?S||D.path?S&&!D.path?`${S}/`:!S&&D.path?D.path:`${S}/${D.path}`:"":S}function B(S){const D=S.children&&S.children.map(B),b=D?Object.assign(Object.assign({},S),{children:D}):Object.assign({},S);return!b.component&&(D||b.loadChildren)&&b.outlet&&b.outlet!==Vt&&(b.component=cs),b}function Q(S){return S.outlet||Vt}function U(S,D){const b=S.filter(N=>Q(N)===D);return b.push(...S.filter(N=>Q(N)!==D)),b}const te={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _e(S,D,b){var N;if(""===D.path)return"full"===D.pathMatch&&(S.hasChildren()||b.length>0)?Object.assign({},te):{matched:!0,consumedSegments:[],remainingSegments:b,parameters:{},positionalParamSegments:{}};const K=(D.matcher||Li)(b,S,D);if(!K)return Object.assign({},te);const de={};ke(K.posParams,(dt,Jt)=>{de[Jt]=dt.path});const Ie=K.consumed.length>0?Object.assign(Object.assign({},de),K.consumed[K.consumed.length-1].parameters):de;return{matched:!0,consumedSegments:K.consumed,remainingSegments:b.slice(K.consumed.length),parameters:Ie,positionalParamSegments:null!==(N=K.posParams)&&void 0!==N?N:{}}}function rt(S,D,b,N,P="corrected"){if(b.length>0&&function wn(S,D,b){return b.some(N=>kn(S,D,N)&&Q(N)!==Vt)}(S,b,N)){const de=new yn(D,function un(S,D,b,N){const P={};P[Vt]=N,N._sourceSegment=S,N._segmentIndexShift=D.length;for(const K of b)if(""===K.path&&Q(K)!==Vt){const de=new yn([],{});de._sourceSegment=S,de._segmentIndexShift=D.length,P[Q(K)]=de}return P}(S,D,N,new yn(b,S.children)));return de._sourceSegment=S,de._segmentIndexShift=D.length,{segmentGroup:de,slicedSegments:[]}}if(0===b.length&&function Wn(S,D,b){return b.some(N=>kn(S,D,N))}(S,b,N)){const de=new yn(S.segments,function yt(S,D,b,N,P,K){const de={};for(const Ie of N)if(kn(S,b,Ie)&&!P[Q(Ie)]){const dt=new yn([],{});dt._sourceSegment=S,dt._segmentIndexShift="legacy"===K?S.segments.length:D.length,de[Q(Ie)]=dt}return Object.assign(Object.assign({},P),de)}(S,D,b,N,S.children,P));return de._sourceSegment=S,de._segmentIndexShift=D.length,{segmentGroup:de,slicedSegments:b}}const K=new yn(S.segments,S.children);return K._sourceSegment=S,K._segmentIndexShift=D.length,{segmentGroup:K,slicedSegments:b}}function kn(S,D,b){return(!(S.hasChildren()||D.length>0)||"full"!==b.pathMatch)&&""===b.path}function Jn(S,D,b,N){return!!(Q(S)===N||N!==Vt&&kn(D,b,S))&&("**"===S.path||_e(D,S,b).matched)}function qr(S,D,b){return 0===D.length&&!S.children[b]}class Mr{constructor(D){this.segmentGroup=D||null}}class $r{constructor(D){this.urlTree=D}}function zn(S){return at(new Mr(S))}function pi(S){return at(new $r(S))}class ds{constructor(D,b,N,P,K){this.configLoader=b,this.urlSerializer=N,this.urlTree=P,this.config=K,this.allowRedirects=!0,this.ngModule=D.get(_.h0i)}apply(){const D=rt(this.urlTree.root,[],[],this.config).segmentGroup,b=new yn(D.segments,D.children);return this.expandSegmentGroup(this.ngModule,this.config,b,Vt).pipe((0,it.U)(K=>this.createUrlTree(G(K),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ge(K=>{if(K instanceof $r)return this.allowRedirects=!1,this.match(K.urlTree);throw K instanceof Mr?this.noMatchError(K):K}))}match(D){return this.expandSegmentGroup(this.ngModule,this.config,D.root,Vt).pipe((0,it.U)(P=>this.createUrlTree(G(P),D.queryParams,D.fragment))).pipe(ge(P=>{throw P instanceof Mr?this.noMatchError(P):P}))}noMatchError(D){return new Error(`Cannot match any routes. URL Segment: '${D.segmentGroup}'`)}createUrlTree(D,b,N){const P=D.segments.length>0?new yn([],{[Vt]:D}):D;return new _i(P,b,N)}expandSegmentGroup(D,b,N,P){return 0===N.segments.length&&N.hasChildren()?this.expandChildren(D,b,N).pipe((0,it.U)(K=>new yn([],K))):this.expandSegment(D,N,b,N.segments,P,!0)}expandChildren(D,b,N){const P=[];for(const K of Object.keys(N.children))"primary"===K?P.unshift(K):P.push(K);return(0,be.D)(P).pipe(Ue(K=>{const de=N.children[K],Ie=U(b,K);return this.expandSegmentGroup(D,Ie,de,K).pipe((0,it.U)(dt=>({segment:dt,outlet:K})))}),(0,Kt.R)((K,de)=>(K[de.outlet]=de.segment,K),{}),function Wt(S,D){const b=arguments.length>=2;return N=>N.pipe(S?(0,Je.h)((P,K)=>S(P,K,N)):Ce.y,Ye(1),b?(0,Pt.d)(D):(0,St.T)(()=>new wt.K))}())}expandSegment(D,b,N,P,K,de){return(0,be.D)(N).pipe(Ue(Ie=>this.expandSegmentAgainstRoute(D,b,N,Ie,P,K,de).pipe(ge(Jt=>{if(Jt instanceof Mr)return(0,xe.of)(null);throw Jt}))),(0,Tn.P)(Ie=>!!Ie),ge((Ie,dt)=>{if(Ie instanceof wt.K||"EmptyError"===Ie.name)return qr(b,P,K)?(0,xe.of)(new yn([],{})):zn(b);throw Ie}))}expandSegmentAgainstRoute(D,b,N,P,K,de,Ie){return Jn(P,b,K,de)?void 0===P.redirectTo?this.matchSegmentAgainstRoute(D,b,P,K,de):Ie&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(D,b,N,P,K,de):zn(b):zn(b)}expandSegmentAgainstRouteUsingRedirect(D,b,N,P,K,de){return"**"===P.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(D,N,P,de):this.expandRegularSegmentAgainstRouteUsingRedirect(D,b,N,P,K,de)}expandWildCardWithParamsAgainstRouteUsingRedirect(D,b,N,P){const K=this.applyRedirectCommands([],N.redirectTo,{});return N.redirectTo.startsWith("/")?pi(K):this.lineralizeSegments(N,K).pipe((0,Oe.z)(de=>{const Ie=new yn(de,{});return this.expandSegment(D,Ie,b,de,P,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(D,b,N,P,K,de){const{matched:Ie,consumedSegments:dt,remainingSegments:Jt,positionalParamSegments:yr}=_e(b,P,K);if(!Ie)return zn(b);const pn=this.applyRedirectCommands(dt,P.redirectTo,yr);return P.redirectTo.startsWith("/")?pi(pn):this.lineralizeSegments(P,pn).pipe((0,Oe.z)(Tr=>this.expandSegment(D,b,N,Tr.concat(Jt),de,!1)))}matchSegmentAgainstRoute(D,b,N,P,K){if("**"===N.path)return N.loadChildren?(N._loadedConfig?(0,xe.of)(N._loadedConfig):this.configLoader.load(D.injector,N)).pipe((0,it.U)(pn=>(N._loadedConfig=pn,new yn(P,{})))):(0,xe.of)(new yn(P,{}));const{matched:de,consumedSegments:Ie,remainingSegments:dt}=_e(b,N,P);return de?this.getChildConfig(D,N,P).pipe((0,Oe.z)(yr=>{const pn=yr.module,Tr=yr.routes,{segmentGroup:_r,slicedSegments:to}=rt(b,Ie,dt,Tr),po=new yn(_r.segments,_r.children);if(0===to.length&&po.hasChildren())return this.expandChildren(pn,Tr,po).pipe((0,it.U)(wo=>new yn(Ie,wo)));if(0===Tr.length&&0===to.length)return(0,xe.of)(new yn(Ie,{}));const Fa=Q(N)===K;return this.expandSegment(pn,po,Tr,to,Fa?Vt:K,!0).pipe((0,it.U)(Dn=>new yn(Ie.concat(Dn.segments),Dn.children)))})):zn(b)}getChildConfig(D,b,N){return b.children?(0,xe.of)(new ls(b.children,D)):b.loadChildren?void 0!==b._loadedConfig?(0,xe.of)(b._loadedConfig):this.runCanLoadGuards(D.injector,b,N).pipe((0,Oe.z)(P=>P?this.configLoader.load(D.injector,b).pipe((0,it.U)(K=>(b._loadedConfig=K,K))):function Zi(S){return at(ri(`Cannot load children because the guard of the route "path: '${S.path}'" returned false`))}(b))):(0,xe.of)(new ls([],D))}runCanLoadGuards(D,b,N){const P=b.canLoad;if(!P||0===P.length)return(0,xe.of)(!0);const K=P.map(de=>{const Ie=D.get(de);let dt;if(function lo(S){return S&&Es(S.canLoad)}(Ie))dt=Ie.canLoad(b,N);else{if(!Es(Ie))throw new Error("Invalid CanLoad guard");dt=Ie(b,N)}return fe(dt)});return(0,xe.of)(K).pipe(hi(),(0,zt.b)(de=>{if(!Ei(de))return;const Ie=ri(`Redirecting to "${this.urlSerializer.serialize(de)}"`);throw Ie.url=de,Ie}),(0,it.U)(de=>!0===de))}lineralizeSegments(D,b){let N=[],P=b.root;for(;;){if(N=N.concat(P.segments),0===P.numberOfChildren)return(0,xe.of)(N);if(P.numberOfChildren>1||!P.children[Vt])return at(new Error(`Only absolute redirects can have named outlets. redirectTo: '${D.redirectTo}'`));P=P.children[Vt]}}applyRedirectCommands(D,b,N){return this.applyRedirectCreatreUrlTree(b,this.urlSerializer.parse(b),D,N)}applyRedirectCreatreUrlTree(D,b,N,P){const K=this.createSegmentGroup(D,b.root,N,P);return new _i(K,this.createQueryParams(b.queryParams,this.urlTree.queryParams),b.fragment)}createQueryParams(D,b){const N={};return ke(D,(P,K)=>{if("string"==typeof P&&P.startsWith(":")){const Ie=P.substring(1);N[K]=b[Ie]}else N[K]=P}),N}createSegmentGroup(D,b,N,P){const K=this.createSegments(D,b.segments,N,P);let de={};return ke(b.children,(Ie,dt)=>{de[dt]=this.createSegmentGroup(D,Ie,N,P)}),new yn(K,de)}createSegments(D,b,N,P){return b.map(K=>K.path.startsWith(":")?this.findPosParam(D,K,P):this.findOrReturn(K,N))}findPosParam(D,b,N){const P=N[b.path.substring(1)];if(!P)throw new Error(`Cannot redirect to '${D}'. Cannot find '${b.path}'.`);return P}findOrReturn(D,b){let N=0;for(const P of b){if(P.path===D.path)return b.splice(N),P;N++}return D}}function G(S){const D={};for(const N of Object.keys(S.children)){const K=G(S.children[N]);(K.segments.length>0||K.hasChildren())&&(D[N]=K)}return function Ni(S){if(1===S.numberOfChildren&&S.children[Vt]){const D=S.children[Vt];return new yn(S.segments.concat(D.segments),D.children)}return S}(new yn(S.segments,D))}class F{constructor(D){this.path=D,this.route=this.path[this.path.length-1]}}class E{constructor(D,b){this.component=D,this.route=b}}function R(S,D,b){const N=S._root;return Ke(N,D?D._root:null,b,[N.value])}function oe(S,D,b){const N=function Te(S){if(!S)return null;for(let D=S.parent;D;D=D.parent){const b=D.routeConfig;if(b&&b._loadedConfig)return b._loadedConfig}return null}(D);return(N?N.module.injector:b).get(S)}function Ke(S,D,b,N,P={canDeactivateChecks:[],canActivateChecks:[]}){const K=gr(D);return S.children.forEach(de=>{(function mt(S,D,b,N,P={canDeactivateChecks:[],canActivateChecks:[]}){const K=S.value,de=D?D.value:null,Ie=b?b.getContext(S.value.outlet):null;if(de&&K.routeConfig===de.routeConfig){const dt=function Gt(S,D,b){if("function"==typeof b)return b(S,D);switch(b){case"pathParamsChange":return!Zr(S.url,D.url);case"pathParamsOrQueryParamsChange":return!Zr(S.url,D.url)||!vr(S.queryParams,D.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ss(S,D)||!vr(S.queryParams,D.queryParams);default:return!Ss(S,D)}}(de,K,K.routeConfig.runGuardsAndResolvers);dt?P.canActivateChecks.push(new F(N)):(K.data=de.data,K._resolvedData=de._resolvedData),Ke(S,D,K.component?Ie?Ie.children:null:b,N,P),dt&&Ie&&Ie.outlet&&Ie.outlet.isActivated&&P.canDeactivateChecks.push(new E(Ie.outlet.component,de))}else de&&Ut(D,Ie,P),P.canActivateChecks.push(new F(N)),Ke(S,null,K.component?Ie?Ie.children:null:b,N,P)})(de,K[de.value.outlet],b,N.concat([de.value]),P),delete K[de.value.outlet]}),ke(K,(de,Ie)=>Ut(de,b.getContext(Ie),P)),P}function Ut(S,D,b){const N=gr(S),P=S.value;ke(N,(K,de)=>{Ut(K,P.component?D?D.children.getContext(de):null:D,b)}),b.canDeactivateChecks.push(new E(P.component&&D&&D.outlet&&D.outlet.isActivated?D.outlet.component:null,P))}class gi{}function Ms(S){return new ne.y(D=>D.error(S))}class Pi{constructor(D,b,N,P,K,de){this.rootComponentType=D,this.config=b,this.urlTree=N,this.url=P,this.paramsInheritanceStrategy=K,this.relativeLinkResolution=de}recognize(){const D=rt(this.urlTree.root,[],[],this.config.filter(de=>void 0===de.redirectTo),this.relativeLinkResolution).segmentGroup,b=this.processSegmentGroup(this.config,D,Vt);if(null===b)return null;const N=new Qs([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Vt,this.rootComponentType,null,this.urlTree.root,-1,{}),P=new er(N,b),K=new qi(this.url,P);return this.inheritParamsAndData(K._root),K}inheritParamsAndData(D){const b=D.value,N=di(b,this.paramsInheritanceStrategy);b.params=Object.freeze(N.params),b.data=Object.freeze(N.data),D.children.forEach(P=>this.inheritParamsAndData(P))}processSegmentGroup(D,b,N){return 0===b.segments.length&&b.hasChildren()?this.processChildren(D,b):this.processSegment(D,b,b.segments,N)}processChildren(D,b){const N=[];for(const K of Object.keys(b.children)){const de=b.children[K],Ie=U(D,K),dt=this.processSegmentGroup(Ie,de,K);if(null===dt)return null;N.push(...dt)}const P=xo(N);return function Js(S){S.sort((D,b)=>D.value.outlet===Vt?-1:b.value.outlet===Vt?1:D.value.outlet.localeCompare(b.value.outlet))}(P),P}processSegment(D,b,N,P){for(const K of D){const de=this.processSegmentAgainstRoute(K,b,N,P);if(null!==de)return de}return qr(b,N,P)?[]:null}processSegmentAgainstRoute(D,b,N,P){if(D.redirectTo||!Jn(D,b,N,P))return null;let K,de=[],Ie=[];if("**"===D.path){const _r=N.length>0?ye(N).parameters:{};K=new Qs(N,_r,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,zo(D),Q(D),D.component,D,ju(b),Ea(b)+N.length,Ko(D))}else{const _r=_e(b,D,N);if(!_r.matched)return null;de=_r.consumedSegments,Ie=_r.remainingSegments,K=new Qs(de,_r.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,zo(D),Q(D),D.component,D,ju(b),Ea(b)+de.length,Ko(D))}const dt=function _o(S){return S.children?S.children:S.loadChildren?S._loadedConfig.routes:[]}(D),{segmentGroup:Jt,slicedSegments:yr}=rt(b,de,Ie,dt.filter(_r=>void 0===_r.redirectTo),this.relativeLinkResolution);if(0===yr.length&&Jt.hasChildren()){const _r=this.processChildren(dt,Jt);return null===_r?null:[new er(K,_r)]}if(0===dt.length&&0===yr.length)return[new er(K,[])];const pn=Q(D)===P,Tr=this.processSegment(dt,Jt,yr,pn?Vt:P);return null===Tr?null:[new er(K,Tr)]}}function la(S){const D=S.value.routeConfig;return D&&""===D.path&&void 0===D.redirectTo}function xo(S){const D=[],b=new Set;for(const N of S){if(!la(N)){D.push(N);continue}const P=D.find(K=>N.value.routeConfig===K.value.routeConfig);void 0!==P?(P.children.push(...N.children),b.add(P)):D.push(N)}for(const N of b){const P=xo(N.children);D.push(new er(N.value,P))}return D.filter(N=>!b.has(N))}function ju(S){let D=S;for(;D._sourceSegment;)D=D._sourceSegment;return D}function Ea(S){let D=S,b=D._segmentIndexShift?D._segmentIndexShift:0;for(;D._sourceSegment;)D=D._sourceSegment,b+=D._segmentIndexShift?D._segmentIndexShift:0;return b-1}function zo(S){return S.data||{}}function Ko(S){return S.resolve||{}}function No(S){return[...Object.keys(S),...Object.getOwnPropertySymbols(S)]}function Si(S){return(0,en.w)(D=>{const b=S(D);return b?(0,be.D)(b).pipe((0,it.U)(()=>D)):(0,xe.of)(D)})}class Sl extends class Hi{shouldDetach(D){return!1}store(D,b){}shouldAttach(D){return!1}retrieve(D){return null}shouldReuseRoute(D,b){return D.routeConfig===b.routeConfig}}{}const wa=new _.OlP("ROUTES");class ec{constructor(D,b,N,P){this.injector=D,this.compiler=b,this.onLoadStartListener=N,this.onLoadEndListener=P}load(D,b){if(b._loader$)return b._loader$;this.onLoadStartListener&&this.onLoadStartListener(b);const P=this.loadModuleFactory(b.loadChildren).pipe((0,it.U)(K=>{this.onLoadEndListener&&this.onLoadEndListener(b);const de=K.create(D);return new ls(Ne(de.injector.get(wa,void 0,_.XFs.Self|_.XFs.Optional)).map(B),de)}),ge(K=>{throw b._loader$=void 0,K}));return b._loader$=new ht(P,()=>new ut.x).pipe(kt()),b._loader$}loadModuleFactory(D){return fe(D()).pipe((0,Oe.z)(b=>b instanceof _.YKP?(0,xe.of)(b):(0,be.D)(this.compiler.compileModuleAsync(b))))}}class Pa{shouldProcessUrl(D){return!0}extract(D){return D}merge(D,b){return D}}function vo(S){throw S}function Wa(S,D,b){return D.parse("/")}function Po(S,D){return(0,xe.of)(null)}const Xs={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},qo={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let mr=(()=>{class S{constructor(b,N,P,K,de,Ie,dt){this.rootComponentType=b,this.urlSerializer=N,this.rootContexts=P,this.location=K,this.config=dt,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ut.x,this.errorHandler=vo,this.malformedUriErrorHandler=Wa,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Po,afterPreactivation:Po},this.urlHandlingStrategy=new Pa,this.routeReuseStrategy=new Sl,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=de.get(_.h0i),this.console=de.get(_.c2e);const pn=de.get(_.R0b);this.isNgZoneEnabled=pn instanceof _.R0b&&_.R0b.isInAngularZone(),this.resetConfig(dt),this.currentUrlTree=function qe(){return new _i(new yn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new ec(de,Ie,Tr=>this.triggerEvent(new ln(Tr)),Tr=>this.triggerEvent(new Ci(Tr))),this.routerState=Qn(this.currentUrlTree,this.rootComponentType),this.transitions=new Ge.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var b;return null===(b=this.location.getState())||void 0===b?void 0:b.\u0275routerPageId}setupNavigations(b){const N=this.events;return b.pipe((0,Je.h)(P=>0!==P.id),(0,it.U)(P=>Object.assign(Object.assign({},P),{extractedUrl:this.urlHandlingStrategy.extract(P.rawUrl)})),(0,en.w)(P=>{let K=!1,de=!1;return(0,xe.of)(P).pipe((0,zt.b)(Ie=>{this.currentNavigation={id:Ie.id,initialUrl:Ie.currentRawUrl,extractedUrl:Ie.extractedUrl,trigger:Ie.source,extras:Ie.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,en.w)(Ie=>{const dt=this.browserUrlTree.toString(),Jt=!this.navigated||Ie.extractedUrl.toString()!==dt||dt!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Jt)&&this.urlHandlingStrategy.shouldProcessUrl(Ie.rawUrl))return $s(Ie.source)&&(this.browserUrlTree=Ie.extractedUrl),(0,xe.of)(Ie).pipe((0,en.w)(pn=>{const Tr=this.transitions.getValue();return N.next(new sr(pn.id,this.serializeUrl(pn.extractedUrl),pn.source,pn.restoredState)),Tr!==this.transitions.getValue()?V.E:Promise.resolve(pn)}),function k(S,D,b,N){return(0,en.w)(P=>function ho(S,D,b,N,P){return new ds(S,D,b,N,P).apply()}(S,D,b,P.extractedUrl,N).pipe((0,it.U)(K=>Object.assign(Object.assign({},P),{urlAfterRedirects:K}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,zt.b)(pn=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:pn.urlAfterRedirects})}),function Mo(S,D,b,N,P){return(0,Oe.z)(K=>function Xn(S,D,b,N,P="emptyOnly",K="legacy"){try{const de=new Pi(S,D,b,N,P,K).recognize();return null===de?Ms(new gi):(0,xe.of)(de)}catch(de){return Ms(de)}}(S,D,K.urlAfterRedirects,b(K.urlAfterRedirects),N,P).pipe((0,it.U)(de=>Object.assign(Object.assign({},K),{targetSnapshot:de}))))}(this.rootComponentType,this.config,pn=>this.serializeUrl(pn),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,zt.b)(pn=>{if("eager"===this.urlUpdateStrategy){if(!pn.extras.skipLocationChange){const _r=this.urlHandlingStrategy.merge(pn.urlAfterRedirects,pn.rawUrl);this.setBrowserUrl(_r,pn)}this.browserUrlTree=pn.urlAfterRedirects}const Tr=new Ar(pn.id,this.serializeUrl(pn.extractedUrl),this.serializeUrl(pn.urlAfterRedirects),pn.targetSnapshot);N.next(Tr)}));if(Jt&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Tr,extractedUrl:_r,source:to,restoredState:po,extras:Fa}=Ie,Lo=new sr(Tr,this.serializeUrl(_r),to,po);N.next(Lo);const Dn=Qn(_r,this.rootComponentType).snapshot;return(0,xe.of)(Object.assign(Object.assign({},Ie),{targetSnapshot:Dn,urlAfterRedirects:_r,extras:Object.assign(Object.assign({},Fa),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=Ie.rawUrl,Ie.resolve(null),V.E}),Si(Ie=>{const{targetSnapshot:dt,id:Jt,extractedUrl:yr,rawUrl:pn,extras:{skipLocationChange:Tr,replaceUrl:_r}}=Ie;return this.hooks.beforePreactivation(dt,{navigationId:Jt,appliedUrlTree:yr,rawUrlTree:pn,skipLocationChange:!!Tr,replaceUrl:!!_r})}),(0,zt.b)(Ie=>{const dt=new Vn(Ie.id,this.serializeUrl(Ie.extractedUrl),this.serializeUrl(Ie.urlAfterRedirects),Ie.targetSnapshot);this.triggerEvent(dt)}),(0,it.U)(Ie=>Object.assign(Object.assign({},Ie),{guards:R(Ie.targetSnapshot,Ie.currentSnapshot,this.rootContexts)})),function Bn(S,D){return(0,Oe.z)(b=>{const{targetSnapshot:N,currentSnapshot:P,guards:{canActivateChecks:K,canDeactivateChecks:de}}=b;return 0===de.length&&0===K.length?(0,xe.of)(Object.assign(Object.assign({},b),{guardsResult:!0})):function cr(S,D,b,N){return(0,be.D)(S).pipe((0,Oe.z)(P=>function Cr(S,D,b,N,P){const K=D&&D.routeConfig?D.routeConfig.canDeactivate:null;if(!K||0===K.length)return(0,xe.of)(!0);const de=K.map(Ie=>{const dt=oe(Ie,D,P);let Jt;if(function oi(S){return S&&Es(S.canDeactivate)}(dt))Jt=fe(dt.canDeactivate(S,D,b,N));else{if(!Es(dt))throw new Error("Invalid CanDeactivate guard");Jt=fe(dt(S,D,b,N))}return Jt.pipe((0,Tn.P)())});return(0,xe.of)(de).pipe(hi())}(P.component,P.route,b,D,N)),(0,Tn.P)(P=>!0!==P,!0))}(de,N,P,S).pipe((0,Oe.z)(Ie=>Ie&&function Ao(S){return"boolean"==typeof S}(Ie)?function Br(S,D,b,N){return(0,be.D)(D).pipe(Ue(P=>(0,It.z)(function rr(S,D){return null!==S&&D&&D(new ei(S)),(0,xe.of)(!0)}(P.route.parent,N),function Or(S,D){return null!==S&&D&&D(new Fr(S)),(0,xe.of)(!0)}(P.route,N),function Ti(S,D,b){const N=D[D.length-1],K=D.slice(0,D.length-1).reverse().map(de=>function Y(S){const D=S.routeConfig?S.routeConfig.canActivateChild:null;return D&&0!==D.length?{node:S,guards:D}:null}(de)).filter(de=>null!==de).map(de=>nt(()=>{const Ie=de.guards.map(dt=>{const Jt=oe(dt,de.node,b);let yr;if(function co(S){return S&&Es(S.canActivateChild)}(Jt))yr=fe(Jt.canActivateChild(N,S));else{if(!Es(Jt))throw new Error("Invalid CanActivateChild guard");yr=fe(Jt(N,S))}return yr.pipe((0,Tn.P)())});return(0,xe.of)(Ie).pipe(hi())}));return(0,xe.of)(K).pipe(hi())}(S,P.path,b),function Dr(S,D,b){const N=D.routeConfig?D.routeConfig.canActivate:null;if(!N||0===N.length)return(0,xe.of)(!0);const P=N.map(K=>nt(()=>{const de=oe(K,D,b);let Ie;if(function wi(S){return S&&Es(S.canActivate)}(de))Ie=fe(de.canActivate(D,S));else{if(!Es(de))throw new Error("Invalid CanActivate guard");Ie=fe(de(D,S))}return Ie.pipe((0,Tn.P)())}));return(0,xe.of)(P).pipe(hi())}(S,P.route,b))),(0,Tn.P)(P=>!0!==P,!0))}(N,K,S,D):(0,xe.of)(Ie)),(0,it.U)(Ie=>Object.assign(Object.assign({},b),{guardsResult:Ie})))})}(this.ngModule.injector,Ie=>this.triggerEvent(Ie)),(0,zt.b)(Ie=>{if(Ei(Ie.guardsResult)){const Jt=ri(`Redirecting to "${this.serializeUrl(Ie.guardsResult)}"`);throw Jt.url=Ie.guardsResult,Jt}const dt=new Bt(Ie.id,this.serializeUrl(Ie.extractedUrl),this.serializeUrl(Ie.urlAfterRedirects),Ie.targetSnapshot,!!Ie.guardsResult);this.triggerEvent(dt)}),(0,Je.h)(Ie=>!!Ie.guardsResult||(this.restoreHistory(Ie),this.cancelNavigationTransition(Ie,""),!1)),Si(Ie=>{if(Ie.guards.canActivateChecks.length)return(0,xe.of)(Ie).pipe((0,zt.b)(dt=>{const Jt=new En(dt.id,this.serializeUrl(dt.extractedUrl),this.serializeUrl(dt.urlAfterRedirects),dt.targetSnapshot);this.triggerEvent(Jt)}),(0,en.w)(dt=>{let Jt=!1;return(0,xe.of)(dt).pipe(function ca(S,D){return(0,Oe.z)(b=>{const{targetSnapshot:N,guards:{canActivateChecks:P}}=b;if(!P.length)return(0,xe.of)(b);let K=0;return(0,be.D)(P).pipe(Ue(de=>function Ga(S,D,b,N){return function Ma(S,D,b,N){const P=No(S);if(0===P.length)return(0,xe.of)({});const K={};return(0,be.D)(P).pipe((0,Oe.z)(de=>function Na(S,D,b,N){const P=oe(S,D,N);return fe(P.resolve?P.resolve(D,b):P(D,b))}(S[de],D,b,N).pipe((0,zt.b)(Ie=>{K[de]=Ie}))),Ye(1),(0,Oe.z)(()=>No(K).length===P.length?(0,xe.of)(K):V.E))}(S._resolve,S,D,N).pipe((0,it.U)(K=>(S._resolvedData=K,S.data=Object.assign(Object.assign({},S.data),di(S,b).resolve),null)))}(de.route,N,S,D)),(0,zt.b)(()=>K++),Ye(1),(0,Oe.z)(de=>K===P.length?(0,xe.of)(b):V.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,zt.b)({next:()=>Jt=!0,complete:()=>{Jt||(this.restoreHistory(dt),this.cancelNavigationTransition(dt,"At least one route resolver didn't emit any value."))}}))}),(0,zt.b)(dt=>{const Jt=new Sn(dt.id,this.serializeUrl(dt.extractedUrl),this.serializeUrl(dt.urlAfterRedirects),dt.targetSnapshot);this.triggerEvent(Jt)}))}),Si(Ie=>{const{targetSnapshot:dt,id:Jt,extractedUrl:yr,rawUrl:pn,extras:{skipLocationChange:Tr,replaceUrl:_r}}=Ie;return this.hooks.afterPreactivation(dt,{navigationId:Jt,appliedUrlTree:yr,rawUrlTree:pn,skipLocationChange:!!Tr,replaceUrl:!!_r})}),(0,it.U)(Ie=>{const dt=function yo(S,D,b){const N=Ir(S,D._root,b?b._root:void 0);return new Yn(N,D)}(this.routeReuseStrategy,Ie.targetSnapshot,Ie.currentRouterState);return Object.assign(Object.assign({},Ie),{targetRouterState:dt})}),(0,zt.b)(Ie=>{this.currentUrlTree=Ie.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(Ie.urlAfterRedirects,Ie.rawUrl),this.routerState=Ie.targetRouterState,"deferred"===this.urlUpdateStrategy&&(Ie.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,Ie),this.browserUrlTree=Ie.urlAfterRedirects)}),((S,D,b)=>(0,it.U)(N=>(new ss(D,N.targetRouterState,N.currentRouterState,b).activate(S),N)))(this.rootContexts,this.routeReuseStrategy,Ie=>this.triggerEvent(Ie)),(0,zt.b)({next(){K=!0},complete(){K=!0}}),function qt(S){return(0,De.e)((D,b)=>{try{D.subscribe(b)}finally{b.add(S)}})}(()=>{var Ie;K||de||this.cancelNavigationTransition(P,`Navigation ID ${P.id} is not equal to the current navigation id ${this.navigationId}`),(null===(Ie=this.currentNavigation)||void 0===Ie?void 0:Ie.id)===P.id&&(this.currentNavigation=null)}),ge(Ie=>{if(de=!0,function cn(S){return S&&S[Pr]}(Ie)){const dt=Ei(Ie.url);dt||(this.navigated=!0,this.restoreHistory(P,!0));const Jt=new Hr(P.id,this.serializeUrl(P.extractedUrl),Ie.message);N.next(Jt),dt?setTimeout(()=>{const yr=this.urlHandlingStrategy.merge(Ie.url,this.rawUrlTree),pn={skipLocationChange:P.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||$s(P.source)};this.scheduleNavigation(yr,"imperative",null,pn,{resolve:P.resolve,reject:P.reject,promise:P.promise})},0):P.resolve(!1)}else{this.restoreHistory(P,!0);const dt=new Gn(P.id,this.serializeUrl(P.extractedUrl),Ie);N.next(dt);try{P.resolve(this.errorHandler(Ie))}catch(Jt){P.reject(Jt)}}return V.E}))}))}resetRootComponentType(b){this.rootComponentType=b,this.routerState.root.component=this.rootComponentType}setTransition(b){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),b))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(b=>{const N="popstate"===b.type?"popstate":"hashchange";"popstate"===N&&setTimeout(()=>{var P;const K={replaceUrl:!0},de=(null===(P=b.state)||void 0===P?void 0:P.navigationId)?b.state:null;if(de){const dt=Object.assign({},de);delete dt.navigationId,delete dt.\u0275routerPageId,0!==Object.keys(dt).length&&(K.state=dt)}const Ie=this.parseUrl(b.url);this.scheduleNavigation(Ie,N,de,K)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(b){this.events.next(b)}resetConfig(b){fi(b),this.config=b.map(B),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(b,N={}){const{relativeTo:P,queryParams:K,fragment:de,queryParamsHandling:Ie,preserveFragment:dt}=N,Jt=P||this.routerState.root,yr=dt?this.currentUrlTree.fragment:de;let pn=null;switch(Ie){case"merge":pn=Object.assign(Object.assign({},this.currentUrlTree.queryParams),K);break;case"preserve":pn=this.currentUrlTree.queryParams;break;default:pn=K||null}return null!==pn&&(pn=this.removeEmptyProps(pn)),function Pe(S,D,b,N,P){if(0===b.length)return pt(D.root,D.root,D.root,N,P);const K=function Mn(S){if("string"==typeof S[0]&&1===S.length&&"/"===S[0])return new Un(!0,0,S);let D=0,b=!1;const N=S.reduce((P,K,de)=>{if("object"==typeof K&&null!=K){if(K.outlets){const Ie={};return ke(K.outlets,(dt,Jt)=>{Ie[Jt]="string"==typeof dt?dt.split("/"):dt}),[...P,{outlets:Ie}]}if(K.segmentPath)return[...P,K.segmentPath]}return"string"!=typeof K?[...P,K]:0===de?(K.split("/").forEach((Ie,dt)=>{0==dt&&"."===Ie||(0==dt&&""===Ie?b=!0:".."===Ie?D++:""!=Ie&&P.push(Ie))}),P):[...P,K]},[]);return new Un(b,D,N)}(b);if(K.toRoot())return pt(D.root,D.root,new yn([],{}),N,P);const de=function rs(S,D,b){if(S.isAbsolute)return new tr(D.root,!0,0);if(-1===b.snapshot._lastPathIndex){const K=b.snapshot._urlSegment;return new tr(K,K===D.root,0)}const N=He(S.commands[0])?0:1;return function Bi(S,D,b){let N=S,P=D,K=b;for(;K>P;){if(K-=P,N=N.parent,!N)throw new Error("Invalid number of '../'");P=N.segments.length}return new tr(N,!1,P-K)}(b.snapshot._urlSegment,b.snapshot._lastPathIndex+N,S.numberOfDoubleDots)}(K,D,S),Ie=de.processChildren?vn(de.segmentGroup,de.index,K.commands):nr(de.segmentGroup,de.index,K.commands);return pt(D.root,de.segmentGroup,Ie,N,P)}(Jt,this.currentUrlTree,b,pn,null!=yr?yr:null)}navigateByUrl(b,N={skipLocationChange:!1}){const P=Ei(b)?b:this.parseUrl(b),K=this.urlHandlingStrategy.merge(P,this.rawUrlTree);return this.scheduleNavigation(K,"imperative",null,N)}navigate(b,N={skipLocationChange:!1}){return function da(S){for(let D=0;D<S.length;D++){const b=S[D];if(null==b)throw new Error(`The requested path contains ${b} segment at index ${D}`)}}(b),this.navigateByUrl(this.createUrlTree(b,N),N)}serializeUrl(b){return this.urlSerializer.serialize(b)}parseUrl(b){let N;try{N=this.urlSerializer.parse(b)}catch(P){N=this.malformedUriErrorHandler(P,this.urlSerializer,b)}return N}isActive(b,N){let P;if(P=!0===N?Object.assign({},Xs):!1===N?Object.assign({},qo):N,Ei(b))return hn(this.currentUrlTree,b,P);const K=this.parseUrl(b);return hn(this.currentUrlTree,K,P)}removeEmptyProps(b){return Object.keys(b).reduce((N,P)=>{const K=b[P];return null!=K&&(N[P]=K),N},{})}processNavigations(){this.navigations.subscribe(b=>{this.navigated=!0,this.lastSuccessfulId=b.id,this.currentPageId=b.targetPageId,this.events.next(new Pn(b.id,this.serializeUrl(b.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,b.resolve(!0)},b=>{this.console.warn(`Unhandled Navigation Error: ${b}`)})}scheduleNavigation(b,N,P,K,de){var Ie,dt;if(this.disposed)return Promise.resolve(!1);let Jt,yr,pn;de?(Jt=de.resolve,yr=de.reject,pn=de.promise):pn=new Promise((to,po)=>{Jt=to,yr=po});const Tr=++this.navigationId;let _r;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(P=this.location.getState()),_r=P&&P.\u0275routerPageId?P.\u0275routerPageId:K.replaceUrl||K.skipLocationChange?null!==(Ie=this.browserPageId)&&void 0!==Ie?Ie:0:(null!==(dt=this.browserPageId)&&void 0!==dt?dt:0)+1):_r=0,this.setTransition({id:Tr,targetPageId:_r,source:N,restoredState:P,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:b,extras:K,resolve:Jt,reject:yr,promise:pn,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),pn.catch(to=>Promise.reject(to))}setBrowserUrl(b,N){const P=this.urlSerializer.serialize(b),K=Object.assign(Object.assign({},N.extras.state),this.generateNgRouterState(N.id,N.targetPageId));this.location.isCurrentPathEqualTo(P)||N.extras.replaceUrl?this.location.replaceState(P,"",K):this.location.go(P,"",K)}restoreHistory(b,N=!1){var P,K;if("computed"===this.canceledNavigationResolution){const de=this.currentPageId-b.targetPageId;"popstate"!==b.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(P=this.currentNavigation)||void 0===P?void 0:P.finalUrl)||0===de?this.currentUrlTree===(null===(K=this.currentNavigation)||void 0===K?void 0:K.finalUrl)&&0===de&&(this.resetState(b),this.browserUrlTree=b.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(de)}else"replace"===this.canceledNavigationResolution&&(N&&this.resetState(b),this.resetUrlToCurrentUrlTree())}resetState(b){this.routerState=b.currentRouterState,this.currentUrlTree=b.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,b.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(b,N){const P=new Hr(b.id,this.serializeUrl(b.extractedUrl),N);this.triggerEvent(P),b.resolve(!1)}generateNgRouterState(b,N){return"computed"===this.canceledNavigationResolution?{navigationId:b,\u0275routerPageId:N}:{navigationId:b}}}return S.\u0275fac=function(b){_.$Z()},S.\u0275prov=_.Yz7({token:S,factory:S.\u0275fac}),S})();function $s(S){return"imperative"!==S}let Gi=(()=>{class S{constructor(b,N,P,K,de){this.router=b,this.route=N,this.tabIndexAttribute=P,this.renderer=K,this.el=de,this.commands=null,this.onChanges=new ut.x,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(b){if(null!=this.tabIndexAttribute)return;const N=this.renderer,P=this.el.nativeElement;null!==b?N.setAttribute(P,"tabindex",b):N.removeAttribute(P,"tabindex")}ngOnChanges(b){this.onChanges.next(this)}set routerLink(b){null!=b?(this.commands=Array.isArray(b)?b:[b],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const b={skipLocationChange:Oo(this.skipLocationChange),replaceUrl:Oo(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,b),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Oo(this.preserveFragment)})}}return S.\u0275fac=function(b){return new(b||S)(_.Y36(mr),_.Y36(Kr),_.$8M("tabindex"),_.Y36(_.Qsj),_.Y36(_.SBq))},S.\u0275dir=_.lG2({type:S,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(b,N){1&b&&_.NdJ("click",function(){return N.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[_.TTD]}),S})(),Oa=(()=>{class S{constructor(b,N,P){this.router=b,this.route=N,this.locationStrategy=P,this.commands=null,this.href=null,this.onChanges=new ut.x,this.subscription=b.events.subscribe(K=>{K instanceof Pn&&this.updateTargetUrlAndHref()})}set routerLink(b){this.commands=null!=b?Array.isArray(b)?b:[b]:null}ngOnChanges(b){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(b,N,P,K,de){if(0!==b||N||P||K||de||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const Ie={skipLocationChange:Oo(this.skipLocationChange),replaceUrl:Oo(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,Ie),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Oo(this.preserveFragment)})}}return S.\u0275fac=function(b){return new(b||S)(_.Y36(mr),_.Y36(Kr),_.Y36(hr.S$))},S.\u0275dir=_.lG2({type:S,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(b,N){1&b&&_.NdJ("click",function(K){return N.onClick(K.button,K.ctrlKey,K.shiftKey,K.altKey,K.metaKey)}),2&b&&_.uIk("target",N.target)("href",N.href,_.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[_.TTD]}),S})();function Oo(S){return""===S||!!S}let ko=(()=>{class S{constructor(b,N,P,K,de,Ie){this.router=b,this.element=N,this.renderer=P,this.cdr=K,this.link=de,this.linkWithHref=Ie,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new _.vpe,this.routerEventsSubscription=b.events.subscribe(dt=>{dt instanceof Pn&&this.update()})}ngAfterContentInit(){(0,xe.of)(this.links.changes,this.linksWithHrefs.changes,(0,xe.of)(null)).pipe((0,Yt.J)()).subscribe(b=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var b;null===(b=this.linkInputChangesSubscription)||void 0===b||b.unsubscribe();const N=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(P=>!!P).map(P=>P.onChanges);this.linkInputChangesSubscription=(0,be.D)(N).pipe((0,Yt.J)()).subscribe(P=>{this.isActive!==this.isLinkActive(this.router)(P)&&this.update()})}set routerLinkActive(b){const N=Array.isArray(b)?b:b.split(" ");this.classes=N.filter(P=>!!P)}ngOnChanges(b){this.update()}ngOnDestroy(){var b;this.routerEventsSubscription.unsubscribe(),null===(b=this.linkInputChangesSubscription)||void 0===b||b.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const b=this.hasActiveLinks();this.isActive!==b&&(this.isActive=b,this.cdr.markForCheck(),this.classes.forEach(N=>{b?this.renderer.addClass(this.element.nativeElement,N):this.renderer.removeClass(this.element.nativeElement,N)}),this.isActiveChange.emit(b))})}isLinkActive(b){const N=function ha(S){return!!S.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return P=>!!P.urlTree&&b.isActive(P.urlTree,N)}hasActiveLinks(){const b=this.isLinkActive(this.router);return this.link&&b(this.link)||this.linkWithHref&&b(this.linkWithHref)||this.links.some(b)||this.linksWithHrefs.some(b)}}return S.\u0275fac=function(b){return new(b||S)(_.Y36(mr),_.Y36(_.SBq),_.Y36(_.Qsj),_.Y36(_.sBO),_.Y36(Gi,8),_.Y36(Oa,8))},S.\u0275dir=_.lG2({type:S,selectors:[["","routerLinkActive",""]],contentQueries:function(b,N,P){if(1&b&&(_.Suo(P,Gi,5),_.Suo(P,Oa,5)),2&b){let K;_.iGM(K=_.CRH())&&(N.links=K),_.iGM(K=_.CRH())&&(N.linksWithHrefs=K)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[_.TTD]}),S})();class za{}class Ka{preload(D,b){return(0,xe.of)(null)}}let $u=(()=>{class S{constructor(b,N,P,K){this.router=b,this.injector=P,this.preloadingStrategy=K,this.loader=new ec(P,N,dt=>b.triggerEvent(new ln(dt)),dt=>b.triggerEvent(new Ci(dt)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Je.h)(b=>b instanceof Pn),Ue(()=>this.preload())).subscribe(()=>{})}preload(){const b=this.injector.get(_.h0i);return this.processRoutes(b,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(b,N){const P=[];for(const K of N)if(K.loadChildren&&!K.canLoad&&K._loadedConfig){const de=K._loadedConfig;P.push(this.processRoutes(de.module,de.routes))}else K.loadChildren&&!K.canLoad?P.push(this.preloadConfig(b,K)):K.children&&P.push(this.processRoutes(b,K.children));return(0,be.D)(P).pipe((0,Yt.J)(),(0,it.U)(K=>{}))}preloadConfig(b,N){return this.preloadingStrategy.preload(N,()=>(N._loadedConfig?(0,xe.of)(N._loadedConfig):this.loader.load(b.injector,N)).pipe((0,Oe.z)(K=>(N._loadedConfig=K,this.processRoutes(K.module,K.routes)))))}}return S.\u0275fac=function(b){return new(b||S)(_.LFG(mr),_.LFG(_.Sil),_.LFG(_.zs3),_.LFG(za))},S.\u0275prov=_.Yz7({token:S,factory:S.\u0275fac}),S})(),mi=(()=>{class S{constructor(b,N,P={}){this.router=b,this.viewportScroller=N,this.options=P,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},P.scrollPositionRestoration=P.scrollPositionRestoration||"disabled",P.anchorScrolling=P.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(b=>{b instanceof sr?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=b.navigationTrigger,this.restoredId=b.restoredState?b.restoredState.navigationId:0):b instanceof Pn&&(this.lastId=b.id,this.scheduleScrollEvent(b,this.router.parseUrl(b.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(b=>{b instanceof xr&&(b.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(b.position):b.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(b.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(b,N){this.router.triggerEvent(new xr(b,"popstate"===this.lastSource?this.store[this.restoredId]:null,N))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return S.\u0275fac=function(b){_.$Z()},S.\u0275prov=_.Yz7({token:S,factory:S.\u0275fac}),S})();const Yo=new _.OlP("ROUTER_CONFIGURATION"),eo=new _.OlP("ROUTER_FORROOT_GUARD"),Yr=[hr.Ye,{provide:si,useClass:ys},{provide:mr,useFactory:function Yi(S,D,b,N,P,K,de={},Ie,dt){const Jt=new mr(null,S,D,b,N,P,Ne(K));return Ie&&(Jt.urlHandlingStrategy=Ie),dt&&(Jt.routeReuseStrategy=dt),function Ps(S,D){S.errorHandler&&(D.errorHandler=S.errorHandler),S.malformedUriErrorHandler&&(D.malformedUriErrorHandler=S.malformedUriErrorHandler),S.onSameUrlNavigation&&(D.onSameUrlNavigation=S.onSameUrlNavigation),S.paramsInheritanceStrategy&&(D.paramsInheritanceStrategy=S.paramsInheritanceStrategy),S.relativeLinkResolution&&(D.relativeLinkResolution=S.relativeLinkResolution),S.urlUpdateStrategy&&(D.urlUpdateStrategy=S.urlUpdateStrategy),S.canceledNavigationResolution&&(D.canceledNavigationResolution=S.canceledNavigationResolution)}(de,Jt),de.enableTracing&&Jt.events.subscribe(yr=>{var pn,Tr;null===(pn=console.group)||void 0===pn||pn.call(console,`Router Event: ${yr.constructor.name}`),console.log(yr.toString()),console.log(yr),null===(Tr=console.groupEnd)||void 0===Tr||Tr.call(console)}),Jt},deps:[si,Cn,hr.Ye,_.zs3,_.Sil,wa,Yo,[class tc{},new _.FiY],[class fo{},new _.FiY]]},Cn,{provide:Kr,useFactory:function Fo(S){return S.routerState.root},deps:[mr]},$u,Ka,class Ns{preload(D,b){return b().pipe(ge(()=>(0,xe.of)(null)))}},{provide:Yo,useValue:{enableTracing:!1}}];function Eo(){return new _.PXZ("Router",mr)}let Hs=(()=>{class S{constructor(b,N){}static forRoot(b,N){return{ngModule:S,providers:[Yr,Gs(b),{provide:eo,useFactory:ka,deps:[[mr,new _.FiY,new _.tp0]]},{provide:Yo,useValue:N||{}},{provide:hr.S$,useFactory:Qr,deps:[hr.lw,[new _.tBr(hr.mr),new _.FiY],Yo]},{provide:mi,useFactory:ru,deps:[mr,hr.EM,Yo]},{provide:za,useExisting:N&&N.preloadingStrategy?N.preloadingStrategy:Ka},{provide:_.PXZ,multi:!0,useFactory:Eo},[Qo,{provide:_.ip1,multi:!0,useFactory:Hu,deps:[Qo]},{provide:ai,useFactory:xt,deps:[Qo]},{provide:_.tb,multi:!0,useExisting:ai}]]}}static forChild(b){return{ngModule:S,providers:[Gs(b)]}}}return S.\u0275fac=function(b){return new(b||S)(_.LFG(eo,8),_.LFG(mr,8))},S.\u0275mod=_.oAB({type:S}),S.\u0275inj=_.cJS({}),S})();function ru(S,D,b){return b.scrollOffset&&D.setOffset(b.scrollOffset),new mi(S,D,b)}function Qr(S,D,b={}){return b.useHash?new hr.Do(S,D):new hr.b0(S,D)}function ka(S){return"guarded"}function Gs(S){return[{provide:_.deG,multi:!0,useValue:S},{provide:wa,multi:!0,useValue:S}]}let Qo=(()=>{class S{constructor(b){this.injector=b,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ut.x}appInitializer(){return this.injector.get(hr.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let N=null;const P=new Promise(Ie=>N=Ie),K=this.injector.get(mr),de=this.injector.get(Yo);return"disabled"===de.initialNavigation?(K.setUpLocationChangeListener(),N(!0)):"enabled"===de.initialNavigation||"enabledBlocking"===de.initialNavigation?(K.hooks.afterPreactivation=()=>this.initNavigation?(0,xe.of)(null):(this.initNavigation=!0,N(!0),this.resultOfPreactivationDone),K.initialNavigation()):N(!0),P})}bootstrapListener(b){const N=this.injector.get(Yo),P=this.injector.get($u),K=this.injector.get(mi),de=this.injector.get(mr),Ie=this.injector.get(_.z2F);b===Ie.components[0]&&(("enabledNonBlocking"===N.initialNavigation||void 0===N.initialNavigation)&&de.initialNavigation(),P.setUpPreloading(),K.init(),de.resetRootComponentType(Ie.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return S.\u0275fac=function(b){return new(b||S)(_.LFG(_.zs3))},S.\u0275prov=_.Yz7({token:S,factory:S.\u0275fac}),S})();function Hu(S){return S.appInitializer.bind(S)}function xt(S){return S.bootstrapListener.bind(S)}const ai=new _.OlP("Router Initializer")},3942:(Ft,We,$)=>{$.d(We,{Z:()=>at});var _=$(2090),ne=$(4859),ie=$(9681),be=$(1877);class Ce{constructor(nt,ft){this._delegate=nt,this.firebase=ft,(0,ie._addComponent)(nt,new ne.wA("app-compat",()=>this,"PUBLIC")),this.container=nt.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(nt){this._delegate.automaticDataCollectionEnabled=nt}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(nt=>{this._delegate.checkDestroyed(),nt()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,ie.deleteApp)(this._delegate)))}_getService(nt,ft=ie._DEFAULT_ENTRY_NAME){var De;this._delegate.checkDestroyed();const kt=this._delegate.container.getProvider(nt);return!kt.isInitialized()&&"EXPLICIT"===(null===(De=kt.getComponent())||void 0===De?void 0:De.instantiationMode)&&kt.initialize(),kt.getImmediate({identifier:ft})}_removeServiceInstance(nt,ft=ie._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(nt).clearInstance(ft)}_addComponent(nt){(0,ie._addComponent)(this._delegate,nt)}_addOrOverwriteComponent(nt){(0,ie._addOrOverwriteComponent)(this._delegate,nt)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Ve=new _.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),ce=function Be(){const Dt=function Me(Dt){const nt={},ft={__esModule:!0,initializeApp:function ht(It,V={}){const ut=ie.initializeApp(It,V);if((0,_.r3)(nt,ut.name))return nt[ut.name];const ge=new Dt(ut,ft);return nt[ut.name]=ge,ge},app:kt,registerVersion:ie.registerVersion,setLogLevel:ie.setLogLevel,onLog:ie.onLog,apps:null,SDK_VERSION:ie.SDK_VERSION,INTERNAL:{registerComponent:function Ge(It){const V=It.name,ut=V.replace("-compat","");if(ie._registerComponent(It)&&"PUBLIC"===It.type){const ge=(Oe=kt())=>{if("function"!=typeof Oe[ut])throw Ve.create("invalid-app-argument",{appName:V});return Oe[ut]()};void 0!==It.serviceProps&&(0,_.ZB)(ge,It.serviceProps),ft[ut]=ge,Dt.prototype[ut]=function(...Oe){return this._getService.bind(this,V).apply(this,It.multipleInstances?Oe:[])}}return"PUBLIC"===It.type?ft[ut]:null},removeApp:function De(It){delete nt[It]},useAsService:function wt(It,V){return"serverAuth"===V?null:V},modularAPIs:ie}};function kt(It){if(!(0,_.r3)(nt,It=It||ie._DEFAULT_ENTRY_NAME))throw Ve.create("no-app",{appName:It});return nt[It]}return ft.default=ft,Object.defineProperty(ft,"apps",{get:function xe(){return Object.keys(nt).map(It=>nt[It])}}),kt.App=Dt,ft}(Ce);return Dt.INTERNAL=Object.assign(Object.assign({},Dt.INTERNAL),{createFirebaseNamespace:Be,extendNamespace:function nt(ft){(0,_.ZB)(Dt,ft)},createSubscribe:_.ne,ErrorFactory:_.LL,deepExtend:_.ZB}),Dt}(),ae=new be.Yd("@firebase/app-compat");if((0,_.jU)()&&void 0!==self.firebase){ae.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Dt=self.firebase.SDK_VERSION;Dt&&Dt.indexOf("LITE")>=0&&ae.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const at=ce;!function ot(Dt){(0,ie.registerVersion)("@firebase/app-compat","0.1.28",Dt)}()},9681:(Ft,We,$)=>{$.r(We),$.d(We,{FirebaseError:()=>be.ZR,SDK_VERSION:()=>Hr,_DEFAULT_ENTRY_NAME:()=>qt,_addComponent:()=>tn,_addOrOverwriteComponent:()=>Kt,_apps:()=>en,_clearComponents:()=>hr,_components:()=>on,_getProvider:()=>zt,_registerComponent:()=>Tn,_removeServiceInstance:()=>Yt,deleteApp:()=>Bt,getApp:()=>Ar,getApps:()=>Vn,initializeApp:()=>Gn,onLog:()=>ln,registerVersion:()=>Sn,setLogLevel:()=>Ci});var _=$(5861),ne=$(4859),ie=$(1877),be=$(2090),Ce=$(8766);class Se{constructor(fe){this.container=fe}getPlatformInfoString(){return this.container.getProviders().map(qe=>{if(function Ve(ke){const fe=ke.getComponent();return"VERSION"===(null==fe?void 0:fe.type)}(qe)){const At=qe.getImmediate();return`${At.library}/${At.version}`}return null}).filter(qe=>qe).join(" ")}}const Me="@firebase/app",ce=new ie.Yd("@firebase/app"),qt="[DEFAULT]",it={[Me]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},en=new Map,on=new Map;function tn(ke,fe){try{ke.container.addComponent(fe)}catch(qe){ce.debug(`Component ${fe.name} failed to register with FirebaseApp ${ke.name}`,qe)}}function Kt(ke,fe){ke.container.addOrOverwriteComponent(fe)}function Tn(ke){const fe=ke.name;if(on.has(fe))return ce.debug(`There were multiple attempts to register component ${fe}.`),!1;on.set(fe,ke);for(const qe of en.values())tn(qe,ke);return!0}function zt(ke,fe){const qe=ke.container.getProvider("heartbeat").getImmediate({optional:!0});return qe&&qe.triggerHeartbeat(),ke.container.getProvider(fe)}function Yt(ke,fe,qe=qt){zt(ke,fe).clearInstance(qe)}function hr(){on.clear()}const sr=new be.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class Pn{constructor(fe,qe,At){this._isDeleted=!1,this._options=Object.assign({},fe),this._config=Object.assign({},qe),this._name=qe.name,this._automaticDataCollectionEnabled=qe.automaticDataCollectionEnabled,this._container=At,this.container.addComponent(new ne.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(fe){this.checkDestroyed(),this._automaticDataCollectionEnabled=fe}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(fe){this._isDeleted=fe}checkDestroyed(){if(this.isDeleted)throw sr.create("app-deleted",{appName:this._name})}}const Hr="9.8.4";function Gn(ke,fe={}){"object"!=typeof fe&&(fe={name:fe});const qe=Object.assign({name:qt,automaticDataCollectionEnabled:!1},fe),At=qe.name;if("string"!=typeof At||!At)throw sr.create("bad-app-name",{appName:String(At)});const $t=en.get(At);if($t){if((0,be.vZ)(ke,$t.options)&&(0,be.vZ)(qe,$t.config))return $t;throw sr.create("duplicate-app",{appName:At})}const hn=new ne.H0(At);for(const lr of on.values())hn.addComponent(lr);const or=new Pn(ke,qe,hn);return en.set(At,or),or}function Ar(ke=qt){const fe=en.get(ke);if(!fe)throw sr.create("no-app",{appName:ke});return fe}function Vn(){return Array.from(en.values())}function Bt(ke){return En.apply(this,arguments)}function En(){return(En=(0,_.Z)(function*(ke){const fe=ke.name;en.has(fe)&&(en.delete(fe),yield Promise.all(ke.container.getProviders().map(qe=>qe.delete())),ke.isDeleted=!0)})).apply(this,arguments)}function Sn(ke,fe,qe){var At;let $t=null!==(At=it[ke])&&void 0!==At?At:ke;qe&&($t+=`-${qe}`);const hn=$t.match(/\s|\//),or=fe.match(/\s|\//);if(hn||or){const lr=[`Unable to register library "${$t}" with version "${fe}":`];return hn&&lr.push(`library name "${$t}" contains illegal characters (whitespace or "/")`),hn&&or&&lr.push("and"),or&&lr.push(`version name "${fe}" contains illegal characters (whitespace or "/")`),void ce.warn(lr.join(" "))}Tn(new ne.wA(`${$t}-version`,()=>({library:$t,version:fe}),"VERSION"))}function ln(ke,fe){if(null!==ke&&"function"!=typeof ke)throw sr.create("invalid-log-argument");(0,ie.Am)(ke,fe)}function Ci(ke){(0,ie.Ub)(ke)}const Fr="firebase-heartbeat-store";let ci=null;function xr(){return ci||(ci=(0,Ce.X3)("firebase-heartbeat-database",1,{upgrade:(ke,fe)=>{0===fe&&ke.createObjectStore(Fr)}}).catch(ke=>{throw sr.create("storage-open",{originalErrorMessage:ke.message})})),ci}function Xt(){return(Xt=(0,_.Z)(function*(ke){var fe;try{return(yield xr()).transaction(Fr).objectStore(Fr).get(ri(ke))}catch(qe){throw sr.create("storage-get",{originalErrorMessage:null===(fe=qe)||void 0===fe?void 0:fe.message})}})).apply(this,arguments)}function nn(ke,fe){return Pr.apply(this,arguments)}function Pr(){return(Pr=(0,_.Z)(function*(ke,fe){var qe;try{const $t=(yield xr()).transaction(Fr,"readwrite");return yield $t.objectStore(Fr).put(fe,ri(ke)),$t.done}catch(At){throw sr.create("storage-set",{originalErrorMessage:null===(qe=At)||void 0===qe?void 0:qe.message})}})).apply(this,arguments)}function ri(ke){return`${ke.name}!${ke.options.appId}`}class Lr{constructor(fe){this.container=fe,this._heartbeatsCache=null;const qe=this.container.getProvider("app").getImmediate();this._storage=new Ne(qe),this._heartbeatsCachePromise=this._storage.read().then(At=>(this._heartbeatsCache=At,At))}triggerHeartbeat(){var fe=this;return(0,_.Z)(function*(){const At=fe.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),$t=vr();if(null===fe._heartbeatsCache&&(fe._heartbeatsCache=yield fe._heartbeatsCachePromise),fe._heartbeatsCache.lastSentHeartbeatDate!==$t&&!fe._heartbeatsCache.heartbeats.some(hn=>hn.date===$t))return fe._heartbeatsCache.heartbeats.push({date:$t,agent:At}),fe._heartbeatsCache.heartbeats=fe._heartbeatsCache.heartbeats.filter(hn=>{const or=new Date(hn.date).valueOf();return Date.now()-or<=2592e6}),fe._storage.overwrite(fe._heartbeatsCache)})()}getHeartbeatsHeader(){var fe=this;return(0,_.Z)(function*(){if(null===fe._heartbeatsCache&&(yield fe._heartbeatsCachePromise),null===fe._heartbeatsCache||0===fe._heartbeatsCache.heartbeats.length)return"";const qe=vr(),{heartbeatsToSend:At,unsentEntries:$t}=function dn(ke,fe=1024){const qe=[];let At=ke.slice();for(const $t of ke){const hn=qe.find(or=>or.agent===$t.agent);if(hn){if(hn.dates.push($t.date),ye(qe)>fe){hn.dates.pop();break}}else if(qe.push({agent:$t.agent,dates:[$t.date]}),ye(qe)>fe){qe.pop();break}At=At.slice(1)}return{heartbeatsToSend:qe,unsentEntries:At}}(fe._heartbeatsCache.heartbeats),hn=(0,be.L)(JSON.stringify({version:2,heartbeats:At}));return fe._heartbeatsCache.lastSentHeartbeatDate=qe,$t.length>0?(fe._heartbeatsCache.heartbeats=$t,yield fe._storage.overwrite(fe._heartbeatsCache)):(fe._heartbeatsCache.heartbeats=[],fe._storage.overwrite(fe._heartbeatsCache)),hn})()}}function vr(){return(new Date).toISOString().substring(0,10)}class Ne{constructor(fe){this.app=fe,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,_.Z)(function*(){return!!(0,be.hl)()&&(0,be.eu)().then(()=>!0).catch(()=>!1)})()}read(){var fe=this;return(0,_.Z)(function*(){return(yield fe._canUseIndexedDBPromise)&&(yield function Vt(ke){return Xt.apply(this,arguments)}(fe.app))||{heartbeats:[]}})()}overwrite(fe){var qe=this;return(0,_.Z)(function*(){var At;if(yield qe._canUseIndexedDBPromise){const hn=yield qe.read();return nn(qe.app,{lastSentHeartbeatDate:null!==(At=fe.lastSentHeartbeatDate)&&void 0!==At?At:hn.lastSentHeartbeatDate,heartbeats:fe.heartbeats})}})()}add(fe){var qe=this;return(0,_.Z)(function*(){var At;if(yield qe._canUseIndexedDBPromise){const hn=yield qe.read();return nn(qe.app,{lastSentHeartbeatDate:null!==(At=fe.lastSentHeartbeatDate)&&void 0!==At?At:hn.lastSentHeartbeatDate,heartbeats:[...hn.heartbeats,...fe.heartbeats]})}})()}}function ye(ke){return(0,be.L)(JSON.stringify({version:2,heartbeats:ke})).length}!function je(ke){Tn(new ne.wA("platform-logger",fe=>new Se(fe),"PRIVATE")),Tn(new ne.wA("heartbeat",fe=>new Lr(fe),"PRIVATE")),Sn(Me,"0.7.27",ke),Sn(Me,"0.7.27","esm2017"),Sn("fire-js","")}("")},4859:(Ft,We,$)=>{$.d(We,{wA:()=>ie,H0:()=>Me,zt:()=>Ce});var _=$(5861),ne=$(2090);class ie{constructor(ce,ae,Re){this.name=ce,this.instanceFactory=ae,this.type=Re,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(ce){return this.instantiationMode=ce,this}setMultipleInstances(ce){return this.multipleInstances=ce,this}setServiceProps(ce){return this.serviceProps=ce,this}setInstanceCreatedCallback(ce){return this.onInstanceCreated=ce,this}}const be="[DEFAULT]";class Ce{constructor(ce,ae){this.name=ce,this.container=ae,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(ce){const ae=this.normalizeInstanceIdentifier(ce);if(!this.instancesDeferred.has(ae)){const Re=new ne.BH;if(this.instancesDeferred.set(ae,Re),this.isInitialized(ae)||this.shouldAutoInitialize())try{const Rt=this.getOrInitializeService({instanceIdentifier:ae});Rt&&Re.resolve(Rt)}catch(Rt){}}return this.instancesDeferred.get(ae).promise}getImmediate(ce){var ae;const Re=this.normalizeInstanceIdentifier(null==ce?void 0:ce.identifier),Rt=null!==(ae=null==ce?void 0:ce.optional)&&void 0!==ae&&ae;if(!this.isInitialized(Re)&&!this.shouldAutoInitialize()){if(Rt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Re})}catch(ot){if(Rt)return null;throw ot}}getComponent(){return this.component}setComponent(ce){if(ce.name!==this.name)throw Error(`Mismatching Component ${ce.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=ce,this.shouldAutoInitialize()){if(function Ve(Be){return"EAGER"===Be.instantiationMode}(ce))try{this.getOrInitializeService({instanceIdentifier:be})}catch(ae){}for(const[ae,Re]of this.instancesDeferred.entries()){const Rt=this.normalizeInstanceIdentifier(ae);try{const ot=this.getOrInitializeService({instanceIdentifier:Rt});Re.resolve(ot)}catch(ot){}}}}clearInstance(ce=be){this.instancesDeferred.delete(ce),this.instancesOptions.delete(ce),this.instances.delete(ce)}delete(){var ce=this;return(0,_.Z)(function*(){const ae=Array.from(ce.instances.values());yield Promise.all([...ae.filter(Re=>"INTERNAL"in Re).map(Re=>Re.INTERNAL.delete()),...ae.filter(Re=>"_delete"in Re).map(Re=>Re._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(ce=be){return this.instances.has(ce)}getOptions(ce=be){return this.instancesOptions.get(ce)||{}}initialize(ce={}){const{options:ae={}}=ce,Re=this.normalizeInstanceIdentifier(ce.instanceIdentifier);if(this.isInitialized(Re))throw Error(`${this.name}(${Re}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Rt=this.getOrInitializeService({instanceIdentifier:Re,options:ae});for(const[ot,at]of this.instancesDeferred.entries())Re===this.normalizeInstanceIdentifier(ot)&&at.resolve(Rt);return Rt}onInit(ce,ae){var Re;const Rt=this.normalizeInstanceIdentifier(ae),ot=null!==(Re=this.onInitCallbacks.get(Rt))&&void 0!==Re?Re:new Set;ot.add(ce),this.onInitCallbacks.set(Rt,ot);const at=this.instances.get(Rt);return at&&ce(at,Rt),()=>{ot.delete(ce)}}invokeOnInitCallbacks(ce,ae){const Re=this.onInitCallbacks.get(ae);if(Re)for(const Rt of Re)try{Rt(ce,ae)}catch(ot){}}getOrInitializeService({instanceIdentifier:ce,options:ae={}}){let Re=this.instances.get(ce);if(!Re&&this.component&&(Re=this.component.instanceFactory(this.container,{instanceIdentifier:(Be=ce,Be===be?void 0:Be),options:ae}),this.instances.set(ce,Re),this.instancesOptions.set(ce,ae),this.invokeOnInitCallbacks(Re,ce),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,ce,Re)}catch(Rt){}var Be;return Re||null}normalizeInstanceIdentifier(ce=be){return this.component?this.component.multipleInstances?ce:be:ce}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Me{constructor(ce){this.name=ce,this.providers=new Map}addComponent(ce){const ae=this.getProvider(ce.name);if(ae.isComponentSet())throw new Error(`Component ${ce.name} has already been registered with ${this.name}`);ae.setComponent(ce)}addOrOverwriteComponent(ce){this.getProvider(ce.name).isComponentSet()&&this.providers.delete(ce.name),this.addComponent(ce)}getProvider(ce){if(this.providers.has(ce))return this.providers.get(ce);const ae=new Ce(ce,this);return this.providers.set(ce,ae),ae}getProviders(){return Array.from(this.providers.values())}}},1877:(Ft,We,$)=>{$.d(We,{in:()=>ne,Yd:()=>Ve,Ub:()=>Me,Am:()=>Be});const _=[];var ne=(()=>{return(ce=ne||(ne={}))[ce.DEBUG=0]="DEBUG",ce[ce.VERBOSE=1]="VERBOSE",ce[ce.INFO=2]="INFO",ce[ce.WARN=3]="WARN",ce[ce.ERROR=4]="ERROR",ce[ce.SILENT=5]="SILENT",ne;var ce})();const ie={debug:ne.DEBUG,verbose:ne.VERBOSE,info:ne.INFO,warn:ne.WARN,error:ne.ERROR,silent:ne.SILENT},be=ne.INFO,Ce={[ne.DEBUG]:"log",[ne.VERBOSE]:"log",[ne.INFO]:"info",[ne.WARN]:"warn",[ne.ERROR]:"error"},Se=(ce,ae,...Re)=>{if(ae<ce.logLevel)return;const Rt=(new Date).toISOString(),ot=Ce[ae];if(!ot)throw new Error(`Attempted to log a message with an invalid logType (value: ${ae})`);console[ot](`[${Rt}]  ${ce.name}:`,...Re)};class Ve{constructor(ae){this.name=ae,this._logLevel=be,this._logHandler=Se,this._userLogHandler=null,_.push(this)}get logLevel(){return this._logLevel}set logLevel(ae){if(!(ae in ne))throw new TypeError(`Invalid value "${ae}" assigned to \`logLevel\``);this._logLevel=ae}setLogLevel(ae){this._logLevel="string"==typeof ae?ie[ae]:ae}get logHandler(){return this._logHandler}set logHandler(ae){if("function"!=typeof ae)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ae}get userLogHandler(){return this._userLogHandler}set userLogHandler(ae){this._userLogHandler=ae}debug(...ae){this._userLogHandler&&this._userLogHandler(this,ne.DEBUG,...ae),this._logHandler(this,ne.DEBUG,...ae)}log(...ae){this._userLogHandler&&this._userLogHandler(this,ne.VERBOSE,...ae),this._logHandler(this,ne.VERBOSE,...ae)}info(...ae){this._userLogHandler&&this._userLogHandler(this,ne.INFO,...ae),this._logHandler(this,ne.INFO,...ae)}warn(...ae){this._userLogHandler&&this._userLogHandler(this,ne.WARN,...ae),this._logHandler(this,ne.WARN,...ae)}error(...ae){this._userLogHandler&&this._userLogHandler(this,ne.ERROR,...ae),this._logHandler(this,ne.ERROR,...ae)}}function Me(ce){_.forEach(ae=>{ae.setLogLevel(ce)})}function Be(ce,ae){for(const Re of _){let Rt=null;ae&&ae.level&&(Rt=ie[ae.level]),Re.userLogHandler=null===ce?null:(ot,at,...Dt)=>{const nt=Dt.map(ft=>{if(null==ft)return null;if("string"==typeof ft)return ft;if("number"==typeof ft||"boolean"==typeof ft)return ft.toString();if(ft instanceof Error)return ft.message;try{return JSON.stringify(ft)}catch(De){return null}}).filter(ft=>ft).join(" ");at>=(null!=Rt?Rt:ot.logLevel)&&ce({level:ne[at].toLowerCase(),message:nt,args:Dt,type:ot.name})}}}},8766:(Ft,We,$)=>{$.d(We,{Lj:()=>ht,X3:()=>kt});var _=$(5861);let ie,be;const Ve=new WeakMap,Me=new WeakMap,Be=new WeakMap,ce=new WeakMap,ae=new WeakMap;let ot={get(V,ut,ge){if(V instanceof IDBTransaction){if("done"===ut)return Me.get(V);if("objectStoreNames"===ut)return V.objectStoreNames||Be.get(V);if("store"===ut)return ge.objectStoreNames[1]?void 0:ge.objectStore(ge.objectStoreNames[0])}return ft(V[ut])},set:(V,ut,ge)=>(V[ut]=ge,!0),has:(V,ut)=>V instanceof IDBTransaction&&("done"===ut||"store"===ut)||ut in V};function nt(V){return"function"==typeof V?function Dt(V){return V!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Se(){return be||(be=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(V)?function(...ut){return V.apply(De(this),ut),ft(Ve.get(this))}:function(...ut){return ft(V.apply(De(this),ut))}:function(ut,...ge){const Oe=V.call(De(this),ut,...ge);return Be.set(Oe,ut.sort?ut.sort():[ut]),ft(Oe)}}(V):(V instanceof IDBTransaction&&function Rt(V){if(Me.has(V))return;const ut=new Promise((ge,Oe)=>{const Ue=()=>{V.removeEventListener("complete",Je),V.removeEventListener("error",Ye),V.removeEventListener("abort",Ye)},Je=()=>{ge(),Ue()},Ye=()=>{Oe(V.error||new DOMException("AbortError","AbortError")),Ue()};V.addEventListener("complete",Je),V.addEventListener("error",Ye),V.addEventListener("abort",Ye)});Me.set(V,ut)}(V),((V,ut)=>ut.some(ge=>V instanceof ge))(V,function Ce(){return ie||(ie=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(V,ot):V)}function ft(V){if(V instanceof IDBRequest)return function Re(V){const ut=new Promise((ge,Oe)=>{const Ue=()=>{V.removeEventListener("success",Je),V.removeEventListener("error",Ye)},Je=()=>{ge(ft(V.result)),Ue()},Ye=()=>{Oe(V.error),Ue()};V.addEventListener("success",Je),V.addEventListener("error",Ye)});return ut.then(ge=>{ge instanceof IDBCursor&&Ve.set(ge,V)}).catch(()=>{}),ae.set(ut,V),ut}(V);if(ce.has(V))return ce.get(V);const ut=nt(V);return ut!==V&&(ce.set(V,ut),ae.set(ut,V)),ut}const De=V=>ae.get(V);function kt(V,ut,{blocked:ge,upgrade:Oe,blocking:Ue,terminated:Je}={}){const Ye=indexedDB.open(V,ut),St=ft(Ye);return Oe&&Ye.addEventListener("upgradeneeded",Pt=>{Oe(ft(Ye.result),Pt.oldVersion,Pt.newVersion,ft(Ye.transaction))}),ge&&Ye.addEventListener("blocked",()=>ge()),St.then(Pt=>{Je&&Pt.addEventListener("close",()=>Je()),Ue&&Pt.addEventListener("versionchange",()=>Ue())}).catch(()=>{}),St}function ht(V,{blocked:ut}={}){const ge=indexedDB.deleteDatabase(V);return ut&&ge.addEventListener("blocked",()=>ut()),ft(ge).then(()=>{})}const xe=["get","getKey","getAll","getAllKeys","count"],Ge=["put","add","delete","clear"],wt=new Map;function It(V,ut){if(!(V instanceof IDBDatabase)||ut in V||"string"!=typeof ut)return;if(wt.get(ut))return wt.get(ut);const ge=ut.replace(/FromIndex$/,""),Oe=ut!==ge,Ue=Ge.includes(ge);if(!(ge in(Oe?IDBIndex:IDBObjectStore).prototype)||!Ue&&!xe.includes(ge))return;const Je=function(){var Ye=(0,_.Z)(function*(St,...Pt){const Wt=this.transaction(St,Ue?"readwrite":"readonly");let qt=Wt.store;return Oe&&(qt=qt.index(Pt.shift())),(yield Promise.all([qt[ge](...Pt),Ue&&Wt.done]))[0]});return function(Pt){return Ye.apply(this,arguments)}}();return wt.set(ut,Je),Je}!function at(V){ot=V(ot)}(V=>WE(GE({},V),{get:(ut,ge,Oe)=>It(ut,ge)||V.get(ut,ge,Oe),has:(ut,ge)=>!!It(ut,ge)||V.has(ut,ge)}))},5861:(Ft,We,$)=>{function _(ie,be,Ce,Se,Ve,Me,Be){try{var ce=ie[Me](Be),ae=ce.value}catch(Re){return void Ce(Re)}ce.done?be(ae):Promise.resolve(ae).then(Se,Ve)}function ne(ie){return function(){var be=this,Ce=arguments;return new Promise(function(Se,Ve){var Me=ie.apply(be,Ce);function Be(ae){_(Me,Se,Ve,Be,ce,"next",ae)}function ce(ae){_(Me,Se,Ve,Be,ce,"throw",ae)}Be(void 0)})}}$.d(We,{Z:()=>ne})}},Ft=>{Ft(Ft.s=8343)}]);